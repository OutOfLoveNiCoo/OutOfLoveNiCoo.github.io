<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>OutOfLoveğŸ¥</title>
  
  
  <link href="https://outoflovenicoo.github.io/atom.xml" rel="self"/>
  
  <link href="https://outoflovenicoo.github.io/"/>
  <updated>2025-04-17T14:00:00.000Z</updated>
  <id>https://outoflovenicoo.github.io/</id>
  
  <author>
    <name>OutOfLoveğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åä¸º416æ‰¹æ¬¡ç¬”è¯•</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-04-17-%E5%8D%8E%E4%B8%BA416%E6%89%B9%E6%AC%A1%E7%AC%94%E8%AF%95.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-04-17-%E5%8D%8E%E4%B8%BA416%E6%89%B9%E6%AC%A1%E7%AC%94%E8%AF%95.html</id>
    <published>2025-04-17T10:19:03.000Z</published>
    <updated>2025-04-17T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2025å¹´4æœˆ16æ—¥åä¸ºç¬”è¯•å¤ç›˜"><a href="#2025å¹´4æœˆ16æ—¥åä¸ºç¬”è¯•å¤ç›˜" class="headerlink" title="2025å¹´4æœˆ16æ—¥åä¸ºç¬”è¯•å¤ç›˜"></a>2025å¹´4æœˆ16æ—¥åä¸ºç¬”è¯•å¤ç›˜</h1><p>â€‹    è¿™åœºç¬”è¯•åšçš„å¾ˆç³Ÿç³•ï¼Œä¸‰é“é¢˜ä¸€é“ä¹Ÿæ²¡aå‡ºæ¥ï¼Œä¸è¿‡å¹¸å¥½æœ€ååŠæ ¼äº†ï¼Œæˆ‘è§‰å¾—éœ€è¦å¤ç›˜ä¸€ä¸‹ä¸ºä»€ä¹ˆåšçš„è¿™ä¹ˆç³Ÿç³•ã€‚</p><p>â€‹    é¢˜ç›®æ¥æºç½‘ç«™ï¼šCodeFun:<a href="https://codefun2000.com/pset/673c82a4d67fed3f6531c8e1">https://codefun2000.com/pset/673c82a4d67fed3f6531c8e1</a></p><h2 id="ç¬¬ä¸€é¢˜"><a href="#ç¬¬ä¸€é¢˜" class="headerlink" title="ç¬¬ä¸€é¢˜"></a>ç¬¬ä¸€é¢˜</h2><p><a href="https://codefun2000.com/p/P2845">https://codefun2000.com/p/P2845</a></p><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418102041869.png" alt="image-20250418102041869"></p><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418102120394.png" alt="image-20250418102120394"></p><p>å…¶å®çœ‹åˆ°è¿™ä¸€é¢˜ï¼Œæˆ‘ç¬¬ä¸€çœ¼å°±æƒ³åˆ°ç”¨ä½è¿ç®—ï¼Œä½†æ˜¯ä½è¿ç®—ä¸çŸ¥é“è¯¥æ€ä¹ˆæ ·å»éå†ï¼Œå› ä¸ºç­”æ¡ˆå¯èƒ½æœ‰å¤šä¸ªè¡Œå åŠ ã€‚æ‰€ä»¥æˆ‘é‡‡å–äº†ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„dfsæ–¹æ³•å»éå†æ‰€æœ‰å¯èƒ½(ä½†æ˜¯æ²¡æ³¨æ„åˆ°m,nçš„é•¿åº¦æœ€å¤§ä¸º1000ï¼Œä½è¿ç®—è‚¯å®šè¶…æ—¶)ã€‚</p><p>è¿™æ˜¯å½“æ—¶çš„åšæ³•ï¼ˆå›å¿†ç‰ˆï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[][] cases;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> minCount;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        cases = <span class="keyword">new</span> <span class="title class_">int</span>[i][j];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0</span>; x &lt; i; x++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> <span class="number">0</span>; y &lt; j; y++) &#123;</span><br><span class="line">                cases[x][y] = sc.nextInt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span>[] covered = <span class="keyword">new</span> <span class="title class_">boolean</span>[j];</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">        dfs(covered,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        System.out.println(allCovered ? count : -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// DFS</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(<span class="type">boolean</span>[] covered, <span class="type">int</span> caseIndex, <span class="type">int</span> selected, <span class="type">int</span> coveredCount)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­å½“å‰æ˜¯å¦å·²ç»è¦†ç›–äº†æ‰€æœ‰æ¨¡å—</span></span><br><span class="line">        <span class="keyword">if</span> (coveredCount == covered.length) &#123;</span><br><span class="line">            minCount = Math.min(minCount, selected); <span class="comment">// æ›´æ–°æœ€å°æµ‹è¯•ç”¨ä¾‹æ•°</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰å·²é€‰æ‹©çš„æµ‹è¯•ç”¨ä¾‹æ•°é‡å·²ç»å¤§äºæˆ–ç­‰äºæœ€å°å€¼ï¼Œå‰ªæ</span></span><br><span class="line">        <span class="keyword">if</span> (selected &gt;= minCount) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€’å½’é€‰æ‹©æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> caseIndex; i &lt; cases.length; i++) &#123;</span><br><span class="line">            <span class="type">boolean</span>[] newCov = Arrays.copyOf(covered, covered.length); <span class="comment">// å¤åˆ¶å½“å‰å·²è¦†ç›–çš„æ¨¡å—</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">newCovCount</span> <span class="operator">=</span> coveredCount;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ›´æ–°è¦†ç›–çŠ¶æ€</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; cases[i].length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cases[i][j] == <span class="number">1</span> &amp;&amp; !newCov[j]) &#123;</span><br><span class="line">                    newCov[j] = <span class="literal">true</span>;</span><br><span class="line">                    newCovCount++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            dfs(newCov, i + <span class="number">1</span>, selected + <span class="number">1</span>, newCovCount);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–è¶…æ—¶äº†ï¼Œæœ€ååªé€šè¿‡äº†25%ğŸ˜­ï¼Œè¿™é“é¢˜åšäº†åŠå¤©æ²¡aå‡ºæ¥ï¼Œ<strong>è¿›è€Œå½±å“äº†ä¸‹ä¸€é“é¢˜</strong>ã€‚</p><p>å†æ¥è¯´ä¸€ä¸‹è¿™é“é¢˜çš„æ­£ç¡®åšæ³•å§ï¼Œè½¬åŒ–æˆé›†åˆå»éå†ï¼Œè¿™é‡Œæ²¡æƒ³åˆ°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">// è¯»å–æµ‹è¯•ç”¨ä¾‹æ€»æ•° n å’Œæ¨¡å—æ€»æ•° m</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">int</span>[] tests = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è½¬æ¢ä¸ºä½æ©ç è¡¨ç¤º</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mask</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">                <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">                    mask |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tests[i] = mask;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç›®æ ‡æ©ç ï¼šæ‰€æœ‰æ¨¡å—éƒ½è¢«è¦†ç›–ï¼ˆä½ m ä½å…¨ä¸º 1ï¼‰</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">target</span> <span class="operator">=</span> (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æšä¸¾æ‰€æœ‰å¯èƒ½çš„æµ‹è¯•ç”¨ä¾‹å­é›†ï¼ˆé‡‡ç”¨äºŒè¿›åˆ¶æšä¸¾ï¼‰</span></span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">      æš´åŠ›æšä¸¾ï¼Œè¿™é‡Œæ²¡æƒ³åˆ°</span></span><br><span class="line"><span class="comment">      0 0 0 éƒ½ä¸é€‰</span></span><br><span class="line"><span class="comment">      0 0 1 é€‰ç¬¬ä¸€ä¸ª</span></span><br><span class="line"><span class="comment">      0 1 1 é€‰ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ª</span></span><br><span class="line"><span class="comment">      1 1 1 å…¨é€‰</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> <span class="number">0</span>; s &lt; (<span class="number">1</span> &lt;&lt; n); s++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">unionMask</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// éå†å­é›†ä¸­çš„æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå°†å…¶è¦†ç›–æƒ…å†µåˆå¹¶</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">              <span class="comment">// é€‰å½“å‰è¡Œ</span></span><br><span class="line">                <span class="keyword">if</span> ((s &amp; (<span class="number">1</span> &lt;&lt; i)) != <span class="number">0</span>) &#123;</span><br><span class="line">                    unionMask |= tests[i];</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰å­é›†èƒ½å¤Ÿè¦†ç›–æ‰€æœ‰æ¨¡å—ï¼Œåˆ™æ›´æ–°ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">if</span> (unionMask == target) &#123;</span><br><span class="line">                ans = Math.min(ans, cnt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰æ»¡è¶³è¦æ±‚çš„å­é›†ï¼Œè¾“å‡º -1ï¼›å¦åˆ™è¾“å‡ºæœ€å°ç”¨ä¾‹æ•°</span></span><br><span class="line">        System.out.println(ans == Integer.MAX_VALUE ? -<span class="number">1</span> : ans);</span><br><span class="line">        sc.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒé¢˜"><a href="#ç¬¬äºŒé¢˜" class="headerlink" title="ç¬¬äºŒé¢˜"></a>ç¬¬äºŒé¢˜</h2><p><a href="https://codefun2000.com/p/P2846">https://codefun2000.com/p/P2846</a></p><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418105640610.png" alt="image-20250418105640610"></p><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418105657826.png" alt="image-20250418105657826"></p><p>å› ä¸ºç¬¬ä¸€é¢˜æ²¡aå‡ºæ¥ï¼Œå¯¼è‡´åšè¿™é¢˜çš„æ€è·¯éƒ½å¾ˆä¹±ã€‚ä¸€å¼€å§‹æƒ³ç”¨ä¸€ä¸ªTreeSetå»å­˜å‚¨å›¾çš„ä¿¡æ¯ï¼Œå‘ç°è¿™æ ·åšä¸å¯¹ã€‚</p><p>ç„¶åæƒ³ç€ç”¨ä¸€ä¸ªHashMapå»å­˜é¢†æ¥è¡¨ï¼Œä½†æ˜¯æ„Ÿè§‰å›¾çš„æ„å»ºå¾ˆéº»çƒ¦ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒå‘å›¾ï¼Œæ•´ä¸ªæ€è·¯éƒ½æ˜¯ä¹±çš„ï¼Œæƒ³å…ˆå†™BFSçš„ä»£ç ï¼Œå†™åˆ°ä¸€åŠæ„æ€åˆ°æ—¶é—´å¯èƒ½å¿«ä¸å¤Ÿäº†ï¼Œç»§ç»­åšè¿™é¢˜åšä¸å‡ºæ¥è¿™æ¬¡ç¬”è¯•å°±è¿‡ä¸äº†ï¼Œæ²¡åŠæ³•ï¼Œåªèƒ½èˆå¼ƒäº†ï¼Œç›´æ¥è¾“å‡ºâ€œNAâ€éª—äº†7%çš„åˆ†ï¼Œæƒ­æ„§ğŸ˜­ã€‚</p><p>åé¢åšå®Œç¬¬ä¸‰é¢˜å†æ¥çœ‹ç¬¬äºŒé¢˜ï¼Œå‘ç°DFSåº”è¯¥ä¹Ÿèƒ½åšï¼Œä½†æ˜¯æ²¡æ—¶é—´äº†ã€‚ã€‚ã€‚ä¸»è¦æ˜¯è¿™é¢˜å›¾çš„æ„å»ºè¦å¤æ‚ä¸€ç‚¹ã€‚</p><p><strong>æ­£ç¡®åšæ³•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RouteFinder</span> &#123;</span><br><span class="line">    <span class="comment">// çº¿è·¯æ•°é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> N;</span><br><span class="line">    <span class="comment">// èµ·ç‚¹ç«™</span></span><br><span class="line">    <span class="keyword">static</span> String start;</span><br><span class="line">    <span class="comment">// ç»ˆç‚¹ç«™</span></span><br><span class="line">    <span class="keyword">static</span> String target;</span><br><span class="line">    <span class="comment">// å­˜å‚¨çº¿è·¯ä¹‹é—´çš„æ¢ä¹˜ä¿¡æ¯ï¼Œé”®ä¸ºçº¿è·¯ç¼–å·ï¼Œå€¼ä¸ºè¯¥çº¿è·¯å¯æ¢ä¹˜çš„çº¿è·¯åŠæ¢ä¹˜ç«™ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;Integer, List&lt;Route&gt;&gt; mp = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å­˜å‚¨æ¯ä¸ªç«™ç‚¹æ‰€åœ¨çš„çº¿è·¯ï¼Œé”®ä¸ºç«™ç‚¹åç§°ï¼Œå€¼ä¸ºåŒ…å«è¯¥ç«™ç‚¹çš„çº¿è·¯ç¼–å·åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, List&lt;Integer&gt;&gt; mp1 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// è®°å½•æ¢ä¹˜æ¬¡æ•°ï¼Œåˆå§‹åŒ–ä¸º -1</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="comment">// æ ‡è®°æ˜¯å¦æ‰¾åˆ°å¯è¾¾è·¯çº¿</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// è®°å½•åˆ°è¾¾ç»ˆç‚¹ç«™æ‰€åœ¨çš„çº¿è·¯ç¼–å·</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> targ;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†…éƒ¨ç±»ï¼Œç”¨äºå­˜å‚¨çº¿è·¯å’Œæ¢ä¹˜ç«™ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Route</span> &#123;</span><br><span class="line">        <span class="comment">// å¯æ¢ä¹˜çš„çº¿è·¯ç¼–å·</span></span><br><span class="line">        <span class="type">int</span> line;</span><br><span class="line">        <span class="comment">// æ¢ä¹˜ç«™åç§°</span></span><br><span class="line">        String station;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–çº¿è·¯å’Œæ¢ä¹˜ç«™ä¿¡æ¯</span></span><br><span class="line">        Route(<span class="type">int</span> line, String station) &#123;</span><br><span class="line">            <span class="built_in">this</span>.line = line;</span><br><span class="line">            <span class="built_in">this</span>.station = station;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¹¿åº¦ä¼˜å…ˆæœç´¢å‡½æ•°ï¼Œç”¨äºæŸ¥æ‰¾ä»èµ·ç‚¹ç«™åˆ°ç»ˆç‚¹ç«™çš„æœ€çŸ­æ¢ä¹˜è·¯çº¿</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bfs</span><span class="params">(<span class="type">int</span>[] visited, Set&lt;Integer&gt; tar, <span class="type">int</span>[] father)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨å¾…è®¿é—®çš„çº¿è·¯ç¼–å·</span></span><br><span class="line">        Queue&lt;Integer&gt; qu = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// å°†èµ·ç‚¹ç«™æ‰€åœ¨çš„æ‰€æœ‰çº¿è·¯ç¼–å·åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x : mp1.get(start)) &#123;</span><br><span class="line">            qu.add(x);</span><br><span class="line">            visited[x] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å½“é˜Ÿåˆ—ä¸ä¸ºç©ºä¸”æœªæ‰¾åˆ°å¯è¾¾è·¯çº¿æ—¶ï¼Œç»§ç»­æœç´¢</span></span><br><span class="line">        <span class="keyword">while</span> (!qu.isEmpty() &amp;&amp; !flag) &#123;</span><br><span class="line">            <span class="comment">// æ¢ä¹˜æ¬¡æ•°åŠ  1</span></span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="comment">// è·å–å½“å‰é˜Ÿåˆ—çš„å¤§å°ï¼Œå³å½“å‰å±‚çš„çº¿è·¯æ•°é‡</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> qu.size();</span><br><span class="line">            <span class="comment">// éå†å½“å‰å±‚çš„æ‰€æœ‰çº¿è·¯</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                <span class="comment">// å–å‡ºé˜Ÿåˆ—å¤´éƒ¨çš„çº¿è·¯ç¼–å·</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> qu.poll();</span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥çº¿è·¯æ˜¯ç»ˆç‚¹ç«™æ‰€åœ¨çš„çº¿è·¯ï¼Œæ ‡è®°æ‰¾åˆ°å¯è¾¾è·¯çº¿ï¼Œè®°å½•çº¿è·¯ç¼–å·å¹¶è·³å‡ºå¾ªç¯</span></span><br><span class="line">                <span class="keyword">if</span> (tar.contains(tmp)) &#123;</span><br><span class="line">                    targ = tmp;</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éå†è¯¥çº¿è·¯å¯æ¢ä¹˜çš„æ‰€æœ‰çº¿è·¯</span></span><br><span class="line">                <span class="keyword">for</span> (Route next : mp.getOrDefault(tmp, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;())) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœè¯¥çº¿è·¯å·²è¢«è®¿é—®è¿‡ï¼Œè·³è¿‡</span></span><br><span class="line">                    <span class="keyword">if</span> (visited[next.line] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="comment">// æ ‡è®°è¯¥çº¿è·¯ä¸ºå·²è®¿é—®</span></span><br><span class="line">                    visited[next.line] = <span class="number">1</span>;</span><br><span class="line">                    <span class="comment">// å°†è¯¥çº¿è·¯åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">                    qu.add(next.line);</span><br><span class="line">                    <span class="comment">// è®°å½•è¯¥çº¿è·¯çš„çˆ¶çº¿è·¯ç¼–å·</span></span><br><span class="line">                    father[next.line] = tmp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º Scanner å¯¹è±¡ï¼Œç”¨äºè¯»å–ç”¨æˆ·è¾“å…¥</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">// è¯»å–çº¿è·¯æ•°é‡</span></span><br><span class="line">        N = scanner.nextInt();</span><br><span class="line">        <span class="comment">// æ¶ˆè€—æ‰æ¢è¡Œç¬¦</span></span><br><span class="line">        scanner.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// äºŒç»´æ•°ç»„ï¼Œç”¨äºå­˜å‚¨çº¿è·¯ä¹‹é—´çš„æ¢ä¹˜ç«™ä¿¡æ¯</span></span><br><span class="line">        String[][] graph = <span class="keyword">new</span> <span class="title class_">String</span>[N][N];</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–äºŒç»´æ•°ç»„ï¼Œå°†æ‰€æœ‰å…ƒç´ è®¾ç½®ä¸º &quot;*&quot;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            Arrays.fill(graph[i], <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†æ¯æ¡çº¿è·¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="comment">// è¯»å–è¯¥çº¿è·¯ä¸Šçš„æ‰€æœ‰ç«™ç‚¹ä¿¡æ¯</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">            <span class="comment">// å°†ç«™ç‚¹ä¿¡æ¯æŒ‰ç©ºæ ¼åˆ†å‰²æˆæ•°ç»„</span></span><br><span class="line">            String[] stations = s.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="comment">// éå†è¯¥çº¿è·¯ä¸Šçš„æ¯ä¸ªç«™ç‚¹</span></span><br><span class="line">            <span class="keyword">for</span> (String tmp : stations) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥ç«™ç‚¹å·²ç»å­˜åœ¨äº mp1 ä¸­ï¼Œè¯´æ˜è¯¥ç«™ç‚¹æ˜¯æ¢ä¹˜ç«™</span></span><br><span class="line">                <span class="keyword">if</span> (mp1.containsKey(tmp)) &#123;</span><br><span class="line">                    <span class="comment">// è·å–è¯¥ç«™ç‚¹æ‰€åœ¨çš„æ‰€æœ‰çº¿è·¯ç¼–å·åˆ—è¡¨</span></span><br><span class="line">                    List&lt;Integer&gt; a = mp1.get(tmp);</span><br><span class="line">                    <span class="comment">// éå†è¯¥ç«™ç‚¹æ‰€åœ¨çš„æ‰€æœ‰çº¿è·¯</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> j : a) &#123;</span><br><span class="line">                        <span class="comment">// æ›´æ–° mp ä¸­çº¿è·¯ä¹‹é—´çš„æ¢ä¹˜ä¿¡æ¯</span></span><br><span class="line">                        mp.computeIfAbsent(i, k -&gt; <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()).add(<span class="keyword">new</span> <span class="title class_">Route</span>(j, tmp));</span><br><span class="line">                        <span class="comment">// æ›´æ–° graph ä¸­çº¿è·¯ä¹‹é—´çš„æ¢ä¹˜ç«™ä¿¡æ¯</span></span><br><span class="line">                        graph[i][j] = tmp;</span><br><span class="line">                        <span class="comment">// ç”±äºæ˜¯åŒå‘å›¾ï¼Œæ›´æ–°åå‘çš„æ¢ä¹˜ä¿¡æ¯</span></span><br><span class="line">                        mp.computeIfAbsent(j, k -&gt; <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()).add(<span class="keyword">new</span> <span class="title class_">Route</span>(i, tmp));</span><br><span class="line">                        graph[j][i] = tmp;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å°†å½“å‰çº¿è·¯ç¼–å·åŠ å…¥è¯¥ç«™ç‚¹æ‰€åœ¨çš„çº¿è·¯ç¼–å·åˆ—è¡¨</span></span><br><span class="line">                    mp1.get(tmp).add(i);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœè¯¥ç«™ç‚¹æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿è·¯ç¼–å·åˆ—è¡¨ï¼Œå¹¶å°†å½“å‰çº¿è·¯ç¼–å·åŠ å…¥å…¶ä¸­</span></span><br><span class="line">                    List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">                    list.add(i);</span><br><span class="line">                    <span class="comment">// å°†è¯¥ç«™ç‚¹åŠå…¶æ‰€åœ¨çš„çº¿è·¯ç¼–å·åˆ—è¡¨å­˜å…¥ mp1 ä¸­</span></span><br><span class="line">                    mp1.put(tmp, list);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å–èµ·ç‚¹ç«™å’Œç»ˆç‚¹ç«™åç§°</span></span><br><span class="line">        start = scanner.next();</span><br><span class="line">        target = scanner.next();</span><br><span class="line">        <span class="comment">// ç”¨äºæ ‡è®°çº¿è·¯æ˜¯å¦å·²è¢«è®¿é—®è¿‡çš„æ•°ç»„</span></span><br><span class="line">        <span class="type">int</span>[] visited = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">        <span class="comment">// ç”¨äºè®°å½•æ¯ä¸ªçº¿è·¯çš„çˆ¶çº¿è·¯ç¼–å·çš„æ•°ç»„ï¼Œåˆå§‹åŒ–ä¸º -1</span></span><br><span class="line">        <span class="type">int</span>[] father = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">        Arrays.fill(father, -<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœèµ·ç‚¹ç«™æˆ–ç»ˆç‚¹ç«™ä¸åœ¨ä»»ä½•çº¿è·¯ä¸Šï¼Œè¾“å‡º &quot;NA&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (!mp1.containsKey(start) || !mp1.containsKey(target)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;NA&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œå­˜å‚¨ç»ˆç‚¹ç«™æ‰€åœ¨çš„æ‰€æœ‰çº¿è·¯ç¼–å·</span></span><br><span class="line">            Set&lt;Integer&gt; tar = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(mp1.get(target));</span><br><span class="line">            <span class="comment">// è°ƒç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢å‡½æ•°è¿›è¡Œæœç´¢</span></span><br><span class="line">            bfs(visited, tar, father);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæœªæ‰¾åˆ°å¯è¾¾è·¯çº¿ï¼Œè¾“å‡º &quot;NA&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;NA&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ç”¨äºå­˜å‚¨æœ€ç»ˆçš„è·¯çº¿ä¿¡æ¯</span></span><br><span class="line">            List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="comment">// ä»ç»ˆç‚¹ç«™æ‰€åœ¨çš„çº¿è·¯å¼€å§‹å›æº¯</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> targ;</span><br><span class="line">            <span class="comment">// å°†ç»ˆç‚¹ç«™åŠ å…¥ç»“æœåˆ—è¡¨</span></span><br><span class="line">            result.add(target);</span><br><span class="line">            <span class="comment">// å›æº¯è·¯çº¿ï¼Œç›´åˆ°æ‰¾åˆ°èµ·ç‚¹ç«™æ‰€åœ¨çš„çº¿è·¯</span></span><br><span class="line">            <span class="keyword">while</span> (father[u] != -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†æ¢ä¹˜ç«™åŠ å…¥ç»“æœåˆ—è¡¨</span></span><br><span class="line">                result.add(graph[father[u]][u]);</span><br><span class="line">                <span class="comment">// æ›´æ–°å½“å‰çº¿è·¯ä¸ºçˆ¶çº¿è·¯</span></span><br><span class="line">                u = father[u];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å°†èµ·ç‚¹ç«™åŠ å…¥ç»“æœåˆ—è¡¨</span></span><br><span class="line">            result.add(start);</span><br><span class="line">            <span class="comment">// è·å–ç»“æœåˆ—è¡¨çš„å¤§å°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> result.size();</span><br><span class="line">            <span class="comment">// è¾“å‡ºè·¯çº¿ä¿¡æ¯ï¼Œç”¨ &quot;-&quot; è¿æ¥å„ä¸ªç«™ç‚¹</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">                System.out.print(result.get(i) + <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(result.get(<span class="number">0</span>));</span><br><span class="line">            <span class="comment">// è¾“å‡ºæ€»æ¢ä¹˜æ¬¡æ•°ï¼ˆåŒ…æ‹¬èµ·ç‚¹ç«™å’Œç»ˆç‚¹ç«™ï¼‰</span></span><br><span class="line">            System.out.println(<span class="number">2</span> + cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><h2 id="ç¬¬ä¸‰é¢˜"><a href="#ç¬¬ä¸‰é¢˜" class="headerlink" title="ç¬¬ä¸‰é¢˜"></a>ç¬¬ä¸‰é¢˜</h2><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418110705215.png" alt="image-20250418110705215"></p><p><img src="2025-04-17-åä¸º416æ‰¹æ¬¡ç¬”è¯•/image-20250418110727624.png" alt="image-20250418110727624"></p><p>è¿™é“é¢˜æ„Ÿè§‰æ¯”å‰é¢ä¸¤é¢˜ç®€å•å¤šäº†ï¼Œæœ‰ç‚¹åƒLeetCodeå’Œåˆå¹¶åŒºé—´é‚£é“é¢˜ï¼Œä½†æ˜¯è¿™é‡Œæ’åºä¸èƒ½æŒ‰ç…§å­—å…¸åºè¿›è¡Œæ’ï¼Œç´¢å¼•æ¯”è¾ƒæœ´ç´ çš„æ€æƒ³æ˜¯å°†ipåœ°å€è½¬åŒ–æˆä¸€ä¸ªæ•°è¿›è¡Œæ’åºã€‚</p><p>æˆ‘çš„åšæ³•ï¼šå¾ˆå¥‡æ€ªï¼Œæ„Ÿè§‰æ²¡å•¥é—®é¢˜å°±åªaäº†0.55</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> codefun.com.HuaWei;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">P2847</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾…åŠ©æ–¹æ³•ï¼šå°†IPv4åœ°å€è½¬åŒ–ä¸ºæ•´æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">ipToInt</span><span class="params">(String ip)</span> &#123;</span><br><span class="line">        String[] parts = ip.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            result += Integer.parseInt(parts[i]) * Math.pow(<span class="number">256</span>, <span class="number">3</span> - i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">intToIp</span><span class="params">(<span class="type">long</span> ipInt)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">part1</span> <span class="operator">=</span> (<span class="type">int</span>) (ipInt / (<span class="type">int</span>)Math.pow(<span class="number">256</span>,<span class="number">3</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">part2</span> <span class="operator">=</span> (<span class="type">int</span>)(ipInt / (<span class="type">int</span>)Math.pow(<span class="number">256</span>,<span class="number">2</span>)) % <span class="number">256</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">part3</span> <span class="operator">=</span> (<span class="type">int</span>) ((ipInt / <span class="number">256</span>) % <span class="number">256</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">part4</span> <span class="operator">=</span> (<span class="type">int</span>) (ipInt % <span class="number">256</span>);</span><br><span class="line">        <span class="keyword">return</span> part1 + <span class="string">&quot;.&quot;</span> + part2 + <span class="string">&quot;.&quot;</span> + part3 + <span class="string">&quot;.&quot;</span> + part4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> Integer.parseInt(scanner.nextLine());</span><br><span class="line">        List&lt;<span class="type">long</span>[]&gt; ipRanges = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¯»å–IPåŒºé—´</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">            String[] parts = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="type">long</span> <span class="variable">startIp</span> <span class="operator">=</span> ipToInt(parts[<span class="number">0</span>]);</span><br><span class="line">            <span class="type">long</span> <span class="variable">endIp</span> <span class="operator">=</span> ipToInt(parts[<span class="number">1</span>]);</span><br><span class="line">            ipRanges.add(<span class="keyword">new</span> <span class="title class_">long</span>[]&#123;startIp, endIp&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŒ‰ç…§ä¸šåŠ¡éœ€æ±‚è¿›è¡Œæ’åº</span></span><br><span class="line">        <span class="comment">// æ’åºè§„åˆ™: å…ˆæŒ‰IPå ç”¨æ•°é‡ (endIp - startIp + 1)ï¼Œå†æŒ‰èµ·å§‹IPæ’åº</span></span><br><span class="line">        ipRanges.sort((a, b) -&gt; &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lenA</span> <span class="operator">=</span> a[<span class="number">1</span>] - a[<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lenB</span> <span class="operator">=</span> b[<span class="number">1</span>] - b[<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (lenA == lenB) &#123;</span><br><span class="line">                <span class="keyword">return</span> Long.compare(a[<span class="number">0</span>], b[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Long.compare(lenA, lenB);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è´ªå¿ƒç®—æ³•ï¼Œé€‰æ‹©ä¸é‡å çš„åŒºé—´</span></span><br><span class="line">        List&lt;<span class="type">long</span>[]&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">long</span> <span class="variable">lastEnd</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span>[] range : ipRanges) &#123;</span><br><span class="line">            <span class="keyword">if</span> (range[<span class="number">0</span>] &gt; lastEnd) &#123;</span><br><span class="line">                result.add(range);</span><br><span class="line">                lastEnd = range[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span>[] range : result) &#123;</span><br><span class="line">            System.out.println(intToIp(range[<span class="number">0</span>]) + <span class="string">&quot; &quot;</span> + intToIp(range[<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æ­£ç¡®è§£æ³•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> codefun.com.HuaWei;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">P2847</span> &#123;</span><br><span class="line">    <span class="comment">// å°†IPv4åœ°å€è½¬åŒ–ä¸ºæ•´æ•°ï¼Œä½¿ç”¨ä½è¿ç®—ä¿è¯ç²¾ç¡®æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">ipToInt</span><span class="params">(String ip)</span> &#123;</span><br><span class="line">        String[] parts = ip.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            result |= (Long.parseLong(parts[i]) &lt;&lt; (<span class="number">24</span> - <span class="number">8</span> * i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æ•´æ•°è½¬æ¢å›IPv4åœ°å€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">intToIp</span><span class="params">(<span class="type">long</span> ipInt)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((ipInt &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">                ((ipInt &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">                ((ipInt &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">                (ipInt &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> Integer.parseInt(scanner.nextLine().trim());  <span class="comment">// è¯»å–ä¸šåŠ¡æ•°é‡</span></span><br><span class="line">        List&lt;<span class="type">long</span>[]&gt; ipRanges = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å–æ¯ä¸ªä¸šåŠ¡çš„èµ·å§‹å’Œç»“æŸIPï¼Œå°†å…¶è½¬ä¸ºæ•´æ•°å­˜å‚¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            String[] parts = scanner.nextLine().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> ipToInt(parts[<span class="number">0</span>]);</span><br><span class="line">            <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> ipToInt(parts[<span class="number">1</span>]);</span><br><span class="line">            ipRanges.add(<span class="keyword">new</span> <span class="title class_">long</span>[]&#123;start, end&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ’åºè§„åˆ™ï¼š</span></span><br><span class="line">        <span class="comment">// 1) æŒ‰ç»“æŸIPå‡åº</span></span><br><span class="line">        <span class="comment">// 2) è‹¥ç»“æŸIPç›¸åŒï¼ŒæŒ‰åŒºé—´é•¿åº¦(ç«¯ç‚¹å·®+1)å‡åº</span></span><br><span class="line">        <span class="comment">// 3) è‹¥é•¿åº¦ç›¸åŒï¼ŒæŒ‰èµ·å§‹IPå‡åº</span></span><br><span class="line">        ipRanges.sort((a, b) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[<span class="number">1</span>] != b[<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> Long.compare(a[<span class="number">1</span>], b[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lenA</span> <span class="operator">=</span> a[<span class="number">1</span>] - a[<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lenB</span> <span class="operator">=</span> b[<span class="number">1</span>] - b[<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (lenA != lenB) &#123;</span><br><span class="line">                <span class="keyword">return</span> Long.compare(lenA, lenB);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Long.compare(a[<span class="number">0</span>], b[<span class="number">0</span>]);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è´ªå¿ƒé€‰æ‹©ï¼šé€‰æ‹©ä¸é‡å ã€æœ€æ—©ç»“æŸçš„åŒºé—´ä»¥æœ€å¤§åŒ–ä¸šåŠ¡æ•°é‡</span></span><br><span class="line">        List&lt;<span class="type">long</span>[]&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">long</span> <span class="variable">lastEnd</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span>[] range : ipRanges) &#123;</span><br><span class="line">            <span class="keyword">if</span> (range[<span class="number">0</span>] &gt; lastEnd) &#123;</span><br><span class="line">                result.add(range);</span><br><span class="line">                lastEnd = range[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºæœ€ç»ˆè§„åˆ’çš„IPåŒºé—´</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span>[] r : result) &#123;</span><br><span class="line">            System.out.println(intToIp(r[<span class="number">0</span>]) + <span class="string">&quot; &quot;</span> + intToIp(r[<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸»è¦æ”¹åŠ¨äº†ä»¥ä¸‹å‡ å¤„ï¼š</p><ol><li><p><strong>IP è½¬æ¢æ–¹æ³•ä¼˜åŒ–</strong></p><ul><li><p>åŸæ¥åœ¨ <code>ipToInt</code> å’Œ <code>intToIp</code> ä¸­ä½¿ç”¨äº† <code>Math.pow</code>ï¼Œè¿”å› <code>double</code> å†è½¬ <code>long</code>ï¼Œå­˜åœ¨ç²¾åº¦éšæ‚£ã€‚</p></li><li><p>è¦æ”¹æˆäº†ä½ç§»è¿ç®—ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result |= (Long.parseLong(parts[i]) &lt;&lt; (<span class="number">24</span> - <span class="number">8</span> * i));</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((ipInt &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>)</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ—¢æ›´é«˜æ•ˆï¼Œä¹Ÿå®Œå…¨ç²¾ç¡®ã€‚</p></li></ul></li><li><p><strong>æ’åºè§„åˆ™</strong></p><ul><li>åŸå…ˆåªæŒ‰â€œåŒºé—´é•¿åº¦ï¼ˆlenï¼‰â€å’Œâ€œèµ·å§‹ IPâ€æ’åºï¼Œå¿½ç•¥äº†â€œç»“æŸ IPâ€å¯¹è´ªå¿ƒé€‰æ‹©çš„å½±å“ã€‚</li><li>æ–°ç‰ˆæ”¹ä¸ºä¸‰å±‚ä¼˜å…ˆçº§ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1) æŒ‰ç»“æŸ IP å‡åº  </span></span><br><span class="line"><span class="comment">// 2) è‹¥ç»“æŸ IP ç›¸åŒï¼Œå†æŒ‰åŒºé—´é•¿åº¦å‡åº  </span></span><br><span class="line"><span class="comment">// 3) è‹¥é•¿åº¦ç›¸åŒï¼Œå†æŒ‰èµ·å§‹ IP å‡åº</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·èƒ½ä¿è¯è´ªå¿ƒç®—æ³•æ¯æ¬¡éƒ½é€‰æœ€æ—©ç»“æŸã€æœ€å°å ç”¨çš„åŒºé—´ï¼Œä»¥æ»¡è¶³â€œæœ€å¤šä¸šåŠ¡æ•°â€ã€â€œæœ€å°‘åœ°å€é‡â€å’Œâ€œèµ·å§‹æœ€å°â€ä¸‰é‡è¦æ±‚ã€‚</p></li></ol><p>è¿™äº›æ”¹åŠ¨ç¡®ä¿äº†ï¼š</p><ul><li>IP è½¬æ¢æ— ç²¾åº¦è¯¯å·®</li><li>æ’åºä¸¥æ ¼ç¬¦åˆé¢˜æ„çš„ä¸‰é‡æ¯”è¾ƒ</li><li>è´ªå¿ƒç®—æ³•èƒ½çœŸæ­£è¾“å‡ºç¤ºä¾‹ä¸­é¢„æœŸçš„ä¸¤ä¸ªåŒºé—´ã€‚</li></ul><p>åæ€ï¼šæ²¡æœ‰è€ƒè™‘æ•°æ®ç²¾åº¦å¯¹ç»“æœçš„å½±å“ã€‚åªæ˜¯è¿æ°”å¥½è¿‡äº†0.55</p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>è¿™æ¬¡ç®—æ³•åšçš„ä¸å¤ªå¥½ï¼Œä¸»è¦æœ‰ä»¥ä¸‹è¿™ä¸ªåŸå› ï¼š</p><ul><li>â€‹    1.ä¸æ•¢ç”¨IDEå†™ï¼Œç”¨è®°äº‹æœ¬å¯¼è‡´å†™çš„ä¼˜ç‚¹ç£•ç£•ç»Šç»Š</li><li>â€‹    2.ç¬¬ä¸€é¢˜æ²¡åšå‡ºæ¥å½±å“äº†å¿ƒæ€ï¼Œç„¶ååšç¬¬äºŒé¢˜è„‘è¢‹ä¸€å›¢æµ†ç³Šã€‚</li><li>â€‹    3.åšè¿™åœºç¬”è¯•ä¹‹å‰ï¼Œåˆ·äº†å¾ˆå¤šæ¬¡åä¸ºç¬”è¯•çœŸé¢˜ã€‚è‡ªå·±å¹³æ—¶åšæ„Ÿè§‰æ²¡é—®é¢˜ï¼Œåœ¨è€ƒåœºä¸Šåšå´é”™æ¼ç™¾å‡ºï¼Œåªèƒ½è¯´å¹³æ—¶å’Œè€ƒåœºè¿˜æ˜¯ä¸ä¸€æ ·ã€‚</li><li>â€‹    4.å¤ªæƒ³è¿›åä¸ºï¼Œå¯¼è‡´åšç¬”è¯•å‹åŠ›å¾ˆå¤§ã€‚å¿ƒæƒ…ä¸å¹³å’Œå½±å“äº†è‡ªå·±çš„æ€è·¯ã€‚</li></ul><p>æ€»è€Œè¨€ä¹‹ï¼Œç»§ç»­å¤šåˆ·ç®—æ³•ï¼Œç»§ç»­åŠ æ²¹ï¼</p>]]></content>
    
    
    <summary type="html">ğŸ¥§åä¸º416æ‰¹æ¬¡ç¬”è¯•</summary>
    
    
    
    <category term="åˆ·é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E5%88%B7%E9%A2%98/"/>
    
    
    <category term="ç¬”è¯•" scheme="https://outoflovenicoo.github.io/tags/%E7%AC%94%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-03-09-%E4%B8%AA%E4%BA%BA%E5%AF%B9%E9%9B%B6%E6%8B%B7%E8%B4%9D%E6%8A%80%E6%9C%AF%E7%9A%84%E7%90%86%E8%A7%A3.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-03-09-%E4%B8%AA%E4%BA%BA%E5%AF%B9%E9%9B%B6%E6%8B%B7%E8%B4%9D%E6%8A%80%E6%9C%AF%E7%9A%84%E7%90%86%E8%A7%A3.html</id>
    <published>2025-03-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h1><p><img src="2025-03-09-ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£/image-20250414160743861.png" alt="image-20250414160743861"></p><h3 id="ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£ï¼šå‘Šåˆ«å†—ä½™æ‹·è´ï¼Œé‡Šæ”¾ç³»ç»Ÿæ€§èƒ½"><a href="#ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£ï¼šå‘Šåˆ«å†—ä½™æ‹·è´ï¼Œé‡Šæ”¾ç³»ç»Ÿæ€§èƒ½" class="headerlink" title="ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£ï¼šå‘Šåˆ«å†—ä½™æ‹·è´ï¼Œé‡Šæ”¾ç³»ç»Ÿæ€§èƒ½"></a>ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£ï¼šå‘Šåˆ«å†—ä½™æ‹·è´ï¼Œé‡Šæ”¾ç³»ç»Ÿæ€§èƒ½</h3><p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œç£ç›˜å’Œç½‘ç»œä¼ è¾“å¾€å¾€æ˜¯æ€§èƒ½çš„ç“¶é¢ˆä¹‹ä¸€ã€‚ä¼ ç»Ÿçš„æ–‡ä»¶ä¼ è¾“æ–¹å¼è™½ç„¶é€»è¾‘ç®€å•ï¼Œä½†åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä¼šå› é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œæ•°æ®æ‹·è´å¯¼è‡´ä¸¥é‡çš„æ€§èƒ½æŸè€—ã€‚è€Œ<strong>é›¶æ‹·è´ï¼ˆZero-copyï¼‰</strong>æŠ€æœ¯çš„å‡ºç°ï¼Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ã€‚æœ¬æ–‡å°†ä»ç¡¬ä»¶åä½œåˆ°å†…æ ¸ä¼˜åŒ–ï¼Œé€æ­¥æ‹†è§£é›¶æ‹·è´æŠ€æœ¯çš„åŸç†ä¸åº”ç”¨ã€‚</p><hr><h4 id="ä¸€ã€ä»DMAæŠ€æœ¯è¯´èµ·ï¼šè®©CPUâ€œè§£æ”¾åŒæ‰‹â€"><a href="#ä¸€ã€ä»DMAæŠ€æœ¯è¯´èµ·ï¼šè®©CPUâ€œè§£æ”¾åŒæ‰‹â€" class="headerlink" title="ä¸€ã€ä»DMAæŠ€æœ¯è¯´èµ·ï¼šè®©CPUâ€œè§£æ”¾åŒæ‰‹â€"></a>ä¸€ã€ä»DMAæŠ€æœ¯è¯´èµ·ï¼šè®©CPUâ€œè§£æ”¾åŒæ‰‹â€</h4><p>åœ¨æ—©æœŸè®¡ç®—æœºä¸­ï¼Œæ•°æ®çš„ä¼ è¾“å®Œå…¨ä¾èµ–CPUã€‚ä¾‹å¦‚ï¼Œå½“ç£ç›˜éœ€è¦å‘å†…å­˜ä¼ è¾“æ•°æ®æ—¶ï¼ŒCPUéœ€è¦é€ä¸ªå­—èŠ‚åœ°ä»ç£ç›˜æ§åˆ¶å™¨ç¼“å†²åŒºè¯»å–æ•°æ®ï¼Œå†å†™å…¥å†…å­˜ã€‚è¿™ç§â€œå…¨ç¨‹é™ªè·‘â€çš„æ–¹å¼è®©CPUæ— æ³•å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œæ•ˆç‡æä½ã€‚</p><p><strong>DMAï¼ˆç›´æ¥å†…å­˜è®¿é—®ï¼‰æŠ€æœ¯</strong>çš„å¼•å…¥å½»åº•æ”¹å˜äº†è¿™ä¸€å±€é¢ã€‚DMAæ§åˆ¶å™¨æ¥ç®¡äº†æ•°æ®æ¬è¿çš„å·¥ä½œï¼ŒCPUåªéœ€å‘Šè¯‰DMAâ€œä»å“ªé‡Œæ¬ã€æ¬åˆ°å“ªé‡Œâ€ï¼Œåç»­çš„æ•°æ®ä¼ è¾“ç”±DMAç‹¬ç«‹å®Œæˆã€‚è¿™ä¸€è¿‡ç¨‹æ— éœ€CPUå‚ä¸ï¼Œä»è€Œé‡Šæ”¾äº†CPUèµ„æºã€‚</p><p><strong>DMAçš„å·¥ä½œæµç¨‹</strong>ï¼š  </p><ol><li>ç”¨æˆ·è¿›ç¨‹å‘èµ·I/Oè¯·æ±‚ï¼›  </li><li>DMAå°†ç£ç›˜æ•°æ®ç›´æ¥æ¬è¿åˆ°å†…æ ¸ç¼“å†²åŒºï¼›  </li><li>æ•°æ®å°±ç»ªåï¼ŒDMAé€šçŸ¥CPUå°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚  </li></ol><p>è‡³æ­¤ï¼ŒCPUåªéœ€åœ¨ä¼ è¾“çš„å¼€å§‹å’Œç»“æŸæ—¶ä»‹å…¥ï¼Œä¸­é—´çš„æ•°æ®æ¬è¿å·¥ä½œå…¨éƒ¨ç”±DMAå®Œæˆã€‚</p><hr><h4 id="äºŒã€ä¼ ç»Ÿæ–‡ä»¶ä¼ è¾“çš„â€œå››å®—ç½ªâ€"><a href="#äºŒã€ä¼ ç»Ÿæ–‡ä»¶ä¼ è¾“çš„â€œå››å®—ç½ªâ€" class="headerlink" title="äºŒã€ä¼ ç»Ÿæ–‡ä»¶ä¼ è¾“çš„â€œå››å®—ç½ªâ€"></a>äºŒã€ä¼ ç»Ÿæ–‡ä»¶ä¼ è¾“çš„â€œå››å®—ç½ªâ€</h4><p>ä¼ ç»Ÿæ–‡ä»¶ä¼ è¾“é€šè¿‡<code>read()</code>å’Œ<code>write()</code>ç³»ç»Ÿè°ƒç”¨å®ç°ï¼Œçœ‹ä¼¼ç®€å•çš„ä¸¤è¡Œä»£ç ï¼Œå´éšè—ç€å·¨å¤§çš„æ€§èƒ½é—®é¢˜ï¼š  </p><ol><li><strong>4æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ï¼šæ¯æ¬¡ç³»ç»Ÿè°ƒç”¨æ¶‰åŠ2æ¬¡ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œä¸¤æ¬¡è°ƒç”¨å…±4æ¬¡åˆ‡æ¢ã€‚  </li><li><strong>4æ¬¡æ•°æ®æ‹·è´</strong>ï¼š<br>â€¢ DMAå°†ç£ç›˜æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼›<br>â€¢ CPUå°†å†…æ ¸æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼›<br>â€¢ CPUå°†ç”¨æˆ·æ•°æ®æ‹·è´åˆ°Socketå†…æ ¸ç¼“å†²åŒºï¼›<br>â€¢ DMAå°†Socketç¼“å†²åŒºæ•°æ®æ‹·è´åˆ°ç½‘å¡ã€‚  </li></ol><p>è¿™4æ¬¡æ‹·è´ä¸­ï¼Œ<strong>ä¸¤æ¬¡CPUå‚ä¸çš„æ‹·è´æ˜¯å†—ä½™çš„</strong>ï¼Œå°¤å…¶æ˜¯å½“ç”¨æˆ·ä¸éœ€è¦ä¿®æ”¹æ•°æ®æ—¶ï¼Œç”¨æˆ·ç¼“å†²åŒºçš„å­˜åœ¨åè€Œæˆäº†ç´¯èµ˜ã€‚</p><hr><h4 id="ä¸‰ã€é›¶æ‹·è´æŠ€æœ¯ï¼šå¦‚ä½•å®ç°â€œé›¶â€å†—ä½™ï¼Ÿ"><a href="#ä¸‰ã€é›¶æ‹·è´æŠ€æœ¯ï¼šå¦‚ä½•å®ç°â€œé›¶â€å†—ä½™ï¼Ÿ" class="headerlink" title="ä¸‰ã€é›¶æ‹·è´æŠ€æœ¯ï¼šå¦‚ä½•å®ç°â€œé›¶â€å†—ä½™ï¼Ÿ"></a>ä¸‰ã€é›¶æ‹·è´æŠ€æœ¯ï¼šå¦‚ä½•å®ç°â€œé›¶â€å†—ä½™ï¼Ÿ</h4><p>é›¶æ‹·è´çš„æ ¸å¿ƒç›®æ ‡æ˜¯<strong>å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œæ•°æ®æ‹·è´æ¬¡æ•°</strong>ï¼Œå…·ä½“é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ï¼š</p><h5 id="1-mmap-writeï¼šå‡å°‘ä¸€æ¬¡æ•°æ®æ‹·è´"><a href="#1-mmap-writeï¼šå‡å°‘ä¸€æ¬¡æ•°æ®æ‹·è´" class="headerlink" title="1. mmap + writeï¼šå‡å°‘ä¸€æ¬¡æ•°æ®æ‹·è´"></a>1. <code>mmap + write</code>ï¼šå‡å°‘ä¸€æ¬¡æ•°æ®æ‹·è´</h5><p><code>mmap()</code>ç³»ç»Ÿè°ƒç”¨å°†å†…æ ¸ç¼“å†²åŒºæ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´ï¼Œä½¿å¾—ç”¨æˆ·è¿›ç¨‹ä¸å†…æ ¸å…±äº«æ•°æ®ï¼Œçœå»äº†ä»å†…æ ¸åˆ°ç”¨æˆ·ç¼“å†²åŒºçš„æ‹·è´ã€‚ä½†ä»æœ‰3æ¬¡æ•°æ®æ‹·è´ï¼ˆä¸¤æ¬¡DMAï¼Œä¸€æ¬¡CPUï¼‰ï¼Œä¸”éœ€è¦4æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><h5 id="2-sendfile-ï¼šç³»ç»Ÿè°ƒç”¨çš„ç»ˆæä¼˜åŒ–"><a href="#2-sendfile-ï¼šç³»ç»Ÿè°ƒç”¨çš„ç»ˆæä¼˜åŒ–" class="headerlink" title="2. sendfile()ï¼šç³»ç»Ÿè°ƒç”¨çš„ç»ˆæä¼˜åŒ–"></a>2. <code>sendfile()</code>ï¼šç³»ç»Ÿè°ƒç”¨çš„ç»ˆæä¼˜åŒ–</h5><p>Linux 2.1å¼•å…¥çš„<code>sendfile()</code>ç³»ç»Ÿè°ƒç”¨ï¼Œå°†è¯»å–å’Œå‘é€åˆå¹¶ä¸ºä¸€æ¬¡æ“ä½œï¼š<br>â€¢ <strong>2æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ï¼ˆ1æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼›<br>â€¢ <strong>3æ¬¡æ•°æ®æ‹·è´</strong>ï¼ˆDMAæ‹·è´ç£ç›˜åˆ°å†…æ ¸ã€CPUæ‹·è´å†…æ ¸åˆ°Socketç¼“å†²åŒºã€DMAæ‹·è´åˆ°ç½‘å¡ï¼‰ã€‚  </p><p>è‹¥ç½‘å¡æ”¯æŒ<strong>SG-DMAï¼ˆåˆ†æ•£-èšé›†DMAï¼‰</strong>ï¼Œåˆ™å¯è¿›ä¸€æ­¥å°†CPUæ‹·è´ä¼˜åŒ–æ‰ï¼Œä»…éœ€2æ¬¡DMAæ‹·è´ï¼ŒçœŸæ­£å®ç°â€œé›¶æ‹·è´â€ã€‚</p><hr><h4 id="å››ã€PageCacheï¼šé›¶æ‹·è´çš„â€œåŠ é€Ÿå™¨â€"><a href="#å››ã€PageCacheï¼šé›¶æ‹·è´çš„â€œåŠ é€Ÿå™¨â€" class="headerlink" title="å››ã€PageCacheï¼šé›¶æ‹·è´çš„â€œåŠ é€Ÿå™¨â€"></a>å››ã€PageCacheï¼šé›¶æ‹·è´çš„â€œåŠ é€Ÿå™¨â€</h4><p>é›¶æ‹·è´ä¾èµ–å†…æ ¸çš„<strong>PageCacheï¼ˆé¡µç¼“å­˜ï¼‰</strong>æŠ€æœ¯ï¼Œå®ƒé€šè¿‡ä¸¤ç§æœºåˆ¶æå‡æ€§èƒ½ï¼š  </p><ol><li><strong>ç¼“å­˜çƒ­ç‚¹æ•°æ®</strong>ï¼šæœ€è¿‘è®¿é—®çš„æ•°æ®ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œå‡å°‘ç£ç›˜è®¿é—®ã€‚  </li><li><strong>é¢„è¯»æœºåˆ¶</strong>ï¼šæ ¹æ®å±€éƒ¨æ€§åŸç†ï¼Œæå‰åŠ è½½åç»­å¯èƒ½è®¿é—®çš„æ•°æ®ã€‚  </li></ol><p>ç„¶è€Œï¼ŒPageCacheå¯¹<strong>å¤§æ–‡ä»¶ä¼ è¾“å¹¶ä¸å‹å¥½</strong>ï¼š<br>â€¢ å¤§æ–‡ä»¶ä¼šæŒ¤å ç¼“å­˜ç©ºé—´ï¼Œå½±å“å°æ–‡ä»¶æ€§èƒ½ï¼›<br>â€¢ å¤§æ–‡ä»¶çš„æ•°æ®å¤ç”¨ç‡ä½ï¼Œé¢„è¯»åè€Œæµªè´¹èµ„æºã€‚  </p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé’ˆå¯¹å¤§æ–‡ä»¶ï¼Œé‡‡ç”¨<strong>å¼‚æ­¥I/O + ç›´æ¥I/O</strong>ï¼Œç»•è¿‡PageCacheï¼Œç›´æ¥ç”±ç£ç›˜åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p><hr><h4 id="äº”ã€å®è·µæŒ‡å—ï¼šä½•æ—¶ç”¨é›¶æ‹·è´ï¼Ÿä½•æ—¶ç”¨ç›´æ¥I-Oï¼Ÿ"><a href="#äº”ã€å®è·µæŒ‡å—ï¼šä½•æ—¶ç”¨é›¶æ‹·è´ï¼Ÿä½•æ—¶ç”¨ç›´æ¥I-Oï¼Ÿ" class="headerlink" title="äº”ã€å®è·µæŒ‡å—ï¼šä½•æ—¶ç”¨é›¶æ‹·è´ï¼Ÿä½•æ—¶ç”¨ç›´æ¥I/Oï¼Ÿ"></a>äº”ã€å®è·µæŒ‡å—ï¼šä½•æ—¶ç”¨é›¶æ‹·è´ï¼Ÿä½•æ—¶ç”¨ç›´æ¥I/Oï¼Ÿ</h4><p>â€¢ <strong>å°æ–‡ä»¶ä¼ è¾“</strong>ï¼šä¼˜å…ˆä½¿ç”¨é›¶æ‹·è´ï¼ˆå¦‚<code>sendfile</code>ï¼‰ï¼Œç»“åˆPageCacheåŠ é€Ÿã€‚<br>â€¢ <strong>å¤§æ–‡ä»¶ä¼ è¾“</strong>ï¼šä½¿ç”¨å¼‚æ­¥I/O + ç›´æ¥I/Oï¼Œé¿å…PageCacheæ±¡æŸ“ã€‚  </p><p><strong>Nginxé…ç½®ç¤ºä¾‹</strong>ï¼š<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> /video/ &#123;</span><br><span class="line">    <span class="attribute">sendfile</span> <span class="literal">on</span>;       <span class="comment"># å°æ–‡ä»¶ç”¨é›¶æ‹·è´</span></span><br><span class="line">    <span class="attribute">aio</span> <span class="literal">on</span>;            <span class="comment"># å¤§æ–‡ä»¶ç”¨å¼‚æ­¥I/O</span></span><br><span class="line">    <span class="attribute">directio</span> <span class="number">1024m</span>;    <span class="comment"># è¶…è¿‡1GBçš„æ–‡ä»¶å¯ç”¨ç›´æ¥I/O</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h4 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h4><p>é›¶æ‹·è´æŠ€æœ¯é€šè¿‡å‡å°‘CPUå‚ä¸çš„æ•°æ®æ‹·è´å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¾è‘—æå‡äº†æ–‡ä»¶ä¼ è¾“æ•ˆç‡ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š  </p><ol><li><strong>ç¡¬ä»¶åä½œ</strong>ï¼šDMAæ‰¿æ‹…æ•°æ®æ¬è¿ï¼Œé‡Šæ”¾CPUï¼›  </li><li><strong>å†…æ ¸ä¼˜åŒ–</strong>ï¼šåˆå¹¶ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ©ç”¨PageCacheåŠ é€Ÿï¼›  </li><li><strong>åœºæ™¯é€‚é…</strong>ï¼šåŒºåˆ†å¤§å°æ–‡ä»¶ï¼Œé€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆã€‚  </li></ol><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œåˆç†ä½¿ç”¨é›¶æ‹·è´ï¼ˆå¦‚Kafkaã€Nginxï¼‰å¯å¤§å¹…æå‡ååé‡ï¼Œè€Œå¤§æ–‡ä»¶ä¼ è¾“åˆ™éœ€å¦è¾Ÿè¹Šå¾„ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§ä¸ªäººå¯¹é›¶æ‹·è´æŠ€æœ¯çš„ç†è§£</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://outoflovenicoo.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-03-09-%E9%AB%98%E6%80%A7%E8%83%BD%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-03-09-%E9%AB%98%E6%80%A7%E8%83%BD%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F.html</id>
    <published>2025-03-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼ï¼šæ·±å…¥ç†è§£-Reactor-ä¸-Proactor"><a href="#é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼ï¼šæ·±å…¥ç†è§£-Reactor-ä¸-Proactor" class="headerlink" title="é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼ï¼šæ·±å…¥ç†è§£ Reactor ä¸ Proactor"></a>é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼ï¼šæ·±å…¥ç†è§£ Reactor ä¸ Proactor</h1><p>åœ¨æ„å»ºé«˜å¹¶å‘æœåŠ¡å™¨æ—¶ï¼Œä¼ ç»Ÿçš„â€œä¸€è¿æ¥ä¸€çº¿ç¨‹â€æ¨¡å‹ä¼šé¢ä¸´æ€§èƒ½ç“¶é¢ˆå’Œèµ„æºæµªè´¹é—®é¢˜ã€‚<strong>I/O å¤šè·¯å¤ç”¨æŠ€æœ¯</strong>çš„å‡ºç°è§£å†³äº†è¿™ä¸€éš¾é¢˜ï¼Œè€ŒåŸºäºæ­¤æŠ€æœ¯æ¼”åŒ–å‡ºçš„ <strong>Reactor</strong> å’Œ <strong>Proactor</strong> æ¨¡å¼ï¼Œåˆ™æˆä¸ºäº†é«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹çš„æ ¸å¿ƒæ¶æ„ã€‚æœ¬æ–‡å°†ä»è®¾è®¡æ€æƒ³ã€å®ç°æ–¹æ¡ˆåˆ°åº”ç”¨åœºæ™¯ï¼Œä¸ºä½ æ­å¼€è¿™ä¸¤ç§æ¨¡å¼çš„ç¥ç§˜é¢çº±ã€‚</p><h1 id="æ€ç»´å¯¼å›¾ï¼š"><a href="#æ€ç»´å¯¼å›¾ï¼š" class="headerlink" title="æ€ç»´å¯¼å›¾ï¼š"></a>æ€ç»´å¯¼å›¾ï¼š</h1><p><img src="2025-03-09-é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼/image-20250414161555385.png" alt="image-20250414161555385"></p><hr><h2 id="ä¸€ã€Reactor-æ¨¡å¼ï¼šåŒæ­¥éé˜»å¡çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹"><a href="#ä¸€ã€Reactor-æ¨¡å¼ï¼šåŒæ­¥éé˜»å¡çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹" class="headerlink" title="ä¸€ã€Reactor æ¨¡å¼ï¼šåŒæ­¥éé˜»å¡çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹"></a>ä¸€ã€Reactor æ¨¡å¼ï¼šåŒæ­¥éé˜»å¡çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹</h2><h3 id="1-æ ¸å¿ƒæ€æƒ³"><a href="#1-æ ¸å¿ƒæ€æƒ³" class="headerlink" title="1. æ ¸å¿ƒæ€æƒ³"></a>1. æ ¸å¿ƒæ€æƒ³</h3><p>Reactor æ¨¡å¼é€šè¿‡ <strong>äº‹ä»¶åˆ†å‘æœºåˆ¶</strong> å®ç°é«˜æ•ˆå¤„ç†å¤šè¿æ¥ã€‚å…¶æ ¸å¿ƒç”±ä¸¤ä¸ªç»„ä»¶æ„æˆï¼š<br>â€¢ <strong>Reactor</strong>ï¼šè´Ÿè´£ç›‘å¬å’Œåˆ†å‘äº‹ä»¶ï¼ˆå¦‚è¿æ¥å»ºç«‹ã€æ•°æ®å¯è¯»/å†™ï¼‰<br>â€¢ <strong>å¤„ç†èµ„æºæ± </strong>ï¼šçº¿ç¨‹/è¿›ç¨‹æ± è´Ÿè´£å…·ä½“ä¸šåŠ¡å¤„ç†</p><p><strong>ç±»æ¯”ç°å®åœºæ™¯</strong>ï¼š<br>Reactor å¦‚åŒé¤å…çš„æ¥å¾…å‘˜ï¼ŒæŒç»­ç›‘å¬å®¢æˆ·è¯·æ±‚ï¼ˆäº‹ä»¶ï¼‰ã€‚å½“æ–°é¡¾å®¢åˆ°æ¥ï¼ˆè¿æ¥å»ºç«‹ï¼‰æ—¶ï¼Œæ¥å¾…å‘˜å®‰æ’æœåŠ¡å‘˜ï¼ˆHandlerï¼‰æ¥å¾…ï¼›å½“é¡¾å®¢ç‚¹é¤ï¼ˆæ•°æ®åˆ°è¾¾ï¼‰æ—¶ï¼ŒæœåŠ¡å‘˜å¼€å§‹å¤„ç†è®¢å•ã€‚</p><hr><h3 id="2-ä¸‰ç§ç»å…¸å®ç°æ–¹æ¡ˆ"><a href="#2-ä¸‰ç§ç»å…¸å®ç°æ–¹æ¡ˆ" class="headerlink" title="2. ä¸‰ç§ç»å…¸å®ç°æ–¹æ¡ˆ"></a>2. ä¸‰ç§ç»å…¸å®ç°æ–¹æ¡ˆ</h3><h4 id="æ–¹æ¡ˆ-1ï¼šå•-Reactor-å•è¿›ç¨‹-çº¿ç¨‹"><a href="#æ–¹æ¡ˆ-1ï¼šå•-Reactor-å•è¿›ç¨‹-çº¿ç¨‹" class="headerlink" title="æ–¹æ¡ˆ 1ï¼šå• Reactor å•è¿›ç¨‹/çº¿ç¨‹"></a>æ–¹æ¡ˆ 1ï¼šå• Reactor å•è¿›ç¨‹/çº¿ç¨‹</h4><p><strong>æ¶æ„ç»„æˆ</strong>ï¼š<br>â€¢ å•ä¸ªè¿›ç¨‹/çº¿ç¨‹å†…åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒå¯¹è±¡ï¼š<br>  â€¢ <strong>Reactor</strong>ï¼šé€šè¿‡ <code>select</code>/<code>epoll</code> ç›‘å¬æ‰€æœ‰äº‹ä»¶<br>  â€¢ <strong>Acceptor</strong>ï¼šå¤„ç†æ–°è¿æ¥å»ºç«‹<br>  â€¢ <strong>Handler</strong>ï¼šå¤„ç†å·²å»ºç«‹è¿æ¥çš„è¯»å†™è¯·æ±‚</p><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š  </p><ol><li>Reactor ç›‘å¬æ‰€æœ‰äº‹ä»¶ï¼Œå°†è¿æ¥å»ºç«‹äº‹ä»¶åˆ†å‘ç»™ Acceptor</li><li>Acceptor è°ƒç”¨ <code>accept()</code> åˆ›å»ºæ–°è¿æ¥ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ Handler</li><li>Handler å¤„ç†æ•°æ®è¯»å†™ï¼ˆ<code>read â†’ ä¸šåŠ¡å¤„ç† â†’ send</code>ï¼‰</li></ol><p><strong>ç‰¹ç‚¹</strong>ï¼š<br>â€¢ å®ç°ç®€å•ï¼Œæ— è¿›ç¨‹é—´é€šä¿¡å¼€é”€<br>â€¢ æ— æ³•åˆ©ç”¨å¤šæ ¸ CPUï¼Œä¸šåŠ¡å¤„ç†å¿…é¡»éé˜»å¡<br>â€¢ <strong>å…¸å‹åº”ç”¨</strong>ï¼šRedis 6.0 å‰ç‰ˆæœ¬</p><hr><h4 id="æ–¹æ¡ˆ-2ï¼šå•-Reactor-å¤šçº¿ç¨‹"><a href="#æ–¹æ¡ˆ-2ï¼šå•-Reactor-å¤šçº¿ç¨‹" class="headerlink" title="æ–¹æ¡ˆ 2ï¼šå• Reactor å¤šçº¿ç¨‹"></a>æ–¹æ¡ˆ 2ï¼šå• Reactor å¤šçº¿ç¨‹</h4><p><strong>æ¶æ„æ”¹è¿›</strong>ï¼š<br>â€¢ ä¸»çº¿ç¨‹ä¿ç•™ Reactor å’Œ Acceptor<br>â€¢ å¼•å…¥çº¿ç¨‹æ± å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼š<br>  â€¢ Handler ä»…è´Ÿè´£éé˜»å¡ I/O æ“ä½œ<br>  â€¢ å­çº¿ç¨‹å¤„ç†ä¸šåŠ¡åå°†ç»“æœè¿”å›ä¸»çº¿ç¨‹</p><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š  </p><ol><li>Reactor ç›‘å¬äº‹ä»¶ï¼Œè¿æ¥å»ºç«‹åç”± Acceptor åˆ›å»º Handler</li><li>Handler è¯»å–æ•°æ®åï¼Œå°†æ•°æ®æäº¤ç»™çº¿ç¨‹æ± å¤„ç†</li><li>å­çº¿ç¨‹å®Œæˆä¸šåŠ¡é€»è¾‘ï¼Œé€šè¿‡å…±äº«é˜Ÿåˆ—è¿”å›ç»“æœ</li><li>ä¸»çº¿ç¨‹çš„ Handler å°†ç»“æœå‘é€ç»™å®¢æˆ·ç«¯</li></ol><p><strong>ç—›ç‚¹</strong>ï¼š<br>â€¢ Reactor å•ç‚¹å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ<br>â€¢ éœ€å¤„ç†å¤šçº¿ç¨‹èµ„æºå…±äº«é—®é¢˜<br>â€¢ <strong>å…¸å‹åº”ç”¨</strong>ï¼šæ—©æœŸ Memcache</p><hr><h4 id="æ–¹æ¡ˆ-3ï¼šå¤š-Reactor-å¤šè¿›ç¨‹-çº¿ç¨‹"><a href="#æ–¹æ¡ˆ-3ï¼šå¤š-Reactor-å¤šè¿›ç¨‹-çº¿ç¨‹" class="headerlink" title="æ–¹æ¡ˆ 3ï¼šå¤š Reactor å¤šè¿›ç¨‹/çº¿ç¨‹"></a>æ–¹æ¡ˆ 3ï¼šå¤š Reactor å¤šè¿›ç¨‹/çº¿ç¨‹</h4><p><strong>æ¶æ„è®¾è®¡</strong>ï¼š<br>â€¢ <strong>MainReactor</strong>ï¼šä¸»çº¿ç¨‹/è¿›ç¨‹ï¼Œä»…å¤„ç†æ–°è¿æ¥å»ºç«‹<br>â€¢ <strong>SubReactor</strong>ï¼šå­çº¿ç¨‹/è¿›ç¨‹æ± ï¼Œæ¯ä¸ªå­å•å…ƒç®¡ç†ä¸€ç»„è¿æ¥<br>â€¢ <strong>Handler</strong>ï¼šç»‘å®šåˆ° SubReactor å¤„ç†å…·ä½“è¿æ¥</p><p><strong>å·¥ä½œæµç¨‹</strong>ï¼š  </p><ol><li>MainReactor æ¥æ”¶æ–°è¿æ¥ï¼ŒæŒ‰è´Ÿè½½å‡è¡¡ç­–ç•¥åˆ†é…ç»™ SubReactor</li><li>SubReactor å°†è¿æ¥åŠ å…¥è‡ªå·±çš„ç›‘å¬é˜Ÿåˆ—</li><li>äº‹ä»¶è§¦å‘æ—¶ï¼ŒSubReactor è°ƒç”¨å¯¹åº” Handler å¤„ç†æ•°æ®æµ</li></ol><p><strong>ä¼˜åŠ¿</strong>ï¼š<br>â€¢ ä¸»ä»åˆ†å·¥æ˜ç¡®ï¼Œæ‰©å±•æ€§å¼º<br>â€¢ é¿å…å•ç‚¹æ€§èƒ½ç“¶é¢ˆ<br>â€¢ <strong>å…¸å‹åº”ç”¨</strong>ï¼šNettyï¼ˆå¤šçº¿ç¨‹ï¼‰ã€Nginxï¼ˆå¤šè¿›ç¨‹å˜ä½“ï¼‰</p><hr><h2 id="äºŒã€Proactor-æ¨¡å¼ï¼šå¼‚æ­¥éé˜»å¡çš„ç»ˆææ–¹æ¡ˆ"><a href="#äºŒã€Proactor-æ¨¡å¼ï¼šå¼‚æ­¥éé˜»å¡çš„ç»ˆææ–¹æ¡ˆ" class="headerlink" title="äºŒã€Proactor æ¨¡å¼ï¼šå¼‚æ­¥éé˜»å¡çš„ç»ˆææ–¹æ¡ˆ"></a>äºŒã€Proactor æ¨¡å¼ï¼šå¼‚æ­¥éé˜»å¡çš„ç»ˆææ–¹æ¡ˆ</h2><h3 id="1-æ ¸å¿ƒæ€æƒ³-1"><a href="#1-æ ¸å¿ƒæ€æƒ³-1" class="headerlink" title="1. æ ¸å¿ƒæ€æƒ³"></a>1. æ ¸å¿ƒæ€æƒ³</h3><p>Proactor æ˜¯çœŸæ­£çš„ <strong>å¼‚æ­¥ I/O æ¨¡å‹</strong>ï¼Œå…¶ç‰¹ç‚¹åœ¨äºï¼š<br>â€¢ <strong>æ“ä½œç³»ç»Ÿå®Œæˆ I/O æ“ä½œ</strong>ï¼šåŒ…æ‹¬æ•°æ®ä»å†…æ ¸åˆ°ç”¨æˆ·ç©ºé—´çš„æ‹·è´<br>â€¢ <strong>åº”ç”¨å±‚åªå…³æ³¨ä¸šåŠ¡é€»è¾‘</strong>ï¼šå¤„ç†å·²å®Œæˆçš„ I/O äº‹ä»¶</p><p><strong>ç°å®ç±»æ¯”</strong>ï¼š<br>Proactor å¦‚åŒå¤–å–å¹³å°ï¼Œéª‘æ‰‹ï¼ˆç³»ç»Ÿå†…æ ¸ï¼‰ç›´æ¥å°†é¤å“é€åˆ°ä½ å®¶ï¼ˆæ•°æ®å°±ç»ªï¼‰ï¼Œä½ åªéœ€å¤„ç†ç”¨é¤ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰å³å¯ã€‚</p><hr><h3 id="2-å·¥ä½œæµç¨‹"><a href="#2-å·¥ä½œæµç¨‹" class="headerlink" title="2. å·¥ä½œæµç¨‹"></a>2. å·¥ä½œæµç¨‹</h3><ol><li><strong>æ³¨å†Œå¼‚æ­¥æ“ä½œ</strong>ï¼šåº”ç”¨é€šè¿‡ <code>aio_read</code> ç­‰æ¥å£å‘èµ·è¯·æ±‚ï¼ŒæŒ‡å®šæ•°æ®ç¼“å†²åŒº</li><li><strong>ç³»ç»Ÿå†…æ ¸æ‰§è¡Œ I/O</strong>ï¼šä»ç½‘å¡è¯»å–æ•°æ®å¹¶è‡ªåŠ¨æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</li><li><strong>å®Œæˆé€šçŸ¥</strong>ï¼šå†…æ ¸é€šè¿‡å›è°ƒé€šçŸ¥ Proactor</li><li><strong>ä¸šåŠ¡å¤„ç†</strong>ï¼šProactor è°ƒç”¨ Handler å¤„ç†æ•°æ®</li></ol><hr><h3 id="3-å¹³å°æ”¯æŒå·®å¼‚"><a href="#3-å¹³å°æ”¯æŒå·®å¼‚" class="headerlink" title="3. å¹³å°æ”¯æŒå·®å¼‚"></a>3. å¹³å°æ”¯æŒå·®å¼‚</h3><div class="table-container"><table><thead><tr><th><strong>å¹³å°</strong></th><th><strong>å®ç°æ–¹å¼</strong></th><th><strong>ç‰¹ç‚¹</strong></th></tr></thead><tbody><tr><td>Linux</td><td>æ¨¡æ‹Ÿå¼‚æ­¥ I/Oï¼ˆå¦‚ <code>aio</code>ï¼‰</td><td>ä»…æ”¯æŒæ–‡ä»¶æ“ä½œï¼Œç½‘ç»œæ€§èƒ½å—é™</td></tr><tr><td>Windows</td><td>åŸç”Ÿæ”¯æŒ IOCPï¼ˆå®Œæˆç«¯å£ï¼‰</td><td>çœŸæ­£å¼‚æ­¥ï¼Œé€‚åˆé«˜æ€§èƒ½ç½‘ç»œæœåŠ¡</td></tr></tbody></table></div><hr><h2 id="ä¸‰ã€Reactor-vs-Proactor-å…³é”®åŒºåˆ«"><a href="#ä¸‰ã€Reactor-vs-Proactor-å…³é”®åŒºåˆ«" class="headerlink" title="ä¸‰ã€Reactor vs Proactor å…³é”®åŒºåˆ«"></a>ä¸‰ã€Reactor vs Proactor å…³é”®åŒºåˆ«</h2><div class="table-container"><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Reactor</strong></th><th><strong>Proactor</strong></th></tr></thead><tbody><tr><td><strong>äº‹ä»¶ç±»å‹</strong></td><td>é€šçŸ¥â€å¯è¯»/å¯å†™â€ï¼ˆéœ€åº”ç”¨ä¸»åŠ¨å¤„ç†æ•°æ®ï¼‰</td><td>é€šçŸ¥â€æ•°æ®å·²å°±ç»ªâ€ï¼ˆæ•°æ®å·²å­˜å…¥åº”ç”¨ç¼“å†²åŒºï¼‰</td></tr><tr><td><strong>æ•°æ®å¤„ç†</strong></td><td>åº”ç”¨å±‚è°ƒç”¨ <code>read</code>/<code>write</code> å®Œæˆ I/O æ“ä½œ</td><td>ç³»ç»Ÿè‡ªåŠ¨å®Œæˆæ•°æ®è¯»å†™</td></tr><tr><td><strong>æ€§èƒ½ç“¶é¢ˆ</strong></td><td>ä¾èµ–éé˜»å¡ I/O å’Œçº¿ç¨‹æ¨¡å‹ä¼˜åŒ–</td><td>ä¾èµ–æ“ä½œç³»ç»Ÿå¼‚æ­¥æ”¯æŒ</td></tr><tr><td><strong>ç¼–ç¨‹å¤æ‚åº¦</strong></td><td>éœ€å¤„ç†éé˜»å¡ I/O çŠ¶æ€å’ŒåŠåŒ…é—®é¢˜</td><td>åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘</td></tr><tr><td><strong>å…¸å‹åº”ç”¨</strong></td><td>Redisã€Nginxã€Netty</td><td>Windows IOCP æœåŠ¡å™¨</td></tr></tbody></table></div><hr><h2 id="å››ã€å¦‚ä½•é€‰æ‹©ç½‘ç»œæ¨¡å‹ï¼Ÿ"><a href="#å››ã€å¦‚ä½•é€‰æ‹©ç½‘ç»œæ¨¡å‹ï¼Ÿ" class="headerlink" title="å››ã€å¦‚ä½•é€‰æ‹©ç½‘ç»œæ¨¡å‹ï¼Ÿ"></a>å››ã€å¦‚ä½•é€‰æ‹©ç½‘ç»œæ¨¡å‹ï¼Ÿ</h2><h3 id="1-Reactor-é€‚ç”¨åœºæ™¯"><a href="#1-Reactor-é€‚ç”¨åœºæ™¯" class="headerlink" title="1. Reactor é€‚ç”¨åœºæ™¯"></a>1. Reactor é€‚ç”¨åœºæ™¯</h3><p>â€¢ <strong>è·¨å¹³å°éœ€æ±‚</strong>ï¼ˆå°¤å…¶æ˜¯ Linux ç¯å¢ƒï¼‰<br>â€¢ <strong>ä¸šåŠ¡é€»è¾‘è½»é‡</strong>ï¼ˆå¦‚å¾®ç§’çº§å¤„ç†ï¼‰<br>â€¢ <strong>é«˜å¹¶å‘è¿æ¥</strong>ï¼ˆå¦‚ç™¾ä¸‡çº§é•¿è¿æ¥ï¼‰<br>â€¢ <strong>ç»å…¸æ¡ˆä¾‹</strong>ï¼š<br>  â€¢ Redisï¼šå• Reactor å¤„ç†å†…å­˜çº§å¿«é€Ÿæ“ä½œ<br>  â€¢ Nettyï¼šå¤š Reactor åº”å¯¹é«˜å¹¶å‘ç½‘ç»œè¯·æ±‚</p><h3 id="2-Proactor-é€‚ç”¨åœºæ™¯"><a href="#2-Proactor-é€‚ç”¨åœºæ™¯" class="headerlink" title="2. Proactor é€‚ç”¨åœºæ™¯"></a>2. Proactor é€‚ç”¨åœºæ™¯</h3><p>â€¢ <strong>Windows å¹³å°é«˜æ€§èƒ½æœåŠ¡</strong><br>â€¢ <strong>å¤§æ•°æ®é‡ä¼ è¾“</strong>ï¼ˆå¦‚è§†é¢‘æµå¤„ç†ï¼‰<br>â€¢ <strong>ç®€åŒ–ä¸šåŠ¡å±‚å¼€å‘</strong><br>â€¢ <strong>ç»å…¸æ¡ˆä¾‹</strong>ï¼š<br>  â€¢ IIS æœåŠ¡å™¨ï¼šåŸºäº IOCP å®ç°é«˜æ•ˆ HTTP æœåŠ¡<br>  â€¢ é‡‘èäº¤æ˜“ç³»ç»Ÿï¼šä½å»¶è¿Ÿå¤„ç†é«˜é¢‘äº¤æ˜“æ•°æ®</p><hr><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p><strong>Reactor çš„æœ¬è´¨</strong>ï¼š  </p><blockquote><p>â€œäº‹ä»¶å°±ç»ªæ—¶é€šçŸ¥ä½ å¤„ç†â€ â€”â€” åº”ç”¨ç¨‹åºä»éœ€ä¸»åŠ¨å®Œæˆæ•°æ®è¯»å†™ã€‚</p></blockquote><p><strong>Proactor çš„ç²¾é«“</strong>ï¼š  </p><blockquote><p>â€œäº‹ä»¶å¤„ç†å®Œé€šçŸ¥ä½ ç»“æœâ€ â€”â€” æ“ä½œç³»ç»ŸåŒ…æ½è„æ´»ç´¯æ´»ï¼Œåº”ç”¨å±‚ä¸“æ³¨ä¸šåŠ¡ã€‚</p></blockquote><p><strong>æŠ€æœ¯é€‰å‹å»ºè®®</strong>ï¼š<br>â€¢ åœ¨ Linux ä½“ç³»ä¸‹ï¼ŒReactor ä»æ˜¯ä¸»æµé€‰æ‹©ï¼Œç»“åˆ <code>epoll</code> å’Œçº¿ç¨‹æ± ä¼˜åŒ–å¯è¾¾åˆ° C10M å¹¶å‘ã€‚<br>â€¢ Windows å¹³å°ä¼˜å…ˆè€ƒè™‘ Proactorï¼ˆIOCPï¼‰ï¼Œå……åˆ†å‘æŒ¥å¼‚æ­¥æ€§èƒ½ä¼˜åŠ¿ã€‚<br>â€¢ ç°ä»£æ¡†æ¶å¦‚ Netty é€šè¿‡åˆ†å±‚è®¾è®¡å±è”½åº•å±‚å·®å¼‚ï¼Œå¼€å‘è€…å¯åŸºäº API ç»Ÿä¸€ç¼–ç¨‹æ¨¡å‹ã€‚</p><p>ç†è§£è¿™äº›åº•å±‚ç½‘ç»œæ¨¡å¼æ˜¯å¾ˆé‡è¦çš„ã€‚å› ä¸ºæ— è®ºæ˜¯ä¼˜åŒ–ç°æœ‰ç³»ç»Ÿï¼Œè¿˜æ˜¯è®¾è®¡æ–°æ¶æ„ï¼ŒReactor å’Œ Proactor çš„æ€æƒ³éƒ½å°†æŒç»­æŒ‡å¼•æˆ‘ä»¬çªç ´æ€§èƒ½ç“¶é¢ˆã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§é«˜æ€§èƒ½ç½‘ç»œæ¨¡å¼</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ“ä½œç³»ç»Ÿ" scheme="https://outoflovenicoo.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>MySQLå¦‚ä½•å­˜å‚¨æ•°æ®</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-03-09-MySQL%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-03-09-MySQL%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE.html</id>
    <published>2025-03-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="InnoDBå­˜å‚¨å¼•æ“å¦‚ä½•å­˜å‚¨æ•°æ®"><a href="#InnoDBå­˜å‚¨å¼•æ“å¦‚ä½•å­˜å‚¨æ•°æ®" class="headerlink" title="InnoDBå­˜å‚¨å¼•æ“å¦‚ä½•å­˜å‚¨æ•°æ®"></a>InnoDBå­˜å‚¨å¼•æ“å¦‚ä½•å­˜å‚¨æ•°æ®</h1><h2 id="æ€ç»´å¯¼å›¾ï¼š"><a href="#æ€ç»´å¯¼å›¾ï¼š" class="headerlink" title="æ€ç»´å¯¼å›¾ï¼š"></a><strong>æ€ç»´å¯¼å›¾ï¼š</strong></h2><p><img src="2025-03-09-MySQLå¦‚ä½•å­˜å‚¨æ•°æ®/1.png" alt="img"></p><p>åœ¨MySQLæ•°æ®åº“çš„ä¸–ç•Œé‡Œï¼ŒInnoDBå­˜å‚¨å¼•æ“å ªç§°æ˜¯æ•°æ®å­˜å‚¨çš„â€å¿ƒè„â€ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»¥ä¸€ä½æ•°æ®åº“å·¥ç¨‹å¸ˆçš„è§†è§’ï¼Œæ­å¼€è¿™ä¸ªâ€å¿ƒè„â€çš„è¿ä½œå¥¥ç§˜ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬æ²¿ç€æ•°æ®å­˜å‚¨çš„è„‰ç»œï¼Œå¼€å¯ä¸€åœºæŠ€æœ¯æ¢ç§˜ä¹‹æ—…ï¼</p><h2 id="ä¸€ã€MySQLæ•°æ®å­˜å‚¨åŸºçŸ³ï¼šInnoDBçš„ç²¾å¯†è®¾è®¡"><a href="#ä¸€ã€MySQLæ•°æ®å­˜å‚¨åŸºçŸ³ï¼šInnoDBçš„ç²¾å¯†è®¾è®¡" class="headerlink" title="ä¸€ã€MySQLæ•°æ®å­˜å‚¨åŸºçŸ³ï¼šInnoDBçš„ç²¾å¯†è®¾è®¡"></a>ä¸€ã€MySQLæ•°æ®å­˜å‚¨åŸºçŸ³ï¼šInnoDBçš„ç²¾å¯†è®¾è®¡</h2><p>å¦‚æœæŠŠæ•°æ®åº“æ¯”ä½œå›¾ä¹¦é¦†ï¼ŒInnoDBå°±æ˜¯é‚£ä¸ªæ—¢æ‡‚åˆ†ç±»åˆå–„ç®¡ç†çš„å›¾ä¹¦ç®¡ç†å‘˜ã€‚å®ƒé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå°†æ•°æ®æœ‰åºåœ°å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚</p><h3 id="ï¼ˆä¸€ï¼‰ç£ç›˜æ–‡ä»¶é‡Œçš„â€èº«ä»½è¯â€ä¸â€è—ä¹¦é˜â€"><a href="#ï¼ˆä¸€ï¼‰ç£ç›˜æ–‡ä»¶é‡Œçš„â€èº«ä»½è¯â€ä¸â€è—ä¹¦é˜â€" class="headerlink" title="ï¼ˆä¸€ï¼‰ç£ç›˜æ–‡ä»¶é‡Œçš„â€èº«ä»½è¯â€ä¸â€è—ä¹¦é˜â€"></a>ï¼ˆä¸€ï¼‰ç£ç›˜æ–‡ä»¶é‡Œçš„â€èº«ä»½è¯â€ä¸â€è—ä¹¦é˜â€</h3><p><img src="2025-03-09-MySQLå¦‚ä½•å­˜å‚¨æ•°æ®/2.png" alt="img"></p><p>å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªè®¢å•è¡¨<code>order</code>æ—¶ï¼Œç³»ç»Ÿä¼šæ‚„æ‚„ç”Ÿæˆå‡ ä¸ªå…³é”®æ–‡ä»¶ï¼š<br>â€¢ <strong>optæ–‡ä»¶</strong>ï¼šå°±åƒæ˜¯æ•°æ®åº“çš„â€èº«ä»½è¯â€ï¼Œè®°å½•ç€é»˜è®¤çš„å­—ç¬¦é›†ï¼ˆæ¯”å¦‚UTF-8ï¼‰å’Œæ ¡éªŒè§„åˆ™ã€‚å®ƒç¡®ä¿ä¸­æ–‡ä¸ä¼šå˜æˆä¹±ç ï¼Œæ•°å­—æ¯”è¾ƒæ—¶ä¸ä¼šå‡ºé”™ã€‚<br>â€¢ <strong>frmæ–‡ä»¶</strong>ï¼šå¯ä»¥ç†è§£ä¸ºâ€ä¹¦æ¶æ ‡ç­¾â€ï¼Œå­˜å‚¨ç€è¡¨ç»“æ„çš„å®šä¹‰ã€‚æ¯æ¬¡ä½ DESCæŸ¥çœ‹è¡¨ç»“æ„æ—¶ï¼Œç³»ç»Ÿå…¶å®å°±æ˜¯åœ¨è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚<br>â€¢ <strong>idbæ–‡ä»¶</strong>ï¼šè¿™æ‰æ˜¯çœŸæ­£çš„â€è—ä¹¦é˜â€ã€‚ä»¥<code>order.idb</code>ä¸ºä¾‹ï¼Œå®ƒå­˜å‚¨ç€è®¢å•è¡¨çš„æ‰€æœ‰æ•°æ®ã€‚å°±åƒç°ä»£å›¾ä¹¦é¦†çš„æ™ºèƒ½ä¹¦æ¶ï¼ŒMySQL 5.6.6ä¹‹åé»˜è®¤æ¯ä¸ªè¡¨éƒ½æœ‰ç‹¬ç«‹çš„.idbæ–‡ä»¶ï¼Œè¿™æ ·è¦ç»´æŠ¤æŸä¸ªä¹¦æ¶ï¼ˆè¡¨ï¼‰æ—¶ï¼Œå†ä¹Ÿä¸ç”¨æ¬åŠ¨æ•´ä¸ªå›¾ä¹¦é¦†çš„è—ä¹¦äº†ã€‚</p><p>ä¸¾ä¸ªçœŸå®æ¡ˆä¾‹ï¼šæŸç”µå•†å¹³å°å‘ç°è®¢å•è¡¨æŸ¥è¯¢å˜æ…¢ï¼ŒDBAé€šè¿‡<code>ALTER TABLE order ENGINE=InnoDB</code>é‡å»ºè¡¨ç©ºé—´åï¼Œå‘ç°.idbæ–‡ä»¶ä½“ç§¯ç¼©å°äº†30%ï¼Œè¿™æ­£æ˜¯ç‹¬ç«‹è¡¨ç©ºé—´çš„ä¼˜åŠ¿ä½“ç°ã€‚</p><h3 id="ï¼ˆäºŒï¼‰è¡¨ç©ºé—´çš„ä¿„ç½—æ–¯å¥—å¨ƒç»“æ„"><a href="#ï¼ˆäºŒï¼‰è¡¨ç©ºé—´çš„ä¿„ç½—æ–¯å¥—å¨ƒç»“æ„" class="headerlink" title="ï¼ˆäºŒï¼‰è¡¨ç©ºé—´çš„ä¿„ç½—æ–¯å¥—å¨ƒç»“æ„"></a>ï¼ˆäºŒï¼‰è¡¨ç©ºé—´çš„ä¿„ç½—æ–¯å¥—å¨ƒç»“æ„</h3><p>æ‰“å¼€è¿™ä¸ªâ€è—ä¹¦é˜â€ï¼Œä½ ä¼šå‘ç°ä¸€ä¸ªç²¾å¦™çš„å­˜å‚¨ä½“ç³»ï¼š</p><p><img src="2025-03-09-MySQLå¦‚ä½•å­˜å‚¨æ•°æ®/3.png" alt="img"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¡¨ç©ºé—´ â†’ æ®µ â†’ åŒº â†’ é¡µ â†’ è¡Œ</span><br></pre></td></tr></table></figure><p>å°±åƒå›¾ä¹¦é¦†çš„åˆ†åŒºç®¡ç†ï¼š<br>â€¢ <strong>æ®µï¼ˆSegmentï¼‰</strong>ï¼šç±»ä¼¼å›¾ä¹¦é¦†çš„æ¥¼å±‚åˆ†åŒºï¼ˆç´¢å¼•åŒºã€æ•°æ®åŒºï¼‰<br>â€¢ <strong>åŒºï¼ˆExtentï¼‰</strong>ï¼šæ¯ä¸ªæ¥¼å±‚é‡Œçš„è—ä¹¦åŒºï¼Œç”±è¿ç»­64ä¸ªé¡µç»„æˆï¼ˆ1MBï¼‰<br>â€¢ <strong>é¡µï¼ˆPageï¼‰</strong>ï¼šæœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒï¼Œç›¸å½“äºä¹¦æ¶éš”å±‚ï¼ˆ16KBï¼‰<br>â€¢ <strong>è¡Œï¼ˆRowï¼‰</strong>ï¼šæ¯æœ¬ä¹¦å°±æ˜¯ä¸€è¡Œæ•°æ®</p><p>è¿™ç§ç»“æ„è®¾è®¡æœ‰ä¸ªç²¾å¦™ä¹‹å¤„ï¼šå½“éœ€è¦æ–°å¢æ•°æ®æ—¶ï¼ŒInnoDBä¸æ˜¯éšæ„æ‰¾ä¸ªç©ºä½ï¼Œè€Œæ˜¯æ•´åŒºæ•´åŒºåœ°åˆ†é…ç©ºé—´ã€‚å°±åƒå›¾ä¹¦é¦†æ‰©å»ºæ—¶ç›´æ¥å¢åŠ æ•´ä¸ªä¹¦æ¶åŒºï¼Œè€Œä¸æ˜¯è¿™é‡ŒåŠ ä¸€æœ¬é‚£é‡Œå¡ä¸€å†Œã€‚</p><h2 id="äºŒã€è¡Œæ ¼å¼"><a href="#äºŒã€è¡Œæ ¼å¼" class="headerlink" title="äºŒã€è¡Œæ ¼å¼"></a>äºŒã€è¡Œæ ¼å¼</h2><p>å¦‚æœè¯´è¡¨ç©ºé—´æ˜¯å›¾ä¹¦é¦†ï¼Œé‚£ä¹ˆè¡Œæ ¼å¼å°±æ˜¯ä¹¦ç±çš„æ’ç‰ˆè§„èŒƒã€‚InnoDBæ”¯æŒå¤šç§è¡Œæ ¼å¼ï¼Œæˆ‘ä»¬ä»¥æœ€å¸¸ç”¨çš„Compactæ ¼å¼ä¸ºä¾‹ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å°†æ•°æ®â€è£…è®¢æˆå†Œâ€çš„ã€‚</p><h3 id="ï¼ˆä¸€ï¼‰å˜é•¿å­—æ®µçš„"><a href="#ï¼ˆä¸€ï¼‰å˜é•¿å­—æ®µçš„" class="headerlink" title="ï¼ˆä¸€ï¼‰å˜é•¿å­—æ®µçš„"></a>ï¼ˆä¸€ï¼‰å˜é•¿å­—æ®µçš„</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€å¼ ç”¨æˆ·è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>å½“æ’å…¥ä¸€æ¡è®°å½•ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> users <span class="keyword">VALUES</span>(<span class="number">1</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="string">&#x27;zhangsan@example.com&#x27;</span>);</span><br></pre></td></tr></table></figure><br>Compactè¡Œæ ¼å¼ä¼šå…ˆåœ¨æ•°æ®è¡Œå¤´éƒ¨æ”¾ç½®ä¸¤æŠŠâ€å°ºå­â€ï¼š</p><ol><li><p><strong>å˜é•¿å­—æ®µé•¿åº¦åˆ—è¡¨</strong>ï¼šé€†åºè®°å½•æ¯ä¸ªå˜é•¿å­—æ®µçš„å®é™…é•¿åº¦<br>â€¢ emailé•¿åº¦23å­—èŠ‚ï¼ˆASCIIæ¯ä¸ªå­—ç¬¦1å­—èŠ‚ï¼‰<br>â€¢ nameé•¿åº¦4å­—èŠ‚ï¼ˆæ¯ä¸ªä¸­æ–‡å­—ç¬¦3å­—èŠ‚ï¼Ÿä¸ï¼è¿™é‡Œæœ‰ä¸ªå¸¸è§è¯¯åŒºï¼Œå®é™…å­˜å‚¨é•¿åº¦å–å†³äºå­—ç¬¦é›†ï¼‰<br>â€¢ å­˜å‚¨æ–¹å¼ï¼š<code>[23,4]</code>çš„é€†åºåå…­è¿›åˆ¶<code>0x17 0x04</code></p></li><li><p><strong>NULLå€¼æ ‡è®°ä½å›¾</strong>ï¼š<br>â€¢ ä¸‰ä¸ªå­—æ®µéƒ½ä¸å…è®¸NULLï¼Œæ‰€ä»¥è¿™ä¸ªåˆ—è¡¨ä¸å­˜åœ¨<br>â€¢ å¦‚æœå…è®¸NULLï¼Œä¼šç”¨ä½å›¾æ ‡è®°å“ªäº›å­—æ®µæ˜¯NULLï¼ˆ1è¡¨ç¤ºNULLï¼‰</p></li></ol><p>è¿™é‡Œæœ‰ä¸ªæœ‰è¶£çš„æµ‹è¯•ï¼šå°†nameå­—æ®µæ”¹ä¸ºCHAR(20)ï¼Œå®é™…å­˜å‚¨é•¿åº¦ä¼šå˜æˆ60å­—èŠ‚ï¼ˆå‡è®¾UTF8MB4å­—ç¬¦é›†ï¼‰ï¼Œè€ŒVARCHAR(20)å®é™…å­˜å‚¨é•¿åº¦æ ¹æ®å†…å®¹å˜åŒ–ã€‚è¿™å°±æ˜¯CHARç±»å‹åœ¨å­˜å‚¨ç©ºé—´ä¸Šçš„â€ä»¥ç©ºé—´æ¢æ—¶é—´â€ç­–ç•¥ã€‚</p><h3 id="ï¼ˆäºŒï¼‰NULLå€¼çš„å­˜å‚¨"><a href="#ï¼ˆäºŒï¼‰NULLå€¼çš„å­˜å‚¨" class="headerlink" title="ï¼ˆäºŒï¼‰NULLå€¼çš„å­˜å‚¨"></a>ï¼ˆäºŒï¼‰NULLå€¼çš„å­˜å‚¨</h3><p>å½“è¡¨ä¸­å­˜åœ¨å…è®¸NULLçš„å­—æ®µæ—¶ï¼ŒCompactè¡Œæ ¼å¼ä¼šæ–½å±•å®ƒçš„â€éšèº«æœ¯â€ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    product <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    buyer <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>å‡è®¾æ’å…¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> orders <span class="keyword">VALUES</span>(<span class="number">1001</span>, <span class="string">&#x27;æ™ºèƒ½æ‰‹æœº&#x27;</span>, <span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure><br>æ­¤æ—¶ï¼š</p><ol><li>NULLå€¼åˆ—è¡¨ç”¨1å­—èŠ‚è¡¨ç¤ºï¼šäºŒè¿›åˆ¶<code>00000010</code>ï¼ˆé€†åºæ’åˆ—ï¼Œç¬¬äºŒä½è¡¨ç¤ºbuyerä¸ºNULLï¼‰</li><li>å®é™…æ•°æ®åŒºä¸å­˜å‚¨NULLå­—æ®µçš„å€¼</li><li>çœå»äº†å­˜å‚¨â€NULLâ€å­—ç¬¦ä¸²çš„ç©ºé—´</li></ol><p>æ ¹æ®ç»Ÿè®¡ï¼Œå½“è¡¨ä¸­å­˜åœ¨å¤šä¸ªå¯ä¸ºNULLçš„å­—æ®µæ—¶ï¼Œè¿™ç§è®¾è®¡å¯èŠ‚çœçº¦5%çš„å­˜å‚¨ç©ºé—´ã€‚æŸç¤¾äº¤å¹³å°ç”¨æˆ·è¡¨ä¼˜åŒ–åï¼Œä»…NULLä¼˜åŒ–å°±å‡å°‘äº†20GBçš„å­˜å‚¨ç©ºé—´ï¼</p><h2 id="ä¸‰ã€å½“æ•°æ®è†¨èƒ€æ—¶çš„â€åˆ†é¡µå­˜å‚¨æœ¯â€"><a href="#ä¸‰ã€å½“æ•°æ®è†¨èƒ€æ—¶çš„â€åˆ†é¡µå­˜å‚¨æœ¯â€" class="headerlink" title="ä¸‰ã€å½“æ•°æ®è†¨èƒ€æ—¶çš„â€åˆ†é¡µå­˜å‚¨æœ¯â€"></a>ä¸‰ã€å½“æ•°æ®è†¨èƒ€æ—¶çš„â€åˆ†é¡µå­˜å‚¨æœ¯â€</h2><p>æƒ³è±¡ä¸€æœ¬ç™¾ç§‘å…¨ä¹¦å¤ªåšæ— æ³•æ”¾å…¥ä¹¦æ¶éš”å±‚ï¼Œè¿™æ—¶å€™å°±éœ€è¦åˆ†å†Œå­˜æ”¾ã€‚InnoDBçš„è¡Œæº¢å‡ºæœºåˆ¶å°±æ˜¯è¿™ç§æ™ºæ…§çš„æ•°å­—ç‰ˆã€‚</p><h3 id="ï¼ˆä¸€ï¼‰è¡Œæº¢å‡ºçš„ä¸´ç•Œç‚¹è®¡ç®—"><a href="#ï¼ˆä¸€ï¼‰è¡Œæº¢å‡ºçš„ä¸´ç•Œç‚¹è®¡ç®—" class="headerlink" title="ï¼ˆä¸€ï¼‰è¡Œæº¢å‡ºçš„ä¸´ç•Œç‚¹è®¡ç®—"></a>ï¼ˆä¸€ï¼‰è¡Œæº¢å‡ºçš„ä¸´ç•Œç‚¹è®¡ç®—</h3><p>æ¯ä¸ªé¡µï¼ˆ16KBï¼‰èƒ½å­˜å‚¨å¤šå°‘æ•°æ®ï¼Ÿæˆ‘ä»¬é€šè¿‡å…¬å¼è®¡ç®—ï¼š<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å¤§è¡Œé•¿åº¦ <span class="operator">=</span> é¡µå¤§å°(<span class="number">16384</span>) - è¡Œå¤´ä¿¡æ¯(çº¦<span class="number">56</span>å­—èŠ‚) â‰ˆ <span class="number">16328</span>å­—èŠ‚</span><br></pre></td></tr></table></figure><br>å½“æŸè¡Œæ•°æ®è¶…è¿‡è¿™ä¸ªé˜ˆå€¼æ—¶ï¼Œå°±ä¼šè§¦å‘è¡Œæº¢å‡ºã€‚æ¯”å¦‚ä¸€ä¸ªåŒ…å«10ä¸ªTEXTå­—æ®µçš„è¡¨ï¼Œæ¯æ¡è®°å½•éƒ½å¯èƒ½éœ€è¦æº¢å‡ºå­˜å‚¨ã€‚</p><h3 id="ï¼ˆäºŒï¼‰æº¢å‡ºé¡µçš„â€ç›®å½•ç´¢å¼•â€"><a href="#ï¼ˆäºŒï¼‰æº¢å‡ºé¡µçš„â€ç›®å½•ç´¢å¼•â€" class="headerlink" title="ï¼ˆäºŒï¼‰æº¢å‡ºé¡µçš„â€ç›®å½•ç´¢å¼•â€"></a>ï¼ˆäºŒï¼‰æº¢å‡ºé¡µçš„â€ç›®å½•ç´¢å¼•â€</h3><p>å½“å‘ç”Ÿè¡Œæº¢å‡ºæ—¶ï¼ŒCompactè¡Œæ ¼å¼ä¼šï¼š</p><ol><li>åœ¨åŸå§‹é¡µä¿ç•™768å­—èŠ‚çš„â€ä¹¦ç­¾â€</li><li>å‰©ä½™æ•°æ®å­˜å…¥æº¢å‡ºé¡µ</li><li>ç”¨20å­—èŠ‚çš„æŒ‡é’ˆè®°å½•æº¢å‡ºé¡µåœ°å€</li><li>å¤šä¸ªæº¢å‡ºé¡µé€šè¿‡é“¾è¡¨è¿æ¥</li></ol><p>è¿™å°±åƒå›¾ä¹¦é¦†çš„ä¹¦ç±ç›®å½•ï¼š<br>â€¢ ä¸»ä¹¦æ¶å­˜æ”¾ç›®å½•é¡µï¼ˆåŒ…å«å„åˆ†å†Œä½ç½®ï¼‰<br>â€¢ å®é™…å†…å®¹å­˜æ”¾åœ¨å¤šä¸ªåˆ†å†Œä¹¦æ¶</p><p>æŸè®ºå›ç³»ç»Ÿæ›¾å› å¤§æ–‡æœ¬å­—æ®µå¯¼è‡´é¢‘ç¹è¡Œæº¢å‡ºï¼Œé€šè¿‡å°†å¤§å­—æ®µæ‹†åˆ†åˆ°æ‰©å±•è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡äº†3å€ã€‚</p><h2 id="å››ã€è¡Œæ ¼å¼è®¾è®¡"><a href="#å››ã€è¡Œæ ¼å¼è®¾è®¡" class="headerlink" title="å››ã€è¡Œæ ¼å¼è®¾è®¡"></a>å››ã€è¡Œæ ¼å¼è®¾è®¡</h2><h3 id="ï¼ˆä¸€ï¼‰Compact-vs-Dynamicï¼šé€‰æ‹©çš„æ™ºæ…§"><a href="#ï¼ˆä¸€ï¼‰Compact-vs-Dynamicï¼šé€‰æ‹©çš„æ™ºæ…§" class="headerlink" title="ï¼ˆä¸€ï¼‰Compact vs Dynamicï¼šé€‰æ‹©çš„æ™ºæ…§"></a>ï¼ˆä¸€ï¼‰Compact vs Dynamicï¼šé€‰æ‹©çš„æ™ºæ…§</h3><p>MySQL 8.0é»˜è®¤ä½¿ç”¨Dynamicè¡Œæ ¼å¼ï¼Œå®ƒåœ¨å¤„ç†æº¢å‡ºæ—¶æ›´æ¿€è¿›ï¼š<br>â€¢ ä»…ä¿ç•™20å­—èŠ‚æŒ‡é’ˆ<br>â€¢ æ‰€æœ‰å˜é•¿å­—æ®µæ•°æ®ä¼˜å…ˆå­˜æº¢å‡ºé¡µ<br>â€¢ æ›´é€‚åˆç°ä»£åº”ç”¨çš„å¤§æ•°æ®å­—æ®µåœºæ™¯</p><p>é€‰æ‹©å»ºè®®ï¼š<br>â€¢ é¢‘ç¹æ›´æ–°çš„å¤§å­—æ®µè¡¨ â†’ Dynamic<br>â€¢ éœ€è¦å…¼å®¹æ—§ç‰ˆæœ¬ â†’ Compact<br>â€¢ å‹ç¼©éœ€æ±‚ â†’ Compressed</p><h3 id="ï¼ˆäºŒï¼‰å­—ç¬¦é›†çš„éšè—é™·é˜±"><a href="#ï¼ˆäºŒï¼‰å­—ç¬¦é›†çš„éšè—é™·é˜±" class="headerlink" title="ï¼ˆäºŒï¼‰å­—ç¬¦é›†çš„éšè—é™·é˜±"></a>ï¼ˆäºŒï¼‰å­—ç¬¦é›†çš„éšè—é™·é˜±</h3><p>å½“è®¡ç®—varchar(n)æœ€å¤§é•¿åº¦æ—¶ï¼Œå­—ç¬¦é›†çš„å½±å“å¸¸è¢«å¿½è§†ï¼š<br>â€¢ UTF8MB4å­—ç¬¦é›†ï¼šæ¯ä¸ªå­—ç¬¦æœ€å¤š4å­—èŠ‚<br>â€¢ å®é™…æœ€å¤§nå€¼ = (65535 - é•¿åº¦åˆ—è¡¨ - NULLåˆ—è¡¨) / 4</p><p>ä¾‹å¦‚å…è®¸NULLçš„å•å­—æ®µè¡¨ï¼š<br><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(65535 -<span class="number"> 2 </span>- 1) /<span class="number"> 4 </span>â‰ˆ 16383å­—ç¬¦</span><br></pre></td></tr></table></figure><br>æŸå›½é™…åŒ–ç”µå•†å°±æ›¾å› æœªè€ƒè™‘å­—ç¬¦é›†ï¼Œå¯¼è‡´åœ°å€å­—æ®µè¢«æˆªæ–­ï¼ŒæŸå¤±ç™¾ä¸‡è®¢å•ã€‚</p><h2 id="äº”ã€æ€§èƒ½ä¼˜åŒ–"><a href="#äº”ã€æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="äº”ã€æ€§èƒ½ä¼˜åŒ–"></a>äº”ã€æ€§èƒ½ä¼˜åŒ–</h2><ol><li><strong>NULLå€¼ä¼˜åŒ–</strong>ï¼šå°†å…è®¸NULLçš„å­—æ®µæ”¹ä¸ºNOT NULL DEFAULT â€˜â€™ï¼Œå¯èŠ‚çœNULLåˆ—è¡¨ç©ºé—´</li><li><strong>å¤§å­—æ®µåˆ†ç¦»</strong>ï¼šå°†BLOB/TEXTå­—æ®µæ‹†åˆ†åˆ°æ‰©å±•è¡¨</li><li><strong>è¡Œæ ¼å¼è½¬æ¢</strong>ï¼š<code>ALTER TABLE ... ROW_FORMAT=DYNAMIC</code></li><li><strong>é¡µå‹ç¼©</strong>ï¼šå¯¹å†å²æ•°æ®è¡¨å¯ç”¨é¡µå‹ç¼©</li><li><strong>å­—ç¬¦é›†é€‰æ‹©</strong>ï¼šä¸­æ–‡ç¯å¢ƒä¼˜å…ˆè€ƒè™‘UTF8MB4è€ŒéUTF8</li></ol><p>æŸé‡‘èç³»ç»Ÿé€šè¿‡ä¸Šè¿°ä¼˜åŒ–ç»„åˆæ‹³ï¼Œä½¿æ ¸å¿ƒäº¤æ˜“è¡¨çš„TPSä»1500æå‡åˆ°5200ï¼Œæ•ˆæœæ˜¾è‘—ã€‚</p><h2 id="ç»“è¯­ï¼šå­˜å‚¨ä¹‹é“çš„ä¸‰é‡å¢ƒç•Œ"><a href="#ç»“è¯­ï¼šå­˜å‚¨ä¹‹é“çš„ä¸‰é‡å¢ƒç•Œ" class="headerlink" title="ç»“è¯­ï¼šå­˜å‚¨ä¹‹é“çš„ä¸‰é‡å¢ƒç•Œ"></a>ç»“è¯­ï¼šå­˜å‚¨ä¹‹é“çš„ä¸‰é‡å¢ƒç•Œ</h2><p>ç†è§£InnoDBçš„å­˜å‚¨æœºåˆ¶ï¼Œå°±åƒä¿®ç‚¼æ•°æ®åº“çš„å†…åŠŸå¿ƒæ³•ï¼š</p><ol><li><strong>è§å±±æ˜¯å±±</strong>ï¼šçœ‹æ‡‚æ–‡ä»¶ç»“æ„å’Œè¡Œæ ¼å¼</li><li><strong>è§å±±ä¸æ˜¯å±±</strong>ï¼šç†è§£è®¾è®¡å“²å­¦ä¸å–èˆæƒè¡¡</li><li><strong>è§å±±è¿˜æ˜¯å±±</strong>ï¼šèƒ½æ ¹æ®ä¸šåŠ¡ç‰¹å¾å®šåˆ¶å­˜å‚¨æ–¹æ¡ˆ</li></ol><p>å½“æˆ‘ä»¬ç¿»å¼€InnoDBçš„å­˜å‚¨å®å…¸ï¼Œçœ‹åˆ°çš„ä¸ä»…æ˜¯å†·å†°å†°çš„æ•°æ®ç»“æ„ï¼Œæ›´æ˜¯ä¸€ç¾¤å·¥ç¨‹å¸ˆå¯¹æ•ˆç‡ä¸å¯é æ€§çš„æè‡´è¿½æ±‚ã€‚ä¸‹æ¬¡å½“ä½ æ‰§è¡Œä¸€æ¡SELECTè¯­å¥æ—¶ï¼Œä¸å¦¨æƒ³è±¡ä¸€ä¸‹ï¼Œè¿™ç®€å•çš„æŸ¥è¯¢èƒŒåï¼Œæ­£æœ‰ä¸€æ”¯ç²¾å¯†çš„â€å­˜å‚¨äº¤å“ä¹å›¢â€åœ¨ä¸ºä½ æ¼”å¥ã€‚</p><h1 id="å‚è€ƒåšå®¢ï¼š"><a href="#å‚è€ƒåšå®¢ï¼š" class="headerlink" title="å‚è€ƒåšå®¢ï¼š"></a>å‚è€ƒåšå®¢ï¼š</h1><p><a href="https://xiaolincoding.com/mysql/base/row_format.html#æ€»ç»“">MySQL ä¸€è¡Œè®°å½•æ˜¯æ€ä¹ˆå­˜å‚¨çš„ï¼Ÿ</a></p>]]></content>
    
    
    <summary type="html">ğŸ¥§MySQLå¦‚ä½•å­˜å‚¨æ•°æ®</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="MySQL" scheme="https://outoflovenicoo.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-03-09-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-03-09-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html</id>
    <published>2025-03-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è”åˆç´¢å¼•åº•å±‚ä»¥åŠå†…å¹•"><a href="#è”åˆç´¢å¼•åº•å±‚ä»¥åŠå†…å¹•" class="headerlink" title="è”åˆç´¢å¼•åº•å±‚ä»¥åŠå†…å¹•"></a>è”åˆç´¢å¼•åº•å±‚ä»¥åŠå†…å¹•</h1><p><a href="https://mp.weixin.qq.com/s/8qemhRg5MgXs1So5YCv0fQ">è”åˆç´¢å¼•åº•å±‚</a></p><p><a href="https://blog.csdn.net/wangye135/article/details/140389620">MySQLè¦†ç›–ç´¢å¼•å’Œç´¢å¼•è·³è·ƒæ‰«æ-CSDNåšå®¢</a></p><p><img src="2025-03-09-è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°/image-20250407160156273-4012927.png" alt="image-20250407160156273"></p><h3 id="è¢«é—®åˆ°è¿‡ä¸€ä¸ªé¢è¯•é¢˜ï¼š"><a href="#è¢«é—®åˆ°è¿‡ä¸€ä¸ªé¢è¯•é¢˜ï¼š" class="headerlink" title="è¢«é—®åˆ°è¿‡ä¸€ä¸ªé¢è¯•é¢˜ï¼š"></a>è¢«é—®åˆ°è¿‡ä¸€ä¸ªé¢è¯•é¢˜ï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select a,c from t <span class="type">where</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span> and b= <span class="number">2</span> order by c desc</span><br></pre></td></tr></table></figure><p>åº”è¯¥è®¾ç½®ä»€ä¹ˆç´¢å¼•ï¼Œcçš„å‡åºå’Œé™åºä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Œå“ªä¸ªæ›´å¿«ä¸€ç‚¹ã€‚</p><h3 id="å‡åºç´¢å¼•ä¸é™åºç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“"><a href="#å‡åºç´¢å¼•ä¸é™åºç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“" class="headerlink" title="å‡åºç´¢å¼•ä¸é™åºç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“"></a>å‡åºç´¢å¼•ä¸é™åºç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“</h3><h4 id="1-æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸€è‡´"><a href="#1-æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸€è‡´" class="headerlink" title="1. æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸€è‡´"></a>1. æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸€è‡´</h4><ul><li><strong>å‡åºç´¢å¼•ç”¨äºå‡åºæŸ¥è¯¢</strong>ï¼šå½“åˆ›å»ºçš„ç´¢å¼•æ˜¯ <code>(a, b, c ASC)</code>ï¼ˆ<code>ASC</code> è¡¨ç¤ºå‡åºï¼Œå¯çœç•¥ï¼‰ï¼Œå¹¶ä¸”æŸ¥è¯¢è¯­å¥æ˜¯ <code>ORDER BY c ASC</code> æ—¶ï¼Œæ•°æ®åº“å¯ä»¥ç›´æ¥æŒ‰ç…§ç´¢å¼•ä¸­ <code>c</code> åˆ—çš„é¡ºåºæ¥è¿”å›ç»“æœï¼Œæ— éœ€é¢å¤–çš„æ’åºæ“ä½œï¼Œè¿™æ ·èƒ½æ˜¾è‘—æå‡æŸ¥è¯¢æ•ˆç‡ã€‚å› ä¸ºç´¢å¼•å·²ç»æŒ‰ç…§å‡åºæ’åˆ—å¥½äº†ï¼Œæ•°æ®åº“å¯ä»¥ç›´æ¥ä»ç´¢å¼•ä¸­è·å–æœ‰åºçš„æ•°æ®ã€‚</li><li><strong>é™åºç´¢å¼•ç”¨äºé™åºæŸ¥è¯¢</strong>ï¼šå¦‚æœåˆ›å»ºçš„ç´¢å¼•æ˜¯ <code>(a, b, c DESC)</code>ï¼Œè€ŒæŸ¥è¯¢è¯­å¥æ˜¯ <code>ORDER BY c DESC</code>ï¼Œæ•°æ®åº“åŒæ ·å¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•ä¸­ <code>c</code> åˆ—çš„é™åºæ’åˆ—æ¥è¿”å›ç»“æœï¼Œé¿å…äº†é¢å¤–çš„æ’åºå¼€é”€ã€‚</li></ul><h4 id="2-æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸ä¸€è‡´"><a href="#2-æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸ä¸€è‡´" class="headerlink" title="2. æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸ä¸€è‡´"></a>2. æŸ¥è¯¢æ’åºæ–¹å‘ä¸ç´¢å¼•æ’åºæ–¹å‘ä¸ä¸€è‡´</h4><ul><li><strong>å‡åºç´¢å¼•ç”¨äºé™åºæŸ¥è¯¢</strong>ï¼šå½“ä½¿ç”¨ <code>(a, b, c ASC)</code> ç´¢å¼•ï¼Œè€ŒæŸ¥è¯¢è¯­å¥æ˜¯ <code>ORDER BY c DESC</code> æ—¶ï¼Œæ•°æ®åº“å¯èƒ½æ— æ³•ç›´æ¥åˆ©ç”¨ç´¢å¼•çš„é¡ºåºï¼Œéœ€è¦å¯¹ä»ç´¢å¼•ä¸­è·å–çš„æ•°æ®è¿›è¡Œé¢å¤–çš„é™åºæ’åºæ“ä½œã€‚è¿™ä¼šå¢åŠ æŸ¥è¯¢çš„æ—¶é—´å’Œèµ„æºæ¶ˆè€—ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæ€§èƒ½ä¸‹é™ä¼šæ›´æ˜æ˜¾ã€‚</li><li><strong>é™åºç´¢å¼•ç”¨äºå‡åºæŸ¥è¯¢</strong>ï¼šç±»ä¼¼åœ°ï¼Œè‹¥ä½¿ç”¨ <code>(a, b, c DESC)</code> ç´¢å¼•ï¼Œè€ŒæŸ¥è¯¢æ˜¯ <code>ORDER BY c ASC</code>ï¼Œæ•°æ®åº“ä¹Ÿéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢å¤–çš„å‡åºæ’åºï¼Œå¯¼è‡´æ€§èƒ½é™ä½ã€‚</li></ul><h3 id="å“ªä¸ªæ›´å¿«å–å†³äºå…·ä½“åœºæ™¯"><a href="#å“ªä¸ªæ›´å¿«å–å†³äºå…·ä½“åœºæ™¯" class="headerlink" title="å“ªä¸ªæ›´å¿«å–å†³äºå…·ä½“åœºæ™¯"></a>å“ªä¸ªæ›´å¿«å–å†³äºå…·ä½“åœºæ™¯</h3><ul><li><strong>å¦‚æœæŸ¥è¯¢ä¸­</strong> <strong><code>ORDER BY c</code></strong>çš„æ–¹å‘å›ºå®šï¼š<ul><li>è‹¥æŸ¥è¯¢æ€»æ˜¯ <code>ORDER BY c ASC</code>ï¼Œé‚£ä¹ˆåˆ›å»ºå‡åºç´¢å¼• <code>(a, b, c)</code> ä¼šæ›´å¿«ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•çš„é¡ºåºã€‚</li><li>è‹¥æŸ¥è¯¢æ€»æ˜¯ <code>ORDER BY c DESC</code>ï¼Œåˆ™åˆ›å»ºé™åºç´¢å¼• <code>(a, b, c DESC)</code> æ›´åˆé€‚ï¼Œèƒ½é¿å…é¢å¤–çš„æ’åºæ“ä½œã€‚</li></ul></li><li><strong>å¦‚æœæŸ¥è¯¢ä¸­</strong> <strong><code>ORDER BY c</code></strong>çš„æ–¹å‘ä¸å›ºå®šï¼š<ul><li>åœ¨æŸäº›æ•°æ®åº“ï¼ˆå¦‚ MySQL 8.0 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ä¸­ï¼Œå¯ä»¥åŒæ—¶åˆ›å»ºå‡åºå’Œé™åºç´¢å¼•ï¼Œä½†è¿™ä¼šå¢åŠ ç´¢å¼•ç»´æŠ¤çš„å¼€é”€ï¼Œå› ä¸ºæ¯æ¬¡æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ•°æ®æ—¶ï¼Œéƒ½éœ€è¦åŒæ—¶æ›´æ–°å¤šä¸ªç´¢å¼•ã€‚</li><li>ä¹Ÿå¯ä»¥è€ƒè™‘åªåˆ›å»ºä¸€ä¸ªå‡åºç´¢å¼•ï¼Œè®©æ•°æ®åº“åœ¨éœ€è¦é™åºæ’åºæ—¶è¿›è¡Œé¢å¤–çš„æ’åºæ“ä½œã€‚åœ¨æ•°æ®é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œè¿™ç§é¢å¤–æ’åºçš„å¼€é”€å¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ä»£ç </strong></p><p><strong>å‡åºç´¢å¼•</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºå‡åºç´¢å¼•</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_a_b_c_asc <span class="keyword">ON</span> t (a, b, c);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å‡åºæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> a, c <span class="keyword">FROM</span> t <span class="keyword">WHERE</span> a <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> b <span class="operator">=</span> <span class="number">2</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> c <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure><p><strong>é™åºç´¢å¼•</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºé™åºç´¢å¼•</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_a_b_c_desc <span class="keyword">ON</span> t (a, b, c <span class="keyword">DESC</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- é™åºæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> a, c <span class="keyword">FROM</span> t <span class="keyword">WHERE</span> a <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> b <span class="operator">=</span> <span class="number">2</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> c <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šæ‰€è¿°ï¼Œé€‰æ‹©å‡åºç´¢å¼•è¿˜æ˜¯é™åºç´¢å¼•å–å†³äºæŸ¥è¯¢ä¸­ <code>ORDER BY</code> å­å¥çš„æ’åºæ–¹å‘ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§è”åˆç´¢å¼•å­¦ä¹ </summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="MySQL" scheme="https://outoflovenicoo.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>JavaåŸºç¡€é¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-01-Java%E5%9F%BA%E7%A1%80.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-01-Java%E5%9F%BA%E7%A1%80.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2-Java"><a href="#2-Java" class="headerlink" title="2.Java"></a>2.Java</h1><p><img src="2025-01-01-JavaåŸºç¡€/clip_image001.jpg" alt="img"></p><p>1.JavaåŸºç¡€</p><p>1.1 BIOã€NIOã€AIOæœ‰ä»€ä¹ˆåŒºåˆ«</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image003.jpg" alt="img"></p><p>1.2 Comparatorä¸Comparableæœ‰ä»€ä¹ˆåŒºåˆ«</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image005.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image007.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image009.jpg" alt="img"></p><p>1.3 è¯´è¯´ä½ å¯¹Integerç¼“å­˜çš„ç†è§£</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image011.jpg" alt="img"></p><p>1.4 synchronizedçš„å®ç°åŸç†</p><p>åœ¨JVMå†…éƒ¨ï¼Œæ¯ä¸ªJavaå¯¹è±¡éƒ½æœ‰å¤´ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«äº†å¯¹è±¡çš„ä¸€äº›å…ƒä¿¡æ¯å’ŒçŠ¶æ€æ ‡å¿—ã€‚synchronizedé€šè¿‡ä¿®æ”¹å¤´ä¿¡æ¯çš„çŠ¶æ€æ ‡å¿—æ¥å®ç°é”çš„è·å–å’Œé‡Šæ”¾ã€‚</p><p>å½“synchronizedä½œç”¨äºæŸä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒå°±ä¼šå°è¯•è·å–è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œå¦‚æœé”æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œåˆ™å½“å‰çº¿ç¨‹è·å–åˆ°é”ï¼Œå¹¶å¯ä»¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼›å¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹å°±ä¼šé˜»å¡åœ¨åŒæ­¥å—ä¹‹å¤–ï¼Œç›´åˆ°è·å–åˆ°é”æ‰èƒ½è¿›å…¥åŒæ­¥å—ã€‚</p><p>å½“ synchronized ä½œç”¨äºå®ä¾‹æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰å®ä¾‹å¯¹è±¡ï¼ˆå³ thisï¼‰ã€‚å½“synchronized ä½œç”¨äºé™æ€æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰ç±»çš„ Class å¯¹è±¡ã€‚å½“ synchronized ä½œç”¨äºæŸä¸ªç±»æ—¶ï¼Œæ­¤æ—¶å®ƒé”ä½çš„æ˜¯æ•´ä¸ªç±»ï¼Œè€Œä¸æ˜¯ç±»çš„æŸä¸ªå®ä¾‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºåªæœ‰ä¸€ä¸ªé”å­˜åœ¨ï¼Œæ‰€ä»¥æ‰€æœ‰ä½¿ç”¨è¯¥ç±»çš„çº¿ç¨‹éƒ½éœ€è¦ç­‰å¾…é”çš„é‡Šæ”¾ã€‚</p><p>synchronizedè¿˜æ”¯æŒå¯é‡å…¥æ€§ï¼Œå³åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­å¯ä»¥å¤šæ¬¡è·å–åŒä¸€ä¸ªé”ï¼Œè¿™æ ·å¯ä»¥é¿å…æ­»é”é—®é¢˜ã€‚Javaè™šæ‹Ÿæœºä¼šé€šè¿‡é”å‡çº§çš„æ–¹å¼æ¥æå‡synchronizedçš„æ•ˆç‡ï¼Œæ¯”å¦‚åå‘é”ã€è½»é‡çº§é”å’Œé‡é‡çº§é”ç­‰æœºåˆ¶ï¼Œä½¿å¾—åœ¨ç«äº‰ä¸æ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œsynchronizedçš„æ€§èƒ½å¯ä»¥è¾¾åˆ°ä¸éåŒæ­¥ä»£ç ç›¸å½“çš„æ°´å¹³ã€‚ </p><p>1.5â­ï¸ synchronizedé”ä¼˜åŒ–</p><p>è½»é‡çº§é”å’Œé‡é‡çº§é”çš„åŒºåˆ«æ˜¯è½»é‡çº§é”ä¼šä¸€ç›´å°è¯•è·å–é”ï¼Œè€Œé‡é‡çº§é”ä¸ä¼šå¹¶ä¸”ä¼šé˜»å¡</p><p>â€¢     åå‘é”ï¼šçº¿ç¨‹è·å–é”ååœ¨å¯¹è±¡å¤´è®°å½•çº¿ç¨‹æ ‡è¯†ï¼Œå†æ¬¡è¿›å…¥åŒæ­¥å—æ— éœ€é¢å¤–åŠ é”æ“ä½œï¼Œæé«˜æ€§èƒ½ã€‚é€‚ç”¨äºé”åŸºæœ¬æ— ç«äº‰åœºæ™¯ï¼Œå‡å°‘æ— ç«äº‰æ—¶åŠ è§£é”å¼€é”€ã€‚</p><p>â€¢     è½»é‡çº§é”ï¼šå¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€é”æ—¶ï¼ŒJVMé‡‡ç”¨è½»é‡çº§é”ï¼Œä»¥è‡ªæ—‹æ–¹å¼å°è¯•å¿«é€Ÿè·å–é”ï¼Œä¸æ”¾å¼ƒCPUæ‰§è¡Œæ—¶é—´ï¼Œé¿å…çº¿ç¨‹é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚é€‚ç”¨äºçŸ­æ—¶é—´å†…é”ç«äº‰ä¸æ¿€çƒˆåœºæ™¯ï¼Œè‡ªæ—‹ä¸€æ®µæ—¶é—´è‹¥æœªè·å–åˆ°é”ï¼Œä¼šå‡çº§ä¸ºé‡é‡çº§é”ã€‚</p><p>â€¢     é‡é‡çº§é”ï¼šçº¿ç¨‹å¯¹åŒä¸€é”å¼ºçƒˆç«äº‰æ—¶ï¼ŒJVMå°†é”å‡çº§ä¸ºé‡é‡çº§é”ï¼Œæ­¤æ—¶çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ç­‰å¾…é”é‡Šæ”¾ã€‚é€‚ç”¨äºç«äº‰æ¿€çƒˆåœºæ™¯ï¼Œä½†å› çº¿ç¨‹é˜»å¡å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰æ“ä½œï¼Œä¼šå¸¦æ¥è¾ƒå¤§æ€§èƒ½å¼€é”€ã€‚ </p><p>1.6 â­ï¸è®²è®²ä½ å¯¹ThreadLocalçš„ç†è§£</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image013.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image015.jpg" alt="img"></p><p>1.7 âœ…JDKå’ŒJREå’ŒJVM</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image017.jpg" alt="img"></p><p>1.8 âœ…ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image019.jpg" alt="img"></p><p>1.9 ä¸ºä»€ä¹ˆä¸å…¨éƒ¨ä½¿ç”¨ AOT å‘¢ï¼Ÿ</p><p>ä½¿ç”¨AOTå°±æ˜¯ç›´æ¥åœ¨è¿è¡Œå‰æŠŠå­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ç„¶åæ‰§è¡Œï¼Œä½†æ˜¯è¿™æ ·å°±ä¸èƒ½æ”¯æŒjavaçš„è¿è¡Œæ—¶åŠ¨æ€ç‰¹æ€§äº†ã€‚</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image021.jpg" alt="img"></p><p>1.10 â­ï¸ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ</p><p>ç­”ï¼šjavaæ˜¯ç¼–è¯‘å‹æ˜¯æŒ‡javaä»£ç è¦å…ˆç¼–è¯‘æˆ.Classå­—èŠ‚ç ï¼Œjvmæ‰èƒ½è¿è¡Œã€‚æ­¤å¤–ï¼Œåœ¨jvmé‡Œé¢ï¼Œçƒ­ç‚¹ä»£ç é€šè¿‡JITä¼šç›´æ¥ç¼–è¯‘æˆæœºå™¨ç ç„¶åæ‰§è¡Œã€‚</p><p>Javaæ˜¯è§£é‡Šå‹è¯­è¨€æ˜¯æŒ‡ï¼Œå­—èŠ‚ç åœ¨Jvmä¸­çš„æ‰§è¡Œæ˜¯é€šè¿‡è§£é‡Šå™¨ä¸€å¥ä¸€å¥è§£é‡Šæˆæœºå™¨ç ç„¶åæ‰èƒ½æ‰§è¡Œçš„ã€‚</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image023.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image025.jpg" alt="img"></p><p>1.11 åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„åŒºåˆ«ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image027.jpg" alt="img"></p><p>1.12 ä¸ºä»€ä¹ˆæµ®ç‚¹æ•°è¿ç®—çš„æ—¶å€™ä¼šæœ‰ç²¾åº¦ä¸¢å¤±çš„é£é™©ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image029.jpg" alt="img"></p><p>1.13 é¢å‘å¯¹è±¡ä¸‰ç‰¹å¾ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image031.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image033.jpg" alt="img"></p><p>1.14 â­ï¸å‘ä¸Šè½¬å‹ï¼Œå‘ä¸‹è½¬å‹</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image035.jpg" alt="img"></p><p>1.15 âœ…ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image037.jpg" alt="img"></p><p>1.16 intern æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p>å­—ç¬¦ä¸²å¸¸é‡æ± åœ¨å †é‡Œé¢ã€‚</p><p>è¿è¡Œæ—¶å¸¸é‡æ± åœ¨å…ƒç©ºé—´ï¼ˆæ–¹æ³•åŒºï¼‰é‡Œé¢</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image039.jpg" alt="img"></p><p>1.17 âœ…Javaå¼‚å¸¸ä½“ç³»</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image041.jpg" alt="img"></p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image043.jpg" alt="img"></p><p>1.18 â­ï¸æ³¨è§£çš„è§£ææ–¹æ³•æœ‰å“ªå‡ ç§ï¼Ÿ</p><p>Javaä¸­æ³¨è§£éœ€è¢«è§£ææ‰ç”Ÿæ•ˆï¼Œå¸¸è§è§£ææ–¹æ³•æœ‰ï¼š</p><p>â€¢     ç¼–è¯‘æœŸç›´æ¥æ‰«æï¼šç¼–è¯‘å™¨ç¼–è¯‘Javaä»£ç æ—¶æ‰«æå¹¶å¤„ç†å¯¹åº”æ³¨è§£ã€‚å¦‚@Overrideæ³¨è§£ï¼Œç¼–è¯‘å™¨ä¼šæ£€æµ‹æ–¹æ³•æ˜¯å¦é‡å†™çˆ¶ç±»å¯¹åº”æ–¹æ³•ï¼Œç”¨äºåœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œè¯­æ³•å’Œé€»è¾‘çš„æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç ç¬¦åˆé‡å†™è§„èŒƒã€‚</p><p>â€¢     è¿è¡ŒæœŸé€šè¿‡åå°„å¤„ç†ï¼šåƒSpringæ¡†æ¶çš„@Valueã€@Componentç­‰æ¡†æ¶è‡ªå¸¦æ³¨è§£ï¼Œåˆ©ç”¨åå°„æœºåˆ¶åœ¨è¿è¡Œæ—¶è·å–ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ä¿¡æ¯ï¼Œå¹¶æ ¹æ®æ³¨è§£å®šä¹‰çš„è§„åˆ™è¿›è¡Œç›¸åº”å¤„ç†ï¼Œå¦‚ä¾èµ–æ³¨å…¥ã€ç»„ä»¶æ³¨å†Œç­‰æ“ä½œï¼Œå¢å¼ºäº†æ¡†æ¶çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚ </p><p>2.Javaé›†åˆ</p><p>2.1 ArrayListæ€ä¹ˆåšçš„æ•°ç»„æ‰©å®¹</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image045.jpg" alt="img"></p><p>2.2 ä»€ä¹ˆæ˜¯ fail-fastï¼Œ ä»€ä¹ˆæ˜¯ fail-safe</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image047.jpg" alt="img"></p><p>2.3 å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image049.jpg" alt="img"></p><p>2.4 â­ï¸HashSetå®ç°åŸç†</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image051.jpg" alt="img"></p><p>2.5 HashMapå·¥ä½œåŸç†</p><p>HashMapåŸºäºå“ˆå¸Œè¡¨å·¥ä½œï¼Œå“ˆå¸Œè¡¨åˆ©ç”¨å“ˆå¸Œå‡½æ•°å°†é”®æ˜ å°„åˆ°å­˜å‚¨ä½ç½®ï¼š</p><p>â€¢     å“ˆå¸Œæ˜ å°„ï¼šè®¡ç®—é”®çš„å“ˆå¸Œå€¼å¹¶è½¬åŒ–ä¸ºæ•°ç»„ç´¢å¼•ï¼Œä»¥æ­¤å¿«é€Ÿå®šä½é”®å€¼å¯¹å­˜å‚¨ä½ç½®ã€‚ç†æƒ³çŠ¶æ€ä¸‹ï¼Œå“ˆå¸Œå‡½æ•°è®©é”®å‡åŒ€åˆ†å¸ƒï¼Œå‡å°‘å“ˆå¸Œå†²çªã€‚</p><p>â€¢     è§£å†³å“ˆå¸Œå†²çªï¼š</p><p>ï¿®    Java 1.7ï¼šä¸»è¦ç”¨é“¾è¡¨è§£å†³ï¼Œç›¸åŒå“ˆå¸Œå€¼çš„é”®å€¼å¯¹é“¾æ¥åœ¨ä¸€èµ·ã€‚</p><p>ï¿®    Java 1.8ï¼šå½“é“¾è¡¨é•¿åº¦å’Œæ•°ç»„é•¿åº¦è¶…ä¸€å®šé˜ˆå€¼ï¼Œé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚çº¢é»‘æ ‘æ˜¯è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œåœ¨å“ˆå¸Œå†²çªè¾ƒå¤šæ—¶ï¼ŒæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œæ›´å¿«ã€‚</p><p>HashMapç»¼åˆå“ˆå¸Œè¡¨ã€é“¾è¡¨å’Œçº¢é»‘æ ‘åŸç†ï¼Œå®ç°é«˜æ•ˆçš„é”®å€¼å¯¹å­˜å‚¨ä¸æŸ¥æ‰¾åŠŸèƒ½ã€‚ </p><p>2.6 â­ï¸HashMap çš„PUTå·¥ä½œæµç¨‹ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image053.jpg" alt="img"></p><p>2.7 æ¯”è¾ƒ HashSetã€ LinkedHashSet å’Œ TreeSet ä¸‰è€…çš„å¼‚åŒ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image055.jpg" alt="img"></p><p>2.8 â­ï¸Queue ä¸ Deque çš„åŒºåˆ«</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image057.jpg" alt="img"></p><p>2.9 åœ¨ Queue ä¸­ poll()å’Œ removeï¼ˆï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image059.jpg" alt="img"></p><p>2.10 â­ï¸ArrayDeque ä¸ LinkedList çš„åŒºåˆ«</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image061.jpg" alt="img"></p><p>ArrayDequeï¼š ArrayDeque å†…éƒ¨ç»´æŠ¤äº†ä¸€ ä¸ªå¾ªç¯æ•°ç»„ï¼Œé€šè¿‡ä¸¤ä¸ªæŒ‡é’ˆ ï¼ˆfront å’Œ rearï¼‰æ¥æ ‡è®°é˜Ÿåˆ—çš„å¤´éƒ¨ å’Œå°¾éƒ¨ã€‚å½“å‘é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´  æ—¶ï¼Œrear æŒ‡é’ˆå‘åç§»åŠ¨ï¼›å½“ä»é˜Ÿ åˆ—ä¸­åˆ é™¤å…ƒç´ æ—¶ï¼Œfront æŒ‡é’ˆå‘ åç§»åŠ¨ã€‚å¦‚æœæ•°ç»„æ»¡äº†ï¼Œ ArrayDeque ä¼šè‡ªåŠ¨æ‰©å®¹ã€‚ ArrayDeque çš„åº•å±‚æ•°ç»„é•¿åº¦æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Œè¿™æ ·å¯ä»¥é€š ä½è¿ç®—æ¥å®ç°å¾ªç¯é˜Ÿåˆ—çš„æ“ä½œï¼Œ æé«˜æ€§èƒ½ã€‚</p><p>LinkedListï¼š LinkedList å†…éƒ¨ä½¿ç”¨åŒå‘é“¾ è¡¨æ¥å­˜å‚¨å…ƒç´ ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å« ä¸€ä¸ªå‰é©±èŠ‚ç‚¹å’Œä¸€ä¸ªåç»§èŠ‚ç‚¹çš„ å¼•ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ LinkedList å¯ä»¥åœ¨ä»»æ„ä½ç½®é«˜æ•ˆ åœ°æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ LinkedList è¿˜æœ‰ä¸€ä¸ªå¤´ç»“ç‚¹ å’Œå°¾èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œåˆ†åˆ«è¡¨ç¤ºé“¾è¡¨ çš„å¤´éƒ¨å’Œå°¾éƒ¨ã€‚é€šè¿‡è¿™ä¸¤ä¸ªå¼•ç”¨ï¼Œå¯ä»¥å¿«é€Ÿè®¿é—®åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ ã€‚</p><p>2.11 â­ï¸HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯2çš„å¹‚æ¬¡æ–¹</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image063.jpg" alt="img"></p><p>2.12 â­ï¸HashMap å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image065.jpg" alt="img"></p><p>2.13 â­ï¸LinkedHashMapæ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆä¹°ç°çš„ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image067.jpg" alt="img"></p><p>2.14 â­ï¸ä¸ºä»€ä¹ˆ ConcurrentHashMap æ¯” HashTable æ•ˆç‡è¦é«˜ï¼Ÿ</p><p><img src="2025-01-01-JavaåŸºç¡€/clip_image069.jpg" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„JavaåŸºç¡€é¢è¯•æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="JavaåŸºç¡€é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/tags/Java%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisé¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025331p.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025331p.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><h2 id="1-ä»€ä¹ˆæ˜¯MyBatis"><a href="#1-ä»€ä¹ˆæ˜¯MyBatis" class="headerlink" title="1. ä»€ä¹ˆæ˜¯MyBatis?"></a>1. ä»€ä¹ˆæ˜¯MyBatis?</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NWU3OGM0OWExNWVlYzY5MGJkNmNlZGU2NDZjN2YwODNfNXRjcUNzNWdDbEJBUDJINjhJejlxMEtEd1oyR3JHUmNfVG9rZW46Q1NmRGI0djBxb3BpVVd4cXROOGNuWXZ5blJiXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="2-Mybaits-çš„ä¼˜ç‚¹-amp-ç¼ºç‚¹"><a href="#2-Mybaits-çš„ä¼˜ç‚¹-amp-ç¼ºç‚¹" class="headerlink" title="2. Mybaits çš„ä¼˜ç‚¹ &amp; ç¼ºç‚¹"></a>2. Mybaits çš„ä¼˜ç‚¹ &amp; ç¼ºç‚¹</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MzFlM2EzNDkzOWZiZjUxYmE4NWFkOTA2MzRjMjY3NDFfdEJMZm01TmFpZFY1b2xYUERoZmhsbWtKeW1uWWkweWFfVG9rZW46Q01wY2JnZnVab205b1N4THNvWGMyanB1bmZlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="3-MyBatisçš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ"><a href="#3-MyBatisçš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="3. MyBatisçš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ"></a>3. MyBatisçš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ODAyNjFhYTJiYjllODY2YjYxNWE4Yjk0ODZiNGU1N2FfbUVvUXkzNnlhbnc2VXlkMWloWVJ6ZHBvVlFvYWRXRWRfVG9rZW46QVRpTWJncGdUbzVKN2J4OThCSWNlMlM3bjJlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="4-â­ï¸MyBatisçš„å·¥ä½œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#4-â­ï¸MyBatisçš„å·¥ä½œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="4. â­ï¸MyBatisçš„å·¥ä½œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"></a>4. â­ï¸MyBatisçš„å·¥ä½œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NjM5ODc0MjhiYmQ1YTc4OTU1YWE4YzkzNGVkMzBmYjJfbW4zYlJ3S1N5WnFqdGFja3dHa3F3dHNMem96Q2U0U0dfVG9rZW46SDBWWmI5TDRGbzVTOTB4VlVPZmNweWxkbjZkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="5-â­ï¸MyBatisä¸€äºŒçº§ç¼“å­˜çš„åŒºåˆ«ï¼Ÿ"><a href="#5-â­ï¸MyBatisä¸€äºŒçº§ç¼“å­˜çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="5. â­ï¸MyBatisä¸€äºŒçº§ç¼“å­˜çš„åŒºåˆ«ï¼Ÿ"></a>5. â­ï¸MyBatisä¸€äºŒçº§ç¼“å­˜çš„åŒºåˆ«ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OTEyZjBjN2MyYjE2OGRhNGQ2ZDY5NDg2ZTZmNTRhYWFfazJieW5sazBkN1I5T2IwbGZ1V2xLeHR3dHN3VHF3NTRfVG9rZW46TkZTb2JaeWNOb1JuN1p4NFBUQWNWalRQbjFkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="6-MyBatiså¦‚ä½•å¤„ç†å»¶è¿ŸåŠ è½½ï¼Ÿ"><a href="#6-MyBatiså¦‚ä½•å¤„ç†å»¶è¿ŸåŠ è½½ï¼Ÿ" class="headerlink" title="6.MyBatiså¦‚ä½•å¤„ç†å»¶è¿ŸåŠ è½½ï¼Ÿ"></a>6.MyBatiså¦‚ä½•å¤„ç†å»¶è¿ŸåŠ è½½ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NTk4ZGZkYWE4YTdlYjdhZjhkNDFiZmEyN2ViNjgxMTNfdTZ3bWEzZWY2N2ZtZEI2RG8yWWdzdk5Jekl1OXRVWHZfVG9rZW46RzQ2QmJJWFUwb1Q4emx4WHJmSmM2N2hTbmllXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="7-â­ï¸MyBatisä¸­çš„åŠ¨æ€SQLæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#7-â­ï¸MyBatisä¸­çš„åŠ¨æ€SQLæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="7. â­ï¸MyBatisä¸­çš„åŠ¨æ€SQLæ˜¯ä»€ä¹ˆï¼Ÿ"></a>7. â­ï¸MyBatisä¸­çš„åŠ¨æ€SQLæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=N2Y1NGUzY2I5ZTYxZDMwNTEzMTdkOTQ3MmY1MjJhMzJfc2E1QmlhY004SkNpRjZrdHE3MU5QcFFGSkZvZkpKcnhfVG9rZW46QVdDUGIxamR4b0xkNjN4NEJiRmNDaUZTblliXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NjUwODViOWZjYWEzNjRlZmUzMTY1YzVhMmE5MDhiNjdfanpSM3N0VWZqaGpzQWZMU1hnSmZQdTNFUnYzVGFQTXhfVG9rZW46S2dzN2JZQ3ZIb0hCQUV4VDdiUGNBdUpKblRkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="8-â­ï¸MyBatisä¸­XMLæ˜ å°„æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ"><a href="#8-â­ï¸MyBatisä¸­XMLæ˜ å°„æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ" class="headerlink" title="8. â­ï¸MyBatisä¸­XMLæ˜ å°„æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ"></a>8. â­ï¸MyBatisä¸­XMLæ˜ å°„æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=Njk0ZTQzYWVlZDk4MTM5MGQwMWY2MmZmMmRiMjdiNTdfOUdQTFZQYTV1ZWliMHRpVVJ6emJwRlRnWndDOE5YZXZfVG9rZW46QlZWV2JTWFNLbzY0elB4OTlUbmNJZkF0bkdoXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="9-æ¨¡ç³ŠæŸ¥è¯¢-like-è¯­å¥è¯¥æ€ä¹ˆå†™ï¼Ÿ"><a href="#9-æ¨¡ç³ŠæŸ¥è¯¢-like-è¯­å¥è¯¥æ€ä¹ˆå†™ï¼Ÿ" class="headerlink" title="9. æ¨¡ç³ŠæŸ¥è¯¢ like è¯­å¥è¯¥æ€ä¹ˆå†™ï¼Ÿ"></a>9. æ¨¡ç³ŠæŸ¥è¯¢ like è¯­å¥è¯¥æ€ä¹ˆå†™ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=YjM1ODcxZGY3YjEyMmYyMWQyZjNjOGM2ODgxM2Y2ZjdfVzA0SWQxeXpIbVBvMXZWbHFtdHp4NlVFaG5oM01pYkpfVG9rZW46SElUb2J3NkV4bzVFSFJ4NkFFTGNRdWlXbk9iXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="10-â­ï¸-å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#10-â­ï¸-å’Œ-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="10. â­ï¸#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>10. â­ï¸#{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=M2I2MmNlZmJmZTdjMmVkMTlmZmI2ZGU1N2NkNjc5ZGZfdWY5WnI3UmI0dXlrdmZtVkJXdzFRWmE2N1BIS05jakJfVG9rZW46UThwbGJMUXBwb3c3UWd4SlZubGNwak1ablNnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ODU3ZDNjNzAxZmUyYzBmM2U1MzcxMjdiMTE0YmZkNjhfcTFUcnlDQWdybWgyNXpoYVN1VXA1TmdHWEhwSlhSN2JfVG9rZW46THZVcmI4c3ppb2RyZVV4aXNYNGNwdkdlbmlnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="11-è®²è®²MyBatisä¸­äºŒçº§ç¼“å­˜çš„ç¼ºç‚¹ï¼Ÿ"><a href="#11-è®²è®²MyBatisä¸­äºŒçº§ç¼“å­˜çš„ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="11. è®²è®²MyBatisä¸­äºŒçº§ç¼“å­˜çš„ç¼ºç‚¹ï¼Ÿ"></a>11. è®²è®²MyBatisä¸­äºŒçº§ç¼“å­˜çš„ç¼ºç‚¹ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OGFiYjFhMTU0NzQ5MmZjYzlmZGFiYmMwZGJkMTBjZWFfbzVwWjFDaWlPYzdnNHJ4U05NWnlKc1JlMm1CN2VzRzVfVG9rZW46VEJWZmJKQ1pHbzRBTzJ4ZkNaVWN0bWw5bnRlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="12-ä¸ºä»€ä¹ˆè¯´-Mybatis-æ˜¯åŠORM-æ˜ å°„å·¥å…·ï¼Ÿ"><a href="#12-ä¸ºä»€ä¹ˆè¯´-Mybatis-æ˜¯åŠORM-æ˜ å°„å·¥å…·ï¼Ÿ" class="headerlink" title="12. ä¸ºä»€ä¹ˆè¯´ Mybatis æ˜¯åŠORM æ˜ å°„å·¥å…·ï¼Ÿ"></a>12. ä¸ºä»€ä¹ˆè¯´ Mybatis æ˜¯åŠORM æ˜ å°„å·¥å…·ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=Yjc0YWMzM2MzZjA3ODE0MTU3ODY2YzY1ZjQzMGRiMTBfV2I0NkJpN1g2ZTRhWXNhNnJDZjlEOHhIYXZzMGtkYTBfVG9rZW46UENyOGJlUTBvb2cwNkN4WWNCVWNLUEVKbmxiXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="13-â­ï¸å¦‚ä½•åœ¨-MyBatis-ä¸­è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Ÿ"><a href="#13-â­ï¸å¦‚ä½•åœ¨-MyBatis-ä¸­è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Ÿ" class="headerlink" title="13. â­ï¸å¦‚ä½•åœ¨ MyBatis ä¸­è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Ÿ"></a>13. â­ï¸å¦‚ä½•åœ¨ MyBatis ä¸­è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NjFlYzc3Zjc0MzJjODFkYWNjYjRmYTg1ZjIzZGQxZTFfakZCc0ZrNWdUR0Y0SlROMnJKZHJiZzZWdkRHMjFYUVlfVG9rZW46QWpGOGIyeGVmb3V0WlV4Nkxib2NHVTA5bmxlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=YTJjZGQwZjc1M2U3YmYyN2ZkOWI3OTc2MjgxYWNjOTNfZXZNcm1GR0I3WllWRVJweDJjVVBJbWN0cG5LREk0YTFfVG9rZW46TGxyOGJvVmozb2F6STh4MWtIS2NhRlhYbmdoXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="14-Mybatiså’ŒHibernateçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#14-Mybatiså’ŒHibernateçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="14. Mybatiså’ŒHibernateçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>14. Mybatiså’ŒHibernateçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmM0N2E5YjUxZGQ0YzI3MTM4YzFiNWY0MmVmYzgzYjJfcVBXSlhhSmFCMXhKTjRQUlV6UzNmb3FnbDVIMWpNNXZfVG9rZW46RjVRNGJJY0xyb0Z6cEN4aEpGR2NNeW85bkJjXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="15-JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ"><a href="#15-JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ" class="headerlink" title="15. JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ"></a>15. JDBCç¼–ç¨‹æœ‰å“ªäº›ä¸è¶³ä¹‹å¤„ï¼ŒMyBatisæ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjE1MTExMzkzODVjYzdhMTk5MGI0Mjc2MWNlMDMyZGNfNzlJV2NCd1dZUURwYW9ZU0ZobWxBcGlYb3BjeThieDFfVG9rZW46VzNrMmJXMlB2b3NrMzl4ZUk0OWNkUW1hbkFkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="16-MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#16-MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="16. MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>16. MyBatisç¼–ç¨‹æ­¥éª¤æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTNjNTVkMTdiMTljZTg4MGNiZTc4M2ZjMTIxZWZlYzVfOHVubEdxQnVMczYwbnVhNk9weEU4YXdoaWtEZVRKV2FfVG9rZW46TXA1bmJSbDZ3b0pCN3p4RTNoQ2M5b2JXbnFmXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="17-Mybatiså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ï¼Ÿ"><a href="#17-Mybatiså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ï¼Ÿ" class="headerlink" title="17. Mybatiså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ï¼Ÿ"></a>17. Mybatiså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=N2M0YjlkODM0MWNhYTNiZDMzNzg4ZmUwMTE0NzI3ZWZfbUJXMWtUZkh0elRTNmdNenVNbEU2OURObVNXbjM1OE9fVG9rZW46SlcyOWJSNjVlb0hDZHR4dW14VGM3UGhObk5nXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="â­ï¸18-Xml-æ˜ å°„æ–‡ä»¶ä¸­ï¼Œé™¤äº†å¸¸è§çš„-selectï¼Œinsertï¼Œupcaeldelete-æ ‡ç­¾ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ"><a href="#â­ï¸18-Xml-æ˜ å°„æ–‡ä»¶ä¸­ï¼Œé™¤äº†å¸¸è§çš„-selectï¼Œinsertï¼Œupcaeldelete-æ ‡ç­¾ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ" class="headerlink" title="â­ï¸18.Xml æ˜ å°„æ–‡ä»¶ä¸­ï¼Œé™¤äº†å¸¸è§çš„ selectï¼Œinsertï¼Œupcaeldelete æ ‡ç­¾ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ"></a>â­ï¸18.Xml æ˜ å°„æ–‡ä»¶ä¸­ï¼Œé™¤äº†å¸¸è§çš„ selectï¼Œinsertï¼Œupcaeldelete æ ‡ç­¾ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ ‡ç­¾ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MDk5MTM5NzUwYzUyMDYwNTk0ODVjOWRmOWZmM2RlMDhfZ0gxRUJocG9EUjhtbkx0N0g2OGg5RmFSQ2dOU2E1dUxfVG9rZW46RFEwa2JZTmpBbzRjRzJ4bUx1UmN4Z2xFblBnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=Yjk0ZGRiMjQxNzc4MDVmMDQ4NmQ2YThiNTZhMWZjMzRfaUxMaUlmUHFxSjE0RXdJb1VCYzRNaWFON2NEVURQNm9fVG9rZW46VW8ybWJkWDJ2b2JnblZ4MEw5c2NxN0lJblBlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDg5YTUwZmI1ZmZiZjliN2RhMmQ5MGE0MzcyNjNjOWVfYndDWlJaa2JmNG1Kb3pWQU8yWVA5RXlUZ3N5Q2dCeWlfVG9rZW46Vm4zZGJpeHE1b20wd214TVpBY2NPcFU3bkhmXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OWQzMmQyNzczNzgwNTA3YmFmODlhYWY4MjQ4NzM0NDRfc2lBaWg5OFUwTE0zdnUyaXFDbmFxdHJSZHdlTVBYTnBfVG9rZW46RVVEeGI3QU93bzZ1ZG94N29PS2NzZVZRbjlnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="19-Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#19-Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="19. Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>19. Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MWRhODk3MTMzZjZlNjEyN2I4OGI1MWMxM2ExN2QzNGZfMVdGOXZQdFJUVnVFVnJlaUpxVGR5aTN5MU1lNGx5d1VfVG9rZW46QU96MWJYd3Rvb0xGelJ4MndMdmNFQzEwbnVnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=YWFjZjQzYzZiY2MwZWY0Mjk3YjQxMDJmMDUwZGVhMmJfRDBFdHFNVElkbTNGQUZXUHAwUDdjNlloOWxjeTVQUTFfVG9rZW46STdoWGJ1NzRqb2ZCa0F4WlJ0ZGNFRDFibkhTXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="20-â­ï¸MyBatis-å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#20-â­ï¸MyBatis-å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="20. â­ï¸MyBatis å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>20. â­ï¸MyBatis å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OTc4MzE0ZjAyZGU0ZTUwODg0OWVlOTc2N2Q1YTQxNGNfdDRnY1RZdkZ0MldsMUgzQThWVTBmMFpkNGZQZGQxYWZfVG9rZW46UUtTRmJEbHEzb1BBSkp4ZGNGSGNrbndybktnXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MTZhOWY1YzJlMzBhYjJlZjg1OWI2MjVkMjNkMDBkM2ZfbXpoMmYwdXZTV3BSWXd6ZTBWV1pDUGNSMmVaczBPQVhfVG9rZW46Q2tKd2JwVmg2b1Y1MUV4R0lPM2NGQTdXblAyXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="21-â­ï¸Mybatis-èƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ"><a href="#21-â­ï¸Mybatis-èƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ" class="headerlink" title="21. â­ï¸Mybatis èƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ"></a>21. â­ï¸Mybatis èƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NmQ1NjI3ZDgzMDgwMzRjZDY2YmM4NjcwZWM5ZjQ3MDFfQkFQQlQ5bTEwdk95VVFPb053cDNhbXBqcmJyZENFRjVfVG9rZW46Q3J2cmI4cU9Ub2ZMa0x4cFZZdWNzWVBBbjVjXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NWQ0NzU3YWQwODVhNjc5MDhiOTNjOGQxZjg3OGM3MmRfd04zUE5HVXJ4Q01ZOGlSektjUEdkZUZpWXRXSnl1VE5fVG9rZW46TEM1YmJqRnJJb01YVVZ4Y0ZyQ2Naajh0bkRkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="22-â­ï¸-Mybatis-æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ"><a href="#22-â­ï¸-Mybatis-æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ" class="headerlink" title="22.â­ï¸ Mybatis æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ"></a>22.â­ï¸ Mybatis æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OTdmNTRiMDY0M2Q3Mjc2NjM2ZjI1OTI0Y2E3OGFiYzlfN2Q2NGw5R3l0Rk9VRWRjRVU1c0c5bnR4TjBxY3pRTWpfVG9rZW46VG1INWJrVFU1b3BJRUJ4OU1lYmNNQmFwbkJhXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="23-â­ï¸ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"><a href="#23-â­ï¸ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ" class="headerlink" title="23. â­ï¸ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ"></a>23. â­ï¸ä»€ä¹ˆæ˜¯MyBatisçš„æ¥å£ç»‘å®šï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OWZmNzdkZjU4NjIzYzQ4MGJiNGJhZjRjYjdhYjNiMDNfOExrZm5ueWZMVVJvYnlNSTh4eG5xbng2S0RKODZuT0RfVG9rZW46TENjUGJWeWM2b3g1VVh4U1ZYYmNVelJxbkdjXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="24-â­ï¸Mybatisæ˜¯å¦‚ä½•å°†sqlæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ"><a href="#24-â­ï¸Mybatisæ˜¯å¦‚ä½•å°†sqlæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ" class="headerlink" title="24. â­ï¸Mybatisæ˜¯å¦‚ä½•å°†sqlæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ"></a>24. â­ï¸Mybatisæ˜¯å¦‚ä½•å°†sqlæ‰§è¡Œç»“æœå°è£…ä¸ºç›®æ ‡å¯¹è±¡å¹¶è¿”å›çš„ï¼Ÿéƒ½æœ‰å“ªäº›æ˜ å°„å½¢å¼ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=OTY5ZjA2MmUxMGM2MjYwYjg1ODRhMjEyOTVlMzA4Y2NfU2N0ZW1VdURUMjlNTXBrZ3Q0ajRnZEpKdkM2MXFWMlZfVG9rZW46RDVxcGJuNXZGb1huYU94TEtuTWNJYnlUbmhoXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="25-â­ï¸-Mybatisçš„Xmlæ˜ å°„æ–‡ä»¶ä¸­ï¼Œä¸åŒçš„Xmlæ˜ å°„æ–‡ä»¶ï¼Œidæ˜¯å¦å¯ä»¥é‡å¤ï¼Ÿ"><a href="#25-â­ï¸-Mybatisçš„Xmlæ˜ å°„æ–‡ä»¶ä¸­ï¼Œä¸åŒçš„Xmlæ˜ å°„æ–‡ä»¶ï¼Œidæ˜¯å¦å¯ä»¥é‡å¤ï¼Ÿ" class="headerlink" title="25.â­ï¸ Mybatisçš„Xmlæ˜ å°„æ–‡ä»¶ä¸­ï¼Œä¸åŒçš„Xmlæ˜ å°„æ–‡ä»¶ï¼Œidæ˜¯å¦å¯ä»¥é‡å¤ï¼Ÿ"></a>25.â­ï¸ Mybatisçš„Xmlæ˜ å°„æ–‡ä»¶ä¸­ï¼Œä¸åŒçš„Xmlæ˜ å°„æ–‡ä»¶ï¼Œidæ˜¯å¦å¯ä»¥é‡å¤ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=YzkwNjllNWE2ODE5MzIyMzU5NGMxNDgzOGU1NGI3YjRfR2dIdnoyUlZJTE9OVHJzc2IzeXlqOWdBT29SRkVPR05fVG9rZW46TTJoc2JJeEYxbzdDd0J4TEF2OWM0RTUzbkFiXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="26-â­ï¸MyBatis-å¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ"><a href="#26-â­ï¸MyBatis-å¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ" class="headerlink" title="26. â­ï¸MyBatis å¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ"></a>26. â­ï¸MyBatis å¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NTE0MTEyMGRmNmU3M2JiMDM1NTk2MmEwYzFhN2YzMGZfYlBMdVlyZkg4VnczMUpOVTNrbFlWdXlXYTk5TWVTcnpfVG9rZW46QjlMZGJWeDNZb2doMFl4Tk9RS2NLMDB5bklkXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MzY2YWM1NjM0ODQ3YTkyYTgxYmM0MmY2ZmY4ZjdiNGJfd291dU9GN1RySjBpc2lwcGVkVnlCUzkwN0gzbno5ZURfVG9rZW46WHNtaGJDTjRCb1RkeU14QUpDeGNJTDRsbk5jXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmYyMzIzMzU4M2ZkMzc0MTIzMTY2Yjk5Njg0ZWM2MTlfTlFocTM3amNkU2x2bVR0d0dBU0U5YTdwZjVvWW9nRG5fVG9rZW46SHhNcGIxUlhMb2dEa094aGszVWNnaDh3bmFmXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MGQ5YWZlODVmNTgzZWQyNWVjMzliZDVkMmQwYzFhMTdfR2xGVWZXM1pMUnpMSXBxS1VXaDZHRDdKaGR1b3JiY29fVG9rZW46QW5TTGJKa1JOb2I4T0N4amZ0NGNoeWR5bkdlXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="27-â­ï¸åœ¨mapper-ä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ"><a href="#27-â­ï¸åœ¨mapper-ä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ" class="headerlink" title="27. â­ï¸åœ¨mapper ä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ"></a>27. â­ï¸åœ¨mapper ä¸­å¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=YTFkOTA0ZTc5ZTNiOTkwZTgxZjA4MjMzMzI0MzBiYjhfYUp2V0syblJjWjNiTWFSbElkUVJJTlpHbk9rNXdhOXBfVG9rZW46RVlUTmJQSlpFb2NjWWh4emNNM2NFNE5LbnBoXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=M2M4MDcwNjY4ZGMxYTA5ZGQyMTgxMTllMzZiY2ZjNjhfQ3NUcG5OYXZ5V1RyMXpEVnRPdVNJZzhWR1kzN0V1MUlfVG9rZW46VDlRc2JrRGF2b1NxQTF4UWdtOGNuSWZvbm5tXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MzcwYzJjODg2ZTZiZjljY2YxNWUxMDkyOThhNDlmZWRfNEQ2eVpqSnBHYkZHdXZsMWJwZ3lQWU5kSURzd3BZaGdfVG9rZW46Skk4NmI4Z2tab2xQZXR4NlFSZmM0MzYzbnhoXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="28-â­ï¸ç®€è¿°Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"><a href="#28-â­ï¸ç®€è¿°Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ" class="headerlink" title="28. â­ï¸ç®€è¿°Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ"></a>28. â­ï¸ç®€è¿°Mybatisçš„æ’ä»¶è¿è¡ŒåŸç†ï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=MDJjYmFlNjE1NzdiNTg2ZWYxZWY4NzBkZWIxY2I0NzdfQ3lJVFdzZXdmdjFRRjhaalo1UDFKZ1ViR085dmxKbXRfVG9rZW46RVN2UWJrTVdyb2xCdGt4Rnl0OWNhZTRrbkplXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p><h2 id="29-â­ï¸åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#29-â­ï¸åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="29. â­ï¸åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>29. â­ï¸åˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWQxMjJlZDAzZjA3OWY1NGU0NGE1NWQ4M2E4MzMwMGVfeE94Z2NSbmY0MzNFTjZZUFlUQmk1ZTJnV0xBQXhIcURfVG9rZW46UGYwZ2JCOEFFb2NJeTR4M3I1RmM4WW9IbmdMXzE3NDMzODkxNTM6MTc0MzM5Mjc1M19WNA" alt="img"></p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„MyBatisé¢è¯•é¢˜æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="MyBatis" scheme="https://outoflovenicoo.github.io/tags/MyBatis/"/>
    
  </entry>
  
  <entry>
    <title>Rabbitmqé¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025331m.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025331m.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PS"><a href="#PS" class="headerlink" title="PS:"></a>PS:</h1><p><strong>é¢è¯•é¢˜æ€»ç»“è‡ªå°æ—Codingï¼Œä»…ä¾›ä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼Œå¦‚æœ‰ä¾µæƒå¯è”ç³»åˆ é™¤</strong></p><h1 id="æ¦‚å¿µï¼š"><a href="#æ¦‚å¿µï¼š" class="headerlink" title="æ¦‚å¿µï¼š"></a>æ¦‚å¿µï¼š</h1><h2 id="1-AMQPåè®®ï¼Ÿ"><a href="#1-AMQPåè®®ï¼Ÿ" class="headerlink" title="1. AMQPåè®®ï¼Ÿ"></a>1. AMQPåè®®ï¼Ÿ</h2><p>AMQPï¼Œå³Advanced Message Queuing Protocolï¼Œé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„å¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚æ¶ˆæ¯ä¸­é—´ä»¶ç”¨äºç»„ä»¶è§£è€¦ï¼Œå‘é€è€…å’Œä½¿ç”¨è€…ç›¸äº’æ— æ„ŸçŸ¥ã€‚å…¶ä¸»è¦ç‰¹å¾åŒ…æ‹¬é¢å‘æ¶ˆæ¯ã€é˜Ÿåˆ—ã€è·¯ç”±ã€å¯é æ€§ã€å®‰å…¨æ€§ã€‚RabbitMQæ˜¯å¼€æºçš„AMQPå®ç°ï¼ŒæœåŠ¡å™¨ç«¯ç”¨Erlangç¼–å†™ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯ï¼Œç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿå­˜å‚¨è½¬å‘æ¶ˆæ¯ï¼Œåœ¨æ˜“ç”¨æ€§ç­‰æ–¹é¢è¡¨ç°å¥½ã€‚</p><p><strong>AMQP**</strong>ä¸‰å±‚åè®®**</p><ul><li><strong>Module Layer</strong>ï¼šæœ€é«˜å±‚ï¼Œå®šä¹‰å®¢æˆ·ç«¯è°ƒç”¨å‘½ä»¤ï¼Œç”¨äºå®ç°ä¸šåŠ¡é€»è¾‘ã€‚</li><li><strong>Session Layer</strong>ï¼šä¸­é—´å±‚ï¼Œè´Ÿè´£å®¢æˆ·ç«¯å‘½ä»¤ä¸æœåŠ¡å™¨åº”ç­”ä¼ è¾“ï¼Œæä¾›å¯é æ€§åŒæ­¥å’Œé”™è¯¯å¤„ç†ã€‚</li><li><strong>Transport Layer</strong>ï¼šæœ€åº•å±‚ï¼Œä¼ è¾“äºŒè¿›åˆ¶æ•°æ®æµï¼Œæä¾›å¸§å¤„ç†ç­‰åŠŸèƒ½ã€‚</li></ul><p><strong>AMQP**</strong>ç»„ä»¶**</p><ul><li><strong>äº¤æ¢å™¨**</strong>(Exchange)**ï¼šå°†æ¶ˆæ¯è·¯ç”±åˆ°é˜Ÿåˆ—çš„ç»„ä»¶ã€‚</li><li><strong>é˜Ÿåˆ— (queue)</strong>ï¼šå­˜å‚¨æ¶ˆæ¯çš„æ•°æ®ç»“æ„ï¼Œä½äºç¡¬ç›˜æˆ–å†…å­˜ã€‚</li><li><strong>ç»‘å®š (Binding)</strong>ï¼šå‘ŠçŸ¥äº¤æ¢å™¨æ¶ˆæ¯æŠ•é€’é˜Ÿåˆ—çš„è§„åˆ™ã€‚</li></ul><h2 id="2-RabbitMQåŒ…å«å“ªäº›è¦ç´ ï¼Ÿ"><a href="#2-RabbitMQåŒ…å«å“ªäº›è¦ç´ ï¼Ÿ" class="headerlink" title="2. RabbitMQåŒ…å«å“ªäº›è¦ç´ ï¼Ÿ"></a>2. RabbitMQåŒ…å«å“ªäº›è¦ç´ ï¼Ÿ</h2><ul><li>ç”Ÿäº§è€…ï¼šæ¶ˆæ¯é˜Ÿåˆ—åˆ›å»ºè€…ï¼Œå‘é€æ¶ˆæ¯åˆ° MQã€‚</li><li>æ¶ˆè´¹è€…ï¼šè¿æ¥åˆ° RabbitMQï¼Œè®¢é˜…åˆ°é˜Ÿåˆ—ä¸Šï¼Œæ¶ˆè´¹æ¶ˆæ¯ï¼Œæ”¯æŒæŒç»­è®¢é˜…å’Œå•æ¡è®¢é˜…ã€‚</li><li>æ¶ˆæ¯ï¼šåŒ…å«æœ‰æ•ˆè½½è·å’Œæ ‡ç­¾ï¼Œæœ‰æ•ˆè½½è·æŒ‡è¦ä¼ è¾“çš„æ•°æ®ï¼Œæ ‡ç­¾æè¿°æœ‰æ•ˆè½½è·ï¼ŒRabbitMQ ç”¨å®ƒå†³å®šè°è·å¾—æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…åªèƒ½æ‹¿åˆ°æœ‰æ•ˆè½½è·ï¼Œä¸çŸ¥é“ç”Ÿäº§è€…æ˜¯è°ã€‚</li></ul><h2 id="3-RabbitMQä¸­æ¶ˆæ¯å¯èƒ½æœ‰çš„å‡ ç§çŠ¶æ€ï¼Ÿ"><a href="#3-RabbitMQä¸­æ¶ˆæ¯å¯èƒ½æœ‰çš„å‡ ç§çŠ¶æ€ï¼Ÿ" class="headerlink" title="3. RabbitMQä¸­æ¶ˆæ¯å¯èƒ½æœ‰çš„å‡ ç§çŠ¶æ€ï¼Ÿ"></a>3. RabbitMQä¸­æ¶ˆæ¯å¯èƒ½æœ‰çš„å‡ ç§çŠ¶æ€ï¼Ÿ</h2><ul><li>alphaï¼šæ¶ˆæ¯å†…å®¹ï¼ˆåŒ…æ‹¬æ¶ˆæ¯ä½“ã€å±æ€§å’Œ headersï¼‰å’Œæ¶ˆæ¯ç´¢å¼•éƒ½å­˜å‚¨åœ¨å†…å­˜ã€‚</li><li>betaï¼šæ¶ˆæ¯å†…å®¹ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œæ¶ˆæ¯ç´¢å¼•ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚</li><li>gammaï¼šæ¶ˆæ¯å†…å®¹ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œæ¶ˆæ¯ç´¢å¼•åœ¨ç£ç›˜å’Œå†…å­˜ä¸­éƒ½æœ‰ã€‚</li><li>deltaï¼šæ¶ˆæ¯å†…å®¹å’Œç´¢å¼•éƒ½åœ¨ç£ç›˜ä¸­ã€‚</li></ul><h2 id="4-å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Ÿ"><a href="#4-å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="4. å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Ÿ"></a>4. å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Ÿ</h2><ul><li>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªäº¤æ¢å™¨ï¼ˆExchangeï¼‰ä¸­ã€‚äº¤æ¢å™¨æ ¹æ®è·¯ç”±é”®ï¼ˆRouting Keyï¼‰å°†æ¶ˆæ¯åˆ†é…ç»™ç‰¹å®šçš„é˜Ÿåˆ—ï¼ˆQueueï¼‰ã€‚</li><li>äº¤æ¢å™¨é€šè¿‡è·¯ç”±é”®å°†æ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚è‹¥è·¯ç”±é”®ä¸ºç©ºï¼Œæ¶ˆæ¯ä¼šè¢«åˆ†é…ç»™æ‰€æœ‰ç»‘å®šåˆ°è¯¥äº¤æ¢å™¨çš„é˜Ÿåˆ—ã€‚</li><li>æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«æ¶ˆè´¹è€…æ¥æ”¶ã€‚åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ¶ˆæ¯ä¼šè¢«å­˜å‚¨åœ¨æŒä¹…åŒ–å­˜å‚¨ä¸­ï¼Œä»¥é˜²æœåŠ¡å™¨å´©æºƒæˆ–é‡å¯æ—¶æ•°æ®ä¸¢å¤±ã€‚</li><li>æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶å¤„ç†ã€‚æ¶ˆè´¹è€…å¯é€šè¿‡è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—æ¥æ¥æ”¶æ¶ˆæ¯ã€‚ä¸€æ—¦æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ¥æ”¶ï¼Œå®ƒå°†ä»é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚</li></ul><h2 id="5-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RabbitMQï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RabbitMQï¼Ÿ" class="headerlink" title="5. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RabbitMQï¼Ÿ"></a>5. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RabbitMQï¼Ÿ</h2><ul><li>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹å…·å¤‡å¼‚æ­¥ã€å‰Šå³°ã€è´Ÿè½½å‡è¡¡ç­‰ä¸€ç³»åˆ—é«˜çº§åŠŸèƒ½ã€‚</li><li>æ‹¥æœ‰æŒä¹…åŒ–çš„æœºåˆ¶ï¼Œè¿›ç¨‹æ¶ˆæ¯ã€é˜Ÿåˆ—ä¸­çš„ä¿¡æ¯ä¹Ÿå¯ä»¥ä¿å­˜ä¸‹æ¥ã€‚</li><li>å®ç°æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¹‹é—´çš„è§£è€¦ã€‚</li><li>å¯¹äºé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ä½¿å¾—åŒæ­¥è®¿é—®å˜ä¸ºä¸²è¡Œè®¿é—®è¾¾åˆ°ä¸€å®šé‡çš„é™æµï¼Œåˆ©äºæ•°æ®åº“çš„æ“ä½œã€‚</li><li>å¯ä»¥ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¾¾åˆ°å¼‚æ­¥ä¸‹å•çš„æ•ˆæœï¼Œæ’é˜Ÿä¸­ï¼Œåå°è¿›è¡Œé€»è¾‘ä¸‹å•ã€‚</li></ul><h2 id="6-Kafkaã€-ActiveMQã€-RabbitMQã€-RocketMQæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"><a href="#6-Kafkaã€-ActiveMQã€-RabbitMQã€-RocketMQæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ" class="headerlink" title="6. Kafkaã€ ActiveMQã€ RabbitMQã€ RocketMQæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ"></a>6. Kafkaã€ ActiveMQã€ RabbitMQã€ RocketMQæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h2><p>ä¸€èˆ¬çš„ä¸šåŠ¡ç³»ç»Ÿè¦å¼•å…¥ MQï¼Œæœ€æ—©å¤§å®¶éƒ½ç”¨ ActiveMQï¼Œä½†æ˜¯ç°åœ¨ç¡®å®å¤§å®¶ç”¨çš„ä¸å¤šäº†ï¼Œæ²¡ç»è¿‡å¤§è§„æ¨¡ååé‡åœºæ™¯çš„éªŒè¯ï¼Œç¤¾åŒºä¹Ÿä¸æ˜¯å¾ˆæ´»è·ƒï¼Œæ‰€ä»¥å¤§å®¶è¿˜æ˜¯ç®—äº†å§ï¼Œæˆ‘ä¸ªäººä¸æ¨èç”¨è¿™ä¸ªäº†ï¼›</p><p>åæ¥å¤§å®¶å¼€å§‹ç”¨ RabbitMQï¼Œä½†æ˜¯ç¡®å® erlang è¯­è¨€é˜»æ­¢äº†å¤§é‡çš„ Java å·¥ç¨‹å¸ˆå»æ·±å…¥ç ”ç©¶å’ŒæŒæ§å®ƒï¼Œå¯¹å…¬å¸è€Œè¨€ï¼Œå‡ ä¹å¤„äºä¸å¯æ§çš„çŠ¶æ€ï¼Œä½†æ˜¯ç¡®å®äººå®¶æ˜¯å¼€æºçš„ï¼Œæ¯”è¾ƒç¨³å®šçš„æ”¯æŒï¼Œæ´»è·ƒåº¦ä¹Ÿé«˜ï¼›</p><p>ä¸è¿‡ç°åœ¨ç¡®å®è¶Šæ¥è¶Šå¤šçš„å…¬å¸ä¼šå»ç”¨ RocketMQï¼Œç¡®å®å¾ˆä¸é”™ï¼Œæ¯•ç«Ÿæ˜¯é˜¿é‡Œå‡ºå“ï¼Œä½†ç¤¾åŒºå¯èƒ½æœ‰çªç„¶é»„æ‰çš„é£é™©ï¼ˆç›®å‰ RocketMQ å·²æç»™ï¼Œä½† GitHub ä¸Šçš„æ´»è·ƒåº¦å…¶å®ä¸ç®—é«˜ï¼‰å¯¹è‡ªå·±å…¬å¸æŠ€æœ¯å®åŠ›æœ‰ç»å¯¹è‡ªä¿¡çš„ï¼Œæ¨èç”¨ RocketMQï¼Œå¦åˆ™å›å»è€è€å®å®ä½¿ç”¨ RabbitMQ å§ï¼Œäººå®¶æœ‰æ´»è·ƒçš„å¼€æºç¤¾åŒºï¼Œç»å¯¹ä¸ä¼šé»„ï¼›</p><p>æ‰€ä»¥ä¸­å°å‹å…¬å¸ï¼ŒæŠ€æœ¯å®åŠ›è¾ƒä¸ºä¸€èˆ¬ï¼ŒæŠ€æœ¯æŒ‘æˆ˜ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œç”¨ RabbitMQ æ˜¯ä¸é”™çš„é€‰æ‹©ï¼›å¤§å‹å…¬å¸ï¼ŒåŸºç¡€æ¶æ„ç ”å‘å®åŠ›è¾ƒå¼ºï¼Œç”¨ RocketMQ æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼›å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯ï¼Œä½¿ç”¨ Kafkaã€‚</p><h1 id="åº”ç”¨ï¼š"><a href="#åº”ç”¨ï¼š" class="headerlink" title="åº”ç”¨ï¼š"></a>åº”ç”¨ï¼š</h1><h2 id="1-å¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ­£ç¡®åœ°å‘é€è‡³RabbitMQï¼Ÿå¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ¥æ”¶æ–¹æ¶ˆè´¹äº†æ¶ˆæ¯ï¼Ÿ"><a href="#1-å¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ­£ç¡®åœ°å‘é€è‡³RabbitMQï¼Ÿå¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ¥æ”¶æ–¹æ¶ˆè´¹äº†æ¶ˆæ¯ï¼Ÿ" class="headerlink" title="1. å¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ­£ç¡®åœ°å‘é€è‡³RabbitMQï¼Ÿå¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ¥æ”¶æ–¹æ¶ˆè´¹äº†æ¶ˆæ¯ï¼Ÿ"></a>1. å¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ­£ç¡®åœ°å‘é€è‡³RabbitMQï¼Ÿå¦‚ä½•ç¡®ä¿æ¶ˆæ¯æ¥æ”¶æ–¹æ¶ˆè´¹äº†æ¶ˆæ¯ï¼Ÿ</h2><ul><li><strong>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶(**</strong>ç”Ÿäº§è€…ç¡®è®¤<strong>**)</strong>ï¼šç”Ÿäº§è€…åœ¨å‘é€æ¶ˆæ¯åï¼Œå¯é€šè¿‡æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ˆConfirmï¼‰ç¡®ä¿æ¶ˆæ¯æ­£ç¡®å‘é€è‡³RabbitMQã€‚æ¶ˆæ¯ç¡®è®¤æœºåˆ¶åˆ†ä¸ºæ‰¹é‡ç¡®è®¤å’Œå•ä¸ªç¡®è®¤ä¸¤ç§æ–¹å¼ï¼Œç”Ÿäº§è€…å¯æ ¹æ®è‡ªèº«ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹å¼ã€‚</li><li><strong>æ¶ˆæ¯æŒä¹…åŒ–</strong>ï¼šé€šè¿‡å°†æ¶ˆæ¯è®¾ç½®ä¸ºæŒä¹…åŒ–çš„æ–¹å¼ï¼Œå¯ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚åœ¨RabbitMQä¸­ï¼Œå¯å°†Exchangeã€Queueå’ŒMessageéƒ½æ ‡è®°ä¸ºæŒä¹…åŒ–ã€‚åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥å°†æ¶ˆæ¯çš„delivery - modeè®¾ç½®ä¸º2ï¼Œè¡¨ç¤ºæ¶ˆæ¯éœ€è¦æŒä¹…åŒ–ã€‚</li><li><strong>è¿æ¥è¶…æ—¶è®¾ç½®ï¼ˆ**</strong>ç”Ÿäº§è€…é‡è¿<strong>**ï¼‰</strong>ï¼šåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯é€šè¿‡è®¾ç½®è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå½“è¶…è¿‡æŒ‡å®šæ—¶é—´åä»æœªæ”¶åˆ°å‘é€æ¶ˆæ¯å“åº”ï¼Œå¯ä»¥é€šè¿‡é‡å‘ç­‰æ–¹å¼ç¡®ä¿æ¶ˆæ¯æ­£ç¡®åœ°å‘é€è‡³RabbitMQã€‚</li><li><strong>æ¶ˆæ¯**</strong>åºåˆ—åŒ–<strong>**å’Œååºåˆ—åŒ–</strong>ï¼šåœ¨å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ—¶ï¼Œéœ€è¦å°†æ¶ˆæ¯å¯¹è±¡åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œå†åœ¨æ¥æ”¶æ–¹ååºåˆ—åŒ–ä¸ºå¯¹è±¡ç±»å‹ã€‚å› æ­¤ï¼Œéœ€è¦ç¡®ä¿æ¶ˆæ¯çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹æ­£ç¡®æ— è¯¯ï¼Œå¯ä»¥é‡‡ç”¨JSONã€Protobufç­‰å¸¸ç”¨çš„åºåˆ—åŒ–æ¡†æ¶ã€‚ </li></ul><h2 id="2-å¦‚ä½•å›ç­”-æ¶ˆæ¯é˜Ÿåˆ—-çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜"><a href="#2-å¦‚ä½•å›ç­”-æ¶ˆæ¯é˜Ÿåˆ—-çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜" class="headerlink" title="2. å¦‚ä½•å›ç­”**æ¶ˆæ¯é˜Ÿåˆ—**çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜"></a>2. <strong>å¦‚ä½•å›ç­”**</strong>æ¶ˆæ¯é˜Ÿåˆ—<strong>**çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜</strong></h2><p><a href="https://learn.lianglianglee.com/ä¸“æ /æ¶æ„è®¾è®¡é¢è¯•ç²¾è®²/08  MQï¼šå¦‚ä½•å›ç­”æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜.md">08 MQ:å¦‚ä½•å›ç­”æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸¢å¤±ã€é‡å¤ä¸ç§¯å‹é—®é¢˜</a></p><ul><li><strong>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</strong>ï¼šæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯åï¼Œå‘RabbitMQå‘é€æ¶ˆæ¯ç¡®è®¤ï¼ˆACKï¼‰ï¼Œå‘ŠçŸ¥æ¶ˆæ¯å·²æ­£ç¡®å¤„ç†ã€‚è‹¥æœªå‘é€ï¼ŒRabbitMQä¼šå°†æ¶ˆæ¯é‡æ–°æŠ•åˆ°é˜Ÿåˆ—ï¼Œé€ æˆé‡å¤æ¶ˆè´¹ã€‚</li><li><strong>æ¶ˆæ¯å»é‡æœºåˆ¶</strong>ï¼šå¯åœ¨åº”ç”¨ç¨‹åºä¸­å®ç°ï¼Œæ¯”å¦‚ç”¨åˆ†å¸ƒå¼ç¼“å­˜ã€æ•°æ®åº“ç­‰å­˜å‚¨ç³»ç»Ÿè®°å½•å·²å¤„ç†æ¶ˆæ¯æ ‡è¯†ï¼Œä¸‹æ¬¡å¤„ç†æ—¶åˆ¤æ–­ï¼Œè‹¥å·²å¤„ç†åˆ™å¿½ç•¥ï¼Œé¿å…é‡å¤å¤„ç†ã€‚</li><li><strong>æ¶ˆæ¯å¹‚ç­‰æ€§å¤„ç†ï¼ˆä¸šåŠ¡å¤„ç†ï¼‰</strong>ï¼šå°†æ¶ˆè´¹è€…å¤„ç†é€»è¾‘è®¾è®¡ä¸ºå¹‚ç­‰æ“ä½œï¼Œå³é‡å¤æ‰§è¡Œå¤šæ¬¡æ•ˆæœç›¸åŒï¼Œé˜²æ­¢å› æ¶ˆæ¯é‡å¤æ¶ˆè´¹è‡´ä¸šåŠ¡æ•°æ®é”™è¯¯ã€‚</li><li><strong>è®¾ç½®æ¶ˆæ¯è¿‡æœŸæ—¶é—´</strong>ï¼šå‘é€æ¶ˆæ¯æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåä¸å†æŠ•é€’ç»™æ¶ˆè´¹è€…ï¼Œé¿å…é‡å¤æ¶ˆè´¹ã€‚</li><li><strong>ä½¿ç”¨æ¶ˆæ¯å”¯ä¸€æ ‡è¯†ç¬¦</strong>ï¼šåœ¨æ¶ˆæ¯ä¸­æ·»åŠ å¦‚UUIDè¿™æ ·çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¿è¯æ¯æ¡æ¶ˆæ¯æœ‰ç‹¬ä¸€æ— äºŒæ ‡è¯†ï¼Œé¿å…é‡å¤æ¶ˆè´¹å’Œé‡å¤æŠ•é€’ã€‚ </li></ul><h2 id="3-å¦‚ä½•ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–ï¼Ÿ"><a href="#3-å¦‚ä½•ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–ï¼Ÿ" class="headerlink" title="3. å¦‚ä½•ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–ï¼Ÿ"></a>3. å¦‚ä½•ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–ï¼Ÿ</h2><ul><li><strong>æ¶ˆæ¯çš„**</strong>delivery - mode<strong>**è®¾ç½®ä¸º2</strong>ï¼šåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥å°†æ¶ˆæ¯çš„delivery - modeå±æ€§è®¾ç½®ä¸º2ï¼Œè¡¨ç¤ºæ¶ˆæ¯éœ€è¦è¢«æŒä¹…åŒ–ã€‚æŒä¹…åŒ–çš„æ¶ˆæ¯å°†ä¼šè¢«å†™å…¥ç£ç›˜ï¼Œå³ä½¿RabbitMQé‡å¯æˆ–è€…å´©æºƒï¼Œæ¶ˆæ¯ä¹Ÿä»ç„¶å¯ä»¥ä¿ç•™ã€‚</li><li><strong>é˜Ÿåˆ—çš„durableå±æ€§è®¾ç½®ä¸ºtrue</strong>ï¼šåœ¨åˆ›å»ºé˜Ÿåˆ—æ—¶ï¼Œå¯ä»¥å°†é˜Ÿåˆ—çš„durableå±æ€§è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºé˜Ÿåˆ—æ˜¯æŒä¹…æ€§çš„ã€‚æŒä¹…åŒ–çš„é˜Ÿåˆ—å°†ä¼šåœ¨RabbitMQé‡å¯æˆ–è€…å´©æºƒåå¾—åˆ°ä¿ç•™ã€‚</li><li><strong>å°†**</strong>äº¤æ¢å™¨<strong>**çš„durableå±æ€§è®¾ç½®ä¸ºtrue</strong>ï¼šåœ¨åˆ›å»ºäº¤æ¢å™¨æ—¶ï¼Œå¯ä»¥å°†äº¤æ¢å™¨çš„durableå±æ€§è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºäº¤æ¢å™¨æ˜¯æŒä¹…æ€§çš„ã€‚æŒä¹…åŒ–çš„äº¤æ¢å™¨å°†ä¼šåœ¨RabbitMQé‡å¯æˆ–è€…å´©æºƒåå¾—åˆ°ä¿ç•™ã€‚</li><li><strong>ä½¿ç”¨äº‹åŠ¡æœºåˆ¶</strong>ï¼šåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äº‹åŠ¡æœºåˆ¶æ¥ç¡®ä¿æ¶ˆæ¯çš„æŒä¹…æ€§ã€‚é€šè¿‡å¼€å¯äº‹åŠ¡ï¼Œå‘é€è€…å¯ä»¥å°†æ¶ˆæ¯å‘é€åˆ°RabbitMQï¼Œç„¶åç­‰å¾…RabbitMQçš„ç¡®è®¤ï¼Œç¡®è®¤åå†æäº¤äº‹åŠ¡ã€‚ä½¿ç”¨äº‹åŠ¡æœºåˆ¶å¯ä»¥ç¡®ä¿æ¶ˆæ¯çš„å¯é æ€§ï¼Œä½†æ˜¯ä¼šå½±å“ç³»ç»Ÿçš„æ€§èƒ½ã€‚ </li></ul><h2 id="4-æ¶ˆæ¯å¦‚ä½•è·¯ç”±ï¼Ÿ"><a href="#4-æ¶ˆæ¯å¦‚ä½•è·¯ç”±ï¼Ÿ" class="headerlink" title="4. æ¶ˆæ¯å¦‚ä½•è·¯ç”±ï¼Ÿ"></a>4. æ¶ˆæ¯å¦‚ä½•è·¯ç”±ï¼Ÿ</h2><p> æ¶ˆæ¯çš„è·¯ç”±è¿‡ç¨‹é€šè¿‡äº¤æ¢å™¨ï¼ˆExchangeï¼‰å®ç°ã€‚å½“æ¶ˆæ¯è¢«å‘é€åˆ° RabbitMQ æ—¶ï¼Œç”Ÿäº§è€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°äº¤æ¢å™¨ä¸­ï¼Œç„¶åä¾æ®äº¤æ¢å™¨çš„ç±»å‹å’Œç»‘å®šè§„åˆ™å°†æ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ä¸­ã€‚</p><p> æ¶ˆæ¯è·¯ç”±çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„äº¤æ¢å™¨ä¸­ã€‚</li><li>äº¤æ¢å™¨æ ¹æ®è·¯ç”±é”®ï¼ˆRouting Keyï¼‰å’Œç»‘å®šé”®ï¼ˆBinding Keyï¼‰å°†æ¶ˆæ¯å‘é€åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ä¸­ã€‚è·¯ç”±é”®å’Œç»‘å®šé”®å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œæ ¹æ®äº¤æ¢å™¨çš„ç±»å‹å’Œç»‘å®šè§„åˆ™è¿›è¡ŒåŒ¹é…ã€‚</li><li>è‹¥äº¤æ¢å™¨ç±»å‹ä¸º directï¼Œä¼šæ ¹æ®è·¯ç”±é”®è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ—ä¸­ã€‚</li><li>è‹¥äº¤æ¢å™¨ç±»å‹ä¸º fanoutï¼Œä¼šå°†æ¶ˆæ¯å‘é€åˆ°æ‰€æœ‰ç»‘å®šåˆ°è¯¥äº¤æ¢å™¨çš„é˜Ÿåˆ—ä¸­ã€‚</li><li>è‹¥äº¤æ¢å™¨ç±»å‹ä¸º topicï¼Œä¼šæ ¹æ®é€šé…ç¬¦åŒ¹é…è§„åˆ™å°†æ¶ˆæ¯å‘é€åˆ°åŒ¹é…çš„é˜Ÿåˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œè·¯ç”±é”®ä¸º â€œfoo.barâ€ çš„æ¶ˆæ¯å¯ä»¥åŒ¹é…ç»‘å®šé”®ä¸º â€œ*.barâ€ æˆ– â€œfoo.#â€ çš„é˜Ÿåˆ—ã€‚</li><li>è‹¥äº¤æ¢å™¨ç±»å‹ä¸º headersï¼Œä¼šæ ¹æ®æ¶ˆæ¯çš„å±æ€§ï¼ˆheadersï¼‰è¿›è¡ŒåŒ¹é…ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°åŒ¹é…çš„é˜Ÿåˆ—ä¸­ã€‚</li><li><p>å¦‚æœæ²¡æœ‰åŒ¹é…çš„é˜Ÿåˆ—ï¼Œæ¶ˆæ¯å°†è¢«ä¸¢å¼ƒæˆ–è¿”å›ç»™ç”Ÿäº§è€…ï¼Œæ ¹æ®ç”Ÿäº§è€…çš„é…ç½®ã€‚</p><p>éœ€æ³¨æ„ï¼Œäº¤æ¢å™¨å’Œé˜Ÿåˆ—éƒ½éœ€è¦è¿›è¡Œç»‘å®šï¼Œå¦åˆ™æ¶ˆæ¯å°†æ— æ³•è·¯ç”±åˆ°é˜Ÿåˆ—ä¸­ã€‚å¦å¤–ï¼Œå¯æ ¹æ®éœ€è¦åœ¨äº¤æ¢å™¨å’Œé˜Ÿåˆ—ä¸­é…ç½®å„ç§å±æ€§ï¼Œä¾‹å¦‚æŒä¹…åŒ–ã€è‡ªåŠ¨åˆ é™¤ç­‰ï¼Œä»¥æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p></li></ul><h2 id="5ï¼â­ï¸RabbitMQçš„æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ï¼Ÿ"><a href="#5ï¼â­ï¸RabbitMQçš„æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="5ï¼â­ï¸RabbitMQçš„æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ï¼Ÿ"></a>5ï¼â­ï¸RabbitMQçš„æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ï¼Ÿ</h2><p><strong>æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ï¼š</strong></p><p>ä¸ºç¡®è®¤æ¶ˆè´¹è€…æ˜¯å¦æˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQ æä¾›äº†æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ï¼ˆConsumer Acknowledgementï¼‰ã€‚å½“æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯ç»“æŸåï¼Œåº”å‘ RabbitMQ å‘é€ä¸€ä¸ªå›æ‰§ï¼Œå‘ŠçŸ¥ RabbitMQ è‡ªå·±çš„å¤„ç†çŠ¶æ€ã€‚å›æ‰§æœ‰ä¸‰ç§å¯é€‰å€¼ï¼š</p><ul><li>ackï¼šæˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQ ä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯ã€‚</li><li>nackï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼ŒRabbitMQ éœ€è¦å†æ¬¡æŠ•é€’æ¶ˆæ¯ã€‚</li><li>rejectï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥å¹¶æ‹’ç»è¯¥æ¶ˆæ¯ï¼ŒRabbitMQ ä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯ã€‚</li></ul><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NzU2YmM3YmFkYTU4MGY3OThiZjVkNDkxMDkzNjNkYjlfZEtDMkh2N0FYbENvR2xEVm4wMnZJTjRWVWFKRElrYzlfVG9rZW46SUZQVWJLOUV4b3RmRVF4MWhPRWNHOEs3bmRkXzE3NDMzODg3ODE6MTc0MzM5MjM4MV9WNA" alt="img"></p><p>RabbitMQçš„æ¶ˆæ¯ç¡®è®¤æœºåˆ¶æ˜¯æŒ‡æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹ä¸€æ¡æ¶ˆæ¯åï¼Œå‘RabbitMQå‘é€ç¡®è®¤æ¶ˆæ¯ï¼ˆACKï¼‰çš„è¿‡ç¨‹ï¼Œä»¥æ­¤å‘ŠçŸ¥RabbitMQæ¶ˆæ¯å·²è¢«æ­£ç¡®å¤„ç†ã€‚<strong>è¯¥æœºåˆ¶çš„ä½œç”¨æ˜¯ç¡®ä¿RabbitMQèƒ½æ­£ç¡®åœ°å°†æ¶ˆæ¯ä»é˜Ÿåˆ—ä¸­åˆ é™¤ï¼Œé¿å…é‡å¤æŠ•é€’å’Œé‡å¤æ¶ˆè´¹ã€‚</strong></p><p>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>æ¶ˆè´¹è€…ä»RabbitMQä¸­è·å–æ¶ˆæ¯å¹¶å¤„ç†ã€‚</li><li>å¤„ç†å®Œæˆåï¼Œå‘RabbitMQå‘é€ç¡®è®¤æ¶ˆæ¯ï¼ˆACKï¼‰ã€‚ç¡®è®¤æ¶ˆæ¯é€šå¸¸æ˜¯ä¸€ä¸ªç®€å•çš„AMQPåŸºæœ¬ç¡®è®¤å¸§ï¼Œå¸¦æœ‰æ¶ˆæ¯çš„æ ‡è¯†ç¬¦ï¼ˆdelivery tagï¼‰å’Œæ˜¯å¦æ‰¹é‡ç¡®è®¤çš„æ ‡è®°ã€‚</li><li>RabbitMQæ”¶åˆ°ç¡®è®¤æ¶ˆæ¯åï¼Œå°†è¯¥æ¶ˆæ¯ä»é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚</li><li>å¦‚æœæ¶ˆè´¹è€…åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰å‘é€ç¡®è®¤æ¶ˆæ¯ï¼ŒRabbitMQä¼šè®¤ä¸ºæ¶ˆæ¯æœªè¢«æ­£ç¡®å¤„ç†ï¼Œå°†ä¼šé‡æ–°å°†æ¶ˆæ¯æŠ•é€’åˆ°é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ¶ˆè´¹ã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¶ˆè´¹è€…å¯èƒ½æ— æ³•æ­£ç¡®å¤„ç†æ¶ˆæ¯ï¼Œæ¯”å¦‚æ¶ˆè´¹è€…å´©æºƒæˆ–å‡ºç°å¼‚å¸¸ç­‰ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œ<strong>RabbitMQè¿˜æä¾›äº†Nack</strong>ï¼ˆNegative Acknowledgeï¼‰å’ŒRejectæœºåˆ¶ï¼Œå¯å°†æ¶ˆæ¯æ ‡è®°ä¸ºæ— æ³•å¤„ç†æˆ–æ— æ³•è·¯ç”±çš„çŠ¶æ€ï¼Œä½¿å…¶é‡æ–°å›åˆ°é˜Ÿåˆ—ä¸­ç­‰å¾…ä¸‹ä¸€æ¬¡æŠ•é€’ã€‚æ­¤å¤–ï¼Œå¯é€šè¿‡è®¾ç½®é‡è¯•æ¬¡æ•°å’Œé‡è¯•æ—¶é—´é—´éš”ç­‰å‚æ•°ï¼Œè¿›è¡Œæ¶ˆæ¯é‡è¯•å’Œå»¶è¿ŸæŠ•é€’çš„é…ç½®ï¼Œä»¥æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ã€‚ </p><h2 id="6-â“æ¶ˆæ¯åŸºäºä»€ä¹ˆä¼ è¾“ï¼Ÿ"><a href="#6-â“æ¶ˆæ¯åŸºäºä»€ä¹ˆä¼ è¾“ï¼Ÿ" class="headerlink" title="6. â“æ¶ˆæ¯åŸºäºä»€ä¹ˆä¼ è¾“ï¼Ÿ"></a>6. â“æ¶ˆæ¯åŸºäºä»€ä¹ˆä¼ è¾“ï¼Ÿ</h2><p><img src="https://mcnfxurl5vzo.feishu.cn/space/api/box/stream/download/asynccode/?code=NzJmYWVhZWU4ZmI4YWY2NDg4N2FjNmExZGYyOWNlY2RfZFhvUUFRZ1d0b1A5QkgzUjhDYWw4ZlZONU85c3k5OWhfVG9rZW46RWhMdmJ5YUJRb2hxSkd4MUQwT2NGYUtIbkdkXzE3NDMzODg3ODE6MTc0MzM5MjM4MV9WNA" alt="img"></p><h2 id="7-ä¸ºä»€ä¹ˆä¸åº”è¯¥å¯¹æ‰€æœ‰çš„-message-éƒ½ä½¿ç”¨æŒä¹…åŒ–æœºåˆ¶ï¼Ÿ"><a href="#7-ä¸ºä»€ä¹ˆä¸åº”è¯¥å¯¹æ‰€æœ‰çš„-message-éƒ½ä½¿ç”¨æŒä¹…åŒ–æœºåˆ¶ï¼Ÿ" class="headerlink" title="7. ä¸ºä»€ä¹ˆä¸åº”è¯¥å¯¹æ‰€æœ‰çš„ message éƒ½ä½¿ç”¨æŒä¹…åŒ–æœºåˆ¶ï¼Ÿ"></a>7. ä¸ºä»€ä¹ˆä¸åº”è¯¥å¯¹æ‰€æœ‰çš„ message éƒ½ä½¿ç”¨æŒä¹…åŒ–æœºåˆ¶ï¼Ÿ</h2><p>ä½¿ç”¨æŒä¹…åŒ–æœºåˆ¶ä¼šå¢åŠ ç£ç›˜è´Ÿæ‹…ï¼Œå°¤å…¶åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæˆæœ¬æ›´é«˜ã€‚è‹¥æ‰€æœ‰æ¶ˆæ¯éƒ½ç”¨ï¼Œä¼šä½¿RabbitMQæ€§èƒ½ä¸‹é™ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚æ‰€ä»¥è¦ä¾ä¸šåŠ¡éœ€æ±‚å’Œæ¶ˆæ¯é‡è¦æ€§é€‰æ‹©æ˜¯å¦ç”¨ã€‚é‡è¦æ¶ˆæ¯ç”¨å®ƒä¿å¯é ï¼Œä¸´æ—¶æ¶ˆæ¯å¯ä¸ç”¨ï¼Œå‡è½»æœåŠ¡å™¨è´Ÿæ‹…ã€‚</p><p>è‹¥messageè®¾äº†persistentå±æ€§ï¼Œä½†queueæœªè®¾durableå±æ€§ï¼Œqueueçš„owner nodeå¼‚å¸¸æ—¶ï¼Œåœ¨queueé‡å»ºå‰ï¼Œå‘å¾€å®ƒçš„messageå°†è¢«é˜»å¡ï¼›è‹¥messageå’Œqueueéƒ½åˆ†åˆ«è®¾äº†persistentå’Œdurableå±æ€§ï¼Œqueueçš„owner nodeå¼‚å¸¸ä¸”æ— æ³•é‡å¯ï¼Œqueueæ— æ³•åœ¨å…¶ä»–nodeé‡å»ºï¼Œåªèƒ½ç­‰å…¶owner nodeé‡å¯åæ‰èƒ½æ¢å¤ä½¿ç”¨ï¼ŒæœŸé—´å‘é€ç»™è¯¥queueçš„æ¶ˆæ¯ä¹Ÿä¼šè¢«é˜»å¡ã€‚</p><p>å› æ­¤ï¼Œæ˜¯å¦å¯¹messageæŒä¹…åŒ–ï¼Œéœ€ç»¼åˆè€ƒé‡æ€§èƒ½éœ€æ±‚åŠå¯èƒ½é—®é¢˜ã€‚è‹¥æƒ³å•RabbitMQæœåŠ¡å™¨è¾¾100000æ¡/ç§’ä»¥ä¸Šæ¶ˆæ¯ååé‡ï¼Œè¦ä¹ˆä¸ç”¨æŒä¹…åŒ–ä¿é€Ÿåº¦ï¼Œç”¨å…¶ä»–æ–¹å¼ç¡®ä¿æ¶ˆæ¯å¯é ï¼›è¦ä¹ˆç”¨æŒä¹…åŒ–ï¼Œä¸”ä¿è¯å…³é”®æ¶ˆæ¯é‡ä¸è‡´æ€§èƒ½ç“¶é¢ˆã€‚ </p><h2 id="8-å¦‚ä½•ä¿è¯é«˜å¯ç”¨çš„ï¼ŸRabbitMQ-çš„é›†ç¾¤ï¼Ÿ"><a href="#8-å¦‚ä½•ä¿è¯é«˜å¯ç”¨çš„ï¼ŸRabbitMQ-çš„é›†ç¾¤ï¼Ÿ" class="headerlink" title="8. å¦‚ä½•ä¿è¯é«˜å¯ç”¨çš„ï¼ŸRabbitMQ çš„é›†ç¾¤ï¼Ÿ"></a>8. å¦‚ä½•ä¿è¯é«˜å¯ç”¨çš„ï¼ŸRabbitMQ çš„é›†ç¾¤ï¼Ÿ</h2><p><strong>æ™®é€šé›†ç¾¤æ¨¡å¼</strong></p><p>æ™®é€šé›†ç¾¤æ¨¡å¼æ˜¯RabbitMQæœ€å¸¸è§ä¸”æœ€ç®€å•çš„é›†ç¾¤æ¨¡å¼ã€‚å¤šå°RabbitMQæœåŠ¡å™¨ç»ç½‘ç»œè¿æ¥æˆé›†ç¾¤ï¼Œå…±åŒç®¡ç†æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå€ŸèŠ‚ç‚¹é—´é€šä¿¡å®ç°æ¶ˆæ¯ä¼ é€’ä¸è·¯ç”±ã€‚é€‚ç”¨äºå¤šæ•°åº”ç”¨åœºæ™¯ï¼Œæä¾›é«˜å¯ç”¨æ€§å’Œå¯é æ€§ã€‚</p><p><strong>é•œåƒé›†ç¾¤æ¨¡å¼</strong></p><p>ä¸€ç§é«˜å¯ç”¨æ€§é›†ç¾¤æ¨¡å¼ï¼Œå¯æå‡RabbitMQé›†ç¾¤çš„å¯é æ€§ä¸å®¹é”™èƒ½åŠ›ã€‚æ¯ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªé•œåƒèŠ‚ç‚¹ï¼Œé•œåƒèŠ‚ç‚¹è‡ªåŠ¨å¤åˆ¶ä¸»èŠ‚ç‚¹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸»èŠ‚ç‚¹æ•…éšœæ—¶æ¥ç®¡æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†ã€‚é€‚ç”¨äºå¯¹æ¶ˆæ¯å¯é æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä½†ä¼šå¢åŠ ç½‘ç»œå¸¦å®½å’Œå­˜å‚¨æˆæœ¬</p><p><strong>Federatedé›†ç¾¤æ¨¡å¼</strong></p><p>RabbitMQçš„ç‰¹æ®Šé›†ç¾¤æ¨¡å¼ï¼Œèƒ½å°†å¤šä¸ªRabbitMQé›†ç¾¤ç»„æˆé€»è¾‘æ•´ä½“ï¼Œé€šè¿‡Federationæ’ä»¶å®ç°é›†ç¾¤é—´æ¶ˆæ¯ä¼ é€’ä¸è·¯ç”±ã€‚é€‚ç”¨äºéœ€è·¨å¤šæ•°æ®ä¸­å¿ƒæˆ–åœ°ç†åˆ†å¸ƒçš„åœºæ™¯ï¼Œä½†ä¼šå¢åŠ ç½‘ç»œå»¶è¿Ÿå’Œå¤æ‚åº¦ã€‚ </p><h2 id="9-RabbitMQä¸Šçš„ä¸€ä¸ªqueueä¸­å­˜æ”¾çš„messageæ˜¯å¦æœ‰æ•°é‡é™åˆ¶ï¼Ÿ"><a href="#9-RabbitMQä¸Šçš„ä¸€ä¸ªqueueä¸­å­˜æ”¾çš„messageæ˜¯å¦æœ‰æ•°é‡é™åˆ¶ï¼Ÿ" class="headerlink" title="9. RabbitMQä¸Šçš„ä¸€ä¸ªqueueä¸­å­˜æ”¾çš„messageæ˜¯å¦æœ‰æ•°é‡é™åˆ¶ï¼Ÿ"></a>9. RabbitMQä¸Šçš„ä¸€ä¸ªqueueä¸­å­˜æ”¾çš„messageæ˜¯å¦æœ‰æ•°é‡é™åˆ¶ï¼Ÿ</h2><ul><li><strong>é˜Ÿåˆ—çš„å¤§å°é™åˆ¶</strong>ï¼šé˜Ÿåˆ—å¯é€šè¿‡é…ç½®å‚æ•°é™åˆ¶å¤§å°ï¼Œå½“é˜Ÿåˆ—å¤§å°è¾¾åˆ°é™åˆ¶ï¼Œæ–°æ¶ˆæ¯æ— æ³•å…¥é˜Ÿã€‚è¯¥é™åˆ¶èƒ½é€šè¿‡RabbitMQçš„ç®¡ç†ç•Œé¢æˆ–è€…AMQPåè®®è®¾ç½®ã€‚</li><li><strong>å†…å­˜**</strong>é™åˆ¶**ï¼šRabbitMQä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè‹¥é˜Ÿåˆ—ä¸­æ¶ˆæ¯æ•°é‡è¿‡å¤šï¼Œä¼šå ç”¨å¤§é‡å†…å­˜ç©ºé—´ï¼Œå¯èƒ½è‡´ä½¿ç³»ç»Ÿæ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒã€‚æ‰€ä»¥ï¼Œç³»ç»Ÿå†…å­˜å¤§å°æ˜¯é˜Ÿåˆ—å­˜æ”¾æ¶ˆæ¯æ•°é‡çš„é™åˆ¶å› ç´ ä¹‹ä¸€ã€‚ </li><li><strong>ç£ç›˜é™åˆ¶</strong>ï¼šå½“RabbitMQçš„ç£ç›˜ç©ºé—´ä¸è¶³æ—¶ï¼Œä¹Ÿä¼šå¯¹é˜Ÿåˆ—ä¸­å­˜æ”¾æ¶ˆæ¯çš„æ•°é‡å½¢æˆé™åˆ¶ã€‚ </li></ul><h2 id="10-â­ï¸åœ¨å•nodeç³»ç»Ÿå’Œå¤šnodeæ„æˆçš„clusterç³»ç»Ÿä¸­å£°æ˜queueï¼Œexchangeï¼Œä»¥åŠè¿›è¡Œbindingä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#10-â­ï¸åœ¨å•nodeç³»ç»Ÿå’Œå¤šnodeæ„æˆçš„clusterç³»ç»Ÿä¸­å£°æ˜queueï¼Œexchangeï¼Œä»¥åŠè¿›è¡Œbindingä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="10. â­ï¸åœ¨å•nodeç³»ç»Ÿå’Œå¤šnodeæ„æˆçš„clusterç³»ç»Ÿä¸­å£°æ˜queueï¼Œexchangeï¼Œä»¥åŠè¿›è¡Œbindingä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>10. â­ï¸åœ¨å•nodeç³»ç»Ÿå’Œå¤šnodeæ„æˆçš„clusterç³»ç»Ÿä¸­å£°æ˜queueï¼Œexchangeï¼Œä»¥åŠè¿›è¡Œbindingä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h2><p>å½“ä½ åœ¨å•nodeä¸Šå£°æ˜queueæ—¶ï¼Œåªè¦è¯¥nodeä¸Šç›¸å…³å…ƒæ•°æ®è¿›è¡Œäº†å˜æ›´ï¼Œä½ å°±ä¼šå¾—åˆ°Queue.Declare - okå›åº”ï¼›è€Œåœ¨clusterä¸Šå£°æ˜queueï¼Œåˆ™è¦æ±‚clusterä¸Šçš„å…¨éƒ¨nodeéƒ½è¦è¿›è¡Œå…ƒæ•°æ®æˆåŠŸæ›´æ–°ï¼Œæ‰ä¼šå¾—åˆ°Queue.Declare - okå›åº”ã€‚å¦å¤–ï¼Œè‹¥nodeç±»å‹ä¸ºRAM nodeåˆ™å˜æ›´çš„æ•°æ®ä»…ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè‹¥ç±»å‹ä¸ºdisk nodeåˆ™è¿˜è¦å˜æ›´ä¿å­˜åœ¨ç£ç›˜ä¸Šçš„æ•°æ®ã€‚</p><p><strong>å®¢æˆ·ç«¯è¿æ¥åˆ°clusterä¸­çš„ä»»æ„nodeä¸Šæ˜¯å¦éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</strong></p><p>æ˜¯çš„ï¼Œå®¢æˆ·ç«¯æ„Ÿè§‰ä¸åˆ°ä¸åŒã€‚</p><p><strong>è‹¥clusterä¸­æ‹¥æœ‰æŸä¸ªqueueçš„owner nodeå¤±æ•ˆäº†ï¼Œä¸”è¯¥queueè¢«å£°æ˜å…·æœ‰durableå±æ€§ï¼Œæ˜¯å¦èƒ½å¤ŸæˆåŠŸä»å…¶ä»–nodeä¸Šé‡æ–°å£°æ˜è¯¥queueï¼Ÿ</strong></p><p>ä¸èƒ½ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†å¾—åˆ°404 NOT FOUNDé”™è¯¯ã€‚åªèƒ½ç­‰queueæ‰€å±çš„nodeæ¢å¤åæ‰èƒ½ä½¿ç”¨è¯¥queueã€‚ä½†è‹¥è¯¥queueæœ¬èº«ä¸å…·æœ‰durableå±æ€§ï¼Œåˆ™å¯åœ¨å…¶ä»–nodeä¸Šé‡æ–°å£°æ˜ã€‚ </p><h2 id="11-å‘ä¸å­˜åœ¨çš„exchangeå‘publishæ¶ˆæ¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‘ä¸å­˜åœ¨çš„queueæ‰§è¡ŒconsumeåŠ¨ä½œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#11-å‘ä¸å­˜åœ¨çš„exchangeå‘publishæ¶ˆæ¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‘ä¸å­˜åœ¨çš„queueæ‰§è¡ŒconsumeåŠ¨ä½œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="11. å‘ä¸å­˜åœ¨çš„exchangeå‘publishæ¶ˆæ¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‘ä¸å­˜åœ¨çš„queueæ‰§è¡ŒconsumeåŠ¨ä½œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>11. å‘ä¸å­˜åœ¨çš„exchangeå‘publishæ¶ˆæ¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‘ä¸å­˜åœ¨çš„queueæ‰§è¡ŒconsumeåŠ¨ä½œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</h2><p>éƒ½ä¼šæ”¶åˆ° Channel.Close ä¿¡ä»¤å‘Šä¹‹ä¸å­˜åœ¨ï¼ˆå†…å«åŸå›  404 NOT FOUNDï¼‰</p><h2 id="12-ä¸ºä»€ä¹ˆè¯´ä¿è¯messageè¢«å¯é æŒä¹…åŒ–çš„æ¡ä»¶æ˜¯queueå’Œexchangeå…·æœ‰durableå±æ€§ï¼ŒåŒæ—¶messageå…·æœ‰-persistentå±æ€§æ‰è¡Œï¼Ÿ"><a href="#12-ä¸ºä»€ä¹ˆè¯´ä¿è¯messageè¢«å¯é æŒä¹…åŒ–çš„æ¡ä»¶æ˜¯queueå’Œexchangeå…·æœ‰durableå±æ€§ï¼ŒåŒæ—¶messageå…·æœ‰-persistentå±æ€§æ‰è¡Œï¼Ÿ" class="headerlink" title="12. ä¸ºä»€ä¹ˆè¯´ä¿è¯messageè¢«å¯é æŒä¹…åŒ–çš„æ¡ä»¶æ˜¯queueå’Œexchangeå…·æœ‰durableå±æ€§ï¼ŒåŒæ—¶messageå…·æœ‰ persistentå±æ€§æ‰è¡Œï¼Ÿ"></a>12. ä¸ºä»€ä¹ˆè¯´ä¿è¯messageè¢«å¯é æŒä¹…åŒ–çš„æ¡ä»¶æ˜¯queueå’Œexchangeå…·æœ‰durableå±æ€§ï¼ŒåŒæ—¶messageå…·æœ‰ persistentå±æ€§æ‰è¡Œï¼Ÿ</h2><p>binding å…³ç³»å¯ä»¥è¡¨ç¤ºä¸º exchange - binding - queueã€‚ä»æ–‡æ¡£ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œè‹¥è¦æ±‚æŠ•é€’çš„ message èƒ½å¤Ÿä¸ä¸¢å¤±ï¼Œè¦æ±‚ message æœ¬èº«è®¾ç½® persistent å±æ€§ï¼Œè¦æ±‚ exchange å’Œ queue éƒ½è®¾ç½® durable å±æ€§ã€‚å…¶å®è¿™é—®é¢˜å¯ä»¥è¿™ä¹ˆæƒ³ï¼Œè‹¥ exchange æˆ– queue æœªè®¾ç½® durable å±æ€§ï¼Œåˆ™åœ¨å…¶ crash ä¹‹åå°±ä¼šæ— æ³•æ¢å¤ï¼Œé‚£ä¹ˆå³ä½¿ message è®¾ç½®äº† persistent å±æ€§ï¼Œä»ç„¶å­˜åœ¨ message è™½ç„¶èƒ½æ¢å¤ä½†å´æ— å¤„å®¹èº«çš„é—®é¢˜ï¼›åŒç†ï¼Œè‹¥ message æœ¬èº«æœªè®¾ç½® persistent å±æ€§ï¼Œåˆ™ message çš„æŒä¹…åŒ–æ›´æ— ä»è°ˆèµ·ã€‚</p><h2 id="13-æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨ï¼Ÿ"><a href="#13-æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨ï¼Ÿ" class="headerlink" title="13. æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨ï¼Ÿ"></a>13. æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨ï¼Ÿ</h2><p> <strong>æ­»ä¿¡é˜Ÿåˆ—</strong></p><p> å½“æ¶ˆæ¯æ— æ³•è¢«æ­£ç¡®å¤„ç†æ—¶ï¼Œå¯å°†å…¶è½¬å‘åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥å¤„ç†ã€‚é€šè¿‡ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—ï¼Œèƒ½ç»Ÿä¸€å­˜å‚¨å’Œç®¡ç†æ— æ³•å¤„ç†çš„æ¶ˆæ¯ï¼Œå¹¶å€ŸåŠ©è®¾ç½®åˆé€‚çš„TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰å’ŒDLXï¼ˆæ­»ä¿¡äº¤æ¢å™¨ï¼‰ç­‰å‚æ•°ï¼Œçµæ´»æ§åˆ¶æ¶ˆæ¯çš„è½¬å‘å’Œé‡æ–°å¤„ç†ã€‚</p><p> ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—çš„ä¸»è¦æ­¥éª¤ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªæ™®é€šé˜Ÿåˆ—å’Œä¸€ä¸ªæ­»ä¿¡äº¤æ¢å™¨ï¼›</li><li>å°†æ™®é€šé˜Ÿåˆ—ç»‘å®šåˆ°æ­»ä¿¡äº¤æ¢å™¨ï¼Œå¹¶æŒ‡å®šæ­»ä¿¡é˜Ÿåˆ—çš„è·¯ç”±é”®ï¼›</li><li><p>å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯å°†æ¶ˆæ¯çš„TTLè®¾ä¸ºè¾ƒå°å€¼ï¼Œå½“æ¶ˆæ¯æœªè¢«æ¶ˆè´¹è€…å¤„ç†æ—¶ï¼Œä¼šè½¬å‘åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚</p><p>å½“éœ€åœ¨ä¸€æ®µæ—¶é—´åæ‰èƒ½å¤„ç†æŸä¸ªæ¶ˆæ¯æ—¶ï¼Œå¯ä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—ã€‚é€šè¿‡è®¾ç½®æ¶ˆæ¯çš„TTLå’ŒDLXç­‰å‚æ•°ï¼Œèƒ½å°†æ¶ˆæ¯è½¬å‘åˆ°æŒ‡å®šé˜Ÿåˆ—ï¼Œä»¥ä¾¿åœ¨ä¸€å®šæ—¶é—´åå†è¿›è¡Œå¤„ç†ã€‚é€‚ç”¨äºè®¢å•è¶…æ—¶å¤„ç†ã€æé†’ä»»åŠ¡ç­‰åœºæ™¯ã€‚</p><p>ä½¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—çš„ä¸»è¦æ­¥éª¤ï¼š</p></li><li><p>åˆ›å»ºä¸€ä¸ªæ™®é€šé˜Ÿåˆ—å’Œä¸€ä¸ªäº¤æ¢å™¨ï¼›</p></li><li>åœ¨äº¤æ¢å™¨ä¸­è®¾ç½®æ¶ˆæ¯çš„TTLå’ŒDLXç­‰å‚æ•°ï¼Œå°†æ¶ˆæ¯è½¬å‘åˆ°æŒ‡å®šé˜Ÿåˆ—ï¼›</li><li>åœ¨æŒ‡å®šé˜Ÿåˆ—ä¸­å¤„ç†æ¶ˆæ¯ã€‚ </li></ul><h2 id="14-ä»€ä¹ˆæƒ…å†µä¸‹producerä¸ä¸»åŠ¨åˆ›å»ºqueueæ˜¯å®‰å…¨çš„ï¼Ÿ"><a href="#14-ä»€ä¹ˆæƒ…å†µä¸‹producerä¸ä¸»åŠ¨åˆ›å»ºqueueæ˜¯å®‰å…¨çš„ï¼Ÿ" class="headerlink" title="14. ä»€ä¹ˆæƒ…å†µä¸‹producerä¸ä¸»åŠ¨åˆ›å»ºqueueæ˜¯å®‰å…¨çš„ï¼Ÿ"></a>14. ä»€ä¹ˆæƒ…å†µä¸‹producerä¸ä¸»åŠ¨åˆ›å»ºqueueæ˜¯å®‰å…¨çš„ï¼Ÿ</h2><p>messageæ˜¯å…è®¸ä¸¢å¤±çš„ï¼›å®ç°äº†é’ˆå¯¹æœªå¤„ç†æ¶ˆæ¯çš„republishåŠŸèƒ½ã€‚</p><h2 id="15-å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Ÿ"><a href="#15-å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Ÿ" class="headerlink" title="15. å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Ÿ"></a>15. å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Ÿ</h2><p>åªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ä»…æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…çš„æƒ…å†µä¸‹æ‰èƒ½ä¿è¯é¡ºåºï¼Œå¦åˆ™åªèƒ½é€šè¿‡å…¨å±€ ID å®ç°ï¼ˆæ¯æ¡æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ª msgIdï¼Œå…³è”çš„æ¶ˆæ¯æ‹¥æœ‰ä¸€ä¸ª parentMsgIdã€‚å¯ä»¥åœ¨æ¶ˆè´¹ç«¯å®ç°å‰ä¸€æ¡æ¶ˆæ¯æœªæ¶ˆè´¹ï¼Œä¸å¤„ç†ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼›ä¹Ÿå¯ä»¥åœ¨ç”Ÿäº§ç«¯å®ç°å‰ä¸€æ¡æ¶ˆæ¯æœªå¤„ç†å®Œä¸å‘ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚</p><h2 id="16-æ¶ˆæ¯ä»€ä¹ˆæ—¶å€™ä¼šå˜æˆæ­»ä¿¡ï¼Ÿ"><a href="#16-æ¶ˆæ¯ä»€ä¹ˆæ—¶å€™ä¼šå˜æˆæ­»ä¿¡ï¼Ÿ" class="headerlink" title="16. æ¶ˆæ¯ä»€ä¹ˆæ—¶å€™ä¼šå˜æˆæ­»ä¿¡ï¼Ÿ"></a>16. æ¶ˆæ¯ä»€ä¹ˆæ—¶å€™ä¼šå˜æˆæ­»ä¿¡ï¼Ÿ</h2><p>æ¶ˆæ¯æ‹’ç»å¹¶ä¸”æ²¡æœ‰è®¾ç½®é‡æ–°å…¥é˜Ÿï¼›æ¶ˆæ¯è¿‡æœŸï¼›æ¶ˆæ¯å †ç§¯ï¼Œå¹¶ä¸”é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ï¼Œå…ˆå…¥é˜Ÿçš„æ¶ˆæ¯ä¼šå˜æˆ DLï¼ˆæ­»ä¿¡ï¼‰ã€‚</p><h2 id="17-â­ï¸-RabbitMQäº‹åŠ¡æœºåˆ¶ï¼š"><a href="#17-â­ï¸-RabbitMQäº‹åŠ¡æœºåˆ¶ï¼š" class="headerlink" title="17.â­ï¸ RabbitMQäº‹åŠ¡æœºåˆ¶ï¼š"></a>17.â­ï¸ RabbitMQäº‹åŠ¡æœºåˆ¶ï¼š</h2><p>RabbitMQ æ”¯æŒäº‹åŠ¡æœºåˆ¶ï¼Œç”¨äºåœ¨å‘é€æ¶ˆæ¯æ—¶ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ã€‚äº‹åŠ¡æœºåˆ¶å…è®¸åœ¨å¤šä¸ª RabbitMQ æ“ä½œä¸­å£°æ˜äº‹åŠ¡ï¼Œå¹¶åœ¨æœ€ç»ˆç¡®è®¤æ¶ˆæ¯è¢«å®Œå…¨å¤„ç†ä¹‹å‰ï¼Œå°†å¤šä¸ªæ“ä½œæ‰“åŒ…ä¸ºä¸€ä¸ªåŸå­æ“ä½œã€‚</p><p>åœ¨ RabbitMQ ä¸­ï¼Œäº‹åŠ¡æœºåˆ¶çš„ä½¿ç”¨æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å¼€å¯äº‹åŠ¡ï¼šåœ¨å‘é€æ¶ˆæ¯ä¹‹å‰ï¼Œä½¿ç”¨ txSelect æ–¹æ³•å¼€å¯äº‹åŠ¡ï¼›</li><li>å‘é€æ¶ˆæ¯ï¼šä½¿ç”¨ basicPublish æ–¹æ³•å‘é€æ¶ˆæ¯ï¼›</li><li>æäº¤äº‹åŠ¡ï¼šä½¿ç”¨ txCommit æ–¹æ³•æäº¤äº‹åŠ¡ï¼Œå¦‚æœæäº¤æˆåŠŸï¼Œåˆ™æ¶ˆæ¯ä¼šè¢« RabbitMQ ç¡®è®¤ï¼Œå¦åˆ™æ¶ˆæ¯ä¼šè¢«å›æ»šï¼›</li><li>å›æ»šäº‹åŠ¡ï¼šä½¿ç”¨ txRollback æ–¹æ³•å›æ»šäº‹åŠ¡ï¼Œå¦‚æœå›æ»šæˆåŠŸï¼Œåˆ™ä¹‹å‰å‘é€çš„æ¶ˆæ¯ä¼šè¢«æ’¤é”€ï¼Œå¦åˆ™æ¶ˆæ¯ä¼šè¢«ç»§ç»­å¤„ç†ã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨äº‹åŠ¡æœºåˆ¶ä¼šå¯¹ RabbitMQ çš„æ€§èƒ½äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œå› æ­¤å»ºè®®åœ¨å¿…è¦çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨æ¶ˆæ¯çš„å¯é æ€§è¦æ±‚éå¸¸é«˜çš„åœºæ™¯ä¸‹ã€‚åœ¨æ¶ˆæ¯é‡è¾ƒå¤§çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨äº‹åŠ¡æœºåˆ¶çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¦‚æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ˆACK æœºåˆ¶ï¼‰ç­‰ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„é«˜æ€§èƒ½å’Œå¯é æ€§ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„Rabbitmqé¢è¯•é¢˜æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="MQ" scheme="https://outoflovenicoo.github.io/tags/MQ/"/>
    
  </entry>
  
  <entry>
    <title>JVMåŸºç¡€é¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-JVM%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-JVM%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/diagram.png" alt=""></p><h1 id="Javaå†…å­˜åŒºåŸŸ"><a href="#Javaå†…å­˜åŒºåŸŸ" class="headerlink" title="Javaå†…å­˜åŒºåŸŸ"></a>Javaå†…å­˜åŒºåŸŸ</h1><h2 id="1-â­ï¸è¯´è¯´JMM"><a href="#1-â­ï¸è¯´è¯´JMM" class="headerlink" title="1.â­ï¸è¯´è¯´JMM"></a>1.â­ï¸è¯´è¯´JMM</h2><p><strong>ä¸»è¦æ¦‚å¿µ</strong></p><ol><li><p><strong>å†…å­˜å¯è§æ€§</strong>ï¼šæŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹å¯¹å…¶ä»–çº¿ç¨‹çš„å¯è§æ€§ã€‚JMMï¼ˆJavaå†…å­˜æ¨¡å‹ï¼‰ç¡®ä¿ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ›´æ–°èƒ½è¢«å…¶ä»–çº¿ç¨‹åŠæ—¶çœ‹åˆ°ã€‚ä¸ºå®ç°å†…å­˜å¯è§æ€§ï¼ŒJMMå¼•å…¥â€œä¸»å†…å­˜â€å’Œâ€œå·¥ä½œå†…å­˜â€æ¦‚å¿µï¼Œçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œå…ˆåœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œç„¶åé€šè¿‡æ‰§è¡Œé¡ºåºç¬¦åˆç¨‹åºé€»è¾‘çš„è§„åˆ™åŒæ­¥åˆ°ä¸»å†…å­˜ã€‚</p></li><li><p><strong>çº¿ç¨‹é—´çš„æ“ä½œé¡ºåº</strong>ï¼šJMMå®šä¹‰äº†çº¿ç¨‹æ“ä½œçš„é¡ºåºè§„åˆ™ï¼ŒåŒ…æ‹¬ç¨‹åºé¡ºåºè§„åˆ™ã€é”è§„åˆ™ã€volatileè§„åˆ™ç­‰ã€‚ç¨‹åºé¡ºåºè§„åˆ™ä¿è¯åœ¨ä¸€ä¸ªçº¿ç¨‹å†…æ“ä½œæŒ‰ä»£ç é¡ºåºæ‰§è¡Œï¼›é”è§„åˆ™ä¿è¯è·å–å’Œé‡Šæ”¾é”çš„é¡ºåºæ€§ï¼›volatileè§„åˆ™ç¡®ä¿volatileå˜é‡çš„è¯»å†™æ“ä½œæœ‰ä¸€å®šçš„å¯è§æ€§å’Œé¡ºåºæ€§ã€‚</p></li><li><p><strong>åŸå­æ€§</strong>ï¼šåŸå­æ€§ä¿è¯äº†æ“ä½œçš„ä¸å¯åˆ†å‰²æ€§ã€‚JMMè§„å®šäº†å“ªäº›æ“ä½œæ˜¯åŸå­çš„ï¼Œåœ¨æ‰§è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­ã€‚åœ¨Javaä¸­ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹çš„è¯»å–å’Œå†™å…¥ï¼ˆå¦‚intã€longï¼‰æ˜¯åŸå­çš„ï¼Œä½†å¯¹äºå¤åˆæ“ä½œï¼ˆå¦‚i++ï¼‰åˆ™ä¸æ˜¯åŸå­çš„ã€‚ä¸ºä¿è¯åŸå­æ€§ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨åŒæ­¥æœºåˆ¶æˆ–åŸå­ç±»ï¼ˆå¦‚AtomicIntegerï¼‰ã€‚</p></li><li><p><strong>å†…å­˜å±éšœ</strong>ï¼šå†…å­˜å±éšœï¼ˆMemory Barriersï¼‰æ˜¯JMMä½¿ç”¨çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºå®ç°å†…å­˜å¯è§æ€§å’Œæ“ä½œé¡ºåºè§„åˆ™ã€‚å±éšœçš„ä½œç”¨æ˜¯é˜»æ­¢ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤çš„é‡æ’åºï¼Œç¡®ä¿ä»£ç æ‰§è¡Œé¡ºåºç¬¦åˆç¨‹åºçš„é¢„æœŸã€‚</p></li></ol><p><strong>å…³é”®æ¦‚å¿µå’Œè§„åˆ™</strong></p><ul><li><p><strong>volatileå…³é”®å­—</strong>ï¼švolatileä¿®é¥°çš„å˜é‡ä¼šè¢«ç›´æ¥è¯»å†™äºä¸»å†…å­˜ï¼Œé¿å…äº†çº¿ç¨‹å¯¹å˜é‡çš„ç¼“å­˜ï¼Œä»è€Œä¿è¯äº†å†…å­˜çš„å¯è§æ€§ã€‚æ­¤å¤–ï¼Œvolatileå˜é‡çš„è¯»æ“ä½œå…·æœ‰ä¸€å®šçš„é¡ºåºæ€§ï¼Œå³ä¿è¯åœ¨volatileå˜é‡çš„å†™æ“ä½œä¹‹å‰å‘ç”Ÿçš„æ“ä½œä¸€å®šåœ¨å†™æ“ä½œä¹‹åå¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚</p></li><li><p><strong>synchronizedå…³é”®å­—</strong>ï¼šsynchronizedå…³é”®å­—ç”¨äºå®ç°åŒæ­¥ï¼Œå®ƒä¸ä»…ä¿è¯äº†å†…å­˜å¯è§æ€§ï¼Œè¿˜ä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€‚æ¯æ¬¡è·å–å’Œé‡Šæ”¾é”æ—¶ï¼Œéƒ½ä¼šå¼ºåˆ¶åˆ·æ–°å·¥ä½œå†…å­˜ä¸­çš„å˜é‡åˆ°ä¸»å†…å­˜ï¼Œå¹¶ä¸”å¼ºåˆ¶ä½¿ä¸»å†…å­˜ä¸­çš„å˜é‡æ›´æ–°åˆ°å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ç¡®ä¿å…¶ä»–çº¿ç¨‹èƒ½çœ‹åˆ°è¿™äº›ä¿®æ”¹ã€‚</p></li><li><p><strong>happens-beforeåŸåˆ™</strong>ï¼šJMMä¸­çš„happens-beforeåŸåˆ™ç”¨äºæè¿°æ“ä½œä¹‹é—´çš„å…ˆåé¡ºåºã€‚è‹¥æ“ä½œA happens-beforeæ“ä½œBï¼Œåˆ™æ“ä½œAçš„ç»“æœå¯¹æ“ä½œBå¯è§ã€‚è¿™ä¸ªåŸåˆ™ç”¨äºç¡®å®šå¤šçº¿ç¨‹ç¨‹åºä¸­ä¸åŒæ“ä½œçš„æ‰§è¡Œé¡ºåºã€‚</p></li></ul><p>Javaå†…å­˜æ¨¡å‹é€šè¿‡å®šä¹‰ä¸€å¥—è§„åˆ™ï¼Œç¡®ä¿å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å†…å­˜è®¿é—®è¡Œä¸ºæ˜¯æœ‰åºå’Œä¸€è‡´çš„ã€‚é€šè¿‡ä½¿ç”¨volatileã€synchronizedå’ŒåŸå­ç±»ç­‰æœºåˆ¶ï¼Œç¨‹åºå‘˜å¯ä»¥æ›´å¥½åœ°æ§åˆ¶å’Œåè°ƒä»£ç æ‰§è¡Œï¼Œç¡®ä¿ä»£ç åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ­£ç¡®æ€§ ã€‚&#x20;</p><h2 id="2-å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—"><a href="#2-å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—" class="headerlink" title="2.å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—"></a>2.å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-14.png" alt=""></p><h2 id="3-è¯´ä¸‹å¯¹JVMå†…å­˜æ¨¡å‹çš„ç†è§£"><a href="#3-è¯´ä¸‹å¯¹JVMå†…å­˜æ¨¡å‹çš„ç†è§£" class="headerlink" title="3.è¯´ä¸‹å¯¹JVMå†…å­˜æ¨¡å‹çš„ç†è§£"></a>3.è¯´ä¸‹å¯¹JVMå†…å­˜æ¨¡å‹çš„ç†è§£</h2><p>é¦–å…ˆ<strong>JVMæœ¬è´¨ä¸Šæ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ç¨‹åº</strong>ã€‚æˆ‘ä»¬ç¼–å†™çš„Javaä»£ç ï¼Œç»ç”± <code>javac</code> ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶å­—èŠ‚ç ã€‚æ“ä½œç³»ç»Ÿåº•å±‚åªèƒ½æ‰§è¡Œæœºå™¨ç æŒ‡ä»¤ï¼ŒåƒCè¯­è¨€è¿™ç±»åº•å±‚è¯­è¨€ï¼Œç»ç¼–è¯‘åç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼Œå› æ­¤æ‰§è¡Œæ•ˆç‡è¾ƒé«˜ã€‚ç„¶è€Œï¼ŒCè¯­è¨€ç¨‹åºæ— æ³•è·¨å¹³å°è¿è¡Œï¼Œéœ€é’ˆå¯¹æ¯ä¸ªå¹³å°åˆ†åˆ«ç¼–è¯‘ã€‚ä¸ä¹‹ä¸åŒï¼Œ<strong>JVMå……å½“äº†å­—èŠ‚ç ä¸æœºå™¨ç ä¹‹é—´çš„æ¡¥æ¢</strong>ï¼Œé€šè¿‡åœ¨ä¸åŒå¹³å°å®‰è£…JVMï¼ŒJavaå®ç°äº†è·¨å¹³å°ç‰¹æ€§ã€‚</p><p><strong>Javaçš„å†…å­˜ç»“æ„ä¸»è¦ç”±ç±»åŠ è½½å™¨ã€è¿è¡Œæ—¶æ•°æ®åŒºã€æ‰§è¡Œå¼•æ“å’Œæœ¬åœ°æ–¹æ³•æ¥å£ç­‰éƒ¨åˆ†ç»„æˆã€‚</strong></p><p>ç±»åŠ è½½å™¨è´Ÿè´£å°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°Javaçš„è¿è¡Œæ—¶æ•°æ®åŒºä¸­ã€‚è¿è¡Œæ—¶æ•°æ®åŒºæ˜¯Javaç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨çš„å†…å­˜åŒºåŸŸï¼Œ<strong>ä»çº¿ç¨‹è§’åº¦å¯åˆ’åˆ†ä¸ºçº¿ç¨‹ç§æœ‰å’Œçº¿ç¨‹å…±äº«ä¸¤éƒ¨åˆ†</strong>ã€‚çº¿ç¨‹ç§æœ‰éƒ¨åˆ†åŒ…å«æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ã€‚æ ˆç”¨äºå­˜å‚¨æ–¹æ³•è°ƒç”¨ç›¸å…³ä¿¡æ¯ï¼Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºæœ¬åœ°æ–¹æ³•æœåŠ¡ï¼Œç¨‹åºè®¡æ•°å™¨è®°å½•å½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤åœ°å€ã€‚çº¿ç¨‹å…±äº«éƒ¨åˆ†ä¸»è¦æœ‰æ–¹æ³•åŒºå’Œå †å†…å­˜ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬åˆ›å»ºçš„å¯¹è±¡éƒ½å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼›è€Œ<strong>æ–¹æ³•åŒºå­˜å‚¨ç±»çš„å…ƒæ•°æ®ã€å­—èŠ‚ç ä»¥åŠå¸¸é‡æ± ç­‰ä¿¡æ¯</strong>ã€‚åœ¨ä¸åŒçš„JDKç‰ˆæœ¬ä¸­ï¼Œæ–¹æ³•åŒºæœ‰è¯¸å¤šå˜åŒ–ï¼Œ<strong>ä¾‹å¦‚åœ¨JDK 8ä¸­ï¼Œæ–¹æ³•åŒºè¢«ç§°ä¸ºå…ƒç©ºé—´ï¼Œå®ƒä¸å†ä½¿ç”¨å †å†…å­˜ï¼Œè€Œæ˜¯é‡‡ç”¨æœ¬åœ°å†…å­˜æ¥å­˜å‚¨ç±»ç›¸å…³æ•°æ®ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºå½“ä¸‹æ¡†æ¶å¤§é‡ä½¿ç”¨åå°„æœºåˆ¶</strong>ï¼Œè¿è¡Œæ—¶ä¼šåŠ¨æ€åŠ è½½ä¼—å¤šç±»ï¼Œè‹¥æ–¹æ³•åŒºä»åœ¨å †å†…å­˜ä¸­ï¼Œæ˜“å¯¼è‡´å †å†…å­˜éš¾ä»¥æ§åˆ¶ã€‚</p><p><strong>æ‰§è¡Œå¼•æ“å…·å¤‡é‡è¦åŠŸèƒ½</strong>ï¼Œå®ƒèƒ½å¤Ÿå°†å­—èŠ‚ç è§£é‡Šä¸ºæœºå™¨ç ï¼ŒåŒæ—¶é‡‡ç”¨JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰æŠ€æœ¯ï¼Œå°†çƒ­ç‚¹ä»£ç ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œä»¥æå‡æ‰§è¡Œæ•ˆç‡ã€‚æ­¤å¤–ï¼Œè™½ç„¶æ‰§è¡Œå¼•æ“å¹¶ä¸ç›´æ¥è´Ÿè´£åƒåœ¾å›æ”¶ï¼Œä½†å®ƒä¸åƒåœ¾å›æ”¶æœºåˆ¶ç´§å¯†åä½œï¼Œç¡®ä¿å†…å­˜çš„æœ‰æ•ˆç®¡ç†ä¸å›æ”¶ã€‚</p><p>æœ¬åœ°æ–¹æ³•æ¥å£æ˜¯Javaä¸æœ¬åœ°ä»£ç ï¼ˆå¦‚Cã€C++ï¼‰äº¤äº’çš„æ¡¥æ¢ã€‚Javaé€šè¿‡æœ¬åœ°æ–¹æ³•æ¥å£ï¼Œå¯<strong>ä»¥è°ƒç”¨æœ¬åœ°ä»£ç å®ç°ä¸€äº›Javaæœ¬èº«éš¾ä»¥å®Œæˆçš„åŠŸèƒ½ï¼Œå¦‚è®¿é—®æ“ä½œç³»ç»Ÿåº•å±‚èµ„æºã€æé«˜æ€§èƒ½æ•æ„Ÿä»£ç çš„æ‰§è¡Œæ•ˆç‡ç­‰ã€‚</strong>&#x5F53;Javaç¨‹åºè°ƒç”¨æœ¬åœ°æ–¹æ³•æ—¶ï¼ŒJVMä¼šåœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ä¸ºè¯¥æ–¹æ³•åˆ›å»ºæ ˆå¸§ï¼Œå¹¶é€šè¿‡JNIï¼ˆJava Native Interfaceï¼‰è§„èŒƒæ¥å¤„ç†Javaä¸æœ¬åœ°ä»£ç ä¹‹é—´çš„æ•°æ®ä¼ é€’å’Œæ–¹æ³•è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘æ¶‰åŠç¡¬ä»¶æ“ä½œã€å›¾å½¢å¤„ç†ç­‰åº”ç”¨æ—¶ï¼Œå¸¸å€ŸåŠ©æœ¬åœ°æ–¹æ³•è°ƒç”¨Cæˆ–C++ç¼–å†™çš„é«˜æ•ˆä»£ç æ¥å®ç°å¤æ‚åŠŸèƒ½ã€‚æœ¬åœ°æ–¹æ³•åœ¨æ‹“å±•JavaåŠŸèƒ½è¾¹ç•Œï¼Œæå‡ç³»ç»Ÿæ€§èƒ½æ–¹é¢å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚&#x20;</p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-13.png" alt=""></p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-12.png" alt=""></p><h2 id="4-å†…å­˜æº¢å‡ºä¸å†…å­˜æ³„æ¼çš„åŒºåˆ«"><a href="#4-å†…å­˜æº¢å‡ºä¸å†…å­˜æ³„æ¼çš„åŒºåˆ«" class="headerlink" title="4.å†…å­˜æº¢å‡ºä¸å†…å­˜æ³„æ¼çš„åŒºåˆ«"></a>4.å†…å­˜æº¢å‡ºä¸å†…å­˜æ³„æ¼çš„åŒºåˆ«</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image.png" alt=""></p><h2 id="5-å¯¹è±¡åˆ†é…è§„åˆ™"><a href="#5-å¯¹è±¡åˆ†é…è§„åˆ™" class="headerlink" title="5.å¯¹è±¡åˆ†é…è§„åˆ™"></a>5.å¯¹è±¡åˆ†é…è§„åˆ™</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-1.png" alt=""></p><h2 id="6-â­ï¸JVMä¸ºä»€ä¹ˆä½¿ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£"><a href="#6-â­ï¸JVMä¸ºä»€ä¹ˆä½¿ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£" class="headerlink" title="6.â­ï¸JVMä¸ºä»€ä¹ˆä½¿ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£"></a>6.â­ï¸JVMä¸ºä»€ä¹ˆä½¿ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£</h2><p>è™šæ‹Ÿæœºä½¿ç”¨å…ƒç©ºé—´æ›¿ä»£æ°¸ä¹…ä»£çš„åŸå› å¦‚ä¸‹ï¼š</p><ol><li><p>å†…å­˜ç®¡ç†ï¼šæ°¸ä¹…ä»£ç”±è™šæ‹Ÿæœºè‡ªèº«æ§åˆ¶å†…å­˜ç®¡ç†ï¼Œæ— æ³•åŠ¨æ€è°ƒæ•´ï¼›å…ƒç©ºé—´ç”¨æœ¬åœ°å†…å­˜ç®¡ç†ï¼Œå¯æŒ‰éœ€åŠ¨æ€åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œæé«˜åˆ©ç”¨ç‡ã€‚</p></li><li><p>æ°¸ä¹…ä»£å†…å­˜æº¢å‡ºï¼šæ°¸ä¹…ä»£å­˜å‚¨ç±»å…ƒæ•°æ®ç­‰ï¼Œåº”ç”¨åŠ è½½å¤§é‡ç±»æˆ–ç”¨å¤§é‡å­—ç¬¦ä¸²å¸¸é‡æ—¶å¯èƒ½æº¢å‡ºï¼›å…ƒç©ºé—´æ— å›ºå®šå¤§å°é™åˆ¶ï¼Œå¯è‡ªåŠ¨æ‰©å±•ã€‚</p></li><li><p>ç±»çš„å¸è½½ï¼šæ°¸ä¹…ä»£ç±»å¸è½½æœºåˆ¶å¤æ‚ï¼Œéš¾å®Œå…¨å¸è½½ï¼›å…ƒç©ºé—´ç”¨æœ¬åœ°å†…å­˜ï¼Œæ›´æ˜“å®ç°ç±»å¸è½½ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚</p></li><li><p>æ€§èƒ½ä¼˜åŒ–ï¼šå…ƒç©ºé—´é‡‡ç”¨æ›´é«˜æ•ˆæ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œå¦‚æŒ‡é’ˆç¢°æ’åˆ†é…å†…å­˜ï¼Œå‡å°‘ç¢ç‰‡åŒ–ï¼Œæé«˜åˆ†é…æ•ˆç‡ï¼›è¿˜æ”¯æŒå¹¶å‘ç±»åŠ è½½å’Œå¸è½½æ“ä½œï¼Œæå‡æ€§èƒ½ã€‚</p></li></ol><p>ç»¼ä¸Šï¼Œå…ƒç©ºé—´å†…å­˜ç®¡ç†æ›´å¥½ã€æ€§èƒ½æ›´é«˜ã€ç‰¹æ€§æ›´çµæ´»ï¼Œèƒ½æ›´å¥½æ»¡è¶³ç°ä»£åº”ç”¨ç¨‹åºéœ€æ±‚ï¼Œæ‰€ä»¥è™šæ‹Ÿæœºé€‰æ‹©ç”¨å…ƒç©ºé—´æ›¿ä»£æ°¸ä¹…ä»£ã€‚&#x20;</p><h2 id="7-è¯´ä¸€ä¸‹å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ"><a href="#7-è¯´ä¸€ä¸‹å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="7.è¯´ä¸€ä¸‹å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ"></a>7.è¯´ä¸€ä¸‹å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ</h2><ol><li><p>å †çš„ç‰©ç†åœ°å€åˆ†é…æ˜¯ä¸è¿ç»­çš„ï¼Œæ€§èƒ½è¾ƒæ…¢ï¼›æ ˆçš„ç‰©ç†åœ°å€åˆ†é…æ˜¯è¿ç»­çš„ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå¿«ã€‚</p></li><li><p>å †å­˜æ”¾çš„æ˜¯å¯¹è±¡çš„å®ä¾‹å’Œæ•°ç»„ï¼›æ ˆå­˜æ”¾çš„æ˜¯å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°æ ˆï¼Œè¿”å›ç»“æœç­‰ã€‚</p></li><li><p>å †æ˜¯çº¿ç¨‹å…±äº«çš„ï¼›æ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p></li></ol><h2 id="8-æ ˆæº¢å‡ºçš„åŸå› ï¼Ÿ"><a href="#8-æ ˆæº¢å‡ºçš„åŸå› ï¼Ÿ" class="headerlink" title="8.æ ˆæº¢å‡ºçš„åŸå› ï¼Ÿ"></a>8.æ ˆæº¢å‡ºçš„åŸå› ï¼Ÿ</h2><p>ç”±äº HotSpot ä¸åŒºåˆ†è™šæ‹Ÿæœºå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œè®¾ç½®æœ¬åœ°æ–¹æ³•æ ˆå¤§å°çš„å‚æ•°æ²¡æœ‰æ„ä¹‰ï¼Œæ ˆå®¹é‡åªèƒ½ç”± -Xss å‚æ•°æ¥è®¾å®šï¼Œå­˜åœ¨ä¸¤ç§å¼‚å¸¸ï¼š</p><ul><li><p>StackOverflowErrorï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡º StackOverflowErrorï¼Œä¾‹å¦‚ä¸€ä¸ªé€’å½’æ–¹æ³•ä¸æ–­è°ƒç”¨è‡ªå·±ã€‚è¯¥å¼‚å¸¸æœ‰æ˜ç¡®é”™è¯¯å †æ ˆå¯ä¾›åˆ†æï¼Œå®¹æ˜“å®šä½åˆ°é—®é¢˜æ‰€åœ¨ã€‚</p></li><li><p>OutOfMemoryErrorï¼šå¦‚æœ JVM æ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå½“æ‰©å±•æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿå†…å­˜æ—¶ä¼šæŠ›å‡º OutOfMemoryErrorã€‚HotSpot ä¸æ”¯æŒè™šæ‹Ÿæœºæ ˆæ‰©å±•ï¼Œæ‰€ä»¥é™¤éåœ¨åˆ›å»ºçº¿ç¨‹ç”³è¯·å†…å­˜æ—¶å°±å› æ— æ³•è·å¾—è¶³å¤Ÿå†…å­˜è€Œå‡ºç° OOMï¼Œå¦åˆ™åœ¨çº¿ç¨‹è¿è¡Œæ—¶æ˜¯ä¸ä¼šå› ä¸ºæ‰©å±•è€Œå¯¼è‡´æº¢å‡ºçš„ã€‚</p></li></ul><h2 id="9-è¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºçš„åŸå› ï¼Ÿ"><a href="#9-è¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºçš„åŸå› ï¼Ÿ" class="headerlink" title="9.è¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºçš„åŸå› ï¼Ÿ"></a>9.è¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºçš„åŸå› ï¼Ÿ</h2><p>String çš„ intern æ–¹æ³•æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œä½œç”¨æ˜¯å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²åŒ…å«ä¸€ä¸ªç­‰äºæ­¤ String å¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›æ± ä¸­è¿™ä¸ªå­—ç¬¦ä¸²çš„ String å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦åˆ™å°†æ­¤ String å¯¹è±¡åŒ…å«çš„å­—ç¬¦ä¸²æ·»åŠ è¿›æ± ä¸­ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å¼•ç”¨è¿”å›ã€‚</p><p>åœ¨ JDK6 åŠä¹‹å‰å¸¸é‡æ± åˆ†é…åœ¨æ°¸ä¹…ä»£ï¼Œå¯é€šè¿‡ -XX:PermSize å’Œ -XX:MaxPermSize é™åˆ¶æ°¸ä¹…ä»£å¤§å°ï¼Œé—´æ¥é™åˆ¶å¸¸é‡æ± ã€‚åœ¨ while æ­»å¾ªç¯ä¸­è°ƒç”¨ intern æ–¹æ³•å¯¼è‡´è¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºã€‚åœ¨ JDK7 åä¸ä¼šå‡ºç°è¯¥é—®é¢˜ï¼Œå› ä¸ºå­˜æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± å·²ç»è¢«ç§»è‡³å †ä¸­ã€‚</p><h2 id="10-æ–¹æ³•åŒºæº¢å‡ºçš„åŸå› ï¼Ÿ"><a href="#10-æ–¹æ³•åŒºæº¢å‡ºçš„åŸå› ï¼Ÿ" class="headerlink" title="10.æ–¹æ³•åŒºæº¢å‡ºçš„åŸå› ï¼Ÿ"></a>10.æ–¹æ³•åŒºæº¢å‡ºçš„åŸå› ï¼Ÿ</h2><p>æ–¹æ³•åŒºä¸»è¦å­˜æ”¾<strong>ç±»å‹ä¿¡æ¯ï¼Œå¦‚ç±»åã€è®¿é—®ä¿®é¥°ç¬¦ã€å¸¸é‡æ± ã€å­—æ®µæè¿°ã€æ–¹æ³•æè¿°</strong>ç­‰ã€‚åªè¦ä¸æ–­åœ¨è¿è¡Œæ—¶äº§ç”Ÿå¤§é‡ç±»ï¼Œæ–¹æ³•åŒºå°±ä¼šæº¢å‡ºã€‚ä¾‹å¦‚ä½¿ç”¨ JDK åå°„æˆ– CGLib ç›´æ¥æ“ä½œå­—èŠ‚ç åœ¨è¿è¡Œæ—¶ç”Ÿæˆå¤§é‡çš„ç±»ã€‚å¾ˆå¤šæ¡†æ¶å¦‚ Springã€Hibernate ç­‰å¯¹ç±»å¢å¼ºæ—¶éƒ½ä¼šä½¿ç”¨ CGLib è¿™ç±»å­—èŠ‚ç æŠ€æœ¯ï¼Œå¢å¼ºçš„ç±»è¶Šå¤šå°±éœ€è¦è¶Šå¤§çš„æ–¹æ³•åŒºä¿è¯åŠ¨æ€ç”Ÿæˆçš„æ–°ç±»å‹å¯ä»¥è½½å…¥å†…å­˜ï¼Œä¹Ÿå°±æ›´å®¹æ˜“å¯¼è‡´æ–¹æ³•åŒºæº¢å‡ºã€‚</p><p>JDK8 ä½¿ç”¨å…ƒç©ºé—´å–ä»£æ°¸ä¹…ä»£ï¼ŒHotSpot æä¾›äº†ä¸€äº›å‚æ•°ä½œä¸ºå…ƒç©ºé—´é˜²å¾¡æªæ–½ï¼Œä¾‹å¦‚ -XX:MetaspaceSize æŒ‡å®šå…ƒç©ºé—´åˆå§‹å¤§å°ï¼Œè¾¾åˆ°è¯¥å€¼ä¼šè§¦å‘ GC è¿›è¡Œç±»å‹å¸è½½ï¼ŒåŒæ—¶æ”¶é›†å™¨ä¼šå¯¹è¯¥å€¼è¿›è¡Œè°ƒæ•´ï¼Œå¦‚æœé‡Šæ”¾å¤§é‡ç©ºé—´å°±é€‚å½“é™ä½è¯¥å€¼ï¼Œå¦‚æœé‡Šæ”¾å¾ˆå°‘ç©ºé—´å°±é€‚å½“æé«˜ã€‚</p><h1 id="ç±»åŠ è½½æœºåˆ¶"><a href="#ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="ç±»åŠ è½½æœºåˆ¶"></a>ç±»åŠ è½½æœºåˆ¶</h1><h2 id="1-è¯´ä¸‹ç±»åŠ è½½å™¨æœºåˆ¶ä¸åŒäº²å§”æ´¾"><a href="#1-è¯´ä¸‹ç±»åŠ è½½å™¨æœºåˆ¶ä¸åŒäº²å§”æ´¾" class="headerlink" title="1.è¯´ä¸‹ç±»åŠ è½½å™¨æœºåˆ¶ä¸åŒäº²å§”æ´¾"></a>1.è¯´ä¸‹ç±»åŠ è½½å™¨æœºåˆ¶ä¸åŒäº²å§”æ´¾</h2><p>é¦–å…ˆ<strong>ç±»åŠ è½½å™¨</strong>ä¸»è¦æ˜¯å¤æ‚ä»å„ç§æ¸ é“å°†æˆ‘ä»¬çš„å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°æˆ‘ä»¬çš„å†…å­˜ä¸­ï¼Œç„¶ååº•å±‚ä¼šè°ƒç”¨nativeæ–¹æ³•å°†æˆ‘ä»¬çš„ç±»ç›¸å…³ä¿¡æ¯å†™å…¥åˆ°æˆ‘ä»¬<strong>å…ƒç©ºé—´</strong>ä¸­ï¼Œä¸»è¦ä¿å­˜æˆ‘ä»¬ç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç„¶åä¼šåœ¨æ–¹æ³•åŒºåˆ›å»ºå½“å‰ç±»çš„classå¯¹è±¡ï¼Œæ–¹ä¾¿æˆ‘ä»¬åç»­é€šè¿‡javaä»£ç è·å–ç±»ä¿¡æ¯ï¼Œé‡Œé¢ä¼šæŒæœ‰ä¸€ä¸ªæŒ‡å‘å…ƒç©ºé—´ä¸­ç±»çš„æŒ‡é’ˆã€‚</p><p>ç±»åŠ è½½å™¨ä¸»è¦æœ‰å››å¤§ç§ï¼Œ<strong>ç³»ç»Ÿã€æ‰©å±•ã€åº”ç”¨ä»¥åŠè‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼Œå†…éƒ¨ç±»åŠ è½½çš„æœºåˆ¶é‡‡ç”¨çš„æ˜¯åŒäº²å§”æ´¾æœºåˆ¶ï¼Œä¸»è¦ç›®çš„æ˜¯<strong>é˜²æ­¢æˆ‘ä»¬çš„æ ¸å¿ƒç±»åº“è¢«ä¿®æ”¹</strong>ï¼Œä»¥åŠæˆ‘ä»¬çš„ç±»è¢«é‡å¤åŠ è½½ï¼Œåº•å±‚åŸç†å°±æ˜¯åŠ è½½ç±»çš„æ—¶å€™å±‚å±‚å‘ä¸Šå§”æ‰˜ï¼Œåˆ°é¡¶å±‚ç±»åŠ è½½å™¨åˆ¤æ–­æœ‰æ²¡æœ‰åŠ è½½è¿‡è¿™ä¸ªç±»ï¼Œè‹¥æ²¡æœ‰å°è¯•åŠ è½½ï¼Œå¦‚æœåŠ è½½ä¸åˆ°å†å±‚å±‚å‘ä¸‹å§”æ‰˜é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚ä¾‹å¦‚æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªåŒ…åå’Œç±»åå®Œå…¨ç›¸åŒçš„Stringï¼Œå®ƒä¼šå±‚å±‚å‘ä¸Šä¼ é€’ç»™ç³»ç»Ÿç±»åŠ è½½å™¨ï¼Œå‘ç°æ²¡æœ‰åŠ è½½è¿‡å°±å°è¯•åŠ è½½ï¼Œç»“æœä¸€ä¸‹å­åŠ è½½åˆ°äº†ï¼Œé‚£å°±ç”¨å®ƒåŠ è½½çš„ã€‚åº•å±‚çš„å®ç°æ˜¯åœ¨æˆ‘ä»¬defineclassæ–¹æ³•ä¸­å®ç°çš„ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥<strong>é€šè¿‡å®ç°Classloaderæ¥å®ç°æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»åŠ è½½é€»è¾‘</strong>ï¼Œç”šè‡³æ‰“ç ´åŒäº²å§”æ´¾æœºåˆ¶ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»åŠ è½½å™¨å¯¹æˆ‘ä»¬çš„å­—èŠ‚ç è¿›è¡ŒåŠ è§£å¯†ç­‰ã€‚&#x20;</p><h2 id="2-ä»€ä¹ˆæ˜¯ç±»åŠ è½½ï¼Ÿç±»åŠ è½½çš„è¿‡ç¨‹ï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯ç±»åŠ è½½ï¼Ÿç±»åŠ è½½çš„è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="2.ä»€ä¹ˆæ˜¯ç±»åŠ è½½ï¼Ÿç±»åŠ è½½çš„è¿‡ç¨‹ï¼Ÿ"></a>2.ä»€ä¹ˆæ˜¯ç±»åŠ è½½ï¼Ÿç±»åŠ è½½çš„è¿‡ç¨‹ï¼Ÿ</h2><p><img src="../../../../../../../images/image-10.png" alt=""></p><p>ç±»åŠ è½½æµç¨‹ï¼Œæœ‰åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–è¿™å‡ ä¸ªæ­¥éª¤ã€‚</p><ul><li><p>åŠ è½½ï¼š</p><ol><li><p>é€šè¿‡ç±»çš„å…¨é™å®šåè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚</p></li><li><p>å°†å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚</p></li><li><p>åœ¨<strong>å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„ Class å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºç±»ä¿¡æ¯çš„è®¿é—®å…¥å£</strong>ã€‚</p></li></ol></li><li><p>éªŒè¯ï¼š<strong>ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆè™šæ‹Ÿæœºè§„èŒƒï¼Œä¿è¯åœ¨è¿è¡Œåä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚</strong>&#x4E3B;è¦åŒ…æ‹¬å››ç§éªŒè¯ï¼šæ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå…ƒæ•°æ®éªŒè¯ï¼Œå­—èŠ‚ç éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯ã€‚</p><ul><li><p>æ–‡ä»¶æ ¼å¼éªŒè¯ï¼šéªŒè¯è¯»è¿›æ¥çš„å­—èŠ‚æµæ˜¯å¦ç¬¦åˆ Class æ ‡å‡†æ ¼å¼ã€‚</p></li><li><p>å…ƒæ•°æ®éªŒè¯ï¼šæ ¼å¼å¯¹äº†ä¹‹åï¼ŒéªŒè¯ä¸€ä¸‹é‡Œè¾¹çš„æ•°æ®åˆä¸åˆç†ã€‚æ¯”å¦‚ï¼šè¿™ä¸ªç±»æ˜¯å¦æœ‰çˆ¶ç±»ï¼ˆé™¤äº† java.lang.Object ä¹‹å¤–ï¼Œæ‰€æœ‰çš„ç±»éƒ½åº”å½“æœ‰çˆ¶ç±»ï¼‰ã€‚</p></li><li><p>å­—èŠ‚ç éªŒè¯ï¼šåˆ†æç±»çš„æ–¹æ³•ä½“ï¼ˆClass æ–‡ä»¶ä¸­çš„ Code å±æ€§ï¼‰ï¼Œç¡®ä¿æ–¹æ³•åœ¨è¿è¡Œæ—¶ä¸ä¼šå±å®³è™šæ‹Ÿæœºã€‚</p></li><li><p>ç¬¦å·å¼•ç”¨éªŒè¯ï¼ˆå‘ç”Ÿåœ¨è§£æé˜¶æ®µï¼‰ï¼šæ£€æŸ¥å¸¸é‡æ± ä¸­å¼•ç”¨çš„å¤–éƒ¨ç±»æ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®ã€‚</p></li></ul></li><li><p>å‡†å¤‡ï¼šä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µã€‚å…¶ä¸­å¦‚æœæ˜¯ final ä¿®é¥°çš„ï¼Œæ„å‘³ç€åœ¨ Class æ–‡ä»¶ä¸­ï¼Œè¯¥å­—æ®µçš„å±æ€§è¡¨ä¸­å­˜åœ¨ ConstantValue å±æ€§ï¼Œæ­¤æ—¶åˆå€¼è®¾ç½®ä¸ºä»£ç é‡Œå†™çš„ã€‚å¦‚æœä¸æ˜¯ï¼Œå°±è®¾ç½®ä¸ºé›¶å€¼ï¼Œç­‰åˆ°åˆå§‹åŒ–é˜¶æ®µå†èµ‹å€¼ã€‚</p></li><li><p>è§£æï¼šè™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ç¬¦å·å¼•ç”¨ç”¨äºæè¿°ç›®æ ‡ï¼Œç›´æ¥å¼•ç”¨ç›´æ¥æŒ‡å‘ç›®æ ‡çš„åœ°å€ã€‚</p></li><li><p>åˆå§‹åŒ–ï¼šå¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ä»£ç ï¼Œåˆå§‹åŒ–é˜¶æ®µæ˜¯è°ƒç”¨ç±»æ„é€ å™¨çš„è¿‡ç¨‹ã€‚</p></li></ul><h2 id="3-ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨æœ‰å“ªäº›ï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="3.ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨æœ‰å“ªäº›ï¼Ÿ"></a>3.ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨æœ‰å“ªäº›ï¼Ÿ</h2><p><img src="../../../../../../../images/image-11.png" alt=""></p><p>å®ç°é€šè¿‡ç±»çš„å…¨é™å®šåè·å–è¯¥ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµçš„ä»£ç å—å«åšç±»åŠ è½½å™¨ã€‚</p><p>ä¸»è¦æœ‰ä»¥ä¸‹å››ç§ç±»åŠ è½½å™¨ï¼š</p><ul><li><p>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰ï¼šç”¨æ¥åŠ è½½ Java æ ¸å¿ƒç±»åº“ï¼Œæ— æ³•è¢« Java ç¨‹åºç›´æ¥å¼•ç”¨ã€‚</p></li><li><p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆextensions class loaderï¼‰ï¼šå®ƒç”¨æ¥åŠ è½½ Java çš„æ‰©å±•åº“ã€‚Java è™šæ‹Ÿæœºçš„å®ç°ä¼šæä¾›ä¸€ä¸ªæ‰©å±•åº“ç›®å½•ã€‚è¯¥ç±»åŠ è½½å™¨åœ¨æ­¤ç›®å½•é‡Œé¢æŸ¥æ‰¾å¹¶åŠ è½½ Java ç±»ã€‚</p></li><li><p>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆapp class loaderï¼‰ï¼šå®ƒæ ¹æ®åº”ç”¨çš„ç±»è·¯å¾„æ¥åŠ è½½ Java ç±»ã€‚å¯é€šè¿‡ ClassLoader.getSystemClassLoader () è·å–å®ƒã€‚</p></li><li><p>è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆcustom class loaderï¼‰ï¼šé€šè¿‡ç»§æ‰¿ java.lang.ClassLoader ç±»çš„æ–¹å¼å®ç°ã€‚</p></li></ul><h2 id="4-ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"><a href="#4-ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ" class="headerlink" title="4.ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"></a>4.ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</h2><p><strong>ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°ä¸€ä¸ªç±»çš„åŠ è½½è¯·æ±‚æ—¶ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å°è¯•å»åŠ è½½å®ƒï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆ</strong>ï¼Œè¿™æ ·å±‚å±‚å§”æ´¾ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½ä¼šä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚</p><p>åŒäº²å§”æ´¾æ¨¡å‹çš„å…·ä½“å®ç°ä»£ç åœ¨ java.lang.ClassLoader ä¸­ï¼Œæ­¤ç±»çš„ loadClass () æ–¹æ³•è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼šå…ˆæ£€æŸ¥ç±»æ˜¯å¦å·²ç»åŠ è½½è¿‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®©çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½ã€‚å½“çˆ¶ç±»åŠ è½½å™¨åŠ è½½å¤±è´¥æ—¶æŠ›å‡º ClassNotFoundExceptionï¼Œæ­¤æ—¶å°è¯•è‡ªå·±å»åŠ è½½ã€‚</p><h2 id="5-ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ" class="headerlink" title="5.ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"></a>5.ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</h2><p>åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„ï¼šå¦‚æœæ²¡æœ‰åŒäº²å§”æ´¾æ¨¡å‹è€Œæ˜¯ç”±å„ä¸ªç±»åŠ è½½å™¨è‡ªè¡ŒåŠ è½½çš„è¯ï¼Œå¦‚æœç”¨æˆ·ç¼–å†™äº†ä¸€<strong>ä¸ª java.lang.Object çš„åŒåç±»å¹¶æ”¾åœ¨ ClassPath&#x20;</strong>&#x4E2D;ï¼Œå¤šä¸ªç±»åŠ è½½å™¨éƒ½å»åŠ è½½è¿™ä¸ªç±»åˆ°å†…å­˜ä¸­ï¼Œç³»ç»Ÿä¸­å°†ä¼šå‡ºç°å¤šä¸ªä¸åŒçš„ Object ç±»ï¼Œé‚£ä¹ˆç±»ä¹‹é—´çš„æ¯”è¾ƒç»“æœåŠç±»çš„å”¯ä¸€æ€§å°†æ— æ³•ä¿è¯ã€‚</p><h2 id="6-å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ï¼Ÿ"><a href="#6-å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ï¼Ÿ" class="headerlink" title="6.å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ï¼Ÿ"></a>6.å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ï¼Ÿ</h2><p>ä»»æ„ä¸€ä¸ªç±»éƒ½å¿…é¡»ç”±ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«å…±åŒç¡®ç«‹å…¶åœ¨è™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ã€‚</p><p>ä¸¤ä¸ªç±»åªæœ‰ç”±åŒä¸€ç±»åŠ è½½å™¨åŠ è½½æ‰æœ‰æ¯”è¾ƒæ„ä¹‰ï¼Œå¦åˆ™å³ä½¿ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª Class æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ª JVM åŠ è½½ï¼Œåªè¦ç±»åŠ è½½å™¨ä¸åŒï¼Œè¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸ç­‰ã€‚</p><p><strong>åŒä¸€ä¸ªç±»ï¼šç›¸åŒç±»åŠ è½½å™¨åŠ è½½ + ç›¸åŒç±»é™å®šå</strong></p><h2 id="7-ç±»çš„å®ä¾‹åŒ–é¡ºåºï¼Ÿ"><a href="#7-ç±»çš„å®ä¾‹åŒ–é¡ºåºï¼Ÿ" class="headerlink" title="7.ç±»çš„å®ä¾‹åŒ–é¡ºåºï¼Ÿ"></a>7.ç±»çš„å®ä¾‹åŒ–é¡ºåºï¼Ÿ</h2><ol><li><p>çˆ¶ç±»ä¸­çš„ static ä»£ç å—ï¼Œå½“å‰ç±»çš„ static ä»£ç å—</p></li><li><p>çˆ¶ç±»çš„æ™®é€šä»£ç å—</p></li><li><p>çˆ¶ç±»çš„æ„é€ å‡½æ•°</p></li><li><p>å½“å‰ç±»æ™®é€šä»£ç å—</p></li><li><p>å½“å‰ç±»çš„æ„é€ å‡½æ•°</p></li></ol><h1 id="åƒåœ¾å›æ”¶å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥"><a href="#åƒåœ¾å›æ”¶å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥" class="headerlink" title="åƒåœ¾å›æ”¶å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥"></a>åƒåœ¾å›æ”¶å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥</h1><h2 id="1-æ–°ç”Ÿä»£GCå’Œè€å¹´ä»£GCæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#1-æ–°ç”Ÿä»£GCå’Œè€å¹´ä»£GCæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="1.æ–°ç”Ÿä»£GCå’Œè€å¹´ä»£GCæœ‰ä»€ä¹ˆåŒºåˆ«"></a>1.æ–°ç”Ÿä»£GCå’Œè€å¹´ä»£GCæœ‰ä»€ä¹ˆåŒºåˆ«</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-6.png" alt=""></p><h2 id="2-åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#2-åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="2.åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº›ï¼Ÿ"></a>2.åƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº›ï¼Ÿ</h2><blockquote><p><a href="https://javaguide.cn/java/jvm/jvm-garbage-collection.html">JVMåƒåœ¾å›æ”¶è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰</a></p></blockquote><p>åƒåœ¾å›æ”¶ç®—æ³•æœ‰å››ç§ï¼Œåˆ†åˆ«æ˜¯æ ‡è®°æ¸…é™¤æ³•ã€æ ‡è®°æ•´ç†æ³•ã€å¤åˆ¶ç®—æ³•ã€åˆ†ä»£æ”¶é›†ç®—æ³•ã€‚</p><ul><li><p><strong>æ ‡è®°æ¸…é™¤ç®—æ³•</strong>ï¼šé¦–å…ˆåˆ©ç”¨å¯è¾¾æ€§å»éå†å†…å­˜ï¼ŒæŠŠåƒåœ¾å¯¹è±¡è¿›è¡Œæ ‡è®°ã€‚æ ‡è®°ç»“æŸåç»Ÿä¸€å°†æ‰€æœ‰åƒåœ¾å¯¹è±¡å›æ”¶æ‰ã€‚è¿™ç§åƒåœ¾å›æ”¶ç®—æ³•æ•ˆç‡è¾ƒä½ï¼Œå¹¶ä¸”ä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„ç©ºé—´ç¢ç‰‡ã€‚</p></li><li><p><strong>å¤åˆ¶ç®—æ³•</strong>ï¼šåŠåŒºå¤åˆ¶ï¼Œç”¨äºæ–°ç”Ÿä»£åƒåœ¾å›æ”¶ã€‚å°†å†…å­˜åˆ†ä¸ºå¤§å°ç›¸åŒçš„ä¸¤å—ï¼Œæ¯æ¬¡ä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™ä¸€å—çš„å†…å­˜ä½¿ç”¨å®Œåï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—å»ï¼Œç„¶åå†æŠŠä½¿ç”¨çš„ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚ç‰¹ç‚¹ï¼šå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆï¼Œä½†å¯ç”¨å†…å­˜ç¼©å°ä¸ºäº†åŸæ¥çš„ä¸€åŠï¼Œæµªè´¹ç©ºé—´ã€‚</p></li><li><p><strong>æ ‡è®°æ•´ç†ç®—æ³•</strong>ï¼šæ ¹æ®è€å¹´ä»£çš„ç‰¹ç‚¹æå‡ºçš„ä¸€ç§æ ‡è®°ç®—æ³•ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸æ ‡è®° - æ¸…é™¤ç®—æ³•ä¸€æ ·ï¼Œä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚</p></li><li><p><strong>åˆ†ä»£æ”¶é›†ç®—æ³•</strong>ï¼šæ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚ä¸€èˆ¬å°†å †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚</p><ul><li><p>æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶ç®—æ³•ã€‚</p></li><li><p>è€å¹´ä»£ä½¿ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•æˆ–è€…æ ‡è®°æ•´ç†ç®—æ³•ã€‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•æ¯”è¾ƒåˆé€‚ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚è€å¹´ä»£å¯¹è±¡å­˜æ´»ç‡é«˜ï¼Œé€‚åˆä½¿ç”¨æ ‡è®° - æ¸…ç†æˆ–è€…æ ‡è®° - æ•´ç†ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚</p></li></ul></li></ul><h2 id="3-æœ‰å“ªäº›åƒåœ¾å›æ”¶å™¨ï¼Ÿ"><a href="#3-æœ‰å“ªäº›åƒåœ¾å›æ”¶å™¨ï¼Ÿ" class="headerlink" title="3.æœ‰å“ªäº›åƒåœ¾å›æ”¶å™¨ï¼Ÿ"></a>3.æœ‰å“ªäº›åƒåœ¾å›æ”¶å™¨ï¼Ÿ</h2><blockquote><p><a href="https://mcnfxurl5vzo.feishu.cn/wiki/Lp6uws3rFiEDjXkkyGGchQWQnVH#share-SO1ldvaSRou7kDxqb6ycHGbMnrc"> åšå®¢</a></p></blockquote><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-9.png" alt=""></p><p>åƒåœ¾æ”¶é›†å™¨ï¼ˆGCï¼ŒGarbage Collectorï¼‰å’Œå…·ä½“ JVM å®ç°ç´§å¯†ç›¸å…³ï¼Œä¸åŒå‚å•†ï¼ˆIBMã€Oracle ï¼‰ã€ä¸åŒç‰ˆæœ¬çš„ JVM æä¾›çš„é€‰æ‹©ä¸åŒï¼Œä¸»è¦ä»‹ç» Oracle JDK çš„åƒåœ¾æ”¶é›†å™¨ï¼š</p><ul><li><p><strong>Serial GCï¼š</strong>&#x6700;å¤è€çš„åƒåœ¾æ”¶é›†å™¨ï¼Œæ”¶é›†å·¥ä½œå•çº¿ç¨‹ï¼Œåƒåœ¾æ”¶é›†æ—¶ä¼šè¿›å…¥ â€œStop - The - Worldâ€ çŠ¶æ€ã€‚å•çº¿ç¨‹è®¾è®¡æ„å‘³ç€ç²¾ç®€çš„ GC å®ç°ï¼Œæ— éœ€ç»´æŠ¤å¤æ‚æ•°æ®ç»“æ„ï¼Œåˆå§‹åŒ–ç®€å•ï¼Œæ˜¯ Client æ¨¡å¼ä¸‹ JVM çš„é»˜è®¤é€‰é¡¹ã€‚è€å¹´ä»£å®ç°ä¸º Serial Oldï¼Œé‡‡ç”¨æ ‡è®° - æ•´ç†ï¼ˆMark Compactï¼‰ç®—æ³•ï¼ŒåŒºåˆ«äºæ–°ç”Ÿä»£å¤åˆ¶ç®—æ³•ã€‚å¯¹åº” JVM å‚æ•°ï¼š-XX:+UseSerialGCã€‚</p></li><li><p>ParNew GCï¼šæ–°ç”Ÿä»£ GC å®ç°ï¼Œæ˜¯ Serial GC çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œå¸¸è§åº”ç”¨åœºæ™¯æ˜¯é…åˆè€å¹´ä»£çš„ CMS GC å·¥ä½œã€‚å¯¹åº”å‚æ•°ï¼š-XX:+UseConcMarkSweepGC -XX:+UseParNewGCã€‚</p></li><li><p><strong>CMS</strong>ï¼ˆConcurrent Mark Sweepï¼‰GCï¼šåŸºäºæ ‡è®° - æ¸…é™¤ï¼ˆMark - Sweepï¼‰ç®—æ³•ï¼Œè®¾è®¡ç›®æ ‡æ˜¯å°½é‡å‡å°‘åœé¡¿æ—¶é—´ï¼Œå¯¹ Web ç­‰ååº”æ—¶é—´æ•æ„Ÿçš„åº”ç”¨é‡è¦ã€‚å­˜åœ¨å†…å­˜ç¢ç‰‡åŒ–é—®é¢˜ï¼Œéš¾ä»¥é¿å…é•¿æ—¶é—´è¿è¡Œä¸‹å‘ç”Ÿ full GC å¯¼è‡´æ¶åŠ£åœé¡¿ï¼Œä¸”ä¼šå ç”¨æ›´å¤š CPU èµ„æºï¼Œå’Œç”¨æˆ·çº¿ç¨‹äº‰æŠ¢ã€‚</p></li><li><p><strong>Parallel GC</strong>ï¼šæ—©æœŸ JDK 8 ç­‰ç‰ˆæœ¬ä¸­ï¼Œæ˜¯ server æ¨¡å¼ JVM çš„é»˜è®¤ GC é€‰æ‹©ï¼Œååé‡ä¼˜å…ˆã€‚ç®—æ³•å’Œ Serial GC ç›¸ä¼¼ä½†å®ç°æ›´å¤æ‚ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£ GC å¹¶è¡Œè¿›è¡Œï¼Œåœ¨å¸¸è§æœåŠ¡å™¨ç¯å¢ƒä¸­æ›´é«˜æ•ˆã€‚å¼€å¯é€‰é¡¹ï¼š-XX:+UseParallelGCã€‚å¼•å…¥å¼€å‘è€…å‹å¥½é…ç½®é¡¹ï¼Œå¯è®¾ç½®æš‚åœæ—¶é—´æˆ–ååé‡ç­‰ç›®æ ‡ï¼ŒJVM è‡ªåŠ¨é€‚åº”æ€§è°ƒæ•´ï¼Œå¦‚ -XX:MaxGCPauseMillis=value ã€-XX:GCTimeRatio=Nï¼ˆGC æ—¶é—´å’Œç”¨æˆ·æ—¶é—´æ¯”ä¾‹ = 1 / (N + 1)ï¼‰ ã€‚</p></li><li><p><strong>G1 GCï¼š</strong>&#x517C;é¡¾ååé‡å’Œåœé¡¿æ—¶é—´çš„ GC å®ç°ï¼Œæ˜¯ Oracle JDK 9 ä»¥åçš„é»˜è®¤ GC é€‰é¡¹ã€‚å¯ç›´è§‚è®¾å®šåœé¡¿æ—¶é—´ç›®æ ‡ï¼Œç›¸æ¯” CMS GCï¼Œæœ€å·®æƒ…å†µè¡¨ç°æ›´å¥½ã€‚ä»å­˜åœ¨å¹´ä»£æ¦‚å¿µï¼Œä½†å†…å­˜ç»“æ„æ˜¯ç±»ä¼¼æ£‹ç›˜çš„ä¸€ä¸ªä¸ª regionã€‚Region ä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•ï¼Œæ•´ä½“å¯çœ‹ä½œæ ‡è®° - æ•´ç†ï¼ˆMark - Compactï¼‰ç®—æ³•ï¼Œèƒ½æœ‰æ•ˆé¿å…å†…å­˜ç¢ç‰‡ï¼ŒJava å †å¾ˆå¤§æ—¶ä¼˜åŠ¿æ›´æ˜æ˜¾ã€‚ååé‡å’Œåœé¡¿è¡¨ç°ä¸é”™ä¸”ä¸æ–­å®Œå–„ï¼ŒCMS åœ¨ JDK 9 ä¸­è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆdeprecatedï¼‰ã€‚</p></li></ul><h2 id="4-è¯´ä¸‹JVMä¸­ä¸€æ¬¡å®Œæ•´çš„-GC-æµç¨‹"><a href="#4-è¯´ä¸‹JVMä¸­ä¸€æ¬¡å®Œæ•´çš„-GC-æµç¨‹" class="headerlink" title="4.è¯´ä¸‹JVMä¸­ä¸€æ¬¡å®Œæ•´çš„ GC æµç¨‹"></a>4.è¯´ä¸‹JVMä¸­ä¸€æ¬¡å®Œæ•´çš„ GC æµç¨‹</h2><p>JVMä¸­åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æµç¨‹ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>æ ‡è®°é˜¶æ®µ</strong>ï¼šä»æ ¹å¯¹è±¡ï¼ˆå¦‚æ´»åŠ¨çº¿ç¨‹æ ˆå¸§ä¸­å±€éƒ¨å˜é‡ã€é™æ€å˜é‡ã€JNIå¼•ç”¨ç­‰ï¼‰å‡ºå‘ï¼Œé€šè¿‡å¼•ç”¨é“¾æ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡ã€‚</p></li><li><p><strong>åƒåœ¾æ ‡è®°</strong>ï¼šæ ‡è®°é˜¶æ®µåç¡®å®šä¸å¯è¾¾å¯¹è±¡ä¸ºåƒåœ¾å¯¹è±¡ï¼Œå°†è¢«å›æ”¶ã€‚</p></li><li><p><strong>åƒåœ¾å›æ”¶</strong>ï¼šæ‰§è¡Œå›æ”¶æ“ä½œï¼Œå›æ”¶è¢«æ ‡è®°åƒåœ¾å¯¹è±¡å ç”¨å†…å­˜ç©ºé—´ï¼Œå›æ”¶æ–¹å¼æœ‰æ ‡è®° - æ¸…é™¤ã€å¤åˆ¶ã€æ ‡è®° - æ•´ç†ç­‰ç®—æ³•ã€‚</p></li><li><p><strong>å†…å­˜æ•´ç†</strong>ï¼šå›æ”¶åå¯èƒ½äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œä¸ºæé«˜åˆ©ç”¨ç‡ï¼ŒGCå¯èƒ½å¯¹å†…å­˜ç©ºé—´æ•´ç†ï¼Œç´§å‡‘æ’åˆ—å­˜æ´»å¯¹è±¡ï¼Œä¾¿äºåˆ†é…æ–°å¯¹è±¡ã€‚</p></li><li><p><strong>å†…å­˜åˆ†é…</strong>ï¼šå›æ”¶å’Œæ•´ç†å®Œæˆåï¼ŒGCä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´ï¼Œåˆ†é…æ–¹å¼æœ‰æŒ‡é’ˆç¢°æ’ã€ç©ºé—²åˆ—è¡¨ç­‰ç®—æ³•ã€‚</p></li><li><p><strong>é‡æ–°åˆ†é…å¯¹è±¡å¼•ç”¨</strong>ï¼šå›æ”¶å’Œå†…å­˜åˆ†é…å®Œæˆåï¼ŒGCæ›´æ–°å¯¹è±¡é—´å¼•ç”¨å…³ç³»ï¼Œç¡®ä¿å¼•ç”¨æŒ‡å‘æ­£ç¡®å¯¹è±¡ã€‚</p></li></ol><p>ä¸åŒGCç®—æ³•å’Œå®ç°æœ‰å·®å¼‚ï¼Œä½†æ•´ä½“æµç¨‹å¤§è‡´ç›¸åŒï¼Œ<strong>ç›®æ ‡æ˜¯å›æ”¶åƒåœ¾å¯¹è±¡ã€é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œå¹¶å°½é‡å‡å°‘å¯¹åº”ç”¨ç¨‹åºå½±å“ï¼Œä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œã€‚</strong>&#x20;</p><h2 id="5-ä»€ä¹ˆæ˜¯æŒ‡é’ˆç¢°æ’"><a href="#5-ä»€ä¹ˆæ˜¯æŒ‡é’ˆç¢°æ’" class="headerlink" title="5.ä»€ä¹ˆæ˜¯æŒ‡é’ˆç¢°æ’"></a>5.ä»€ä¹ˆæ˜¯æŒ‡é’ˆç¢°æ’</h2><p>åœ¨ Java ä¸­ï¼ŒæŒ‡é’ˆç¢°æ’æ˜¯ä¸€ç§åƒåœ¾æ”¶é›†ç®—æ³•ä¸­ç”¨äºåˆ†é…å†…å­˜çš„ä¸€ç§æ–¹å¼ã€‚å®ƒé€šå¸¸ç”¨äºå®ç°åœé¡¿æ—¶é—´è¾ƒçŸ­çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¦‚<strong>å¤åˆ¶ç®—æ³•å’Œæ ‡è®° - æ•´ç†ç®—æ³•</strong>ã€‚</p><p>æŒ‡é’ˆç¢°æ’çš„åŸºæœ¬æ€æƒ³æ˜¯å°†å †å†…å­˜åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼š<strong>ä¸€ä¸ªæ˜¯å·²åˆ†é…çš„å¯¹è±¡åŒºåŸŸï¼Œå¦ä¸€ä¸ªæ˜¯æœªåˆ†é…çš„ç©ºé—²åŒºåŸŸã€‚</strong>&#x901A;è¿‡ä¸€ä¸ªæŒ‡é’ˆæ¥åˆ†éš”è¿™ä¸¤ä¸ªåŒºåŸŸã€‚å½“éœ€è¦åˆ†é…å¯¹è±¡æ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨å°†å¯¹è±¡çš„å¤§å°ä¸ç©ºé—²åŒºåŸŸçš„å¤§å°è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç©ºé—²åŒºåŸŸè¶³å¤Ÿå®¹çº³å¯¹è±¡ï¼Œåˆ™å°†æŒ‡é’ˆç¢°æ’æŒ‡é’ˆå‘å‰ç§»åŠ¨å¯¹è±¡çš„å¤§å°ï¼Œå¹¶è¿”å›æŒ‡é’ˆç¢°æ’æŒ‡é’ˆçš„æ—§å€¼ä½œä¸ºå¯¹è±¡çš„èµ·å§‹åœ°å€ã€‚å¦‚æœç©ºé—²åŒºåŸŸä¸è¶³ä»¥å®¹çº³å¯¹è±¡ï¼Œåˆ™è¿›è¡Œåƒåœ¾å›æ”¶æ“ä½œï¼Œé‡Šæ”¾ä¸€äº›å†…å­˜åå†è¿›è¡Œåˆ†é…ã€‚</p><p>æŒ‡é’ˆç¢°æ’çš„ä¼˜ç‚¹æ˜¯åˆ†é…å†…å­˜çš„é€Ÿåº¦å¾ˆå¿«ï¼Œåªéœ€ç®€å•åœ°ç§»åŠ¨ä¸€ä¸ªæŒ‡é’ˆå³å¯å®Œæˆã€‚è€Œä¸”ç”±äºå·²åˆ†é…çš„å¯¹è±¡åŒºåŸŸå’Œæœªåˆ†é…çš„ç©ºé—²åŒºåŸŸæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥å†…å­˜çš„åˆ©ç”¨ç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚</p><p>ç„¶è€Œï¼ŒæŒ‡é’ˆç¢°æ’ç®—æ³•çš„<strong>ç¼ºç‚¹æ˜¯éœ€è¦ä¿è¯å †å†…å­˜çš„è¿ç»­æ€§ï¼Œå³å †å†…å­˜å¿…é¡»æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚</strong>&#x8FD9;å¯¹äºæŸäº›æƒ…å†µä¸‹çš„å†…å­˜åˆ†é…æ¥è¯´å¯èƒ½æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Œå› ä¸ºè¿ç»­çš„å†…å­˜ç©ºé—´å¯èƒ½ä¼šå—åˆ°ç¢ç‰‡åŒ–çš„å½±å“ï¼Œå¯¼è‡´æ— æ³•åˆ†é…è¶³å¤Ÿå¤§çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæŒ‡é’ˆç¢°æ’ç®—æ³•é€šå¸¸ä¸å…¶ä»–å†…å­˜åˆ†é…ç®—æ³•ç»“åˆä½¿ç”¨ï¼Œä»¥å…‹æœå…¶å±€é™æ€§ã€‚</p><h2 id="6-ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°"><a href="#6-ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°" class="headerlink" title="6.ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°"></a>6.ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°</h2><p>ä¸‰è‰²æ ‡è®°æ˜¯ä¸€ç§ç”¨äºå¹¶å‘åƒåœ¾æ”¶é›†çš„ç®—æ³•ï¼Œå¸¸ç”¨äºåˆ†ä»£åƒåœ¾æ”¶é›†å™¨ä¸­çš„è€å¹´ä»£çš„åƒåœ¾å›æ”¶è¿‡ç¨‹ã€‚å®ƒåŸºäºå¯¹è±¡çš„å¯è¾¾æ€§æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Œå¹¶æ ‡è®°å‡ºå­˜æ´»å¯¹è±¡ã€‚</p><p>ä¸‰è‰²æ ‡è®°ç®—æ³•å°†å¯¹è±¡åˆ†ä¸ºä¸‰ç§çŠ¶æ€ï¼šç™½è‰²ã€ç°è‰²å’Œé»‘è‰²ã€‚</p><ul><li><p>ç™½è‰²è¡¨ç¤ºå¯¹è±¡å°šæœªè¢«æ‰«æï¼Œå³æœªè¢«æ ‡è®°ä¸ºå­˜æ´»å¯¹è±¡ã€‚</p></li><li><p>ç°è‰²è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«æ‰«æï¼Œä½†å…¶å¼•ç”¨çš„å…¶ä»–å¯¹è±¡å°šæœªè¢«æ‰«æã€‚</p></li><li><p>é»‘è‰²è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«æ‰«æï¼Œå¹¶ä¸”å…¶å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ä¹Ÿå·²ç»è¢«æ‰«æã€‚</p></li></ul><p>åƒåœ¾æ”¶é›†å™¨åœ¨å¼€å§‹åƒåœ¾å›æ”¶æ—¶ï¼Œå°†æ‰€æœ‰å¯¹è±¡æ ‡è®°ä¸ºç™½è‰²ã€‚ç„¶åä»æ ¹å¯¹è±¡å¼€å§‹ï¼Œé€’å½’åœ°éå†å¯¹è±¡å›¾ï¼Œå°†é‡åˆ°çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼Œå¹¶å°†å…¶å¼•ç”¨çš„å¯¹è±¡æ·»åŠ åˆ°å¾…æ‰«æé˜Ÿåˆ—ä¸­ã€‚æ¥ç€ï¼Œåƒåœ¾æ”¶é›†å™¨ä»å¾…æ‰«æé˜Ÿåˆ—ä¸­å–å‡ºå¯¹è±¡ï¼Œå°†å…¶æ ‡è®°ä¸ºé»‘è‰²ï¼Œå¹¶å°†å…¶å¼•ç”¨çš„å¯¹è±¡æ·»åŠ åˆ°å¾…æ‰«æé˜Ÿåˆ—ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´è¿›è¡Œï¼Œç›´åˆ°å¾…æ‰«æé˜Ÿåˆ—ä¸ºç©ºã€‚æœ€åï¼Œæ‰€æœ‰æœªè¢«æ ‡è®°ä¸ºé»‘è‰²çš„å¯¹è±¡å³ä¸ºåƒåœ¾å¯¹è±¡ï¼Œå¯ä»¥è¢«å›æ”¶ã€‚</p><p>ä¸‰è‰²æ ‡è®°ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥åœ¨å¹¶å‘æ‰§è¡Œçš„æƒ…å†µä¸‹è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå‡å°‘åœé¡¿æ—¶é—´ã€‚å®ƒé€šè¿‡å°†å¯¹è±¡åˆ†ä¸ºä¸‰ç§çŠ¶æ€ï¼Œé¿å…äº†åœ¨å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­çš„åŒæ—¶ä¿®æ”¹å’Œè®¿é—®å¯¹è±¡çš„å†²çªã€‚ç„¶è€Œï¼Œä¸‰è‰²æ ‡è®°ç®—æ³•ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œå¦‚å¯èƒ½å­˜åœ¨æ ‡è®°æ¼æ ‡å’Œæ ‡è®°è¯¯æ ‡çš„æƒ…å†µï¼Œéœ€è¦é¢å¤–çš„å¤„ç†æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚</p><h2 id="7-Javaå¯¹è±¡çš„å®šä½æ–¹å¼"><a href="#7-Javaå¯¹è±¡çš„å®šä½æ–¹å¼" class="headerlink" title="7. Javaå¯¹è±¡çš„å®šä½æ–¹å¼"></a>7. Javaå¯¹è±¡çš„å®šä½æ–¹å¼</h2><p>Java ç¨‹åºé€šè¿‡æ ˆä¸Šçš„ reference æ•°æ®æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚å¯¹è±¡çš„è®¿é—®æ–¹å¼ç”±è™šæ‹Ÿæœºå®ç°è€Œå®šï¼Œç›®å‰ä¸»æµçš„è®¿é—®æ–¹å¼æœ‰ä½¿ç”¨å¥æŸ„å’Œç›´æ¥æŒ‡é’ˆä¸¤ç§ï¼š</p><ul><li><p>å¦‚æœä½¿ç”¨å¥æŸ„çš„è¯ï¼Œé‚£ä¹ˆ Java å †ä¸­å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜ä½œä¸ºå¥æŸ„æ± ï¼Œreference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œ<strong>è€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯</strong>ã€‚ä½¿ç”¨å¥æŸ„æ¥è®¿é—®çš„æœ€å¤§å¥½å¤„æ˜¯ reference ä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œ reference æœ¬èº«ä¸éœ€è¦ä¿®æ”¹ã€‚</p></li><li><p>ç›´æ¥æŒ‡é’ˆï¼šreference ä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡çš„åœ°å€ã€‚å¯¹è±¡åŒ…å«åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼Œé€šè¿‡è¿™ä¸ªæŒ‡é’ˆå¯ä»¥è®¿é—®å¯¹è±¡ç±»å‹æ•°æ®ã€‚ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®æ–¹å¼æœ€å¤§çš„å¥½å¤„å°±æ˜¯è®¿é—®å¯¹è±¡é€Ÿåº¦å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œè™šæ‹Ÿæœº hotspot ä¸»è¦æ˜¯ä½¿ç”¨ç›´æ¥æŒ‡é’ˆæ¥è®¿é—®å¯¹è±¡ã€‚</p></li></ul><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-8.png" alt=""></p><h2 id="8-å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ"><a href="#8-å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ" class="headerlink" title="8.å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ"></a>8.å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ</h2><p>å¯¹å †åƒåœ¾å›æ”¶å‰çš„ç¬¬ä¸€æ­¥å°±æ˜¯è¦åˆ¤æ–­å“ªäº›å¯¹è±¡å·²ç»æ­»äº¡ï¼ˆå³ä¸å†è¢«ä»»ä½•é€”å¾„å¼•ç”¨çš„å¯¹è±¡ï¼‰ã€‚åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»æœ‰ä¸¤ç§æ–¹æ³•ï¼šå¼•ç”¨è®¡æ•°æ³•å’Œå¯è¾¾æ€§åˆ†æã€‚</p><p><strong>å¼•ç”¨è®¡æ•°æ³•</strong>ï¼š</p><p>ç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒï¼Œè®¡æ•°å™¨å°±åŠ 1ï¼›å½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å°±å‡1ï¼›ä»»ä½•æ—¶å€™è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚è¿™ç§æ–¹æ³•å¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼Œobj1å’Œobj2äº’ç›¸å¼•ç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¼•ç”¨è®¡æ•°å™¨çš„å€¼éƒ½æ˜¯1ï¼Œä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReferenceCount</span> &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ReferenceCount</span> <span class="variable">obj1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceCount</span>();</span><br><span class="line">        <span class="type">ReferenceCount</span> <span class="variable">obj2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceCount</span>();</span><br><span class="line">        obj1.instance = obj2;</span><br><span class="line">        obj2.instance = obj1;</span><br><span class="line">        obj1 = <span class="literal">null</span>;</span><br><span class="line">        obj2 = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¯è¾¾æ€§åˆ†æ</strong>ï¼š</p><p>é€šè¿‡GC Rootå¯¹è±¡ä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„å«å¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootæ²¡æœ‰ä»»ä½•çš„å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚</p><h2 id="9-å¯ä½œä¸ºGC-Rootsçš„å¯¹è±¡æœ‰å“ªäº›ï¼Ÿ"><a href="#9-å¯ä½œä¸ºGC-Rootsçš„å¯¹è±¡æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="9.å¯ä½œä¸ºGC Rootsçš„å¯¹è±¡æœ‰å“ªäº›ï¼Ÿ"></a>9.å¯ä½œä¸ºGC Rootsçš„å¯¹è±¡æœ‰å“ªäº›ï¼Ÿ</h2><ul><li><p>åœ¨è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å„ä¸ªçº¿ç¨‹è¢«è°ƒç”¨çš„æ–¹æ³•å †æ ˆä¸­ä½¿ç”¨åˆ°çš„å‚æ•°ã€å±€éƒ¨å˜é‡ã€ä¸´æ—¶å˜é‡ç­‰ã€‚</p></li><li><p>åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚ Java ç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡ã€‚</p></li><li><p>åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡æ±  (String Table) é‡Œçš„å¼•ç”¨ã€‚</p></li><li><p>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ Native æ–¹æ³•å¼•ç”¨çš„å¯¹è±¡ã€‚</p></li><li><p>Java è™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨ï¼Œå¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„ Class å¯¹è±¡ï¼Œä¸€äº›å¸¸é©»çš„å¼‚å¸¸å¯¹è±¡ (æ¯”å¦‚ NullPointExcepitonã€OutOfMemoryError) ç­‰ï¼Œè¿˜æœ‰ç³»ç»Ÿç±»åŠ è½½å™¨ã€‚</p></li><li><p>æ‰€æœ‰è¢«åŒæ­¥é” (synchronized å…³é”®å­—) æŒæœ‰çš„å¯¹è±¡ã€‚</p></li><li><p>åæ˜  Java è™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„ JMXBeanã€JVMTI ä¸­æ³¨å†Œçš„å›è°ƒã€æœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚</p></li></ul><h2 id="10-ä»€ä¹ˆæƒ…å†µä¸‹ç±»ä¼šè¢«å¸è½½ï¼Ÿ"><a href="#10-ä»€ä¹ˆæƒ…å†µä¸‹ç±»ä¼šè¢«å¸è½½ï¼Ÿ" class="headerlink" title="10.ä»€ä¹ˆæƒ…å†µä¸‹ç±»ä¼šè¢«å¸è½½ï¼Ÿ"></a>10.ä»€ä¹ˆæƒ…å†µä¸‹ç±»ä¼šè¢«å¸è½½ï¼Ÿ</h2><p>éœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ 3 ä¸ªæ¡ä»¶ç±»æ‰å¯èƒ½ä¼šè¢«å¸è½½ï¼š</p><ul><li><p>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ã€‚</p></li><li><p>åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶ã€‚</p></li><li><p>è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚</p></li></ul><p>è™šæ‹Ÿæœºå¯ä»¥å¯¹æ»¡è¶³ä¸Šè¿° 3 ä¸ªæ¡ä»¶çš„ç±»è¿›è¡Œå›æ”¶ï¼Œä½†ä¸ä¸€å®šä¼šè¿›è¡Œå›æ”¶ã€‚</p><h2 id="11-å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#11-å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="11.å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>11.å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p><strong>å¼ºå¼•ç”¨</strong>ï¼šåœ¨ç¨‹åºä¸­æ™®éå­˜åœ¨çš„å¼•ç”¨èµ‹å€¼ï¼Œç±»ä¼¼Object obj = new Object()è¿™ç§å¼•ç”¨å…³ç³»ã€‚åªè¦å¼ºå¼•ç”¨å…³ç³»è¿˜å­˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨å°±æ°¸è¿œä¸ä¼šå›æ”¶è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚</p><p><strong>è½¯å¼•ç”¨</strong>ï¼šå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜ã€‚ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è½¯å¼•ç”¨</span></span><br><span class="line">SoftReference&lt;String&gt; softRef = <span class="keyword">new</span> <span class="title class_">SoftReference</span>&lt;String&gt;(str);</span><br></pre></td></tr></table></figure><p><strong>å¼±å¼•ç”¨</strong>ï¼šåœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼±å¼•ç”¨</span></span><br><span class="line">WeakReference&lt;String&gt; weakRef = <span class="keyword">new</span> <span class="title class_">WeakReference</span>&lt;String&gt;(str);</span><br></pre></td></tr></table></figure><p><strong>è™šå¼•ç”¨</strong>ï¼šè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚è™šå¼•ç”¨ä¸»è¦æ˜¯ä¸ºäº†èƒ½åœ¨å¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚è™šå¼•ç”¨åˆ›å»ºæ—¶å¿…é¡»æ­é…ReferenceQueueã€‚ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ReferenceQueue&lt;Object&gt; queue = <span class="keyword">new</span> <span class="title class_">ReferenceQueue</span>&lt;&gt;();</span><br><span class="line">PhantomReference&lt;Object&gt; phantom = <span class="keyword">new</span> <span class="title class_">PhantomReference</span>&lt;Object&gt;(<span class="keyword">new</span> <span class="title class_">Object</span>(), queue);</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯¹è±¡å¦‚æœè¢«å¼•ç”¨ï¼Œä¸”æœ€é«˜çº§åˆ«æ˜¯è™šå¼•ç”¨ï¼Œå°±ç­‰äºæ²¡æœ‰è¢«å¼•ç”¨ï¼Œå‘ç”Ÿgcæ—¶ä¸ç®¡å†…å­˜å¤Ÿä¸å¤Ÿéƒ½ä¼šè¢«å›æ”¶ã€‚è™šå¼•ç”¨çœ‹èµ·æ¥å’Œå¼±å¼•ç”¨æ²¡å•¥åŒºåˆ«ï¼Œåªæ˜¯å¿…é¡»æ­é…ReferenceQueueã€‚ç”¨è™šå¼•ç”¨çš„ç›®çš„ä¸€èˆ¬æ˜¯è·Ÿè¸ªå¯¹è±¡è¢«å›æ”¶çš„æ´»åŠ¨ã€‚</p><p>ä¸åŒçš„å¼•ç”¨ç±»å‹ï¼Œä¸»è¦ä½“ç°çš„æ˜¯å¯¹è±¡ä¸åŒçš„å¯è¾¾æ€§ï¼ˆreachableï¼‰çŠ¶æ€å’Œå¯¹åƒåœ¾æ”¶é›†çš„å½±å“ã€‚</p><ul><li><p>å¼ºå¼•ç”¨ï¼šå°±æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„æ™®é€šå¯¹è±¡å¼•ç”¨ï¼Œåªè¦è¿˜æœ‰å¼ºå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå°±èƒ½è¡¨æ˜å¯¹è±¡è¿˜ â€œæ´»ç€â€ï¼Œåƒåœ¾æ”¶é›†å™¨ä¸ä¼šç¢°è¿™ç§å¯¹è±¡ã€‚å¯¹äºä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–çš„å¼•ç”¨å…³ç³»ï¼Œåªè¦è¶…è¿‡äº†å¼•ç”¨çš„ä½œç”¨åŸŸæˆ–è€…æ˜¾å¼åœ°å°†ç›¸åº”ï¼ˆå¼ºï¼‰å¼•ç”¨èµ‹å€¼ä¸º nullï¼Œå°±æ˜¯å¯ä»¥è¢«åƒåœ¾æ”¶é›†çš„äº†ï¼Œå½“ç„¶å…·ä½“å›æ”¶æ—¶æœºè¿˜æ˜¯è¦çœ‹åƒåœ¾æ”¶é›†ç­–ç•¥ã€‚</p></li><li><p>è½¯å¼•ç”¨ï¼šæ˜¯ä¸€ç§ç›¸å¯¹å¼ºå¼•ç”¨å¼±åŒ–ä¸€äº›çš„å¼•ç”¨ï¼Œå¯ä»¥è®©å¯¹è±¡è±å…ä¸€äº›åƒåœ¾æ”¶é›†ï¼Œåªæœ‰å½“ JVM è®¤ä¸ºå†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šå»è¯•å›¾å›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚JVM ä¼šç¡®ä¿åœ¨æŠ›å‡º OutOfMemoryError ä¹‹å‰ï¼Œæ¸…ç†è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚è½¯å¼•ç”¨é€šå¸¸ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œå¦‚æœè¿˜æœ‰ç©ºé—²å†…å­˜ï¼Œå°±å¯ä»¥æš‚æ—¶ä¿ç•™ç¼“å­˜ï¼Œå½“å†…å­˜ä¸è¶³æ—¶æ¸…ç†æ‰ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ç¼“å­˜çš„åŒæ—¶ï¼Œä¸ä¼šè€—å°½å†…å­˜ã€‚</p></li><li><p>å¼±å¼•ç”¨ï¼šå¹¶ä¸èƒ½ä½¿å¯¹è±¡è±å…åƒåœ¾æ”¶é›†ï¼Œä»…ä»…æ˜¯æä¾›ä¸€ç§è®¿é—®åœ¨å¼±å¼•ç”¨çŠ¶æ€ä¸‹å¯¹è±¡çš„é€”å¾„ã€‚è¿™å°±å¯ä»¥ç”¨æ¥æ„å»ºä¸€ç§æ²¡æœ‰ç‰¹å®šçº¦æŸçš„å…³ç³»ï¼Œæ¯”å¦‚ï¼Œç»´æŠ¤ä¸€ç§éå¼ºåˆ¶æ€§çš„æ˜ å°„å…³ç³»ï¼Œå¦‚æœè¯•å›¾è·å–æ—¶å¯¹è±¡è¿˜åœ¨ï¼Œå°±ä½¿ç”¨å®ƒï¼Œå¦åˆ™é‡ç°å®ä¾‹åŒ–ã€‚</p></li><li><p>è™šå¼•ç”¨ï¼šè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨ä¾†è·å–å¯¹è±¡å®ä¾‹ã€‚è™šå¼•ç”¨<strong>ä¸»è¦æ˜¯ä¸ºäº†èƒ½åœ¨å¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œè¿™æ ·å¯ä»¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚</strong></p></li></ul><h2 id="12-èŠèŠ-Java-ä¸­çš„-GCï¼Œåˆ†åˆ«ä½œç”¨åœ¨ä»€ä¹ˆèŒƒå›´"><a href="#12-èŠèŠ-Java-ä¸­çš„-GCï¼Œåˆ†åˆ«ä½œç”¨åœ¨ä»€ä¹ˆèŒƒå›´" class="headerlink" title="12.èŠèŠ Java ä¸­çš„ GCï¼Œåˆ†åˆ«ä½œç”¨åœ¨ä»€ä¹ˆèŒƒå›´"></a>12.èŠèŠ Java ä¸­çš„ GCï¼Œåˆ†åˆ«ä½œç”¨åœ¨ä»€ä¹ˆèŒƒå›´</h2><ul><li><p>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC / Young GCï¼‰åªæ˜¯æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†</p></li><li><p>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC / Old GCï¼‰åªæ˜¯è€å¹´ä»£çš„åƒåœ¾æ”¶é›†</p></li><li><p>æ•´å †æ”¶é›†ï¼ˆFull GCï¼‰æ”¶é›†æ•´ä¸ªå †çš„åƒåœ¾</p></li><li><p>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰æ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼ˆç›®å‰åªæœ‰ G1 GC ä¼šæœ‰è¿™ç§è¡Œä¸ºï¼‰</p></li></ul><h2 id="13-å†…å­˜çš„åˆ†é…ç­–ç•¥ï¼Ÿ"><a href="#13-å†…å­˜çš„åˆ†é…ç­–ç•¥ï¼Ÿ" class="headerlink" title="13.å†…å­˜çš„åˆ†é…ç­–ç•¥ï¼Ÿ"></a>13.å†…å­˜çš„åˆ†é…ç­–ç•¥ï¼Ÿ</h2><ol><li><p>å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é…ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden ä¸Šåˆ†é…ï¼Œå½“ Eden ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œè§¦å‘ Minor GCã€‚</p></li><li><p>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼šå¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡æœ‰é•¿å­—ç¬¦ä¸²å’Œå¤§æ•°ç»„ã€‚å¯ä»¥è®¾ç½® JVM å‚æ•° -XX:PretenureSizeThresholdï¼Œå¤§äºæ­¤å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ã€‚</p></li><li><p>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ï¼šé€šè¿‡å‚æ•° -XX:MaxTenuringThreshold å¯ä»¥è®¾ç½®å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ã€‚å¯¹è±¡åœ¨ Survivor åŒºæ¯ç»è¿‡ä¸€æ¬¡ Minor GCï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚</p></li><li><p>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šï¼šå¹¶éå¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨ Survivor ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— éœ€è¾¾åˆ° MaxTenuringThreshold å¹´é¾„é˜ˆå€¼ã€‚</p></li><li><p>ç©ºé—´åˆ†é…æ‹…ä¿ï¼šåœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure çš„å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure çš„å€¼ä¸ºä¸å…è®¸æ‹…ä¿å¤±è´¥ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚</p></li></ol><h2 id="14-å¯¹è±¡å¤´äº†è§£å—ï¼Ÿ"><a href="#14-å¯¹è±¡å¤´äº†è§£å—ï¼Ÿ" class="headerlink" title="14.å¯¹è±¡å¤´äº†è§£å—ï¼Ÿ"></a>14.å¯¹è±¡å¤´äº†è§£å—ï¼Ÿ</h2><p>Java å†…å­˜ä¸­çš„å¯¹è±¡ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……å­—èŠ‚ã€‚</p><ul><li><p>å¯¹è±¡å¤´ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆï¼šmark wordã€æŒ‡å‘ç±»ä¿¡æ¯çš„æŒ‡é’ˆå’Œæ•°ç»„é•¿åº¦ï¼ˆæ•°ç»„æ‰æœ‰ï¼‰ã€‚mark word åŒ…å«ï¼šå¯¹è±¡çš„å“ˆå¸Œç ã€åˆ†ä»£å¹´é¾„å’Œé”æ ‡å¿—ä½ã€‚</p></li><li><p>å¯¹è±¡çš„å®ä¾‹æ•°æ®å°±æ˜¯ Java å¯¹è±¡çš„å±æ€§å’Œå€¼ã€‚</p></li><li><p>å¯¹é½å¡«å……å­—èŠ‚ï¼šå› ä¸º JVM è¦æ±‚å¯¹è±¡å çš„å†…å­˜å¤§å°æ˜¯ 8byte çš„å€æ•°ï¼Œå› æ­¤åé¢æœ‰å‡ ä¸ªå­—èŠ‚ç”¨äºæŠŠå¯¹è±¡çš„å¤§å°è¡¥é½è‡³ 8byte çš„å€æ•°ã€‚<br>å†…å­˜å¯¹é½çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š</p></li></ul><ol><li><p>å¹³å°åŸå› ï¼šä¸æ˜¯æ‰€æœ‰çš„ç¡¬ä»¶å¹³å°éƒ½èƒ½è®¿é—®ä»»æ„åœ°å€ä¸Šçš„ä»»æ„æ•°æ®çš„ï¼›æŸäº›ç¡¬ä»¶å¹³å°åªèƒ½åœ¨æŸäº›åœ°å€å¤„å–æŸäº›ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œå¦åˆ™æŠ›å‡ºç¡¬ä»¶å¼‚å¸¸ã€‚</p></li><li><p>æ€§èƒ½åŸå› ï¼šç»è¿‡å†…å­˜å¯¹é½åï¼ŒCPU çš„å†…å­˜è®¿é—®é€Ÿåº¦å¤§å¤§æå‡ã€‚</p></li></ol><h2 id="15-mainæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹"><a href="#15-mainæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="15.mainæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹"></a>15.mainæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-7.png" alt=""></p><p>æ‰§è¡Œ main æ–¹æ³•çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>ç¼–è¯‘ Application.java åå¾—åˆ° Application.class åï¼Œæ‰§è¡Œè¿™ä¸ª class æ–‡ä»¶ï¼Œç³»ç»Ÿä¼šå¯åŠ¨ä¸€ä¸ª JVM è¿›ç¨‹ï¼Œä»ç±»è·¯å¾„ä¸­æ‰¾åˆ°ä¸€ä¸ªåä¸º Application.class çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°† Application ç±»ä¿¡æ¯åŠ è½½åˆ°è¿è¡Œæ—¶æ•°æ®åŒºçš„æ–¹æ³•åŒºå†…ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšç±»çš„åŠ è½½ã€‚</p></li><li><p>JVM æ‰¾åˆ° Application çš„ä¸»ç¨‹åºå…¥å£ï¼Œæ‰§è¡Œ main æ–¹æ³•ã€‚</p></li><li><p>main æ–¹æ³•çš„ç¬¬ä¸€æ¡è¯­å¥ä¸º Person p = new Person (â€œå¤§å½¬â€)ï¼Œå°±æ˜¯è®© JVM åˆ›å»ºä¸€ä¸ª Person å¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™æ–¹æ³•åŒºä¸­æ˜¯æ²¡æœ‰ Person ç±»çš„ä¿¡æ¯çš„ï¼Œæ‰€ä»¥ JVM é©¬ä¸ŠåŠ è½½ Person ç±»ï¼ŒæŠŠ Person ç±»çš„ä¿¡æ¯æ”¾åˆ°æ–¹æ³•åŒºä¸­ã€‚</p></li><li><p>åŠ è½½å®Œ Person ç±»åï¼ŒJVM åœ¨å †ä¸­åˆ†é…å†…å­˜ç»™ Person å¯¹è±¡ï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ– Person å¯¹è±¡ï¼Œè¿™ä¸ª Person å¯¹è±¡æŒæœ‰æŒ‡å‘æ–¹æ³•åŒºä¸­çš„ Person ç±»çš„ç±»å‹ä¿¡æ¯çš„å¼•ç”¨ã€‚</p></li><li><p>æ‰§è¡Œ p.getName () æ—¶ï¼ŒJVM æ ¹æ® p çš„å¼•ç”¨æ‰¾åˆ° p æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œç„¶åæ ¹æ®æ­¤å¯¹è±¡æŒæœ‰çš„å¼•ç”¨å®šä½åˆ°æ–¹æ³•åŒºä¸­ Person ç±»çš„ç±»å‹ä¿¡æ¯çš„æ–¹æ³•è¡¨ï¼Œè·å¾— getName () çš„å­—èŠ‚ç åœ°å€ã€‚</p></li><li><p>æ‰§è¡Œ getName () æ–¹æ³•ã€‚</p></li></ol><h2 id="16-å¯¹è±¡åˆ›å»ºè¿‡ç¨‹"><a href="#16-å¯¹è±¡åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="16.å¯¹è±¡åˆ›å»ºè¿‡ç¨‹"></a>16.å¯¹è±¡åˆ›å»ºè¿‡ç¨‹</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-5.png" alt=""></p><p>å›¾ç‰‡å±•ç¤ºäº† Java ä¸­å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒ…å«ç±»åŠ è½½æ£€æŸ¥ã€åˆ†é…å†…å­˜ã€åˆå§‹åŒ–é›¶å€¼ã€è®¾ç½®å¯¹è±¡å¤´ã€æ‰§è¡Œ init æ–¹æ³•äº”ä¸ªæ­¥éª¤ï¼Œå¹¶æœ‰å„æ­¥éª¤è¯¦ç»†è¯´æ˜ï¼š</p><ol><li><p><strong>ç±»åŠ è½½æ£€æŸ¥ï¼š</strong>&#x4A;VM é‡åˆ° new æŒ‡ä»¤æ—¶ï¼Œå…ˆæ£€æŸ¥èƒ½å¦åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°è¯¥ç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶æ£€æŸ¥ç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–ï¼Œæœªå®Œæˆåˆ™å…ˆè¿›è¡Œç±»åŠ è½½ï¼Œå·²åŠ è½½åˆ™é€šè¿‡æ£€æŸ¥ã€‚</p></li><li><p><strong>åˆ†é…å†…å­˜ï¼š</strong>&#x7C7B;åŠ è½½æ£€æŸ¥é€šè¿‡å JVM ä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜ï¼Œå¯¹è±¡æ‰€éœ€å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåç¡®å®šï¼ŒJVM ä¼šåœ¨å †ä¸­æŒ‰æŒ‡é’ˆç¢°æ’æˆ–ç©ºé—²åˆ—è¡¨æ–¹å¼ä¸ºå¯¹è±¡åˆ’åˆ†ç©ºé—´ï¼Œé€‰æ‹©æ–¹å¼ä¾åƒåœ¾æ”¶é›†å™¨ç®—æ³•è€Œå®šã€‚å†…å­˜åˆ†é…è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œ<strong>JVM é‡‡ç”¨ CAS + å¤±è´¥é‡è¯•æˆ– TLAB æ–¹å¼ä¿è¯ã€‚</strong>&#x5176;ä¸­ï¼ŒCAS + å¤±è´¥é‡è¯•æ˜¯ä¹è§‚é”çš„ä¸€ç§å®ç°ï¼Œæ¯æ¬¡å ç”¨èµ„æºä¸åŠ é”ï¼Œè€Œæ˜¯ä¸æ–­å°è¯•å ç”¨ï¼›TLAB æ˜¯çº¿ç¨‹åˆ›å»ºæ—¶é¢„å…ˆåœ¨å †ä¸­ç»™çº¿ç¨‹åˆ†é…ä¸€å—å†…å­˜ï¼Œä¸“é—¨å­˜æ”¾è¯¥çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºçš„å¯¹è±¡ï¼ŒTLAB æ»¡æ—¶ï¼Œé‡‡ç”¨ CAS åœ¨å †çš„å…¶å®ƒå†…å­˜ä¸­åˆ†é…ã€‚</p></li><li><p>åˆå§‹åŒ–ï¼šåˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼Œä¿è¯å¯¹è±¡å­—æ®µå¯ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°å¯¹åº”é›¶å€¼ã€‚</p></li><li><p>è®¾ç½®å¯¹è±¡å¤´ï¼šåœ¨å¯¹è±¡å¤´ä¸­è®¾ç½®å¯¹è±¡æ‰€å±ç±»ã€ç±»å…ƒæ•°æ®ä¿¡æ¯è·å–æ–¹å¼ã€å¯¹è±¡å“ˆå¸Œç ã€GC åˆ†ä»£å¹´é¾„ã€æ˜¯å¦å¯ç”¨åå‘é”ç­‰ä¿¡æ¯ã€‚</p></li><li><p>æ‰§è¡Œ init æ–¹æ³•ï¼šæŒ‰ç…§ç¨‹åºå‘˜ç¼–å†™çš„æ„é€ æ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚</p></li></ol><h1 id="JVMè°ƒä¼˜ä¸æ•…éšœé—®é¢˜æ’æŸ¥"><a href="#JVMè°ƒä¼˜ä¸æ•…éšœé—®é¢˜æ’æŸ¥" class="headerlink" title="JVMè°ƒä¼˜ä¸æ•…éšœé—®é¢˜æ’æŸ¥"></a>JVMè°ƒä¼˜ä¸æ•…éšœé—®é¢˜æ’æŸ¥</h1><h2 id="1-â­ï¸Full-GC-çš„è§¦å‘æ¡ä»¶ï¼Ÿ"><a href="#1-â­ï¸Full-GC-çš„è§¦å‘æ¡ä»¶ï¼Ÿ" class="headerlink" title="1.â­ï¸Full GC çš„è§¦å‘æ¡ä»¶ï¼Ÿ"></a>1.â­ï¸Full GC çš„è§¦å‘æ¡ä»¶ï¼Ÿ</h2><p>å¯¹äº Minor GCï¼Œå…¶è§¦å‘æ¡ä»¶æ¯”è¾ƒç®€å•ï¼Œå½“ Eden ç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡ Minor GCã€‚è€Œ Full GC è§¦å‘æ¡ä»¶ç›¸å¯¹å¤æ‚ï¼Œæœ‰ä»¥ä¸‹æƒ…å†µä¼šå‘ç”Ÿ full GCï¼š</p><ul><li><p>è°ƒç”¨ System.gc ()ï¼šåªæ˜¯å»ºè®®è™šæ‹Ÿæœºæ‰§è¡Œ Full GCï¼Œä½†æ˜¯è™šæ‹Ÿæœºä¸ä¸€å®šçœŸæ­£å»æ‰§è¡Œã€‚ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯è®©è™šæ‹Ÿæœºç®¡ç†å†…å­˜ã€‚</p></li><li><p>è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼šè€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå‰æ–‡æ‰€è®²çš„å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç­‰ã€‚ä¸ºäº†é¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œåº”å½“å°½é‡ä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡ä»¥åŠæ•°ç»„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡ -Xmn å‚æ•°è°ƒå¤§æ–°ç”Ÿä»£çš„å¤§å°ï¼Œè®©å¯¹è±¡å°½é‡åœ¨æ–°ç”Ÿä»£è¢«å›æ”¶æ‰ï¼Œä¸è¿›å…¥è€å¹´ä»£ã€‚è¿˜å¯ä»¥é€šè¿‡ -XX:MaxTenuringThreshold è°ƒå¤§å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„å¹´é¾„ï¼Œè®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´ã€‚</p></li><li><p>ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ï¼šä½¿ç”¨å¤åˆ¶ç®—æ³•çš„ Minor GC éœ€è¦è€å¹´ä»£çš„å†…å­˜ç©ºé—´ä½œæ‹…ä¿ï¼Œå¦‚æœæ‹…ä¿å¤±è´¥ä¼šæ‰§è¡Œä¸€æ¬¡ Full GCã€‚</p></li><li><p>JDK 1.7 åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³ï¼šåœ¨ JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº› Class çš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚å½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ°¸ä¹…ä»£å¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨ CMS GC çš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡Œ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºä¼šæŠ›å‡º java.lang.OutOfMemoryErrorã€‚</p></li></ul><h2 id="2-å¸¸ç”¨çš„JVMå¯åŠ¨å‚æ•°æœ‰å“ªäº›"><a href="#2-å¸¸ç”¨çš„JVMå¯åŠ¨å‚æ•°æœ‰å“ªäº›" class="headerlink" title="2.å¸¸ç”¨çš„JVMå¯åŠ¨å‚æ•°æœ‰å“ªäº›"></a>2.å¸¸ç”¨çš„JVMå¯åŠ¨å‚æ•°æœ‰å“ªäº›</h2><p>JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„å¯åŠ¨å‚æ•°ç”¨äºé…ç½®å’Œè°ƒæ•´Javaåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„JVMå¯åŠ¨å‚æ•°ï¼š</p><ol><li><p>-Xmxï¼šæŒ‡å®šJavaå †å†…å­˜çš„æœ€å¤§é™åˆ¶ï¼Œå¦‚â€œ-Xmx512mâ€è¡¨ç¤ºæœ€å¤§å †å†…å­˜ä¸º512å…†å­—èŠ‚ã€‚</p></li><li><p>-Xmsï¼šæŒ‡å®šJavaå †å†…å­˜çš„åˆå§‹å¤§å°ï¼Œå¦‚â€œ-Xms256mâ€è¡¨ç¤ºåˆå§‹å †å†…å­˜ä¸º256å…†å­—èŠ‚ã€‚</p></li><li><p>-Xssï¼šæŒ‡å®šæ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°ï¼Œå¦‚â€œ-Xss256kâ€è¡¨ç¤ºæ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°ä¸º256åƒå­—èŠ‚ã€‚</p></li><li><p>-XX:MaxPermSizeï¼ˆJava 7åŠä¹‹å‰ç‰ˆæœ¬ï¼‰æˆ– -XX:MaxMetaspaceSizeï¼ˆJava 8åŠä»¥åç‰ˆæœ¬ï¼‰ï¼šæŒ‡å®šæ°¸ä¹…ä»£ï¼ˆJava 7åŠä¹‹å‰ï¼‰æˆ–å…ƒç©ºé—´ï¼ˆJava 8åŠä»¥åï¼‰çš„æœ€å¤§å¤§å°ã€‚</p></li><li><p>-XX:PermSizeï¼ˆJava 7åŠä¹‹å‰ç‰ˆæœ¬ï¼‰æˆ– -XX:MetaspaceSizeï¼ˆJava 8åŠä»¥åç‰ˆæœ¬ï¼‰ï¼šæŒ‡å®šæ°¸ä¹…ä»£ï¼ˆJava 7åŠä¹‹å‰ï¼‰æˆ–å…ƒç©ºé—´ï¼ˆJava 8åŠä»¥åï¼‰çš„åˆå§‹å¤§å°ã€‚&#x20;</p></li><li><p>-Xmnï¼šæŒ‡å®šå¹´è½»ä»£çš„å¤§å°ï¼Œå¦‚â€œ-Xmn256mâ€è¡¨ç¤ºå¹´è½»ä»£å¤§å°ä¸º256å…†å­—èŠ‚ã€‚</p></li><li><p>-XX:SurvivorRatioï¼šæŒ‡å®šå¹´è½»ä»£ä¸­EdenåŒºä¸SurvivoråŒºçš„å¤§å°æ¯”ä¾‹ï¼Œå¦‚â€œ-XX:SurvivorRatio=8â€è¡¨ç¤ºEdenåŒºä¸æ¯ä¸ªSurvivoråŒºçš„å¤§å°æ¯”ä¾‹ä¸º8:1ã€‚&#x20;</p></li><li><p>-XX:NewRatioï¼šæŒ‡å®šå¹´è½»ä»£ä¸è€å¹´ä»£çš„å¤§å°æ¯”ä¾‹ï¼Œå¦‚â€œ-XX:NewRatio=2â€è¡¨ç¤ºå¹´è½»ä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ä¸º1:2ã€‚&#x20;</p></li><li><p>-XX:MaxGCPauseMillisï¼šè®¾ç½®åƒåœ¾å›æ”¶çš„æœ€å¤§æš‚åœæ—¶é—´ç›®æ ‡ï¼Œå¦‚â€œ-XX:MaxGCPauseMillis=100â€è¡¨ç¤ºåƒåœ¾å›æ”¶çš„æœ€å¤§æš‚åœæ—¶é—´ç›®æ ‡ä¸º100æ¯«ç§’ã€‚&#x20;</p></li><li><p>-XX:ParallelGCThreadsï¼šæŒ‡å®šå¹¶è¡Œåƒåœ¾å›æ”¶çº¿ç¨‹çš„æ•°é‡ï¼Œå¦‚â€œ-XX:ParallelGCThreads=4â€è¡¨ç¤ºä½¿ç”¨4ä¸ªçº¿ç¨‹è¿›è¡Œå¹¶è¡Œåƒåœ¾å›æ”¶ã€‚&#x20;</p></li><li><p>-XX:+UseConcMarkSweepGCï¼šå¯ç”¨å¹¶å‘æ ‡è®°æ¸…é™¤åƒåœ¾å›æ”¶å™¨ã€‚&#x20;</p></li><li><p>-XX:+UseG1GCï¼šå¯ç”¨G1ï¼ˆGarbage Firstï¼‰åƒåœ¾å›æ”¶å™¨ã€‚&#x20;</p></li><li><p>-Dproperty=valueï¼šè®¾ç½®Javaç³»ç»Ÿå±æ€§ï¼Œå¯åœ¨åº”ç”¨ç¨‹åºä¸­ç”¨System.getProperty(â€œpropertyâ€)è·å–è¿™äº›å±æ€§çš„å€¼ã€‚&#x20;</p></li></ol><h2 id="3-å¸¸ç”¨çš„-JVM-è°ƒä¼˜çš„å‘½ä»¤éƒ½æœ‰å“ªäº›ï¼Ÿ"><a href="#3-å¸¸ç”¨çš„-JVM-è°ƒä¼˜çš„å‘½ä»¤éƒ½æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="3.å¸¸ç”¨çš„ JVM è°ƒä¼˜çš„å‘½ä»¤éƒ½æœ‰å“ªäº›ï¼Ÿ"></a>3.å¸¸ç”¨çš„ JVM è°ƒä¼˜çš„å‘½ä»¤éƒ½æœ‰å“ªäº›ï¼Ÿ</h2><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-4.png" alt=""></p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-3.png" alt=""></p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-2.png" alt=""></p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-15.png" alt=""></p><p><img src="2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜/image-16.png" alt=""></p><h2 id="4-å¦‚ä½•æ’æŸ¥-OOM-çš„é—®é¢˜ï¼Ÿ"><a href="#4-å¦‚ä½•æ’æŸ¥-OOM-çš„é—®é¢˜ï¼Ÿ" class="headerlink" title="4.å¦‚ä½•æ’æŸ¥ OOM çš„é—®é¢˜ï¼Ÿ"></a>4.å¦‚ä½•æ’æŸ¥ OOM çš„é—®é¢˜ï¼Ÿ</h2><p>æ’æŸ¥ OOMï¼ˆOutOfMemoryErrorï¼Œå†…å­˜æº¢å‡ºï¼‰çš„æ–¹æ³•ï¼š</p><ul><li><p>å¢åŠ  JVM å‚æ•° -XX:+HeapDumpOnOutOfMemoryError å’Œ -XX:HeapDumpPath=/tmp/heapdump.hprofï¼Œå½“ OOM å‘ç”Ÿæ—¶è‡ªåŠ¨ dump å †å†…å­˜ä¿¡æ¯åˆ°æŒ‡å®šç›®å½•ï¼›</p></li><li><p>jstat æŸ¥çœ‹ç›‘æ§ JVM çš„å†…å­˜å’Œ GC æƒ…å†µï¼Œè¯„ä¼°é—®é¢˜å¤§æ¦‚åœ¨ä»€ä¹ˆåŒºåŸŸï¼›</p></li><li><p>ä½¿ç”¨ MAT å·¥å…·è½½å…¥ dump æ–‡ä»¶ï¼Œåˆ†æå¤§å¯¹è±¡çš„å ç”¨æƒ…å†µ ã€‚</p></li></ul><h2 id="5-å¦‚ä½•è¯Šæ–­javaçº¿ç¨‹æ­»é”ï¼Ÿjstack"><a href="#5-å¦‚ä½•è¯Šæ–­javaçº¿ç¨‹æ­»é”ï¼Ÿjstack" class="headerlink" title="5.å¦‚ä½•è¯Šæ–­javaçº¿ç¨‹æ­»é”ï¼Ÿjstack"></a>5.å¦‚ä½•è¯Šæ–­javaçº¿ç¨‹æ­»é”ï¼Ÿjstack</h2><blockquote><h3 id="ä½¿ç”¨jstackè¿›è¡Œæ­»é”è¯Šæ–­çš„è¯¦ç»†æ­¥éª¤ï¼š"><a href="#ä½¿ç”¨jstackè¿›è¡Œæ­»é”è¯Šæ–­çš„è¯¦ç»†æ­¥éª¤ï¼š" class="headerlink" title="ä½¿ç”¨jstackè¿›è¡Œæ­»é”è¯Šæ–­çš„è¯¦ç»†æ­¥éª¤ï¼š"></a>ä½¿ç”¨jstackè¿›è¡Œæ­»é”è¯Šæ–­çš„è¯¦ç»†æ­¥éª¤ï¼š</h3><h4 id="æ­¥éª¤1-ç¡®è®¤è¿›ç¨‹ID-PID"><a href="#æ­¥éª¤1-ç¡®è®¤è¿›ç¨‹ID-PID" class="headerlink" title="æ­¥éª¤1: ç¡®è®¤è¿›ç¨‹ID (PID)"></a>æ­¥éª¤1: ç¡®è®¤è¿›ç¨‹ID (PID)</h4><ol><li><p>ä½¿ç”¨psæŸ¥æ‰¾è¿›ç¨‹ï¼š</p><ul><li><p>æ‰“å¼€ç»ˆç«¯ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥åˆ—å‡ºæ‰€æœ‰Javaè¿›ç¨‹ã€‚</p></li><li><p>æ‰¾åˆ°ç›®æ ‡Javaåº”ç”¨çš„PIDã€‚</p></li></ul></li></ol><h4 id="æ­¥éª¤2-ç”Ÿæˆçº¿ç¨‹å †æ ˆä¿¡æ¯"><a href="#æ­¥éª¤2-ç”Ÿæˆçº¿ç¨‹å †æ ˆä¿¡æ¯" class="headerlink" title="æ­¥éª¤2: ç”Ÿæˆçº¿ç¨‹å †æ ˆä¿¡æ¯"></a>æ­¥éª¤2: ç”Ÿæˆçº¿ç¨‹å †æ ˆä¿¡æ¯</h4><ul><li><p>è¿è¡Œjstackå‘½ä»¤ï¼š</p><ul><li><p>ä½¿ç”¨ä»¥ä¸Šå‘½ä»¤ç”Ÿæˆçº¿ç¨‹æ ˆä¿¡æ¯ï¼š</p></li><li><p>æ›¿æ¢\<PID> ä¸ºå®é™…çš„è¿›ç¨‹IDã€‚è¿™ä¸ªå‘½ä»¤ä¼šæŠŠçº¿ç¨‹ä¿¡æ¯è¾“å‡ºåˆ°thread_dump.txtæ–‡ä»¶ä¸­ã€‚</p></li></ul></li></ul><h4 id="æ­¥éª¤3-åˆ†æçº¿ç¨‹å †æ ˆä¿¡æ¯"><a href="#æ­¥éª¤3-åˆ†æçº¿ç¨‹å †æ ˆä¿¡æ¯" class="headerlink" title="æ­¥éª¤3: åˆ†æçº¿ç¨‹å †æ ˆä¿¡æ¯"></a>æ­¥éª¤3: åˆ†æçº¿ç¨‹å †æ ˆä¿¡æ¯</h4><ul><li><p>æ‰“å¼€æ–‡ä»¶ï¼š</p><ul><li>ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€thread_dump.txtæ–‡ä»¶ã€‚</li></ul></li><li><p>æŸ¥æ‰¾çº¿ç¨‹çŠ¶æ€ï¼š</p><ul><li><p>åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾BLOCKEDå’ŒWAITINGå…³é”®å­—ï¼Œå¯»æ‰¾è¢«é˜»å¡æˆ–ç­‰å¾…çš„çº¿ç¨‹ã€‚</p></li><li><p>æ¯ä¸ªçº¿ç¨‹çš„ä¿¡æ¯é€šå¸¸ä»¥ â€œ\nâ€ åˆ†éš”ã€‚</p></li></ul></li><li><p>å®šä½é”ä¿¡æ¯ï¼š</p><ul><li><p>å¯¹äºBLOCKEDçŠ¶æ€çš„çº¿ç¨‹ï¼Œæ£€æŸ¥çº¿ç¨‹æ­£åœ¨ç­‰å¾…çš„é”ï¼Œé€šå¸¸åœ¨è¾“å‡ºçš„æœ€åéƒ¨åˆ†ã€‚</p></li><li><p>å¯¹äºæ¯ä¸ªWAITINGçŠ¶æ€çš„çº¿ç¨‹ï¼Œæ£€æŸ¥å®ƒä»¬çš„ç­‰å¾…æ¥æºã€‚</p></li></ul></li></ul><h4 id="æ­¥éª¤4-ç¡®å®šæ­»é”"><a href="#æ­¥éª¤4-ç¡®å®šæ­»é”" class="headerlink" title="æ­¥éª¤4: ç¡®å®šæ­»é”"></a>æ­¥éª¤4: ç¡®å®šæ­»é”</h4><ul><li><p>è¯†åˆ«å¾ªç¯ä¾èµ–ï¼š</p><ul><li>æ£€æŸ¥æ˜¯å¦æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…å¯¹æ–¹æŒæœ‰çš„é”ã€‚ç¡®è®¤è¿™ç§ä¾èµ–å…³ç³»ä¹‹åï¼Œæ‚¨å¯ä»¥åˆ¤æ–­å­˜åœ¨æ­»é”ã€‚</li></ul></li></ul><h4 id="æ­¥éª¤5-è§£å†³æ­»é”"><a href="#æ­¥éª¤5-è§£å†³æ­»é”" class="headerlink" title="æ­¥éª¤5: è§£å†³æ­»é”"></a>æ­¥éª¤5: è§£å†³æ­»é”</h4><ul><li><p>ä¿®æ”¹ä»£ç ï¼š</p><ul><li><p>ç¡®ä¿æ‰€æœ‰çº¿ç¨‹è·å–é”çš„é¡ºåºä¸€è‡´ï¼Œé¿å…å¾ªç¯ä¾èµ–ã€‚</p></li><li><p>è€ƒè™‘ä½¿ç”¨é”è¶…æ—¶ï¼ˆæ¯”å¦‚tryLock()æ–¹æ³•ï¼‰ã€‚</p></li></ul></li></ul><h3 id="å…¶ä»–è¯Šæ–­æ­»é”çš„æ–¹å¼"><a href="#å…¶ä»–è¯Šæ–­æ­»é”çš„æ–¹å¼" class="headerlink" title="å…¶ä»–è¯Šæ–­æ­»é”çš„æ–¹å¼"></a>å…¶ä»–è¯Šæ–­æ­»é”çš„æ–¹å¼</h3><p>JVisualVMã€JConsoleç­‰éƒ½å¯ä»¥æœ‰æ•ˆè¯Šæ–­Javaä¸­çš„çº¿ç¨‹æ­»é”é—®é¢˜ã€‚&#x20;</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§JVMåŸºç¡€é¢è¯•é¢˜æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="JVMé¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/tags/JVM%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>JUCåŸºç¡€é¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h1><h2 id="1-Future"><a href="#1-Future" class="headerlink" title="1.Future"></a>1.Future</h2><blockquote><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#future-%E7%B1%BB%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8">Future ç±»æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></p><p><a href="https://juejin.cn/post/6844904199625375757">Javaæ˜¯å¦‚ä½•å®ç°Futureæ¨¡å¼çš„?ä¸‡å­—è¯¦è§£!</a></p></blockquote><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/diagram.png" alt=""></p><h2 id="ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•"><a href="#ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•" class="headerlink" title="ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•"></a>ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DaHuoGuo.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DaHuoGuo</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Callable</span>&lt;String&gt;() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span> + <span class="string">&quot;å¼€å§‹çƒ§å¼€æ°´...&quot;</span>);</span><br><span class="line">                                <span class="comment">// æ¨¡æ‹Ÿçƒ§å¼€æ°´è€—æ—¶</span></span><br><span class="line">                                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot;å¼€æ°´å·²ç»çƒ§å¥½äº†...&quot;</span>);</span><br><span class="line">                                <span class="keyword">return</span> <span class="string">&quot;å¼€æ°´&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask);</span><br><span class="line">                thread.start();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// do other thing</span></span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot; æ­¤æ—¶å¼€å¯äº†ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œfutureçš„é€»è¾‘ï¼ˆçƒ§å¼€æ°´ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¹²ç‚¹åˆ«çš„äº‹æƒ…ï¼ˆæ¯”å¦‚å‡†å¤‡ç«é”…é£Ÿæï¼‰...&quot;</span>);</span><br><span class="line">                <span class="comment">// æ¨¡æ‹Ÿå‡†å¤‡ç«é”…é£Ÿæè€—æ—¶</span></span><br><span class="line">                Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot;ç«é”…é£Ÿæå‡†å¤‡å¥½äº†&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">shicai</span> <span class="operator">=</span> <span class="string">&quot;ç«é”…é£Ÿæ&quot;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¼€æ°´å·²ç»ç¨å¥½ï¼Œæˆ‘ä»¬å–å¾—çƒ§å¥½çš„å¼€æ°´</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">boilWater</span> <span class="operator">=</span> futureTask.get();</span><br><span class="line"></span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + boilWater + <span class="string">&quot;å’Œ&quot;</span> + shicai + <span class="string">&quot;å·²ç»å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ‰“ç«é”…å•¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•"><a href="#ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•" class="headerlink" title="ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•"></a>ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•</h2><p>è§ä»£ç CFUser</p><p>åŸç†ï¼š</p><p><a href="https://mcnfxurl5vzo.feishu.cn/wiki/Lp6uws3rFiEDjXkkyGGchQWQnVH#share-YTvbd2a9qoU8qRx7RU4cl8kencd"> åšå®¢</a></p><hr><h1 id="é¢è¯•é¢˜ç›®"><a href="#é¢è¯•é¢˜ç›®" class="headerlink" title="é¢è¯•é¢˜ç›®"></a>é¢è¯•é¢˜ç›®</h1><h2 id="å¹¶å‘åŸºç¡€"><a href="#å¹¶å‘åŸºç¡€" class="headerlink" title="å¹¶å‘åŸºç¡€"></a>å¹¶å‘åŸºç¡€</h2><h3 id="1-çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬"><a href="#1-çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬" class="headerlink" title="1.çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬"></a>1.çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬</h3><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-6.png" alt=""></p><h3 id="2-Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼"><a href="#2-Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼" class="headerlink" title="2.Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼"></a>2.Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼</h3><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image.png" alt=""></p><p><a href="https://blog.csdn.net/longshengguoji/article/details/41126119">javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼åŠå…¶å¯¹æ¯”_åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼-CSDNåšå®¢</a></p><h3 id="3-â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•"><a href="#3-â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•" class="headerlink" title="3. â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•"></a>3. â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•</h3><p><strong>è°ƒç”¨start()æ–¹æ³•ä¼šå‘Šè¯‰jvmåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹</strong>ï¼Œå¹¶åœ¨è¿™ä¸ªæ–°çº¿ç¨‹ä¸­æ‰§è¡Œä¸run()æ–¹æ³•ç›¸å…³è”çš„ä»£ç å—ã€‚è¿™ä¸ªè¿‡ç¨‹å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥åœ¨äº’ä¸ç›¸å¹²çš„æƒ…å†µä¸‹æ‰§è¡Œä»»åŠ¡ã€‚</p><p>ä¸æ­¤ä¸åŒï¼Œ<strong>å¦‚æœç›´æ¥è°ƒç”¨run()æ–¹æ³•</strong>ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è°ƒç”¨ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ç›¸åï¼Œå®ƒä¼šåœ¨å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œrun()æ–¹æ³•ä¸­çš„ä»£ç ã€‚è¿™å°†å¯¼è‡´ä»£ç çš„é¡ºåºæ‰§è¡Œï¼Œæ²¡æœ‰å¹¶è¡Œæ€§å¯è¨€ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…æ‰§è¡Œã€‚</p><p>è¿™ç§åŒºåˆ«éå¸¸é‡è¦ï¼Œå› ä¸ºå¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¸€ä¸ªä¸»è¦ç›®æ ‡æ˜¯å®ç°å¹¶è¡Œæ€§ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ€§èƒ½å’Œå“åº”èƒ½åŠ›ã€‚é€šè¿‡è°ƒç”¨start()æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œä»¥æ›´æœ‰æ•ˆåœ°å®Œæˆä»»åŠ¡ã€‚è€Œç›´æ¥è°ƒç”¨run()æ–¹æ³•åªæ˜¯æŒ‰ç…§ä¸€èˆ¬çš„æ–¹æ³•é¡ºåºæ‰§è¡Œä»£ç ï¼Œæ— æ³•å‘æŒ¥å¤šçº¿ç¨‹çš„æ½œåŠ›ã€‚å› æ­¤ï¼Œä½¿ç”¨start()æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹æ˜¯å®ç°å¹¶è¡Œæ€§çš„å…³é”®ã€‚&#x20;</p><h3 id="4-wait-ã€notify-å’Œ-notifyAll-ã€sleep-ã€yield"><a href="#4-wait-ã€notify-å’Œ-notifyAll-ã€sleep-ã€yield" class="headerlink" title="4. wait()ã€notify()å’Œ notifyAll()ã€sleep()ã€yield()"></a>4. wait()ã€notify()å’Œ notifyAll()ã€sleep()ã€yield()</h3><ul><li><p>sleepæ˜¯è®©çº¿ç¨‹è‡ªå·±æ‹¿ç€é”ä¼‘çœ ï¼Œä½†æ˜¯ä¸é‡Šæ”¾é”ï¼Œæš‚åœçº¿ç¨‹çš„æ‰§è¡Œ</p></li><li><p>waitæ˜¯Açº¿ç¨‹é€šè¿‡å¯¹è±¡çš„æ–¹æ³•æ¥é‡Šæ”¾è‡ªå·±æŒæœ‰çš„è¯¥å¯¹è±¡çš„é”,å¹¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚Javaä¸­æ¯ä¸€ä¸ªå¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªç›‘è§†å™¨é”ï¼Œwaitæ–¹æ³•æ˜¯å½“å‰æŒæœ‰é”çš„çº¿ç¨‹ ã€ä¸»åŠ¨ã€‘ æ”¾å¼ƒé”å¹¶ç­‰å¾…ï¼›wait ä¸æ˜¯ç­‰é”ï¼Œè€Œæ˜¯ç­‰ä¸€ä¸ªæ¡ä»¶ï¼Œè¿™ä¸ªæ¡ä»¶è¦å˜›æ˜¯å®šæ—¶æ—¶é—´åˆ°äº†ï¼Œè¦å˜›æ˜¯åˆ«äººnotifyã€‚ç­‰åˆ°æ¡ä»¶æ»¡è¶³ä¹‹åï¼Œæ‰æœ‰èµ„æ ¼å»ç«äº‰é”ï¼Œåç»­å°±èµ°æ­£å¸¸é”ç«äº‰æµç¨‹äº†ã€‚  ä¾‹å¦‚Bæ²¡æœ‰é‡Šæ”¾ï¼Œé‚£ç¡®å®å¾—ç­‰Bç”¨å®Œé‡Šæ”¾äº†æ‰èƒ½è·å–åˆ°é”ã€‚</p></li><li><p><code>notifyAll()</code>ï¼šä¼šå”¤é†’æ‰€æœ‰åœ¨è¯¥å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ã€‚</p></li><li><p><code>notify()</code>ï¼šåªä¼šéšæœºå”¤é†’ä¸€ä¸ªåœ¨è¯¥å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ã€‚</p></li><li><p>yield()æ–¹æ³•åªä¼šç»™ç›¸åŒä¼˜å…ˆçº§æˆ–æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›sleep()æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼› çº¿ç¨‹æ‰§è¡Œ sleep()æ–¹æ³•åè½¬å…¥é˜»å¡ï¼ˆè¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼‰ï¼Œè€Œæ‰§è¡Œ yield()æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›æ‰©å±•ï¼š</p></li></ul><p>ä¸ºä»€ä¹ˆwait()ã€notify()å’Œ notifyAll()è¦å®šä¹‰åœ¨ç±»é‡Œ</p><p>å¯¹è±¡æ‰æ˜¯å…±äº«èµ„æºçš„å•ä½ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯èƒ½æˆä¸ºå…±äº«èµ„æºï¼Œwaitæ–¹æ³•å®šä¹‰åœ¨Objectä¸­æ˜¯ä¸ºäº†è®©æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥æ–¹ä¾¿çš„å…±äº«ã€‚</p><p>ä¸ºä»€ä¹ˆ wait(), notify()å’Œ notifyAll()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</p><p>å…±äº«èµ„æºæ—¶ä¸éœ€è¦å…³æ³¨çº¿ç¨‹ï¼Œå¯¹è±¡æ‰æ˜¯éœ€è¦äº’æ–¥è®¿é—®çš„èµ„æºï¼Œå› æ­¤å¯¹è±¡çš„wait()æ–¹æ³•å¿…é¡»åœ¨æŒæœ‰é”ä¹‹åè°ƒç”¨ï¼›</p><p>åŒç†ï¼Œnotify()æ–¹æ³•ä¹Ÿå¿…é¡»åœ¨æŒæœ‰é”ä¹‹åè°ƒç”¨ï¼Œç±»ä¼¼äºå‘Šè¯‰åˆ«äººæˆ‘é©¬ä¸Šç”¨å®Œäº†ï¼Œä½ å¯ä»¥è¿‡æ¥æ’é˜Ÿç­‰ç€</p><p>å¾ˆå°‘éœ€è¦ç›´æ¥æ§åˆ¶ä¸€ä¸ªçº¿ç¨‹çš„ç­‰å¾…çŠ¶æ€ï¼Œä¸»è¦è¿˜æ˜¯ç­‰å¾…å…±äº«èµ„æºçš„è®¿é—®æƒï¼Œç›¸æ¯”æ§åˆ¶çº¿ç¨‹æœ¬èº«ï¼Œæ§åˆ¶èµ„æºè®¿é—®æƒé™æ›´ç¬¦åˆç›´è§‰ã€‚</p><h3 id="5-Java-ä¸­-interrupted-å’Œ-isInterrupted-æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ"><a href="#5-Java-ä¸­-interrupted-å’Œ-isInterrupted-æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="5.Java ä¸­ interrupted å’Œ isInterrupted æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ"></a>5.Java ä¸­ interrupted å’Œ isInterrupted æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h3><blockquote><p>interruptï¼šç”¨äºä¸­æ–­çº¿ç¨‹ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹çš„çŠ¶æ€ä¸ºå°†è¢«ç½®ä¸ºâ€ä¸­æ–­â€çŠ¶æ€ã€‚</p><p>&#x20;æ³¨æ„ï¼šçº¿ç¨‹ä¸­æ–­ä»…ä»…æ˜¯ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä½ï¼Œä¸ä¼šåœæ­¢çº¿ç¨‹ã€‚éœ€è¦ç”¨æˆ·è‡ªå·±å»ç›‘è§†çº¿ç¨‹çš„çŠ¶æ€ä¸ºå¹¶åšå¤„ç†ã€‚æ”¯æŒçº¿ç¨‹ä¸­æ–­çš„æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­æ–­åä¼šæŠ›å‡ºinterruptedException çš„æ–¹æ³•ï¼‰å°±æ˜¯åœ¨ç›‘è§†çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œä¸€æ—¦çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«ç½®ä¸ºâ€œä¸­æ–­çŠ¶æ€â€ï¼Œå°±ä¼šæŠ›å‡ºä¸­æ–­å¼‚å¸¸ã€‚</p><p>&#x20;interruptedï¼šæ˜¯é™æ€æ–¹æ³•ï¼ŒæŸ¥çœ‹å½“å‰ä¸­æ–­ä¿¡å·æ˜¯trueè¿˜æ˜¯falseå¹¶ä¸”æ¸…é™¤ä¸­æ–­ä¿¡å·ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹è¢«ä¸­æ–­äº†ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ interrupted åˆ™è¿”å› trueï¼Œç¬¬äºŒæ¬¡å’Œåé¢çš„å°±è¿”å› false äº†ã€‚</p><p>isInterruptedï¼šæ˜¯å¯ä»¥è¿”å›å½“å‰ä¸­æ–­ä¿¡å·æ˜¯trueè¿˜æ˜¯falseï¼Œä¸interruptedæœ€å¤§çš„å·®åˆ«æ˜¯ï¼ŒisInterruputedä¸ä¼šæ¸…é™¤ä¸­æ–­ä¿¡å·ï¼Œè€Œinterruptedä¼šæ¸…é™¤ä¸­æ–­ä¿¡å·â€œã€‚</p></blockquote><h3 id="6-åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©"><a href="#6-åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©" class="headerlink" title="6. åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©?"></a>6. åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>åŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥è®©å®ƒé”ä½æ•´ä¸ªå¯¹è±¡ï¼‰ã€‚åŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œå“ªæ€•è¿™ä¸ªç±»ä¸­æœ‰å¤šä¸ªä¸ç›¸å…³è”çš„åŒæ­¥å—ï¼Œé€šå¸¸ä¼šå¯¼è‡´å®ƒä»¬åœæ­¢æ‰§è¡Œå¹¶éœ€è¦ç­‰å¾…è·å¾—è¿™ä¸ªå¯¹è±¡ä¸Šçš„é”ã€‚</p></li><li><p>åŒæ­¥å—æ›´ç¬¦åˆå¼€æ”¾è°ƒç”¨çš„åŸåˆ™ï¼Œåªåœ¨éœ€è¦é”ä½çš„ä»£ç å—é”ä½ç›¸åº”çš„å¯¹è±¡ï¼Œè¿™æ ·ä»ä¾§é¢æ¥è¯´ä¹Ÿå¯ä»¥é¿å…æ­»é”ã€‚</p></li></ul><p>è¯·çŸ¥é“ä¸€æ¡åŸåˆ™ï¼šåŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚&#x20;</p><h3 id="7-ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ"><a href="#7-ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ" class="headerlink" title="7.ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ"></a>7.ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ</h3><p><strong>å®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•</strong></p><ul><li><p>åŒæ­¥ä»£ç æ–¹æ³•ï¼šsynchronizedå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•</p></li><li><p>åŒæ­¥ä»£ç å—ï¼šsynchronizedå…³é”®å­—ä¿®é¥°çš„ä»£ç å—</p></li><li><p>ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸvolatileå®ç°çº¿ç¨‹åŒæ­¥ï¼švolatileå…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶</p></li><li><p>ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlockç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº†lockæ¥å£çš„é”ï¼Œå®ƒä¸synchronizedæ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰&#x20;</p></li></ul><h3 id="8-åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ"><a href="#8-åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ" class="headerlink" title="8.åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ"></a>8.åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ</h3><blockquote><p>åœ¨ java è™šæ‹Ÿæœºä¸­ï¼Œç›‘è§†å™¨å’Œé”åœ¨Javaè™šæ‹Ÿæœºä¸­æ˜¯ä¸€å—ä½¿ç”¨çš„ã€‚ç›‘è§†å™¨ç›‘è§†ä¸€å—åŒæ­¥ä»£ç å—ï¼Œç¡®ä¿ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ã€‚æ¯ä¸€ä¸ªç›‘è§†å™¨éƒ½å’Œä¸€ä¸ªå¯¹è±¡å¼•ç”¨ç›¸å…³è”ã€‚çº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡ŒåŒæ­¥ä»£ç ã€‚&#x20;</p><p>ä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« synchronized ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </p><p>å¦å¤– java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨( Lock )å’Œéšå¼ç›‘è§†å™¨( synchronized )ä¸¤ç§é”æ–¹æ¡ˆ</p></blockquote><h3 id="9-å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#9-å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="9.å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ"></a>9.å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</h3><blockquote><p>æœ‰ä¿©ç§å¯èƒ½ï¼š</p><ul><li>(1) å¦‚æœä½¿ç”¨çš„æ˜¯æ— ç•Œé˜Ÿåˆ—</li></ul><p>LinkedBlockingQueueï¼Œä¹Ÿå°±æ˜¯æ— ç•Œé˜Ÿåˆ—çš„è¯ï¼Œæ²¡å…³ç³»ï¼Œç»§ç»­æ·»åŠ ä»»åŠ¡åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼Œå› ä¸ºLinkedBlockingQueueå¯ä»¥è¿‘ä¹è®¤ä¸ºæ˜¯ä¸€ä¸ªæ— ç©·å¤§çš„é˜Ÿåˆ—ï¼Œå¯ä»¥æ— é™å­˜æ”¾ä»»åŠ¡ã€‚</p><ul><li>(2) å¦‚æœä½¿ç”¨çš„æ˜¯æœ‰ç•Œé˜Ÿåˆ—æ¯”å¦‚</li></ul><p>ArrayBlockingQueueï¼Œä»»åŠ¡é¦–å…ˆä¼šè¢«æ·»åŠ åˆ°ArrayBlockingQueueä¸­ï¼ŒArrayBlockingQueueæ»¡äº†ï¼Œä¼šæ ¹æ®maximumPoolSizeçš„å€¼å¢åŠ çº¿ç¨‹æ•°é‡ï¼Œå¦‚æœå¢åŠ äº†çº¿ç¨‹æ•°é‡è¿˜æ˜¯å¤„ç†ä¸è¿‡æ¥ï¼ŒArrayBlockingQueueç»§ç»­æ»¡ï¼Œé‚£ä¹ˆåˆ™ä¼šä½¿ç”¨æ‹’ç»ç­–ç•¥RejectedExecutionHandlerå¤„ç†æ»¡äº†çš„ä»»åŠ¡ï¼Œé»˜è®¤æ˜¯AbortPolicy&#x20;</p></blockquote><h3 id="10-åœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ"><a href="#10-åœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ" class="headerlink" title="10.åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ"></a>10.åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ</h3><blockquote><p><strong>æ–¹æ³•ä¸€</strong>ï¼šä½¿ç”¨å®‰å…¨ç±»ï¼Œæ¯”å¦‚java.util.concurrentä¸‹çš„ç±»ï¼Œä½¿ç”¨åŸå­ç±»AtomicInteger</p><p><strong>æ–¹æ³•äºŒ</strong>ï¼šä½¿ç”¨è‡ªåŠ¨é”synchronizedã€‚</p><p><strong>æ–¹æ³•ä¸‰</strong>ï¼šä½¿ç”¨æ‰‹åŠ¨é”Lockã€‚æ‰‹åŠ¨é”Javaç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  Lock lock = new ReentrantLock();</span><br><span class="line">  lock.lock();</span><br><span class="line">  try &#123;</span><br><span class="line">      System.out.println(&quot;è·å¾—é”&quot;);</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">      // TODO: handle exception</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">     System.out.println(&quot;é‡Šæ”¾é”&quot;);</span><br><span class="line">      lock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="11-çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„"><a href="#11-çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„" class="headerlink" title="11.çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„"></a>11.çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„</h3><blockquote><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸åˆé’»å’Œç‹¡çŒ¾çš„é—®é¢˜ã€‚è¯·è®°ä½ï¼šçº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«newè¿™ä¸ªçº¿ç¨‹ç±»æ‰€åœ¨çš„çº¿ç¨‹æ‰€è°ƒç”¨çš„ï¼Œè€Œrunæ–¹æ³•é‡Œé¢çš„ä»£ç æ‰æ˜¯è¢«çº¿ç¨‹è‡ªèº«æ‰€è°ƒç”¨çš„ã€‚</p><p>å¦‚æœè¯´ä¸Šé¢çš„è¯´æ³•è®©ä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œé‚£ä¹ˆæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾Thread2ä¸­newäº†Thread1ï¼Œmainå‡½æ•°ä¸­newäº†Thread2ï¼Œé‚£ä¹ˆï¼š</p><ul><li><p>(1) Thread2çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯mainçº¿ç¨‹è°ƒç”¨çš„ï¼ŒThread2çš„run()æ–¹æ³•æ˜¯Thread2è‡ªå·±è°ƒç”¨çš„</p></li><li><p>(2) Thread1çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯Thread2è°ƒç”¨çš„ï¼ŒThread1çš„run()æ–¹æ³•æ˜¯Thread1è‡ªå·±è°ƒç”¨çš„&#x20;</p></li></ul></blockquote><h3 id="12-Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ"><a href="#12-Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ" class="headerlink" title="12. Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ"></a>12. Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>Dumpæ–‡ä»¶æ˜¯è¿›ç¨‹çš„å†…å­˜é•œåƒã€‚å¯ä»¥æŠŠç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€é€šè¿‡è°ƒè¯•å™¨ä¿å­˜åˆ°dumpæ–‡ä»¶ä¸­ã€‚</p><p>åœ¨Linuxä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤jstack -l PIDï¼ˆJavaè¿›ç¨‹çš„è¿›ç¨‹IDï¼‰æ¥è·å–Javaåº”ç”¨çš„dumpæ–‡ä»¶ã€‚</p><p>åœ¨Windowsä¸‹ï¼Œä½ å¯ä»¥æŒ‰ä¸‹Ctrl + Breakæ¥è·å–ï¼Œè¿™æ ·JVMå°±ä¼šå°†çº¿ç¨‹çš„dumpæ–‡ä»¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºæˆ–é”™è¯¯æ–‡ä»¶ä¸­ï¼Œå®ƒå¯èƒ½æ‰“å°åœ¨æ§åˆ¶å°æˆ–è€…æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå…·ä½“ä½ç½®ä¾èµ–åº”ç”¨çš„é…ç½®ã€‚</p></blockquote><h3 id="13-ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ"><a href="#13-ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ" class="headerlink" title="13. ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ"></a>13. ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><p>å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«æ•è·è¯¥çº¿ç¨‹å°†ä¼šåœæ­¢æ‰§è¡Œã€‚</p><p>Thread.UncaughtExceptionHandleræ˜¯ç”¨äºå¤„ç†æœªæ•è·å¼‚å¸¸é€ æˆçº¿ç¨‹çªç„¶ä¸­æ–­æƒ…å†µçš„ä¸€ä¸ªå†…åµŒæ¥å£ã€‚å½“ä¸€ä¸ªæœªæ•è·å¼‚å¸¸å°†é€ æˆçº¿ç¨‹ä¸­æ–­çš„æ—¶å€™ï¼ŒJVMä¼šä½¿ç”¨Thread.getUncaughtExceptionHandler()æ¥æŸ¥è¯¢çº¿ç¨‹çš„UncaughtExceptionHandlerï¼Œå¹¶å°†çº¿ç¨‹å’Œå¼‚å¸¸ä½œä¸ºå‚æ•°ä¼ é€’ç»™handlerçš„uncaughtException()æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚&#x20;</p></blockquote><h3 id="14-å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•"><a href="#14-å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="14.å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•"></a>14.å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</h3><div class="table-container"><table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th></tr></thead><tbody><tr><td>sleep()isAlive()join()activeCount()enumerate()currentThread()isDaemon()setDaemon()setName()wait()notify()setPriority()</td><td>å¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç¡çœ Næ¯«ç§’åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å­˜æ´»ã€‚ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ã€‚ç¨‹åºä¸­æ´»è·ƒçš„çº¿ç¨‹æ•°ã€‚æšä¸¾ç¨‹åºä¸­çš„çº¿ç¨‹ã€‚å¾—åˆ°å½“å‰çº¿ç¨‹ã€‚ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚ä¸ºçº¿ç¨‹è®¾ç½®ä¸€ä¸ªåç§°ã€‚å¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ã€‚é€šçŸ¥ä¸€ä¸ªçº¿ç¨‹ç»§ç»­è¿è¡Œã€‚è®¾ç½®ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</td></tr></tbody></table></div><h3 id="15-â“ä»‹ç»ä¸€ä¸‹-ThreadLocal"><a href="#15-â“ä»‹ç»ä¸€ä¸‹-ThreadLocal" class="headerlink" title="15.â“ä»‹ç»ä¸€ä¸‹ ThreadLocal"></a>15.â“ä»‹ç»ä¸€ä¸‹ ThreadLocal</h3><blockquote><p>Threadç±»æœ‰ä¸¤ä¸ªå˜é‡ï¼šthreadLocalså’ŒinheritableThreadLocalsã€‚</p><p>è¿™ä¸¤ä¸ªå˜é‡é»˜è®¤ä¸ºnullï¼Œåªæœ‰å½“è¯¥çº¿ç¨‹è°ƒç”¨äº†ThreadLocalç±»çš„get/setæ–¹æ³•æ—¶æ‰ä¼šåˆ›å»ºä»–ä»¬ï¼Œè€Œè°ƒç”¨ThreadLocalçš„get/setå®é™…ä¸Šæ˜¯è°ƒç”¨ThreadLocalMapçš„get/setã€‚</p><p>ThreadLocalMapå¯ç†è§£æˆç»™ThreadLocalå®šåˆ¶åŒ–çš„HashMapã€‚</p><p>æœ€ç»ˆçš„å˜é‡æ”¾åœ¨äº†çº¿ç¨‹çš„ThreadLocalMapä¸­ï¼Œè€Œä¸æ˜¯ThreadLocalä¸­ï¼ŒThreadLocalåªæ˜¯å¯¹å…¶è¿›è¡Œå°è£…ï¼Œå‘å…¶ä¼ é€’å˜é‡å€¼ã€‚</p><p>ç”¨ä¸€ä¸ªåœºæ™¯åˆ†æThreadLocalçš„get/setæµç¨‹ï¼š</p><p>é¦–å…ˆåœ¨æ‰€æœ‰çº¿ç¨‹å¤–éƒ¨åˆ›å»ºä¸€ä¸ªå…±äº«çš„ThreadLocalå¯¹è±¡ï¼Œè®°ä¸ºTL1ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨TL1.get()æ—¶ï¼Œé¦–å…ˆè·å–åˆ°å½“å‰çº¿ç¨‹å¯¹è±¡ï¼Œè®°ä¸ºtï¼Œç„¶ååˆ¤æ–­t.threadLocalsæ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œå°±åœ¨tä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadLocalMapå¯¹è±¡èµ‹å€¼ç»™t.threadLocalsï¼Œå¹¶å°†\<TL1,null>æ’å…¥å…¶ä¸­ï¼Œæœ€ågetæ–¹æ³•è¿”å›nullï¼›å¦‚æœä¸ä¸ºnullï¼Œåˆ™å°è¯•è·å–threadLocalsä¸­TL1æ‰€åœ¨çš„é”®å€¼å¯¹ï¼Œå¦‚æœè¯¥é”®å€¼å¯¹ä¸ºnullï¼Œåˆ™å‘threadLocalsä¸­é€šè¿‡setæ–¹æ³•æ’å…¥\<TL1,null>ï¼Œæœ€åè¿”å›nullï¼Œå¦‚æœé”®å€¼å¯¹ä¸ä¸ºnullï¼Œåˆ™è¿”å›é”®å€¼å¯¹ä¸­çš„å€¼ã€‚</p><p>è°ƒç”¨setæ–¹æ³•æ—¶ï¼Œæµç¨‹å’ŒgetåŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ä»è¯»å˜æˆäº†å†™ã€‚</p><p>è¿™æ ·å°±å¯ä»¥å®ç°ä¸åŒçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªThreadLocalï¼ˆTL1ï¼‰èƒ½æ‹¿åˆ°å„è‡ªå‘å…¶ä¸­å­˜æ”¾çš„å€¼ã€‚&#x20;</p></blockquote><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-5.png" alt=""></p><h3 id="16-ThreadLocal-å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—"><a href="#16-ThreadLocal-å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—" class="headerlink" title="16.ThreadLocal å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—"></a>16.ThreadLocal å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—</h3><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-3.png" alt=""></p><p><strong>åˆ†æ</strong></p><p>ThreadLocal å†…å­˜æ³„éœ²ä¹Ÿæ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜äº†ï¼Œç½‘ä¸Šéƒ¨åˆ†èµ„æ–™ï¼ŒåŒ…æ‹¬å¥½å¤šé¢è¯•å®˜éƒ½æŠŠè¿™ä¸ªé—®é¢˜å‡ºç°çš„ä¸»è¦åŸå› å½’ç»“ä¸º ThreadLocalMaps é‡Œ Entry Keyï¼ˆThreadLocal å¯¹è±¡æœ¬èº«ï¼‰ä½¿ç”¨äº†å¼±å¼•ç”¨å¯¼è‡´çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä»”ç»†çœ‹çœ‹å¼•ç”¨ç»“æ„ï¼Œè„‘è¡¥ä¸€ä¸‹å†…å­˜æ³„éœ²çš„åœºæ™¯å°±ä¸éš¾å‘ç°ï¼ŒçœŸæ­£å¯¼è‡´å†…å­˜æ³„éœ²çš„ä¸»è¦åŸå› ï¼Œå…¶å®æ˜¯ Thread å¼ºå¼•ç”¨ ThreadLocalMapsï¼Œå¦‚æœ Thread ä¸€ç›´å­˜åœ¨ï¼ŒThreadLocalMaps Entry ä¸­çš„ value è¿™ä¸ªå¼ºå¼•ç”¨ä¸€ç›´å­˜åœ¨ï¼Œä¸è¢«å›æ”¶æ‰æ˜¯å¯¼è‡´å‘ç”Ÿå†…å­˜æ³„éœ²çš„çœŸæ­£åŸå› </p><blockquote><p>å› ä¸º ThreadLocal æœ¬èº«ä¸å­˜å‚¨å¯¹è±¡ï¼Œæ˜¯è°ƒç”¨ Thread ä¸­çš„ ThreadLocalMaps æ¥ä¿å­˜ï¼Œè€Œ Thread å¼ºå¼•ç”¨ ThreadLocalMaps å¯¹è±¡ï¼Œå¦‚æœ Thread å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿ï¼Œä¸èƒ½åŠæ—¶è¢«å›æ”¶ï¼Œå°±ä¼šå¯¼è‡´ ThreadLocalMaps å¯¹è±¡é‡Œ Entry çš„ value å­˜åœ¨å†…å­˜æ³„éœ²çš„å¯èƒ½ã€‚</p><p>å½“ç„¶ ThreadLocalMaps åœ¨è®¾è®¡çš„æ—¶å€™ä¹Ÿè€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ ThreadLocalMaps Key é‡‡ç”¨äº†å¼±å¼•ç”¨çš„æ–¹å¼ï¼Œå¹¶ä¸”åœ¨ setã€removeã€rehash çš„æ—¶å€™ä¼šä¸»åŠ¨æ¸…ç† ThreadLocalMaps ä¸­ Key ä¸º Null çš„ valueï¼Œä½†æ˜¯å¦‚æœ ThreadLocal å·²ç»ä¸è¢«ä½¿ç”¨äº† setã€removeã€rehash æ–¹æ³•ä¹Ÿä¸ä¼šè¢«è°ƒç”¨ï¼Œä¸æ­¤åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªçº¿ç¨‹åˆä¸€ç›´å­˜æ´»ã€ä¸ç»ˆæ­¢çš„è¯ï¼Œé‚£ä¹ˆä¸€ThreadLocalMaps ä¸­çš„ Value å¼ºå¼•ç”¨å°±ä¼šä¸€ç›´å­˜åœ¨ï¼Œä¹Ÿå°±é¿å…ä¸äº† Value çš„å†…å­˜æ³„æ¼</p></blockquote><p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%2078%20%E8%AE%B2-%E5%AE%8C/47%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E2%80%94%E2%80%94%E4%B8%BA%E4%BD%95%E6%AF%8F%E6%AC%A1%E7%94%A8%E5%AE%8C%20ThreadLocal%20%E9%83%BD%E8%A6%81%E8%B0%83%E7%94%A8%20remove\(\">47 å†…å­˜æ³„æ¼â€”â€”ä¸ºä½•æ¯æ¬¡ç”¨å®Œ ThreadLocal éƒ½è¦è°ƒç”¨ remove()?</a>%EF%BC%9F.md)</p><h3 id="17-ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡"><a href="#17-ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡" class="headerlink" title="17.ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡?"></a>17.ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>å¦‚æœç”¨æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆæˆå‘˜å˜é‡å¿…é¡»åœ¨Threadé‡Œï¼Œä¸èƒ½åœ¨Runnableé‡Œï¼Œå› ä¸ºä¸€ä¸ªRunnableå¯¹è±¡å¯ä»¥è¢«å¤šä¸ªThreadæ‰§è¡Œã€‚</p><p>è€Œå¦‚æœåœ¨Threadä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Œå°±è¦åŠ å¼ºThreadå’ŒRunnableçš„è€¦åˆï¼Œå°†Threadä½œä¸ºRunnableçš„æˆå‘˜å˜é‡ï¼Œå¹¶åœ¨Runnableä¸­è°ƒç”¨å…·ä½“çš„Threadå˜é‡ï¼Œå¦‚æœæ‰§è¡ŒRunnableçš„Threadå¯èƒ½æœ‰å¾ˆå¤šå­ç±»ï¼Œä¸åŒå­ç±»æœ‰ä¸åŒçš„æˆå‘˜å˜é‡ï¼Œåˆ™è¦åœ¨runæ–¹æ³•ä¸­è¿›è¡Œå¤æ‚å¤„ç†ï¼Œæ‰©å±•æ€§è¾ƒä½ï¼Œä¸åˆ©äºç»´æŠ¤ã€‚è€ŒThreadLocalå°±æ˜¯å°†æˆå‘˜å˜é‡ç»Ÿä¸€ä¸ºä¸€ä¸ªMapæ”¾åˆ°çº¿ç¨‹é‡Œã€‚&#x20;</p></blockquote><h2 id="â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile-Synchronized-CASï¼‰"><a href="#â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile-Synchronized-CASï¼‰" class="headerlink" title="â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile/Synchronized/CASï¼‰"></a>â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile/Synchronized/CASï¼‰</h2><h3 id="1-çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥"><a href="#1-çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥" class="headerlink" title="1. çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥"></a>1. çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>- åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼šçº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥ã€‚é€šä¿¡æ˜¯æŒ‡çº¿ç¨‹ä¹‹é—´ä»¥å¦‚ä½•æ¥äº¤æ¢ä¿¡æ¯ã€‚ä¸€èˆ¬çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æœºåˆ¶æœ‰ä¸¤ç§ï¼šå…±äº«å†…å­˜å’Œæ¶ˆæ¯ä¼ é€’ã€‚åŒæ­¥æ˜¯æŒ‡ç¨‹åºä¸­ç”¨äºæ§åˆ¶ä¸åŒçº¿ç¨‹é—´æ“ä½œå‘ç”Ÿç›¸å¯¹é¡ºåºçš„æœºåˆ¶ã€‚</p><p>- Javaçš„å¹¶å‘é‡‡ç”¨çš„æ˜¯å…±äº«å†…å­˜æ¨¡å‹ï¼ŒJavaçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ€»æ˜¯éšå¼è¿›è¡Œï¼Œæ•´ä¸ªé€šä¿¡è¿‡ç¨‹å¯¹ç¨‹åºå‘˜å®Œå…¨é€æ˜ã€‚å¦‚æœç¼–å†™å¤šçº¿ç¨‹ç¨‹åºçš„Javaç¨‹åºå‘˜ä¸ç†è§£éšå¼è¿›è¡Œçš„çº¿ç¨‹ä¹‹é—´é€šä¿¡çš„å·¥ä½œæœºåˆ¶ï¼Œå¾ˆå¯èƒ½ä¼šé‡åˆ°å„ç§å¥‡æ€ªçš„å†…å­˜å¯è§æ€§é—®é¢˜ã€‚</p><p>- åœ¨å…±äº«å†…å­˜å¹¶å‘æ¨¡å‹é‡Œï¼ŒåŒæ­¥æ˜¯æ˜¾å¼è¿›è¡Œçš„ã€‚ç¨‹åºå‘˜å¿…é¡»æ˜¾å¼æŒ‡å®šæŸä¸ªæ–¹æ³•æˆ–è€…æŸæ®µä»£ç éœ€è¦åœ¨çº¿ç¨‹ä¹‹é—´äº’æ–¥æ‰§è¡Œã€‚&#x20;</p></blockquote><h3 id="2-Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰"><a href="#2-Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰" class="headerlink" title="2.Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰"></a>2.Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</h3><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-4.png" alt=""></p><p><a href="https://blog.csdn.net/Your_heart_private/article/details/105566207">Jvmå†…å­˜æ¨¡å‹å’ŒJMMæ¨¡å‹ç»“æ„å›¾_java jmmæ¨¡å‹å›¾-CSDNåšå®¢</a></p><p><a href="https://pdai.tech/md/java/jvm/java-jvm-x-introduce.html">JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥</a></p><p><a href="https://zhuanlan.zhihu.com/p/29881777">https://zhuanlan.zhihu.com/p/29881777</a></p><h3 id="3-Happens-Before-åŸåˆ™"><a href="#3-Happens-Before-åŸåˆ™" class="headerlink" title="3.Happens-Before åŸåˆ™"></a>3.Happens-Before åŸåˆ™</h3><p><strong>åˆ†æ</strong></p><p>ç†è§£JMMæ¨¡å‹å¦‚ä½•ä¿è¯å¹¶å‘å®‰å…¨æ€§ï¼ŒçŸ¥é“æŒ‡ä»¤é‡æ’ï¼Œç†è§£happens-beforeåŸåˆ™</p><p><strong>å›ç­”</strong></p><blockquote><p>happens-before å­—é¢æ„æ€å°±æ˜¯å…ˆè¡Œå‘ç”Ÿï¼Œä½ å¯ä»¥ç†è§£ä¸ºA happens before Bï¼Œå°±æ˜¯Aå‘ç”Ÿåœ¨Bä¹‹å‰ã€‚</p><p>happens-beforeï¼ˆHBï¼‰æ˜¯åœ¨JMMä¸­çš„ä¸€ä¸ªå¾ˆé‡è¦çš„è§„åˆ™ï¼Œå³ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹äºå¦ä¸€ä¸ªæ“ä½œæ˜¯å¯è§çš„ï¼Œç”¨æ¥æŒ‡å®šä¸¤ä¸ªæ“ä½œä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚&#x20;</p></blockquote><p><a href="https://blog.51cto.com/u_11812862/3002287">é˜¿é‡Œé¢è¯•é¢˜:Java å¹¶å‘ç¼–ç¨‹ä¹‹ happens-before è§„åˆ™_51CTOåšå®¢_java happens-beforeåŸåˆ™</a></p><h3 id="4-Java-æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ"><a href="#4-Java-æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ" class="headerlink" title="4.Java æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ"></a>4.Java æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ</h3><blockquote><p>å¹¶å‘æ§åˆ¶ä¸­çš„é”ä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œæ‚²è§‚é”å’Œä¹è§‚é”ï¼Œä¸€èˆ¬æ¥è¯´æ‚²è§‚é”æ˜¯åŸºäºMonitorå®ç°çš„ï¼Œè¿™åœ¨Javaä¸­åˆ†åˆ«å¯¹åº”synchronizedå…³é”®å­—å’ŒAQSã€‚ä¹è§‚é”æ˜¯åŸºäºCAS+è‡ªæ—‹æ¥å®ç°çš„ï¼ŒJavaä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯å¹¶å‘åŸå­ç±»ã€‚</p><p><strong>synchronized</strong></p><p>synchronizedä¿®é¥°çš„æ–¹æ³•æˆ–ä»£ç å—åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p><p>ä¸€èˆ¬æœ‰ä¸‰ç§ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li><p>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼šè°ƒç”¨æŸå¯¹è±¡çš„è¯¥æ–¹æ³•å‰è·å–è¯¥å¯¹è±¡å®ä¾‹çš„é”ã€‚</p></li><li><p>ä¿®é¥°é™æ€æ–¹æ³•ï¼šè°ƒç”¨æŸå¯¹è±¡çš„è¯¥æ–¹æ³•å‰è·å–è¯¥ç±»çš„é”ã€‚</p></li><li><p>ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰§è¡ŒåŒä¸€ä¸ªå¯¹è±¡synchronizedä¿®é¥°çš„å®ä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•æ—¶ä¸ä¼šå‘ç”Ÿäº’æ–¥ï¼Œå› ä¸ºé”çš„èµ„æºä¸åŒï¼Œä¸€ä¸ªé”äº†å¯¹è±¡å®ä¾‹ï¼Œä¸€ä¸ªé”äº†ç±»ã€‚</p></li><li><p>é”å¯¹è±¡ï¼Œä¿®é¥°ä»£ç å—ï¼šsynchronized(å¯¹è±¡çš„å¼•ç”¨)é”çš„æ˜¯å¯¹è±¡å®ä¾‹ï¼Œsynchronized(ç±».class)é”çš„æ˜¯ç±»ã€‚</p></li></ol><p>å°½é‡ä¸è¦ä½¿ç”¨synchronized(String a)å› ä¸ºJVMä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å…·æœ‰ç¼“å­˜åŠŸèƒ½ï¼</p><p>synchronizedä¸èƒ½ä¿®é¥°æ„é€ æ–¹æ³•ï¼Œä¹Ÿæ²¡å¿…è¦ä¿®é¥°ï¼Œæ„é€ æ–¹æ³•æœ¬èº«å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>åº•å±‚åŸç†ï¼šå°è¯•è·å–å¯¹è±¡çš„monitorï¼Œmonitorå·²è¢«å…¶ä»–çº¿ç¨‹å ç”¨æ—¶ï¼Œè·å–å¤±è´¥ï¼Œè¯¥çº¿ç¨‹è¿›å…¥EntrySetã€‚å æœ‰monitoræ—¶è°ƒç”¨wait()è¿›å…¥WaitSetã€‚è°ƒç”¨notify()æ—¶ä»WaitSeté‡Œéšæœºé€‰ä¸€ä¸ªçº¿ç¨‹å”¤é†’ï¼Œè°ƒç”¨notifyAllæ—¶å”¤é†’WaitSeté‡Œæ‰€æœ‰çº¿ç¨‹ã€‚</p><p><strong>&#x20;AQS</strong></p><p>AQSå…¨ç§°æ˜¯AbstractQueuedSynchronizerï¼Œå®ƒæ˜¯Javaä¸­ç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„åŸºç¡€æ¡†æ¶ï¼Œå¯ä»¥ç”¨äºå®ç°è¯¸å¦‚ReentrantLockã€Semaphoreã€CountDownLatchç­‰å¤šç§åŒæ­¥å·¥å…·ã€‚</p><p>AQSä¸»è¦ä¾èµ–äºä¸€ä¸ªåŒå‘é“¾è¡¨å’Œä¸€ä¸ªvolatileç±»å‹çš„æ•´æ•°stateæ¥å®ç°åŒæ­¥æ§åˆ¶ã€‚è¯¥æ•´æ•°stateç”¨æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œstate=0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;0è¡¨ç¤ºæœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockå¯ä»¥å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—é”ï¼Œæ¯æ¬¡stateå€¼åŠ ä¸€ã€‚</p><p>AQSçš„ä¸»è¦æ–¹æ³•æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p><ul><li><p>acquire()ï¼šè¯¥æ–¹æ³•ç”¨æ¥è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœåŒæ­¥çŠ¶æ€è¢«å ç”¨ï¼Œåˆ™çº¿ç¨‹å°†è¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p></li><li><p>acquireInterruptibly()ï¼šä¸acquire()ç±»ä¼¼ï¼Œä½†æ˜¯è¯¥æ–¹æ³•å…è®¸ä¸­æ–­æ“ä½œã€‚</p></li><li><p>tryAcquire()ï¼šè¯¥æ–¹æ³•ç”¨æ¥å°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p></li><li><p>release()ï¼šè¯¥æ–¹æ³•ç”¨æ¥é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚</p></li><li><p>acquireShared()ï¼šè¯¥æ–¹æ³•ç”¨æ¥è·å–å…±äº«å¼åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœåŒæ­¥çŠ¶æ€è¢«å ç”¨ï¼Œåˆ™çº¿ç¨‹å°†è¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p></li><li><p>releaseShared()ï¼šè¯¥æ–¹æ³•ç”¨æ¥é‡Šæ”¾å…±äº«å¼åŒæ­¥çŠ¶æ€ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚</p></li></ul><p>AQSå®ç°åŒæ­¥çš„å…³é”®åœ¨äºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåŸºäºFIFOé˜Ÿåˆ—çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œé€šè¿‡å°†ç­‰å¾…çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ—¶å€™ï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å”¤é†’ç­‰å¾…çº¿ç¨‹ï¼Œä»è€Œå®ç°äº†åŒæ­¥æœºåˆ¶ã€‚&#x20;</p><p>AQSçš„å®ç°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç‹¬å å¼ï¼ˆExclusiveï¼‰å’Œå…±äº«å¼ï¼ˆSharedï¼‰ã€‚ç‹¬å å¼æ˜¯æŒ‡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockï¼Œè€Œå…±äº«å¼æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚CountDownLatchã€‚åœ¨AQSä¸­ï¼Œè¿™ä¸¤ç§æ–¹å¼çš„å®ç°æ˜¯åŸºæœ¬ç›¸åŒçš„ï¼ŒåŒºåˆ«åœ¨äºè·å–å’Œé‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ–¹å¼ä¸åŒã€‚</p><p>ä»¥ä¸Šæ˜¯AQSçš„åŸºæœ¬å®ç°æ–¹å¼ï¼Œå®ƒæ˜¯Javaä¸­æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ ¸å¿ƒæ¡†æ¶ï¼Œä¸ºå„ç§åŒæ­¥å·¥å…·çš„å®ç°æä¾›äº†å¼ºå¤§çš„åŸºç¡€æ”¯æŒã€‚&#x20;</p></blockquote><p><a href="https://ls8sck0zrg.feishu.cn/wiki/Y6jkwwaHPiJw6skxQsfctlVVnMb#share-WZDZdVZqWobjF0xwtjocNSOqnQd">https://ls8sck0zrg.feishu.cn/wiki/Y6jkwwaHPiJw6skxQsfctlVVnMb#share-WZDZdVZqWobjF0xwtjocNSOqnQd</a></p><h3 id="5-synchronizedå…³é”®å­—"><a href="#5-synchronizedå…³é”®å­—" class="headerlink" title="5. synchronizedå…³é”®å­—"></a>5. synchronizedå…³é”®å­—</h3><p><strong>åˆ†æ</strong></p><p>å›ç­”synchronizedä½œç”¨ã€ç‰¹æ€§ã€å®ç°æ–¹å¼ï¼Œå¯ä»¥é€‚å½“ç”»å›¾æˆ–è€…ä¸¾ä¾‹ã€‚</p><p><strong>å›ç­”</strong></p><blockquote><p>synchronizedå…³é”®å­—æ˜¯Javaç”¨æ¥è§£å†³å¤šä¸ªçº¿ç¨‹å…±äº«èµ„æºç«äº‰é—®é¢˜ï¼ŒsynchronizedåŒæ­¥è¯­å¥å—å®ç°æ˜¯å…ˆæ‰§è¡ŒmonitorenteræŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šå°è¯•è·å–å¯¹è±¡çš„monitorï¼ŒæŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼ŒmonitorexitæŒ‡ä»¤åˆ™åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®ï¼Œsynchronizedå…³é”®å­—å¯ä»¥ä¿è¯è¢«å®ƒä¿®é¥°çš„æ–¹æ³•æˆ–è€…ä»£ç å—åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p><p>æ—©æœŸçš„synchronizedä¾èµ–æ“ä½œç³»ç»Ÿå®ç°ï¼Œå±äºé‡é‡é”ï¼ŒJDK 1.6ä»¥åå¯¹å…¶è¿›è¡Œäº†å¤§é‡çš„ä¼˜åŒ–ã€‚&#x20;</p></blockquote><p><a href="https://pdai.tech/md/java/thread/java-thread-x-key-synchronized.html">å…³é”®å­—: synchronizedè¯¦è§£</a></p><h3 id="6-è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—"><a href="#6-è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—" class="headerlink" title="6. è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—"></a>6. è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š</p><ul><li><p>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼šä½œç”¨äºå½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å¯¹è±¡å®ä¾‹çš„é”ã€‚</p></li><li><p>ä¿®é¥°é™æ€æ–¹æ³•ï¼šä¹Ÿå°±æ˜¯ç»™å½“å‰ç±»åŠ é”ï¼Œä¼šä½œç”¨äºç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œå› ä¸ºé™æ€æˆå‘˜ä¸å±äºä»»ä½•ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œæ˜¯ç±»æˆå‘˜ï¼ˆstaticè¡¨æ˜è¿™æ˜¯è¯¥ç±»çš„ä¸€ä¸ªé™æ€èµ„æºï¼Œä¸ç®¡newäº†å¤šå°‘ä¸ªå¯¹è±¡ï¼Œåªæœ‰ä¸€ä»½ï¼‰ã€‚æ‰€ä»¥å¦‚æœä¸€ä¸ªçº¿ç¨‹Aè°ƒç”¨ä¸€ä¸ªå®ä¾‹å¯¹è±¡çš„éé™æ€synchronizedæ–¹æ³•ï¼Œè€Œçº¿ç¨‹Béœ€è¦è°ƒç”¨è¿™ä¸ªå®ä¾‹å¯¹è±¡æ‰€å±ç±»çš„é™æ€synchronizedæ–¹æ³•ï¼Œæ˜¯å…è®¸çš„ï¼Œä¸ä¼šå‘ç”Ÿäº’æ–¥ç°è±¡ï¼Œå› ä¸ºè®¿é—®é™æ€synchronizedæ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰ç±»çš„é”ï¼Œè€Œè®¿é—®éé™æ€synchronizedæ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰å®ä¾‹å¯¹è±¡é”ã€‚&#x20;</p></li><li><p>ä¿®é¥°ä»£ç å—ï¼šæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚</p></li></ul><p>æ€»ç»“ï¼šsynchronizedå…³é”®å­—åŠ åˆ°staticé™æ€æ–¹æ³•å’Œsynchronized(class)ä»£ç å—ä¸Šéƒ½æ˜¯ç»™Classç±»ä¸Šé”ã€‚synchronizedå…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚å°½é‡ä¸è¦ä½¿ç”¨synchronized(String a)å› ä¸ºJVMä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å…·æœ‰ç¼“å­˜åŠŸèƒ½ï¼&#x20;</p></blockquote><h3 id="7-è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†"><a href="#7-è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†" class="headerlink" title="7. è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†?"></a>7. è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>Synchronizedçš„è¯­ä¹‰åº•å±‚æ˜¯é€šè¿‡ä¸€ä¸ªmonitorï¼ˆç›‘è§†å™¨é”ï¼‰çš„å¯¹è±¡æ¥å®Œæˆï¼Œæ¯ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç›‘è§†å™¨é”(monitor)ã€‚æ¯ä¸ªSynchronizedä¿®é¥°è¿‡çš„ä»£ç å½“å®ƒçš„monitorè¢«å ç”¨æ—¶å°±ä¼šå¤„äºé”å®šçŠ¶æ€å¹¶ä¸”å°è¯•è·å–monitorçš„æ‰€æœ‰æƒ ï¼Œè¿‡ç¨‹ï¼š</p><p>1ã€å¦‚æœmonitorçš„è¿›å…¥æ•°ä¸º0ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥monitorï¼Œç„¶åå°†è¿›å…¥æ•°è®¾ç½®ä¸º1ï¼Œè¯¥çº¿ç¨‹å³ä¸ºmonitorçš„æ‰€æœ‰è€…ã€‚</p><p>2ã€å¦‚æœçº¿ç¨‹å·²ç»å æœ‰è¯¥monitorï¼Œåªæ˜¯é‡æ–°è¿›å…¥ï¼Œåˆ™è¿›å…¥monitorçš„è¿›å…¥æ•°åŠ 1.</p><p>3ã€å¦‚æœå…¶ä»–çº¿ç¨‹å·²ç»å ç”¨äº†monitorï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°monitorçš„è¿›å…¥æ•°ä¸º0ï¼Œå†é‡æ–°å°è¯•è·å–monitorçš„æ‰€æœ‰æƒã€‚</p><p><code>synchronizedæ˜¯å¯ä»¥é€šè¿‡ åæ±‡ç¼–æŒ‡ä»¤javapå‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚</code></p></blockquote><h3 id="8-synchronizedå¯é‡å…¥çš„åŸç†"><a href="#8-synchronizedå¯é‡å…¥çš„åŸç†" class="headerlink" title="8. synchronizedå¯é‡å…¥çš„åŸç†"></a>8. synchronizedå¯é‡å…¥çš„åŸç†</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>é‡å…¥é”æ˜¯æŒ‡ä¸€çº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚åº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º0æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚</p></blockquote><h3 id="9-ä»€ä¹ˆæ˜¯è‡ªæ—‹"><a href="#9-ä»€ä¹ˆæ˜¯è‡ªæ—‹" class="headerlink" title="9. ä»€ä¹ˆæ˜¯è‡ªæ—‹"></a>9. ä»€ä¹ˆæ˜¯è‡ªæ—‹</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>å¾ˆå¤šsynchronizedé‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ­¤æ—¶ç­‰å¾…çš„çº¿ç¨‹éƒ½é˜»å¡å¯èƒ½æ˜¯ä¸€ç§ä¸å¤ªå€¼å¾—çš„æ“ä½œï¼Œå› ä¸ºçº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜ã€‚æ—¢ç„¶synchronizedé‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œè€Œæ˜¯åœ¨ çº¿ç¨‹çš„è¾¹ç•Œå¿™å¾ªç¯ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚</p></li><li><p>å¿™å¾ªç¯ï¼šå°±æ˜¯ç¨‹åºå‘˜ç”¨å¾ªç¯è®©ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œä¸åƒä¼ ç»Ÿæ–¹æ³•wait(),sleep() æˆ–yield() å®ƒä»¬éƒ½æ”¾å¼ƒäº†CPUæ§åˆ¶ï¼Œè€Œå¿™å¾ªç¯ä¸ä¼šæ”¾å¼ƒCPUï¼Œå®ƒå°±æ˜¯åœ¨è¿è¡Œä¸€ä¸ªç©ºå¾ªç¯ã€‚è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä¸ºäº†ä¿ç•™CPUç¼“å­˜ï¼Œåœ¨å¤šæ ¸ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªç­‰å¾…çº¿ç¨‹é†’æ¥çš„æ—¶å€™å¯èƒ½ä¼šåœ¨å¦ä¸€ä¸ªå†…æ ¸è¿è¡Œï¼Œè¿™æ ·ä¼šé‡å»ºç¼“å­˜ã€‚ä¸ºäº†é¿å…é‡å»ºç¼“å­˜å’Œå‡å°‘ç­‰å¾…é‡å»ºçš„æ—¶é—´å°±å¯ä»¥ä½¿ç”¨å®ƒäº†ã€‚&#x20;</p></li></ul><p>åœ¨Javaä¸­ï¼Œè‡ªæ—‹ï¼ˆSpinningï¼‰æ˜¯ä¸€ç§çº¿ç¨‹åŒæ­¥æŠ€æœ¯ï¼Œç”¨äºåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å®ç°é”æœºåˆ¶ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªå·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰çš„é”æ—¶ï¼Œè¯¥çº¿ç¨‹ä¸ä¼šæ”¾å¼ƒCPUæ—¶é—´ç‰‡ï¼Œè€Œæ˜¯è¿›è¡Œå¾ªç¯ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¿™ç­‰å¾…å¾ªç¯ï¼‰ï¼Œä¸æ–­æ£€æŸ¥é”æ˜¯å¦å¯ç”¨ã€‚è¿™ç§æœºåˆ¶æ—¨åœ¨å‡å°‘çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œæé«˜å“åº”é€Ÿåº¦ï¼Œä½†ä¹Ÿå¯èƒ½æµªè´¹å¤§é‡çš„CPUæ—¶é—´ã€‚</p><p>è‡ªæ—‹é”æ˜¯Javaå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œé€šè¿‡å…è®¸çº¿ç¨‹åœ¨é”ä¸å¯ç”¨æ—¶æŒç»­å°è¯•è·å–é”ï¼Œå®ƒå¯ä»¥é¿å…çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚ç„¶è€Œï¼Œå¦‚æœé”æŒæœ‰æ—¶é—´è¿‡é•¿ï¼Œè‡ªæ—‹çº¿ç¨‹ä¼šæµªè´¹å¤§é‡CPUæ—¶é—´ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚å› æ­¤ï¼Œè‡ªæ—‹é”éœ€è¦è°¨æ…ä½¿ç”¨ï¼Œä¾æ®å…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚è¿›è¡Œé€‰æ‹©å’Œä¼˜åŒ–ã€‚</p></blockquote><h3 id="10-å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ"><a href="#10-å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="10. å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ?"></a>10. å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>synchronizedé”å‡çº§åŸç†ï¼šåœ¨é”å¯¹è±¡çš„å¯¹è±¡å¤´é‡Œé¢æœ‰ä¸€ä¸ªthreadidå­—æ®µï¼Œåœ¨ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™threadidä¸ºç©ºï¼Œjvmè®©å…¶æŒæœ‰åå‘é”ï¼Œå¹¶å°†threadidè®¾ç½®ä¸ºå…¶çº¿ç¨‹idï¼Œå†æ¬¡è¿›å…¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­threadidæ˜¯å¦ä¸å…¶çº¿ç¨‹idä¸€è‡´ï¼Œå¦‚æœä¸€è‡´åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤å¯¹è±¡ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™å‡çº§åå‘é”ä¸ºè½»é‡çº§é”ï¼Œé€šè¿‡è‡ªæ—‹å¾ªç¯ä¸€å®šæ¬¡æ•°æ¥è·å–é”ï¼Œæ‰§è¡Œä¸€å®šæ¬¡æ•°ä¹‹åï¼Œå¦‚æœè¿˜æ²¡æœ‰æ­£å¸¸è·å–åˆ°è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œæ­¤æ—¶å°±ä¼šæŠŠé”ä»è½»é‡çº§å‡çº§ä¸ºé‡é‡çº§é”ï¼Œæ­¤è¿‡ç¨‹å°±æ„æˆäº†synchronizedé”çš„å‡çº§ã€‚&#x20;</p><p><code>é”çš„å‡çº§çš„ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚åœ¨Java 6ä¹‹åä¼˜åŒ–synchronizedçš„å®ç°æ–¹å¼ï¼Œä½¿ç”¨äº†åå‘é”å‡çº§ä¸ºè½»é‡çº§é”å†å‡çº§åˆ°é‡é‡çº§é”çš„æ–¹å¼ï¼Œä»è€Œå‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚</code></p><ul><li><p>åå‘é”ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒä¼šåå‘äºç¬¬ä¸€ä¸ªè®¿é—®é”çš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŒæ­¥é”åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹äº‰ç”¨çš„æƒ…å†µï¼Œåˆ™çº¿ç¨‹æ˜¯ä¸éœ€è¦è§¦å‘åŒæ­¥çš„ï¼Œå‡å°‘åŠ é” / è§£é”çš„ä¸€äº›CASæ“ä½œï¼ˆæ¯”å¦‚ç­‰å¾…é˜Ÿåˆ—çš„ä¸€äº›CASæ“ä½œï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä¼šç»™çº¿ç¨‹åŠ ä¸€ä¸ªåå‘é”ã€‚å¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†å…¶ä»–çº¿ç¨‹æŠ¢å é”ï¼Œåˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ŒJVMä¼šæ¶ˆé™¤å®ƒèº«ä¸Šçš„åå‘é”ï¼Œå°†é”æ¢å¤åˆ°æ ‡å‡†çš„è½»é‡çº§é”ã€‚</p></li><li><p>è½»é‡çº§é”æ˜¯ç”±åå‘æ‰€å‡çº§æ¥çš„ï¼Œåå‘é”è¿è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå½“ç¬¬äºŒä¸ªçº¿ç¨‹åŠ å…¥é”äº‰ç”¨çš„æ—¶å€™ï¼Œåå‘é”å°±ä¼šå‡çº§ä¸ºè½»é‡çº§é”ï¼›&#x20;</p></li><li><p>é‡é‡çº§é”æ˜¯synchronizedï¼Œæ˜¯Javaè™šæ‹Ÿæœºä¸­æœ€ä¸ºåŸºç¡€çš„é”å®ç°ã€‚åœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼ŒJavaè™šæ‹Ÿæœºä¼šé˜»å¡åŠ é”å¤±è´¥çš„çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨ç›®æ ‡é”è¢«é‡Šæ”¾çš„æ—¶å€™ï¼Œå”¤é†’è¿™äº›çº¿ç¨‹ã€‚&#x20;</p></li></ul></blockquote><p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E9%9D%A2%E8%AF%95%E7%B2%BE%E8%AE%B2/16%20%20synchronized%E5%BA%95%E5%B1%82%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F%E4%BB%80%E4%B9%88%E6%98%AF%E9%94%81%E7%9A%84%E5%8D%87%E7%BA%A7%E3%80%81%E9%99%8D%E7%BA%A7%EF%BC%9F-%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4.md">16 synchronizedåº•å±‚å¦‚ä½•å®ç°?ä»€ä¹ˆæ˜¯é”çš„å‡çº§ã€é™çº§?-æå®¢æ—¶é—´</a></p><blockquote><h3 id="11-çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡"><a href="#11-çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡" class="headerlink" title="11. çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡"></a>11. çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><p>(1) volatileä¿®é¥°å˜é‡</p><p>(2) synchronizedä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•</p><p>(3) wait/notify</p></blockquote><h3 id="12-å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B"><a href="#12-å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B" class="headerlink" title="12. å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B?"></a>12. å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><p>ä¸èƒ½ã€‚å…¶å®ƒçº¿ç¨‹åªèƒ½è®¿é—®è¯¥å¯¹è±¡çš„éåŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥æ–¹æ³•åˆ™ä¸èƒ½è¿›å…¥ã€‚å› ä¸ºéé™æ€æ–¹æ³•ä¸Šçš„synchronizedä¿®é¥°ç¬¦è¦æ±‚æ‰§è¡Œæ–¹æ³•æ—¶è¦è·å¾—å¯¹è±¡çš„é”ï¼Œå¦‚æœå·²ç»è¿›å…¥Aæ–¹æ³•è¯´æ˜å¯¹è±¡é”å·²ç»è¢«å–èµ°ï¼Œé‚£ä¹ˆè¯•å›¾è¿›å…¥Bæ–¹æ³•çš„çº¿ç¨‹å°±åªèƒ½åœ¨ç­‰é”æ± ï¼ˆæ³¨æ„ä¸æ˜¯ç­‰å¾…æ± å“¦ï¼‰ä¸­ç­‰å¾…å¯¹è±¡çš„é”ã€‚</p></blockquote><h3 id="13-synchronizedã€volatileã€CASæ¯”è¾ƒ"><a href="#13-synchronizedã€volatileã€CASæ¯”è¾ƒ" class="headerlink" title="13. synchronizedã€volatileã€CASæ¯”è¾ƒ"></a>13. synchronizedã€volatileã€CASæ¯”è¾ƒ</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><p>(1) synchronizedæ˜¯æ‚²è§‚é”ï¼Œå±äºæŠ¢å å¼ï¼Œä¼šå¼•èµ·å…¶ä»–çº¿ç¨‹é˜»å¡ã€‚</p><p>(2) volatileæä¾›å¤šçº¿ç¨‹å…±äº«å˜é‡å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚&#x20;</p><p>(3) CASæ˜¯åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚é”ï¼ˆéé˜»å¡ï¼‰&#x20;</p></blockquote><p><a href="https://refblogs.com/article/582">å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronizedã€volatileå’ŒCASæ“ä½œè¯¦è§£ - æ¬ç –çš„ç å†œ</a></p><h3 id="14-synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#14-synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="14. synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«?"></a>14. synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>é¦–å…ˆsynchronizedæ˜¯Javaå†…ç½®å…³é”®å­—ï¼Œåœ¨JVMå±‚é¢ï¼ŒLockæ˜¯ä¸ªæ¥å£ï¼›</p></li><li><p>åŸç†åŒºåˆ«ï¼šsynchronizedæ˜¯å†…ç½®é”ï¼Œç”±JVMå®ç°è·å–é”å’Œé‡Šæ”¾é”çš„åŸç†ï¼Œè¿˜åˆ†ä¸ºåå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ã€‚Lockæ ¹æ®å®ç°ä¸åŒï¼Œæœ‰ä¸åŒçš„åŸç†ï¼Œä¾‹å¦‚ReentrantLockå†…éƒ¨æ˜¯é€šè¿‡AQSæ¥è·å–å’Œé‡Šæ”¾é”çš„ã€‚</p></li><li><p>ç”¨æ³•åŒºåˆ«ï¼šsynchronizedå¯ä»¥ç»™ç±»ã€æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼›è€Œlockåªèƒ½ç»™ä»£ç å—åŠ é”ã€‚synchronizedä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œä½¿ç”¨ç®€å•ï¼Œå‘ç”Ÿå¼‚å¸¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä¸å®¹æ˜“é€ æˆæ­»é”ï¼›è€Œlockéœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼Œå¦‚æœä½¿ç”¨ä¸å½“æ²¡æœ‰unLock()å»é‡Šæ”¾é”å°±ä¼šé€ æˆæ­»é”ã€‚</p></li><li><p>synchronizedé”åªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œä½†æ˜¯Locké”æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œä¾‹å¦‚åœ¨è¯»å†™é”ä¸­çš„è¯»é”ï¼Œæ˜¯å¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æŒæœ‰çš„ï¼Œå¯æ˜¯synchronizedåšä¸åˆ°ã€‚</p></li><li><p>synchronizedé”ä¸å¤Ÿçµæ´»ï¼Œä¸€æ—¦synchronizedé”å·²ç»è¢«æŸä¸ªçº¿ç¨‹è·å¾—äº†ï¼Œæ­¤æ—¶å…¶ä»–çº¿ç¨‹å¦‚æœè¿˜æƒ³è·å¾—ï¼Œé‚£å®ƒåªèƒ½è¢«é˜»å¡ï¼Œç›´åˆ°æŒæœ‰é”çš„çº¿ç¨‹è¿è¡Œå®Œæ¯•æˆ–è€…å‘ç”Ÿå¼‚å¸¸ä»è€Œé‡Šæ”¾è¿™ä¸ªé”ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æŒæœ‰å¾ˆé•¿æ—¶é—´æ‰é‡Šæ”¾ï¼Œé‚£ä¹ˆæ•´ä¸ªç¨‹åºçš„è¿è¡Œæ•ˆç‡å°±ä¼šé™ä½ï¼Œè€Œä¸”å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æ°¸è¿œä¸é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå°è¯•è·å–é”çš„çº¿ç¨‹åªèƒ½æ°¸è¿œç­‰ä¸‹å»ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒLockç±»åœ¨ç­‰é”çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯lockInterruptiblyæ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœè§‰å¾—ç­‰å¾…çš„æ—¶é—´å¤ªé•¿äº†ä¸æƒ³å†ç»§ç»­ç­‰å¾…ï¼Œå¯ä»¥ä¸­æ–­é€€å‡ºï¼Œä¹Ÿå¯ä»¥ç”¨tryLock()ç­‰æ–¹æ³•å°è¯•è·å–é”ï¼Œå¦‚æœè·å–ä¸åˆ°é”ä¹Ÿå¯ä»¥åšåˆ«çš„äº‹ï¼Œæ›´åŠ çµæ´»ã€‚&#x20;</p></li><li><p>æ€§èƒ½åŒºåˆ«ï¼šåœ¨Java 5ä»¥åŠä¹‹å‰ï¼Œsynchronizedçš„æ€§èƒ½æ¯”è¾ƒä½ï¼Œä½†æ˜¯åˆ°äº†Java 6ä»¥åå‘ç”Ÿäº†å˜åŒ–ï¼Œå› ä¸ºJDKå¯¹synchronizedè¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚è‡ªé€‚åº”è‡ªæ—‹ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ã€è½»é‡çº§é”ã€åå‘é”ç­‰ï¼Œæ‰€ä»¥åæœŸçš„Javaç‰ˆæœ¬é‡Œçš„synchronizedçš„æ€§èƒ½å¹¶ä¸æ¯”Lockå·®ã€‚&#x20;</p></li></ul></blockquote><h3 id="15-synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©"><a href="#15-synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©" class="headerlink" title="15. synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©?"></a>15. synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ol><li><p>å¦‚æœèƒ½ä¸ç”¨æœ€å¥½æ—¢ä¸ä½¿ç”¨Lockä¹Ÿä¸ä½¿ç”¨synchronizedã€‚å› ä¸ºåœ¨è®¸å¤šæƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨java.util.concurrentåŒ…ä¸­çš„æœºåˆ¶ï¼Œå®ƒä¼šä¸ºä½ å¤„ç†æ‰€æœ‰çš„åŠ é”å’Œè§£é”æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ¨èä¼˜å…ˆä½¿ç”¨å·¥å…·ç±»æ¥åŠ è§£é”ã€‚</p></li><li><p>å¦‚æœsynchronizedå…³é”®å­—é€‚åˆä½ çš„ç¨‹åºï¼Œé‚£ä¹ˆè¯·å°½é‡ä½¿ç”¨å®ƒï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç¼–å†™ä»£ç çš„æ•°é‡ï¼Œå‡å°‘å‡ºé”™çš„æ¦‚ç‡ã€‚å› ä¸ºä¸€æ—¦å¿˜è®°åœ¨finallyé‡Œunlockï¼Œä»£ç å¯èƒ½ä¼šå‡ºå¾ˆå¤§çš„é—®é¢˜ï¼Œè€Œä½¿ç”¨synchronizedæ›´å®‰å…¨ã€‚</p></li><li><p>å¦‚æœç‰¹åˆ«éœ€è¦Lockçš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œæ¯”å¦‚å°è¯•è·å–é”ã€å¯ä¸­æ–­ã€è¶…æ—¶åŠŸèƒ½ç­‰ï¼Œæ‰ä½¿ç”¨Lockã€‚</p></li></ol></blockquote><p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%2078%20%E8%AE%B2-%E5%AE%8C/22%20synchronized%20%E5%92%8C%20Lock%20%E5%AD%B0%E4%BC%98%E5%AD%B0%E5%8A%A3%EF%BC%8C%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%EF%BC%9F.md">22 synchronized å’Œ Lock å­°ä¼˜å­°åŠ£ï¼Œå¦‚ä½•é€‰æ‹©?</a></p><h3 id="16-synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#16-synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="16. synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ?"></a>16. synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>synchronizedå’ŒReentrantLockéƒ½æ˜¯Javaä¸­æä¾›çš„å¯é‡å…¥é”ï¼ŒäºŒè€…çš„ä¸»è¦åŒºåˆ«æœ‰ä»¥ä¸‹5ä¸ªï¼š</p><ul><li><p>ç”¨æ³•ä¸åŒï¼šsynchronizedå¯ä»¥ç”¨æ¥ä¿®é¥°æ™®é€šæ–¹æ³•ã€é™æ€æ–¹æ³•å’Œä»£ç å—ï¼Œè€ŒReentrantLockåªèƒ½ç”¨äºä»£ç å—ã€‚</p></li><li><p>è·å–é”å’Œé‡Šæ”¾é”çš„æœºåˆ¶ä¸åŒï¼šsynchronizedæ˜¯è‡ªåŠ¨åŠ é”å’Œé‡Šæ”¾é”çš„ï¼Œè€ŒReentrantLockéœ€è¦æ‰‹åŠ¨åŠ é”å’Œé‡Šæ”¾é”ã€‚</p></li><li><p>é”ç±»å‹ä¸åŒï¼šsynchronizedæ˜¯éå…¬å¹³é”ï¼Œè€ŒReentrantLocké»˜è®¤ä¸ºéå…¬å¹³é”ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸ºå…¬å¹³é”ã€‚&#x20;</p></li><li><p>å“åº”ä¸­æ–­ä¸åŒï¼šReentrantLockå¯ä»¥å“åº”ä¸­æ–­ï¼Œè§£å†³æ­»é”çš„é—®é¢˜ï¼Œè€Œsynchronizedä¸èƒ½å“åº”ä¸­æ–­ã€‚</p></li><li><p>åº•å±‚å®ç°ä¸åŒï¼šsynchronizedæ˜¯JVMå±‚é¢é€šè¿‡ç›‘è§†å™¨å®ç°çš„ï¼Œè€ŒReentrantLockæ˜¯åŸºäºAQS</p></li></ul></blockquote><p><a href="https://www.51cto.com/article/707239.html">https://www.51cto.com/article/707239.html</a></p><h3 id="17-volatileå…³é”®å­—çš„ä½œç”¨"><a href="#17-volatileå…³é”®å­—çš„ä½œç”¨" class="headerlink" title="17. volatileå…³é”®å­—çš„ä½œç”¨"></a>17. volatileå…³é”®å­—çš„ä½œç”¨</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>å¯¹äºå¯è§æ€§ï¼ŒJavaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚volatileç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢«volatileä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å†…å­˜ä¸­ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚</p></li><li><p>ä»å®è·µè§’åº¦è€Œè¨€ï¼Œvolatileçš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯å’ŒCASç»“åˆï¼Œä¿è¯äº†åŸå­æ€§ï¼Œè¯¦ç»†çš„å¯ä»¥å‚è§java.util.concurrent.atomicåŒ…ä¸‹çš„ç±»ï¼Œæ¯”å¦‚AtomicIntegerã€‚</p></li></ul></blockquote><h3 id="18-Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—"><a href="#18-Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—" class="headerlink" title="18. Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—?"></a>18. Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>èƒ½ï¼ŒJavaä¸­å¯ä»¥åˆ›å»ºvolatileç±»å‹æ•°ç»„ï¼Œä¸è¿‡åªæ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ã€‚æ„æ€æ˜¯ï¼Œå¦‚æœæ”¹å˜å¼•ç”¨æŒ‡å‘çš„æ•°ç»„ï¼Œå°†ä¼šå—åˆ°volatileçš„ä¿æŠ¤ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ”¹å˜æ•°ç»„çš„å…ƒç´ ï¼Œvolatileæ ‡ç¤ºç¬¦å°±ä¸èƒ½èµ·åˆ°ä¹‹å‰çš„ä¿æŠ¤ä½œç”¨äº†ã€‚&#x20;</p></blockquote><h3 id="19-volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—"><a href="#19-volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—" class="headerlink" title="19. volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—?"></a>19. volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>å…³é”®å­—volatileçš„ä¸»è¦ä½œç”¨æ˜¯ä½¿å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´å¯è§ï¼Œä½†æ— æ³•ä¿è¯åŸå­æ€§ï¼Œå¯¹äºå¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå®ä¾‹å˜é‡éœ€è¦åŠ é”è¿›è¡ŒåŒæ­¥ã€‚</p></li><li><p>è™½ç„¶volatileåªèƒ½ä¿è¯å¯è§æ€§ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨volatileä¿®é¥°longå’Œdoubleå¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚ï¼ˆ<a href="https://blog.csdn.net/tian2342/article/details/122665957ï¼‰">https://blog.csdn.net/tian2342/article/details/122665957ï¼‰</a></p></li></ul></blockquote><h3 id="20-synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#20-synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="20. synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?"></a>20. synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li><p>synchronizedè¡¨ç¤ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–ä½œç”¨å¯¹è±¡çš„é”ï¼Œæ‰§è¡Œä»£ç ï¼Œé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚</p></li><li><p>volatileè¡¨ç¤ºå˜é‡åœ¨CPUçš„å¯„å­˜å™¨ä¸­æ˜¯ä¸ç¡®å®šçš„ï¼Œå¿…é¡»ä»ä¸»å­˜ä¸­è¯»å–ã€‚ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å˜é‡çš„å¯è§æ€§ï¼›ç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚</p></li></ul><p><strong>åŒºåˆ«</strong></p><ul><li><p>volatileæ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronizedå¯ä»¥ä¿®é¥°æ–¹æ³•ï¼Œä»£ç å—ã€‚</p></li><li><p>volatileä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼›è€Œsynchronizedåˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’ŒåŸå­æ€§ã€‚&#x20;</p></li><li><p>volatileä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronizedå¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ã€‚</p></li><li><p>volatileæ ‡è®°çš„å˜é‡ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼›synchronizedæ ‡è®°çš„å˜é‡å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</p></li><li><p>volatileå…³é”®å­—æ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œæ‰€ä»¥volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½ã€‚ä½†æ˜¯volatileå…³é”®å­—åªèƒ½ç”¨äºå˜é‡è€Œsynchronizedå…³é”®å­—å¯ä»¥ä¿®é¥°æ–¹æ³•ä»¥åŠä»£ç å—ã€‚synchronizedå…³é”®å­—åœ¨JavaSE1.6ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œå®é™…å¼€å‘ä¸­ä½¿ç”¨synchronizedå…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›ã€‚&#x20;</p></li></ul></blockquote><h3 id="21-è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£"><a href="#21-è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£" class="headerlink" title="21. è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£"></a>21. è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£</h3><blockquote><p>volatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li><p>ä¿è¯å¯è§æ€§ï¼švolatileä¿è¯äº†å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œæ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ä¼šç«‹å³çœ‹åˆ°è¿™ä¸ªæ”¹å˜ã€‚</p></li><li><p>ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼švolatileé€šè¿‡ç¦æ­¢æŒ‡ä»¤é‡æ’æ¥ä¿è¯é¡ºåºæ€§ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸ºäº†æé«˜ç¨‹åºæ‰§è¡Œæ•ˆç‡ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå˜é‡è¢«volatileä¿®é¥°ï¼Œå°±ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ï¼Œç¡®ä¿æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°æ­£ç¡®çš„æ“ä½œé¡ºåºã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œvolatileå¯ä»¥ç¡®ä¿å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œä¸€è‡´ï¼Œé¿å…äº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚<strong>ä½†æ˜¯å®ƒä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œå› æ­¤å¯¹äºéœ€è¦ä¿è¯åŸå­æ€§çš„æ“ä½œè¿˜éœ€è¦ä½¿ç”¨å…¶ä»–åŒæ­¥æœºåˆ¶ï¼Œå¦‚synchronizedå…³é”®å­—æˆ–java.util.concurrent.atomicåŒ…ä¸­çš„åŸå­ç±»ã€‚&#x20;</strong></p><p><strong>volatileå…³é”®å­—</strong>é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼š</p><ol><li><p>å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰ï¼šå½“ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨çœ‹åˆ°volatileä¿®é¥°çš„å˜é‡æ—¶ï¼Œå®ƒä¼šåœ¨è¯¥å˜é‡å‰åæ’å…¥å†…å­˜å±éšœã€‚å†…å­˜å±éšœå¯ä»¥ä¿è¯åœ¨è¯¥å±éšœä¹‹å‰çš„æ‰€æœ‰è¯»å†™æ“ä½œéƒ½å¿…é¡»åœ¨å±éšœä¹‹åçš„è¯»å†™æ“ä½œä¹‹å‰å®Œæˆã€‚è¿™å®é™…ä¸Šå°±ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ã€‚</p></li><li><p>å¼ºåˆ¶ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼šå½“ä¸€ä¸ªçº¿ç¨‹å‘è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡å†™å…¥æ•°æ®æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå¼ºåˆ¶è¿™ä¸ªå€¼è¢«ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ã€‚è¿™ç¡®ä¿äº†å…¶ä»–çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°è¿™ä¸ªä¿®æ”¹ã€‚</p></li><li><p>å¼ºåˆ¶ä»ä¸»å†…å­˜è¯»å–ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è¯»å–è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå¼ºåˆ¶è¦æ±‚å®ƒä»ä¸»å†…å­˜ä¸­è¯»å–è¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯ä»è¯¥çº¿ç¨‹çš„æœ¬åœ°ç¼“å­˜ä¸­è¯»å–ã€‚è¿™ç¡®ä¿äº†è¯¥çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°å…¶ä»–çº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡çš„ä¿®æ”¹ã€‚&#x20;</p></li></ol></blockquote><h2 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h2><h3 id="1-ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "><a href="#1-ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± " class="headerlink" title="1. ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ?"></a>1. ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šJavaä¸­çš„çº¿ç¨‹æ± æ˜¯è¿ç”¨åœºæ™¯æœ€å¤šçš„å¹¶å‘æ¡†æ¶ï¼Œå‡ ä¹æ‰€æœ‰éœ€è¦å¼‚æ­¥æˆ–å¹¶å‘æ‰§è¡Œä»»åŠ¡çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆç†åœ°ä½¿ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥è®¸å¤šå¥½å¤„ã€‚</p><ul><li><p>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œé™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</p></li><li><p>æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</p></li><li><p>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯ï¼Œè¦åšåˆ°åˆç†åˆ©ç”¨ ã€‚&#x20;</p></li></ul></blockquote><h3 id="2-æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›"><a href="#2-æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›" class="headerlink" title="2. æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›?"></a>2. æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›?</h3><p><strong>åˆ†æ</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">int</span> maximumPoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">long</span> keepAliveTime,</span></span><br><span class="line"><span class="params">                          TimeUnit unit,</span></span><br><span class="line"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class="line"><span class="params">                          ThreadFactory threadFactory,</span></span><br><span class="line"><span class="params">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><p>çº¿ç¨‹æ± çš„æ„é€ å‡½æ•°æœ‰7ä¸ªå‚æ•°ï¼š</p><ul><li><p>corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°</p></li><li><p>maximumPoolSizeï¼šçº¿ç¨‹æ± èƒ½åˆ›å»ºçº¿ç¨‹çš„æœ€å¤§ä¸ªæ•°</p></li><li><p>keepAliveTimeï¼šç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</p></li><li><p>unitï¼šæ—¶é—´å•ä½ï¼Œä¸ºkeepAliveTimeæŒ‡å®šæ—¶é—´å•ä½</p></li><li><p>workQueueï¼šé˜»å¡é˜Ÿåˆ—ï¼Œç”¨äºä¿å­˜ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—</p></li><li><p>threadFactoryï¼šåˆ›å»ºçº¿ç¨‹çš„å·¥ç¨‹ç±»</p></li><li><p>handlerï¼šé¥±å’Œç­–ç•¥ï¼ˆæ‹’ç»ç­–ç•¥ï¼‰&#x20;</p></li></ul></blockquote><h3 id="3-çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯"><a href="#3-çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯" class="headerlink" title="3. çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯"></a>3. çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</h3><p><strong>åˆ†æ</strong></p><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ol><li>newCachedThreadPool</li></ol><p>newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ± çš„é•¿åº¦è¶…è¿‡äº†å¤„ç†çš„éœ€è¦æ—¶ï¼Œå®ƒå¯ä»¥çµæ´»çš„å›æ”¶ç©ºé—²çš„çº¿ç¨‹ï¼Œå½“éœ€è¦å¢åŠ æ—¶ï¼Œå®ƒå¯ä»¥çµæ´»çš„æ·»åŠ æ–°çš„çº¿ç¨‹ï¼Œè€Œä¸ä¼šå¯¹æ± çš„é•¿åº¦ä½œä»»ä½•é™åˆ¶ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šæ‰§è¡Œå¾ˆå¤šçŸ­æœŸå¼‚æ­¥çš„å°ç¨‹åºã€‚</p><ul><li>newFixedThreadPool</li></ul><p>åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å®šé•¿çº¿ç¨‹æ± çš„å¤§å°æœ€å¥½æ ¹æ®ç³»ç»Ÿèµ„æºè¿›è¡Œè®¾ç½®ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šæ‰§è¡Œé•¿æœŸçš„ä»»åŠ¡ï¼Œæ€§èƒ½å¥½å¾ˆå¤šã€‚</p><ul><li>newScheduledThreadPool</li></ul><p>åˆ›å»ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± ï¼Œè€Œä¸”æ”¯æŒå®šæ—¶çš„ä»¥åŠå‘¨æœŸæ€§çš„ä»»åŠ¡æ‰§è¡Œã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ã€‚</p><ul><li>newSingleThreadExecutor</li></ul><p>åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒï¼Œå¿…é¡»ä¿è¯å‰ä¸€é¡¹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰èƒ½æ‰§è¡Œåä¸€é¡¹ã€‚ä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šé€‚åˆå¤šä¸ªä»»åŠ¡é¡ºåºæ‰§è¡Œçš„åœºæ™¯ï¼Œä¸éœ€è¦è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚&#x20;</p></blockquote><p><a href="https://www.cnblogs.com/sachen/p/7401959.html">åšå®¢å›­</a></p><h3 id="4-çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›"><a href="#4-çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›" class="headerlink" title="4. çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›"></a>4. çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›</h3><p><strong>åˆ†æ</strong></p><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li>AbortPolicy, é»˜è®¤</li></ul><p>è¯¥ç­–ç•¥æ˜¯çº¿ç¨‹æ± çš„é»˜è®¤ç­–ç•¥ã€‚ä½¿ç”¨è¯¥ç­–ç•¥æ—¶ï¼Œå¦‚æœçº¿ç¨‹æ± é˜Ÿåˆ—æ»¡äº†ä¸¢æ‰è¿™ä¸ªä»»åŠ¡å¹¶ä¸”æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚</p><ul><li>DiscardPolicy</li></ul><p>è¿™ä¸ªç­–ç•¥å’ŒAbortPolicyçš„silentç‰ˆæœ¬ï¼Œå¦‚æœçº¿ç¨‹æ± é˜Ÿåˆ—æ»¡äº†ï¼Œä¼šç›´æ¥ä¸¢æ‰è¿™ä¸ªä»»åŠ¡å¹¶ä¸”ä¸ä¼šæœ‰ä»»ä½•å¼‚å¸¸ã€‚</p><ul><li>DiscardOldestPolicy</li></ul><p>è¿™ä¸ªç­–ç•¥ä»å­—é¢ä¸Šä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä¸¢å¼ƒæœ€è€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œä¼šå°†æœ€æ—©è¿›å…¥é˜Ÿåˆ—çš„ä»»åŠ¡åˆ æ‰è…¾å‡ºç©ºé—´ï¼Œå†å°è¯•åŠ å…¥é˜Ÿåˆ—ã€‚å› ä¸ºé˜Ÿåˆ—æ˜¯é˜Ÿå°¾è¿›ï¼Œé˜Ÿå¤´å‡ºï¼Œæ‰€ä»¥é˜Ÿå¤´å…ƒç´ æ˜¯æœ€è€çš„ï¼Œå› æ­¤æ¯æ¬¡éƒ½æ˜¯ç§»é™¤é˜Ÿå¤´å…ƒç´ åå†å°è¯•å…¥é˜Ÿã€‚</p><ul><li>CallerRunsPolicy</li></ul><p>ä½¿ç”¨æ­¤ç­–ç•¥ï¼Œå¦‚æœæ·»åŠ åˆ°çº¿ç¨‹æ± å¤±è´¥ï¼Œé‚£ä¹ˆè°ƒç”¨çº¿ç¨‹ä¼šè‡ªå·±å»æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œä¸ä¼šç­‰å¾…çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å»æ‰§è¡Œã€‚å°±åƒæ˜¯ä¸ªæ€¥è„¾æ°”çš„äººï¼Œæˆ‘ç­‰ä¸åˆ°åˆ«äººæ¥åšè¿™ä»¶äº‹å°±å¹²è„†è‡ªå·±å¹²ã€‚&#x20;</p></blockquote><h3 id="5-åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«"><a href="#5-åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«" class="headerlink" title="5. åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«?"></a>5. åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>Executorså·¥å…·ç±»çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ã€‚</p><p>Executoræ¥å£å¯¹è±¡èƒ½æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡ã€‚</p><p>ExecutorServiceæ¥å£ç»§æ‰¿äº†Executoræ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚&#x20;</p></blockquote><h3 id="6-çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€"><a href="#6-çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€" class="headerlink" title="6.çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€"></a>6.çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€</h3><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-1.png" alt=""></p><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li><p>RUNNINGï¼šè¿™æ˜¯æœ€æ­£å¸¸çš„çŠ¶æ€ï¼Œæ¥å—æ–°çš„ä»»åŠ¡ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p></li><li><p>SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p></li><li><p>STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ã€‚</p></li><li><p>TIDYINGï¼šæ‰€æœ‰çš„çº¿ç¨‹éƒ½é”€æ¯äº†ï¼ŒworkerCountä¸º0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€è½¬æ¢ä¸ºTIDYINGçŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³•terminated()ã€‚</p></li><li><p>TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚</p></li></ul></blockquote><h3 id="7-çº¿ç¨‹æ± ä¸­submit-å’Œexecute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#7-çº¿ç¨‹æ± ä¸­submit-å’Œexecute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="7. çº¿ç¨‹æ± ä¸­submit()å’Œexecute()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>7. çº¿ç¨‹æ± ä¸­submit()å’Œexecute()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>ç›¸åŒç‚¹ï¼š</p><ul><li>ç›¸åŒç‚¹å°±æ˜¯éƒ½å¯ä»¥å¼€å¯çº¿ç¨‹æ‰§è¡Œæ± ä¸­çš„ä»»åŠ¡ã€‚</li></ul></li><li><p>ä¸åŒç‚¹ï¼š</p><ul><li><p>æ¥æ”¶å‚æ•°ï¼šexecute()åªèƒ½æ‰§è¡ŒRunnableç±»å‹çš„ä»»åŠ¡ã€‚submit()å¯ä»¥æ‰§è¡ŒRunnableå’ŒCallableç±»å‹çš„ä»»åŠ¡ã€‚</p></li><li><p>è¿”å›å€¼ï¼šsubmit()æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„Futureå¯¹è±¡ï¼Œè€Œexecute()æ²¡æœ‰ã€‚</p></li><li><p>å¼‚å¸¸å¤„ç†ï¼šsubmit()æ–¹ä¾¿Exceptionå¤„ç†ã€‚&#x20;</p></li></ul></li></ul></blockquote><h3 id="8-åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹"><a href="#8-åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹" class="headerlink" title="8. åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹"></a>8. åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹</h3><p><strong>åˆ†æ</strong></p><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± ä¸­ï¼Œçº¿ç¨‹æ± çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå°±ä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p></li><li><p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äºæˆ–å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¹¶ä¸”ä»»åŠ¡é˜Ÿåˆ—æ²¡æ»¡ï¼Œé‚£ä¹ˆå°±æŠŠè¯¥ä»»åŠ¡æ”¾å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚</p></li><li><p>å¦‚æœä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ï¼Œä½†æ˜¯å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°çš„ï¼Œå°±æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p></li><li><p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å·²ç»ç­‰åŒäºæœ€å¤§çº¿ç¨‹æ•°äº†ï¼Œæ–°å»ºçº¿ç¨‹å°†ä¼šä½¿å½“å‰è¿è¡Œçš„çº¿ç¨‹è¶…å‡ºæœ€å¤§çº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå½“å‰ä»»åŠ¡ä¼šè¢«æ‹’ç»ï¼Œè°ƒç”¨æ‹’ç»ç­–ç•¥æ–¹æ³•ã€‚</p></li></ol></blockquote><h3 id="9-çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š"><a href="#9-çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š" class="headerlink" title="9. çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š"></a>9. çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š</h3><p><strong>åˆ†æ</strong></p><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>çº¿ç¨‹æ± ç”¨æ¥æ‰§è¡ŒCPUå¯†é›†å‹ä»»åŠ¡æ—¶ï¼Œè®¾ç½®çº¿ç¨‹æ•°ä¸ºcpuæ ¸å¿ƒæ•°+1ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡ã€‚ç”¨æ¥æ‰§è¡ŒIOå¯†é›†å‹ä»»åŠ¡æ—¶ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹éƒ½é˜»å¡ï¼Œæ‰€ä»¥è®¾ç½®çº¿ç¨‹æ•°ä¸º2*cpuæ ¸æ•°ã€‚&#x20;</p></blockquote><h3 id="10-çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜"><a href="#10-çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜" class="headerlink" title="10. çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜"></a>10. çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜</h3><p><strong>åˆ†æ</strong></p><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ol><li><p>CPUå¯†é›†å‹ä»»åŠ¡é…ç½®å°½å¯èƒ½å°çš„çº¿ç¨‹ï¼Œcpuæ ¸æ•°+1ã€‚</p></li><li><p>IOå¯†é›†å‹ä»»åŠ¡åˆ™ç”±äºçº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹ï¼Œå¦‚2*cpuæ ¸æ•°ã€‚</p></li><li><p>æ··åˆå‹ä»»åŠ¡ï¼Œå¦‚æœå¯ä»¥æ‹†åˆ†ï¼Œåˆ™å°†å…¶æ‹†åˆ†æˆä¸€ä¸ªCPUå¯†é›†å‹ä»»åŠ¡å’Œä¸€ä¸ªIOå¯†é›†å‹ä»»åŠ¡ã€‚åªè¦è¿™ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´ç›¸å·®ä¸æ˜¯å¤ªå¤§ï¼Œé‚£ä¹ˆåˆ†è§£åå¹¶å‘æ‰§è¡Œçš„ååç‡é«˜äºä¸²è¡Œæ‰§è¡Œçš„ååç‡ï¼›å¦‚æœè¿™ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›¸å·®å¤ªå¤§ï¼Œåˆ™æ²¡å¿…è¦è¿›è¡Œåˆ†è§£ã€‚</p></li><li><p>ä¼˜å…ˆçº§ä¸åŒçš„ä»»åŠ¡å¯ä»¥ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—PriorityBlockingQueueæ¥å¤„ç†ï¼Œå®ƒå¯ä»¥è®©ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡å…ˆå¾—åˆ°æ‰§è¡Œã€‚</p></li><li><p>æ‰§è¡Œæ—¶é—´ä¸åŒçš„ä»»åŠ¡å¯ä»¥äº¤ç»™ä¸åŒçº¿ç¨‹æ± æ¥å¤„ç†ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè®©æ‰§è¡Œæ—¶é—´çŸ­çš„ä»»åŠ¡å…ˆæ‰§è¡Œã€‚</p></li><li><p>ä¾èµ–æ•°æ®åº“è¿æ¥æ± çš„ä»»åŠ¡ï¼Œå› ä¸ºçº¿ç¨‹æäº¤SQLåéœ€è¦ç­‰å¾…æ•°æ®åº“è¿”å›ç»“æœï¼Œçº¿ç¨‹æ•°åº”è¯¥è®¾ç½®å¾—è¾ƒå¤§ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„åˆ©ç”¨CPUã€‚</p></li><li><p>å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œæœ‰ç•Œé˜Ÿåˆ—èƒ½å¢åŠ ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œé¢„è­¦èƒ½åŠ›ã€‚å¯ä»¥æ ¹æ®éœ€è¦è®¾å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚å‡ åƒã€‚ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ± çš„é˜Ÿåˆ—å°±ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæœ‰å¯èƒ½ä¼šæ’‘æ»¡å†…å­˜ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚&#x20;</p></li></ol></blockquote><h3 id="11-çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹"><a href="#11-çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹" class="headerlink" title="11. çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹?"></a>11. çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ol><li>é¦–å…ˆçº¿ç¨‹æ± æä¾›äº†éƒ¨åˆ†setteræ–¹æ³•å¯ä»¥è®¾ç½®çº¿ç¨‹æ± çš„å‚æ•°ï¼›</li></ol><p>&#x20;a. ä¿®æ”¹æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œæœ€å¤§çº¿ç¨‹æ•°ï¼Œç©ºé—²çº¿ç¨‹åœç•™æ—¶é—´ï¼Œæ‹’ç»ç­–ç•¥ç­‰ã€‚</p><p>&#x20;b. å¯ä»¥å°†çº¿ç¨‹æ± çš„é…ç½®å‚æ•°æ”¾å…¥é…ç½®ä¸­å¿ƒï¼Œå½“éœ€è¦è°ƒæ•´çš„æ—¶å€™ï¼Œå»é…ç½®ä¸­å¿ƒä¿®æ”¹å°±è¡Œã€‚</p><ul><li>ä»€ä¹ˆæ—¶å€™ä¿®æ”¹å‘¢?</li></ul><p>&#x20;a. è¿™é‡Œéœ€è¦ç›‘æ§æŠ¥è­¦ç­–ç•¥ï¼Œè·å–çº¿ç¨‹æ± çŠ¶æ€æŒ‡æ ‡ï¼Œå½“æŒ‡æ ‡åˆ¤å®šä¸ºå¼‚å¸¸ä¹‹åè¿›è¡ŒæŠ¥è­¦ã€‚</p><p>&#x20;b. åˆ†ææŒ‡æ ‡å¼‚å¸¸åŸå› ï¼Œè¯„ä¼°å¤„ç†ç­–ç•¥ï¼Œæœ€åé€šè¿‡ä¸Šè¿°çº¿ç¨‹æ± æä¾›çš„æ¥å£è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€‚(å¯ä»¥å°†åŠ¨æ€é…ç½®)</p></blockquote><p><strong>æ¨èå­¦ä¹ </strong>ï¼š</p><p><a href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">Javaçº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ</a></p><h3 id="12-ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜"><a href="#12-ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜" class="headerlink" title="12. ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜?"></a>12. ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ä¾‹å¦‚newFixedThreadPoolä½¿ç”¨äº†æ— ç•Œçš„é˜»å¡é˜Ÿåˆ—LinkedBlockingQueueï¼Œå¦‚æœçº¿ç¨‹è·å–ä¸€ä¸ªä»»åŠ¡åï¼Œä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä¼šå¯¼è‡´é˜Ÿåˆ—çš„ä»»åŠ¡è¶Šç§¯è¶Šå¤šï¼Œå¯¼è‡´æœºå™¨å†…å­˜ä½¿ç”¨ä¸åœé£™å‡ï¼Œæœ€ç»ˆå¯¼è‡´OOMã€‚&#x20;</p></blockquote><h3 id="13-çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€"><a href="#13-çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€" class="headerlink" title="13. çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€?"></a>13. çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€?</h3><p><strong>åˆ†æ</strong></p><p>è¿™é‡Œé¢é¢è¯•å®˜å…¶å®æƒ³é—®ä½ çº¿ç¨‹å¤ç”¨çš„é€»è¾‘ï¼Œä»¥åŠå¯¹çº¿ç¨‹çŠ¶æ€æœºçš„ç†è§£ï¼ŒçŸ¥ä¸çŸ¥é“éƒ½è¦æœ‰ä¸€ä¸ªåˆ†ææ€è€ƒçš„è¿‡ç¨‹ï¼Œä¸è¦ä¸€ä¸Šæ¥å°±å›ç­”ç­”æ¡ˆæˆ–è€…è¯´ä¸çŸ¥é“ï¼ŒççŒœã€‚</p><p><strong>å‚è€ƒå›ç­”</strong></p><blockquote><p>é¦–å…ˆçº¿ç¨‹æœ¬èº«åˆ›å»ºå’Œé”€æ¯éƒ½æ˜¯æˆæœ¬æ¯”è¾ƒé«˜çš„ï¼Œé‚£å°±æ’é™¤newå’ŒterminatedçŠ¶æ€ï¼Œæ²¡æœ‰ä»»åŠ¡è¿è¡Œæ’é™¤runnableçŠ¶æ€ï¼Œå‰©ä¸‹é˜»å¡å’Œç­‰å¾…ï¼Œå› ä¸ºçº¿ç¨‹ä¸ä¼šé”€æ¯éœ€è¦ä¸€ç›´ç­‰å¾…æ‰§è¡Œä»»åŠ¡ï¼Œè¶…æ—¶ç­‰å¾…ä¹Ÿä¸å¤ªå¯èƒ½ï¼Œæœ€ååŒæ­¥é”æ‰ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘çŒœæ˜¯ä¸€ç›´ç­‰å¾…ã€‚&#x20;</p></blockquote><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image-2.png" alt=""></p><h3 id="14-å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ"><a href="#14-å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ" class="headerlink" title="14. å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ"></a>14. å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ</h3><p>å¤§å®¶åº”è¯¥éƒ½çŸ¥é“ï¼Œçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ»¡äº†ï¼Œå°±ä¼šæ”¾åœ¨é˜»å¡é˜Ÿåˆ—ï¼Œé˜»å¡é˜Ÿåˆ—æ»¡äº†ä¼šåˆ›å»ºä¸´æ—¶çº¿ç¨‹ï¼Œå¦‚æœè¶…è¿‡æœ€å¤§çº¿ç¨‹æ•°ï¼Œå°±ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚é‚£å¾ˆå¤šäººéƒ½æ˜¯ç”¨ç›´æ¥æ‹’ç»çš„ç­–ç•¥ï¼Œè¿™æ ·ä»»åŠ¡å°±ç›´æ¥ä¸¢äº†ã€‚&#x20;</p><p>ä½†æ˜¯å¦‚æœä»»åŠ¡å¾ˆé‡è¦ï¼Œä¸å…è®¸ä¸¢å¼ƒä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿé‚£å¤§å®¶å¯ä»¥æŠŠå·¥ä½œä¸­ç”¨åˆ°çš„æ–¹æ¡ˆå‘åœ¨è¯„è®ºåŒºï¼Œæˆ‘ç»™ä½ æä¾›å‡ ç§ï¼š</p><ol><li><p>ç”¨CallerRunsPolicyï¼Œå®ƒä¼šé‡‡ç”¨ä¸»çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä½†æ˜¯å¦‚æœä»»åŠ¡éå¸¸è€—æ—¶ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯æ…ç”¨ï¼</p></li><li><p>å°†ä»»åŠ¡è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¯ä»¥é‡‡ç”¨mysqlã€redisã€æˆ–è€…mqå¼‚æ­¥ç­‰æ–¹æ¡ˆæŒä¹…åŒ–ï¼Œåç»­å†å¯¹ä»»åŠ¡è¿›è¡Œè¡¥å¿æ‰§è¡Œã€‚</p></li><li><p>&#x20; ä¹Ÿå¯ä»¥å‚è€ƒnettyï¼šå®ƒä¼šå†åˆ›å»ºæ–°çš„ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚&#x20;</p></li></ol><p><img src="2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜/image76.png" alt=""></p><h3 id="15-Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#15-Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="15. Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>15. Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><blockquote><p>Callableå’ŒRunnableæ¥å£éƒ½æ˜¯ç”¨äºåœ¨Javaä¸­å®ç°å¤šçº¿ç¨‹çš„æ¥å£ï¼Œä½†å®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›åŒºåˆ«ï¼š</p><ol><li><p><strong>è¿”å›å€¼</strong>ï¼š</p><ul><li><p>Runnableæ¥å£çš„run()æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œå®ƒé€šå¸¸ç”¨äºæ‰§è¡Œä¸€äº›ä¸éœ€è¦è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚</p></li><li><p>Callableæ¥å£çš„call()æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªç»“æœï¼Œå®ƒå…è®¸çº¿ç¨‹æ‰§è¡Œä»»åŠ¡å¹¶è¿”å›ç»“æœï¼Œå¯ä»¥é€šè¿‡Futureå¯¹è±¡è·å–ã€‚</p></li></ul></li><li><p><strong>æŠ›å‡ºå¼‚å¸¸</strong>ï¼š</p><ul><li><p>Runnableæ¥å£çš„run()æ–¹æ³•ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œåªèƒ½æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ã€‚</p></li><li><p>Callableæ¥å£çš„call()æ–¹æ³•å¯ä»¥æŠ›å‡ºå—æ£€å¼‚å¸¸ã€‚</p></li></ul></li><li><p><strong>æ³›å‹</strong>ï¼š</p><ul><li><p>Callableæ¥å£ä½¿ç”¨äº†æ³›å‹ï¼Œå¯ä»¥æŒ‡å®šcall()æ–¹æ³•çš„è¿”å›ç±»å‹ã€‚</p></li><li><p>Runnableæ¥å£æ²¡æœ‰ä½¿ç”¨æ³›å‹ã€‚</p></li></ul></li><li><p><strong>çº¿ç¨‹æ± æ”¯æŒ</strong>ï¼š</p><ul><li><p>Callableæ¥å£é€šå¸¸ä¸Executoræ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥æäº¤ç»™ExecutorServiceçš„çº¿ç¨‹æ± æ‰§è¡Œã€‚</p></li><li><p>Runnableæ¥å£åŒæ ·å¯ä»¥ä¸Executoræ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯Callableæ¥å£æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¦‚å–æ¶ˆä»»åŠ¡ã€è·å–æ‰§è¡Œç»“æœç­‰ã€‚&#x20;</p></li></ul></li></ol></blockquote><h3 id="16-çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ"><a href="#16-çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ" class="headerlink" title="16. çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ"></a>16. çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ</h3><blockquote><p>ç¬¬ä¸€ä¸ªçº¿ç¨‹æ± æ‹’ç»ç­–ç•¥æ˜¯ï¼š</p><p><strong>æ‰§è¡Œç­–ç•¥ä¸ºAbortPolicy</strong>ï¼šæ‰§è¡Œä»»åŠ¡å‡ºç°å¼‚å¸¸ï¼Œå‘æäº¤ä»»åŠ¡çº¿ç¨‹ï¼Œå³è°ƒç”¨çº¿ç¨‹ä¼šæŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ï¼Œå¹¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡ã€‚</p><p><strong>æ‰§è¡Œç­–ç•¥ä¸ºDiscardPolicy</strong>ï¼šå†…éƒ¨ä¼šæŠŠå¼‚å¸¸ä¿¡æ¯åæ‰ï¼Œæ—¢ä¸ä¼šæŠŠå¼‚å¸¸æŠ›ç»™è¿™ä¸ªçº¿ç¨‹æ± çº¿ç¨‹ï¼Œä¹Ÿä¸ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ã€‚</p><p>è¿™ä¸¤ç§æ‰§è¡Œæ–¹å¼ï¼Œéƒ½ä¸ä¼šå½±å“çº¿ç¨‹æ± é‡Œé¢å…¶ä»–çº¿ç¨‹çš„æ­£å¸¸æ‰§è¡Œï¼Œæ›´ä¾¿äºçº¿ç¨‹æ± çš„èµ„æºç®¡ç†ï¼Œå¯ä»¥é˜²æ­¢èµ„æºè¢«æ»¥ç”¨ï¼Œå¦‚æœç¨‹åºæœ‰é»˜è®¤å¤„&#x20;</p></blockquote><h3 id="17-çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹"><a href="#17-çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹" class="headerlink" title="17.çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹"></a>17.çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹</h3><blockquote><p>çº¿ç¨‹æ± å¸¸ç”¨çš„é˜»å¡é˜Ÿåˆ—ç±»å‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li><p><code>ArrayBlockingQueue</code>ï¼šåŸºäºæ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚å…¶å®¹é‡åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼Œä¸€æ—¦è¾¾åˆ°å®¹é‡ä¸Šé™ï¼Œæ–°çš„å…¥é˜Ÿæ“ä½œä¼šé˜»å¡ç­‰å¾…ã€‚</p></li><li><p><code>LinkedBlockingQueue</code>ï¼šåŸºäºé“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶å®¹é‡æ²¡æœ‰ä¸Šé™ï¼Œå¯ä»¥çœ‹ä½œæ˜¯æ— ç•Œçš„ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºæ—¶æŒ‡å®šå®¹é‡ã€‚</p></li><li><p><code>PriorityBlockingQueue</code>ï¼šæ— ç•Œçš„ä¼˜å…ˆçº§é˜»å¡é˜Ÿåˆ—ï¼Œå…ƒç´ æŒ‰ç…§è‡ªå®šä¹‰çš„ä¼˜å…ˆçº§è§„åˆ™è¿›è¡Œæ’åºã€‚</p></li><li><p><code>SynchronousQueue</code>ï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œå…¥é˜Ÿæ“ä½œå¿…é¡»ç­‰å¾…å‡ºé˜Ÿæ“ä½œï¼Œåä¹‹äº¦ç„¶ï¼Œå¸¸ç”¨äºå®ç°çº¿ç¨‹ä¹‹é—´çš„ç›´æ¥ä¼ é€’ã€‚</p></li><li><p><code>DelayQueue</code>ï¼šæ— ç•Œçš„å»¶è¿Ÿé˜»å¡é˜Ÿåˆ—ï¼Œå…ƒç´ åªæœ‰åœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åˆ°æœŸåæ‰èƒ½è¢«å–å‡ºã€‚</p></li><li><p><code>LinkedTransferQueue</code>ï¼šæ— ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰é«˜æ•ˆçš„å…ƒç´ ä¼ é€’ç‰¹æ€§ã€‚</p></li><li><p><code>LinkedBlockingDeque</code>ï¼šåŸºäºé“¾è¡¨å®ç°çš„åŒå‘é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä»é˜Ÿåˆ—çš„å¤´éƒ¨å’Œå°¾éƒ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p></li></ol></blockquote><h2 id="Javaä¸­çš„é”"><a href="#Javaä¸­çš„é”" class="headerlink" title="Javaä¸­çš„é”"></a>Javaä¸­çš„é”</h2><h3 id="1-Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿"><a href="#1-Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿" class="headerlink" title="1. Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿?"></a>1. Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>Lockæ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚å®ƒä»¬å…è®¸æ›´çµæ´»çš„ç»“æ„ï¼Œå¯ä»¥å…·æœ‰å®Œå…¨ä¸åŒçš„æ€§è´¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒå¤šä¸ªç›¸å…³ç±»çš„æ¡ä»¶å¯¹è±¡ã€‚</p><p>å®ƒçš„ä¼˜åŠ¿æœ‰ï¼š</p><ul><li><p><strong>(1) å¯ä»¥ä½¿é”æ›´å…¬å¹³ã€‚</strong></p></li><li><p><strong>(2) å¯ä»¥ä½¿çº¿ç¨‹åœ¨ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­ã€‚</strong></p></li><li><p><strong>(3) å¯ä»¥è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</strong></p></li><li><p><strong>(4) å¯ä»¥åœ¨ä¸åŒçš„èŒƒå›´ï¼Œä»¥ä¸åŒçš„é¡ºåºè·å–å’Œé‡Šæ”¾é”ã€‚</strong></p></li></ul><p>æ•´ä½“ä¸Šæ¥è¯´Lockæ˜¯synchronizedçš„æ‰©å±•ç‰ˆï¼ŒLockæä¾›äº†æ— æ¡ä»¶çš„ã€å¯è½®è¯¢çš„(tryLockæ–¹æ³•)ã€å®šæ—¶çš„(tryLockå¸¦å‚æ–¹æ³•)ã€å¯ä¸­æ–­çš„(lockInterruptibly)ã€å¯å¤šæ¡ä»¶é˜Ÿåˆ—çš„(newConditionæ–¹æ³•)é”æ“ä½œã€‚å¦å¤–Lockçš„å®ç°ç±»åŸºæœ¬éƒ½æ”¯æŒéå…¬å¹³é”(é»˜è®¤)å’Œå…¬å¹³é”ï¼Œsynchronizedåªæ”¯æŒéå…¬å¹³é”ï¼Œå½“ç„¶ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œéå…¬å¹³é”æ˜¯é«˜æ•ˆçš„é€‰æ‹©ã€‚&#x20;</p></blockquote><h3 id="2-ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼"><a href="#2-ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼" class="headerlink" title="2. ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼?"></a>2. ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li><p><strong>æ‚²è§‚é”ï¼š</strong>&#x603B;æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚Javaé‡Œé¢çš„åŒæ­¥åŸè¯­synchronizedå…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚</p></li><li><p><strong>ä¹è§‚é”ï¼š</strong>&#x987E;åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œåƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äºwrite_conditionæœºåˆ¶ï¼Œå…¶å®éƒ½æ˜¯æä¾›çš„ä¹è§‚é”ã€‚åœ¨Javaä¸­java.util.concurrent.atomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼CASå®ç°çš„ã€‚&#x20;</p></li></ul></blockquote><h3 id="3-ä»€ä¹ˆæ˜¯CAS"><a href="#3-ä»€ä¹ˆæ˜¯CAS" class="headerlink" title="3. ä»€ä¹ˆæ˜¯CAS"></a>3. ä»€ä¹ˆæ˜¯CAS</h3><p><strong>åˆ†æ</strong></p><p>å›ç­”å‡ºCASæ“ä½œçš„åŸå­æ€§ï¼Œç³»ç»Ÿç¡¬ä»¶çº§åˆ«æä¾›æ”¯æŒ</p><p><strong>å›ç­”</strong></p><blockquote><p>CASå³CompareAndSwapï¼ŒJavaä¸­å¯ä»¥é€šè¿‡CASæ“ä½œæ¥ä¿è¯åŸå­æ€§ï¼ŒåŸå­æ€§å°±æ˜¯ä¸å¯è¢«ä¸­æ–­çš„ä¸€ç³»åˆ—æ“ä½œæˆ–è€…ä¸€ä¸ªæ“ä½œï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ç³»åˆ—æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå¤±è´¥ï¼Œä¸èƒ½è¢«ä¸­æ–­ã€‚</p><p>CASä¸»è¦åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼ˆVï¼Œexpectï¼Œupdateï¼‰ï¼ŒVè¡¨ç¤ºè¦æ›´æ–°çš„å˜é‡ï¼ˆå†…å­˜å€¼ï¼‰ã€expectè¡¨ç¤ºé¢„æœŸå€¼ï¼ˆæ—§å€¼ï¼‰ã€updateè¡¨ç¤ºæ–°å€¼ã€‚ç®—æ³•æµç¨‹æ˜¯é¦–å…ˆæ¯”è¾ƒVå’Œexpectçš„å€¼ï¼Œå¦‚æœç›¸ç­‰ï¼Œå°†updateå€¼èµ‹å€¼ç»™Vï¼Œå¦‚æœä¸ç›¸ç­‰è¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å¯¹è¯¥å˜é‡åšäº†æ›´æ–°ã€‚è¿™ä¸ªå‚æ•°æœ‰çš„åœ°æ–¹ä¹Ÿä¼šç”¨ï¼ˆVï¼ŒAï¼ŒBï¼‰è¡¨ç¤ºï¼Œå…¶ä¸­Aè¡¨ç¤ºé¢„æœŸå€¼ï¼ŒBè¡¨ç¤ºæ–°å€¼ã€‚</p><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹å˜é‡è¿›è¡ŒæˆåŠŸæ›´æ–°ï¼Œå…¶ä»–çº¿ç¨‹å‡ä¼šå¤±è´¥ï¼Œä½†æ˜¯å¤±è´¥å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè¿›è¡Œå†æ¬¡å°è¯•ï¼Œä¹Ÿå°±æ˜¯è‡ªæ—‹ã€‚Javaä¸­çš„è‡ªæ—‹é”å°±æ˜¯åˆ©ç”¨CASæ¥å®ç°çš„ã€‚&#x20;</p></blockquote><p><a href="https://www.cnblogs.com/huansky/p/15746624.html">Java CAS åŸç†è¯¦è§£ - huansky - åšå®¢å›­</a></p><h3 id="4-CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜"><a href="#4-CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜" class="headerlink" title="4. CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜?"></a>4. CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p><strong>1ã€ABAé—®é¢˜ï¼š</strong></p><p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹oneä»å†…å­˜ä½ç½®Vä¸­å–å‡ºAï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹twoä¹Ÿä»å†…å­˜ä¸­å–å‡ºAï¼Œå¹¶ä¸”twoè¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº†Bï¼Œç„¶åtwoåˆå°†Vä½ç½®çš„æ•°æ®å˜æˆAï¼Œè¿™æ—¶å€™çº¿ç¨‹oneè¿›è¡ŒCASæ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯Aï¼Œç„¶åoneæ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹oneçš„CASæ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚ä»Java1.5å¼€å§‹JDKçš„atomicåŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±»AtomicStampedReferenceæ¥è§£å†³ABAé—®é¢˜ã€‚</p><p><strong>2ã€å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ï¼š</strong></p><p>å¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCASè‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„CPUèµ„æºï¼Œæ•ˆç‡ä½äºsynchronizedã€‚</p><p><strong>3ã€åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼š</strong></p><p>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯CASçš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯CASå°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”ã€‚&#x20;</p></blockquote><h3 id="5-ä»€ä¹ˆæ˜¯åŸå­ç±»"><a href="#5-ä»€ä¹ˆæ˜¯åŸå­ç±»" class="headerlink" title="5. ä»€ä¹ˆæ˜¯åŸå­ç±»"></a>5. ä»€ä¹ˆæ˜¯åŸå­ç±»</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>java.util.concurrent.atomicåŒ…ï¼šæ˜¯åŸå­ç±»çš„å°å·¥å…·åŒ…ï¼Œæ”¯æŒåœ¨å•ä¸ªå˜é‡ä¸Šè§£è§£é”çš„çº¿ç¨‹å®‰å…¨ç¼–ç¨‹ã€‚åŸå­å˜é‡ç±»ç›¸å½“äºä¸€ç§æ³›åŒ–çš„volatileå˜é‡ï¼Œèƒ½å¤Ÿæ”¯æŒåŸå­çš„å’Œæœ‰æ¡ä»¶çš„è¯»-æ”¹-å†™æ“ä½œã€‚</p></li><li><p>æ¯”å¦‚ï¼šAtomicIntegerè¡¨ç¤ºä¸€ä¸ªintç±»å‹çš„å€¼ï¼Œå¹¶æä¾›äº†getå’Œsetæ–¹æ³•ï¼Œè¿™äº›Volatileç±»å‹çš„intå˜é‡åœ¨è¯»å–å’Œå†™å…¥ä¸Šæœ‰ç€ç›¸åŒçš„å†…å­˜è¯­ä¹‰ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ªåŸå­çš„compareAndSetæ–¹æ³•ï¼ˆå¦‚æœè¯¥æ–¹æ³•æˆåŠŸæ‰§è¡Œï¼Œé‚£ä¹ˆå°†å®ç°ä¸è¯»å–/å†™å…¥ä¸€ä¸ªvolatileå˜é‡ç›¸åŒçš„å†…å­˜æ•ˆæœï¼‰ï¼Œä»¥åŠåŸå­çš„æ·»åŠ ã€é€’å¢å’Œé€’å‡ç­‰æ–¹æ³•ã€‚AtomicIntegerè¡¨é¢ä¸Šéå¸¸åƒä¸€ä¸ªæ‰©å±•çš„Counterç±»ï¼Œä½†åœ¨å‘ç”Ÿç«äº‰çš„æƒ…å†µä¸‹èƒ½æä¾›æ›´é«˜çš„å¯ä¼¸ç¼©æ€§ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†ç¡¬ä»¶å¯¹å¹¶å‘çš„æ”¯æŒã€‚</p></li></ul><p>ç®€å•æ¥è¯´å°±æ˜¯åŸå­ç±»æ¥å®ç°CASæ— é”æ¨¡å¼çš„ç®—æ³•ã€‚</p></blockquote><h3 id="6-åŸå­ç±»çš„å¸¸ç”¨ç±»"><a href="#6-åŸå­ç±»çš„å¸¸ç”¨ç±»" class="headerlink" title="6. åŸå­ç±»çš„å¸¸ç”¨ç±»"></a>6. åŸå­ç±»çš„å¸¸ç”¨ç±»</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li><p>AtomicBoolean</p></li><li><p>AtomicInteger</p></li><li><p>AtomicLong</p></li><li><p>AtomicReference&#x20;</p></li></ul></blockquote><h3 id="7-è¯´ä¸€ä¸‹Atomicçš„åŸç†"><a href="#7-è¯´ä¸€ä¸‹Atomicçš„åŸç†" class="headerlink" title="7. è¯´ä¸€ä¸‹Atomicçš„åŸç†?"></a>7. è¯´ä¸€ä¸‹Atomicçš„åŸç†?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li>AtomicåŒ…ä¸­çš„ç±»åŸºæœ¬çš„ç‰¹æ€§å°±æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹å•ä¸ªï¼ˆåŒ…æ‹¬åŸºæœ¬ç±»å‹åŠå¼•ç”¨ç±»å‹ï¼‰å˜é‡è¿›è¡Œæ“ä½œæ—¶ï¼Œå…·æœ‰æ’ä»–æ€§ï¼Œå³å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹è¯¥å˜é‡çš„å€¼è¿›è¡Œæ›´æ–°æ—¶ï¼Œä»…æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸï¼Œè€ŒæœªæˆåŠŸçš„çº¿ç¨‹å¯ä»¥è‡ªæ—‹é”ä¸€æ ·ï¼Œç»§ç»­å°è¯•ï¼Œä¸€ç›´ç­‰åˆ°æ‰§è¡ŒæˆåŠŸã€‚</li></ul></blockquote><h3 id="8-æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«"><a href="#8-æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«" class="headerlink" title="8. æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«?"></a>8. æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p><strong>æ­»é”ï¼š</strong>&#x662F;æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p><p><strong>æ´»é”ï¼š</strong>&#x4EFB;åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥ã€‚</p><p>æ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œè€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚</p><p><strong>é¥¥é¥¿ï¼š</strong>&#x4E00;ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚&#x20;</p><p>Javaä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› :</p><p>1ã€é«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„CPUæ—¶é—´ã€‚</p><p>2ã€çº¿ç¨‹è¢«æ°¸ä¹…å µå¡åœ¨ä¸€ä¸ªç­‰å¾…è¿›å…¥åŒæ­¥å—çš„çŠ¶æ€ï¼Œå› ä¸ºå…¶ä»–çº¿ç¨‹æ€»æ˜¯èƒ½åœ¨å®ƒä¹‹å‰æŒç»­åœ°å¯¹è¯¥åŒæ­¥å—è¿›è¡Œè®¿é—®ã€‚</p><p>3ã€çº¿ç¨‹åœ¨ç­‰å¾…ä¸€ä¸ªæœ¬èº«ä¹Ÿå¤„äºæ°¸ä¹…ç­‰å¾…å®Œæˆçš„å¯¹è±¡(æ¯”å¦‚è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„waitæ–¹æ³•)ï¼Œå› ä¸ºå…¶ä»–çº¿ç¨‹æ€»æ˜¯è¢«æŒç»­åœ°è·å¾—å”¤é†’ã€‚&#x20;</p></blockquote><h3 id="9-å¦‚ä½•é¿å…æ­»é”"><a href="#9-å¦‚ä½•é¿å…æ­»é”" class="headerlink" title="9. å¦‚ä½•é¿å…æ­»é”"></a>9. å¦‚ä½•é¿å…æ­»é”</h3><blockquote><p>æ­»é”æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ç§å¸¸è§é—®é¢˜ï¼Œå®ƒå‘ç”Ÿåœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºçš„æƒ…å†µä¸‹ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•ç»§ç»­æ‰§è¡Œã€‚ä¸ºäº†é¿å…æ­»é”ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š</p><ol><li><p><strong>é”é¡ºåº</strong>ï¼šå®šä¹‰ä¸€ä¸ªå›ºå®šçš„é”è·å–é¡ºåºï¼Œå¹¶è¦æ±‚æ‰€æœ‰çº¿ç¨‹éƒ½æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–é”ã€‚è¿™å¯ä»¥å‡å°‘ä¸åŒçº¿ç¨‹ä¹‹é—´èµ„æºäº‰å¤ºçš„å¯èƒ½æ€§ã€‚</p></li><li><p><strong>è¶…æ—¶æœºåˆ¶</strong>ï¼šåœ¨è·å–é”æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å¦‚æœè¶…è¿‡æŒ‡å®šæ—¶é—´ä»ç„¶æ— æ³•è·å–é”ï¼Œçº¿ç¨‹åº”è¯¥é‡Šæ”¾å·²ç»æŒæœ‰çš„é”å¹¶é‡è¯•ï¼Œæˆ–è€…é‡‡å–å…¶ä»–é€‚å½“çš„æªæ–½ã€‚è¿™æœ‰åŠ©äºé¿å…çº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…é”ã€‚</p></li><li><p><strong>é¿å…åµŒå¥—é”</strong>ï¼šå°½é‡é¿å…åœ¨ä¸€ä¸ªé”çš„æŒæœ‰æœŸé—´å†æ¬¡å°è¯•è·å–å…¶ä»–é”ã€‚å¦‚æœç¡®å®éœ€è¦è·å–å¤šä¸ªé”ï¼Œè¯·ç¡®ä¿è·å–çš„é¡ºåºæ˜¯å›ºå®šçš„ï¼Œä»¥å‡å°‘æ­»é”é£é™©ã€‚</p></li><li><p><strong>ä½¿ç”¨é”æœºåˆ¶</strong>ï¼šæ¯”å¦‚Javaä¸­çš„ReentrantLockï¼Œå®ƒæ”¯æŒå¯ä¸­æ–­çš„é”è·å–å’Œæ¡ä»¶ç­‰å¾…ï¼Œæœ‰åŠ©äºé¿å…æ­»é”ã€‚&#x20;</p></li></ol></blockquote><h3 id="10-ä¸ºä»€ä¹ˆ-wait-å’Œ-notify-æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨"><a href="#10-ä¸ºä»€ä¹ˆ-wait-å’Œ-notify-æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨" class="headerlink" title="10. ä¸ºä»€ä¹ˆ wait å’Œ notify æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨"></a>10. ä¸ºä»€ä¹ˆ wait å’Œ notify æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨</h3><blockquote><p>è°ƒç”¨wait()å°±æ˜¯é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”çš„å‰ææ˜¯å¿…é¡»è¦å…ˆè·å¾—é”ï¼Œå…ˆè·å¾—é”æ‰èƒ½é‡Šæ”¾é”ã€‚</p><p>notify(),notifyAll()æ˜¯å°†é”äº¤ç»™å«æœ‰wait()æ–¹æ³•çš„çº¿ç¨‹ï¼Œè®©å…¶ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå¦‚æœè‡ªèº«æ²¡æœ‰é”ï¼Œæ€ä¹ˆå«æŠŠé”äº¤ç»™å…¶ä»–çº¿ç¨‹ ã€‚</p></blockquote><h3 id="11-è¯´ä¸‹å¯¹AQSçš„ç†è§£"><a href="#11-è¯´ä¸‹å¯¹AQSçš„ç†è§£" class="headerlink" title="11. è¯´ä¸‹å¯¹AQSçš„ç†è§£"></a>11. è¯´ä¸‹å¯¹AQSçš„ç†è§£</h3><p>AQSï¼ˆAbstractQueuedSynchronizerï¼‰æ˜¯Javaå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæä¾›äº†çº¿ç¨‹åŒæ­¥çš„åº•å±‚å®ç°æœºåˆ¶ã€‚AQSçš„ä½œç”¨æ˜¯å®ç°çº¿ç¨‹çš„åŒæ­¥å’Œäº’æ–¥æ“ä½œï¼Œå®ƒæä¾›äº†ä¸¤ç§ä¸»è¦çš„é”æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯æ’ä»–é”å’Œå…±äº«é”ã€‚</p><p><strong>æ’ä»–é”ä¹Ÿç§°ä¸ºç‹¬å é”</strong>ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€å…±äº«èµ„æºæ—¶ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥å…±äº«èµ„æºï¼Œå³å¤šä¸ªçº¿ç¨‹ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”èµ„æºã€‚åœ¨AQSä¸­ï¼Œæ’ä»–é”æ˜¯é€šè¿‡å†…ç½®çš„åŒæ­¥çŠ¶æ€æ¥å®ç°çš„ã€‚å½“åŒæ­¥çŠ¶æ€ä¸º0æ—¶ï¼Œè¡¨ç¤ºé”æ˜¯æœªè¢«è·å–çš„ï¼›å½“åŒæ­¥çŠ¶æ€å¤§äº0æ—¶ï¼Œè¡¨ç¤ºé”å·²ç»è¢«è·å–ä¸”è¢«å ç”¨ï¼›å½“åŒæ­¥çŠ¶æ€å°äº0æ—¶ï¼Œè¡¨ç¤ºé”å·²ç»è¢«è·å–ä½†æ˜¯å¤„äºç­‰å¾…çŠ¶æ€ã€‚</p><p><strong>å…±äº«é”</strong>å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—é”èµ„æºï¼Œä½†æ˜¯åœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–åˆ°é”çš„æ‹¥æœ‰æƒï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾é”ã€‚åœ¨AQSä¸­ï¼Œå…±äº«é”çš„å®ç°ä¸æ’ä»–é”ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡å…ˆè¿›å†…ç½®çš„åŒæ­¥çŠ¶æ€æ¥å®ç°çš„ã€‚</p><p>AQSé€šè¿‡ä¸€ä¸ªå†…ç½®çš„<strong>FIFO</strong>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ç­‰å¾…é˜Ÿåˆ—æ¥å®ç°çº¿ç¨‹çš„æ’é˜Ÿå’Œè°ƒåº¦ã€‚å½“çº¿ç¨‹éœ€è¦è·å–é”èµ„æºæ—¶ï¼Œå¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¼šè·å¾—é”èµ„æºå¹¶ç»§ç»­æ‰§è¡Œã€‚</p><p>åœ¨å®ç°AQSæ—¶ï¼Œéœ€è¦ç»§æ‰¿è‡ªAQSç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•ã€‚å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ–¹æ³•åŒ…æ‹¬ï¼štryAcquire()å’ŒtryRelease()æ–¹æ³•ï¼Œç”¨äºå®ç°é”çš„è·å–å’Œé‡Šæ”¾ï¼›acquire()å’Œrelease()æ–¹æ³•ï¼Œç”¨äºå®ç°é˜»å¡å’Œå”¤é†’æ“ä½œï¼›isHeldExclusively()æ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æ˜¯æ’ä»–é”ã€‚&#x20;</p><p>ç­”æ¡ˆï¼š</p><blockquote><p>AQSæ˜¯å¤šçº¿ç¨‹åŒæ­¥å™¨ï¼Œå®ƒæ˜¯J.U.CåŒ…ä¸­å¤šä¸ªç»„ä»¶çš„åº•å±‚å®ç°ï¼Œå¦‚Lockã€CountDownLatchã€Semaphoreç­‰éƒ½ç”¨åˆ°äº†AQSã€‚<strong>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒAQSæä¾›äº†ä¸¤ç§é”æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯æ’ä»–é”ï¼Œå’Œå…±äº«é”ã€‚</strong>&#x6392;ä»–é”ï¼Œå°±æ˜¯å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰åŒä¸€å…±äº«èµ„æºæ—¶ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥å…±äº«èµ„æºï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªçº¿ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”èµ„æºï¼Œæ¯”å¦‚Lockä¸­çš„ReentrantLocké‡å…¥é”å®ç°å°±æ˜¯ç”¨åˆ°äº†AQSä¸­çš„æ’ä»–é”åŠŸèƒ½ã€‚<strong>å…±äº«é”ä¹Ÿç§°ä¸ºè¯»é”</strong>ï¼Œå°±æ˜¯åœ¨åŒä¸€æ—¶åˆ»å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—é”èµ„æºï¼Œæ¯”å¦‚CountDownLatchå’ŒSemaphoreéƒ½æ˜¯ç”¨åˆ°äº†AQSä¸­çš„å…±äº«é”åŠŸèƒ½ã€‚</p><p>AQSæœ‰ä¸‰ä¸ªæ ¸å¿ƒçš„é—®é¢˜ï¼š</p><p>AQSç»´æŒç€ä¸€ä¸ªintç±»å‹çš„äº’æ–¥å˜é‡stateæ¥è®°å½•é”ç«äº‰çš„ä¸€ä¸ªçŠ¶æ€ï¼Œ0è¡¨ç¤ºå½“å‰æ²¡æœ‰ä»»ä½•çº¿ç¨‹ç«äº‰é”èµ„æºï¼Œè€Œå¤§äºç­‰äº1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹æ­£åœ¨æŒæœ‰é”èµ„æºã€‚ä¸€ä¸ªçº¿ç¨‹æ¥è·å–é”èµ„æºçš„æ—¶å€™ï¼Œé¦–å…ˆåˆ¤æ–­stateæ˜¯å¦ç­‰äº0ï¼Œå¦‚æœæ˜¯(æ— é”çŠ¶æ€)ï¼Œåˆ™æŠŠè¿™ä¸ªstateæ›´æ–°æˆ1ï¼Œè¡¨ç¤ºå ç”¨åˆ°é”ã€‚æ­¤æ—¶å¦‚æœå¤šä¸ªçº¿ç¨‹è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œä¼šé€ æˆçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚AQSé‡‡ç”¨äº†CASæœºåˆ¶æ¥ä¿è¯äº’æ–¥å˜é‡stateçš„åŸå­æ€§ã€‚</p><p>æœªè·å–åˆ°é”èµ„æºçš„çº¿ç¨‹é€šè¿‡Unsafeç±»ä¸­çš„parkæ–¹æ³•å¯¹çº¿ç¨‹è¿›è¡Œé˜»å¡ï¼ŒæŠŠé˜»å¡çš„çº¿ç¨‹æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„åŸåˆ™åŠ å…¥åˆ°ä¸€ä¸ªåŒå‘é“¾è¡¨çš„ç»“æ„<strong>CLH</strong>ä¸­ï¼Œå½“è·å¾—é”èµ„æºçš„çº¿ç¨‹é‡Šæ”¾é”ä¹‹åï¼Œä¼šä»åŒå‘é“¾è¡¨çš„å¤´éƒ¨å»å”¤é†’ä¸‹ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹å†å»ç«äº‰é”ã€‚</p><p><strong>CLH é˜Ÿåˆ—</strong>æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—,ç”¨äºå­˜å‚¨ç­‰å¾…é”çš„çº¿ç¨‹ã€‚å½“çº¿ç¨‹å°è¯•è·å–åŒæ­¥çŠ¶æ€å¤±è´¥æ—¶ï¼Œä¼šå°†å…¶å°è£…æˆä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå¹¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚çº¿ç¨‹é€šè¿‡è‡ªæ—‹çš„æ–¹å¼ä¸æ–­æ£€æŸ¥å…¶å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€æ¥åˆ¤æ–­è‡ªå·±æ˜¯å¦èƒ½å¤Ÿè·å–åˆ°é”ã€‚å½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼Œä¼šå”¤é†’å…¶åç»§èŠ‚ç‚¹çš„çº¿ç¨‹è¿›è¡Œç«äº‰è·å–ã€‚</p><p>å¦å¤–å…³äºå…¬å¹³æ€§å’Œéå…¬å¹³æ€§é—®é¢˜ï¼ŒAQSçš„å¤„ç†æ–¹å¼æ˜¯ï¼Œåœ¨ç«äº‰é”èµ„æºçš„æ—¶å€™ï¼Œå…¬å¹³é”éœ€è¦åˆ¤æ–­åŒå‘é“¾è¡¨ä¸­æ˜¯å¦æœ‰é˜»å¡çš„çº¿ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™éœ€è¦å»æ’é˜Ÿç­‰å¾…ï¼›è€Œéå…¬å¹³é”çš„å¤„ç†æ–¹å¼æ˜¯ï¼Œä¸ç®¡åŒå‘é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨ç­‰å¾…é”çš„çº¿ç¨‹ï¼Œéƒ½ä¼šç›´æ¥å°è¯•æ›´æ”¹äº’æ–¥å˜é‡stateå»ç«äº‰é”ã€‚&#x20;</p></blockquote><p><a href="https://pdai.tech/md/java/thread/java-thread-x-lock-AbstractQueuedSynchronizer.html">JUCé”: é”æ ¸å¿ƒç±»AQSè¯¦è§£</a></p><p><a href="https://javaguide.cn/java/concurrent/aqs.html">AQS è¯¦è§£</a></p><h3 id="12-è¯´ä¸‹CASçš„åŸç†"><a href="#12-è¯´ä¸‹CASçš„åŸç†" class="headerlink" title="12. è¯´ä¸‹CASçš„åŸç†"></a>12. è¯´ä¸‹CASçš„åŸç†</h3><blockquote><p>CASï¼ˆCompare And Swapï¼‰æ˜¯ä¸€ç§<strong>ä¹è§‚çš„å¹¶å‘æ§åˆ¶æœºåˆ¶</strong>ï¼Œå®ƒçš„æ ¸å¿ƒåŸç†æ˜¯åŸºäºç¡¬ä»¶å±‚é¢çš„åŸå­æ€§ä¿è¯ã€‚CASæ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼š</p><ol><li><p>åœ¨å°†æ–°å€¼å†™å…¥å†…å­˜ä¹‹å‰ï¼ŒCASæ“ä½œä¼šå…ˆæ¯”è¾ƒå†…å­˜ä½ç½®çš„å€¼æ˜¯å¦ä¸é¢„æœŸåŸå€¼ç›¸åŒ¹é…ã€‚</p></li><li><p>å¦‚æœå†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ã€‚</p></li><li><p>å¦‚æœå†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼ä¸åŒ¹é…ï¼Œåˆ™CASæ“ä½œå¤±è´¥ï¼Œä¸ä¼šä¿®æ”¹å†…å­˜å€¼ã€‚</p></li></ol><p>CASçš„ä¼˜åŠ¿åœ¨äºå®ƒæ²¡æœ‰é˜»å¡çŠ¶æ€ï¼Œä¸ä¼šå¼•èµ·çº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢å’Œè°ƒåº¦é—®é¢˜ã€‚ç„¶è€Œï¼ŒCASä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚ABAé—®é¢˜å’Œå¼€é”€é—®é¢˜ã€‚ABAé—®é¢˜æ˜¯æŒ‡ä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œåˆå˜æˆäº†Aï¼Œé‚£ä¹ˆä½¿ç”¨CASè¿›è¡Œæ£€æŸ¥æ—¶ä¼šå‘ç°å®ƒçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å®é™…ä¸Šå´å˜åŒ–äº†ã€‚å¼€é”€é—®é¢˜åˆ™æ˜¯å› ä¸ºCASè‡ªæ—‹æ“ä½œéœ€è¦ä¸æ–­è½®è¯¢å†…å­˜ä½ç½®ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼Œè¿™ä¼šæ¶ˆè€—å¤§é‡çš„CPUèµ„æºã€‚&#x20;</p></blockquote><h3 id="13-ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°"><a href="#13-ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°" class="headerlink" title="13. ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°"></a>13. ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°</h3><blockquote><p>ReentrantLockæ˜¯Javaä¸­æä¾›çš„ä¸€ç§å¯é‡å…¥é”ï¼Œå®ƒæ”¯æŒä¸¤ç§é”çš„æ¨¡å¼ï¼šå…¬å¹³é”å’Œéå…¬å¹³é”ã€‚è¿™ä¸¤ç§é”æ¨¡å¼çš„åº•å±‚å®ç°ç•¥æœ‰ä¸åŒï¼š</p><ol><li><p><strong>å…¬å¹³é”ï¼ˆFair Lockï¼‰</strong>ï¼šå…¬å¹³é”çš„ç‰¹ç‚¹æ˜¯æŒ‰ç…§è¯·æ±‚é”çš„é¡ºåºæ¥åˆ†é…ï¼Œå³å…ˆåˆ°å…ˆå¾—ã€‚åœ¨ReentrantLockä¸­ï¼Œé€šè¿‡æ„é€ å‡½æ•°å¯ä»¥é€‰æ‹©åˆ›å»ºä¸€ä¸ªå…¬å¹³é”ã€‚å…¬å¹³é”çš„åº•å±‚å®ç°ä½¿ç”¨äº†ä¸€ä¸ªFIFOé˜Ÿåˆ—ï¼ˆFirst - In - First - Outï¼‰ï¼Œå³ç­‰å¾…é˜Ÿåˆ—ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚é”æ—¶ï¼Œå¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œè¯·æ±‚çº¿ç¨‹ä¼šè¢«æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—çš„æœ«å°¾ï¼ŒæŒ‰ç…§è¯·æ±‚çš„é¡ºåºç­‰å¾…é”çš„é‡Šæ”¾ã€‚å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¼šè¢«å”¤é†’å¹¶è·å¾—é”ã€‚</p></li><li><p><strong>éå…¬å¹³é”ï¼ˆNon - Fair Lockï¼‰</strong>ï¼šéå…¬å¹³é”ä¸è€ƒè™‘è¯·æ±‚é”çš„é¡ºåºï¼Œå®ƒå…è®¸æ–°çš„è¯·æ±‚çº¿ç¨‹æ’é˜Ÿå¹¶å°è¯•ç«‹å³è·å–é”ï¼Œè€Œä¸ç®¡å…¶ä»–çº¿ç¨‹æ˜¯å¦åœ¨ç­‰å¾…ã€‚åœ¨ReentrantLockä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹åˆ›å»ºçš„æ˜¯éå…¬å¹³é”ã€‚éå…¬å¹³é”çš„åº•å±‚å®ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œä½†å®ƒä¸ä¼šä¸¥æ ¼æŒ‰ç…§è¯·æ±‚çš„é¡ºåºæ¥åˆ†é…é”ï¼Œè€Œæ˜¯æ ¹æ®çº¿ç¨‹ç«äº‰çš„æƒ…å†µæ¥åˆ¤æ–­æ˜¯å¦ç«‹å³åˆ†é…ç»™è¯·æ±‚çº¿ç¨‹ã€‚</p></li></ol><p>åº•å±‚å®ç°ä¸­ï¼Œæ— è®ºæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ï¼Œéƒ½ä½¿ç”¨äº†ç±»ä¼¼çš„åŒæ­¥å™¨ï¼ˆSyncï¼‰æ¥ç®¡ç†é”çš„çŠ¶æ€å’Œçº¿ç¨‹çš„ç«äº‰ã€‚ä¸åŒä¹‹å¤„åœ¨äºå¦‚ä½•å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œä»¥åŠæ˜¯å¦æŒ‰ç…§è¯·æ±‚çš„é¡ºåºæ¥åˆ†é…é”ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¬å¹³é”è™½ç„¶éµå¾ªå…¬å¹³æ€§åŸåˆ™ï¼Œä½†åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹å¯èƒ½ä¼šå¼•å…¥è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ï¼Œå› ä¸ºæ¯æ¬¡éƒ½è¦ç»´æŠ¤ä¸€ä¸ªæœ‰åºçš„ç­‰å¾…é˜Ÿåˆ—ã€‚è€Œéå…¬å¹³é”åˆ™æ›´åŠ çµæ´»ï¼Œä½†å¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹ä¸€ç›´è·å–ä¸åˆ°é”ã€‚&#x20;</p></blockquote><h3 id="14-AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„-åº•å±‚æ•°æ®ç»“æ„"><a href="#14-AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„-åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="14. AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„? åº•å±‚æ•°æ®ç»“æ„?"></a>14. AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„? åº•å±‚æ•°æ®ç»“æ„?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>AQSä¸»è¦ä¾èµ–äº<strong>ä¸€ä¸ªåŒå‘é“¾è¡¨</strong>å’Œä¸€ä¸ª<strong>volatileç±»å‹çš„æ•´æ•°state</strong>æ¥å®ç°åŒæ­¥æ§åˆ¶ã€‚è¯¥æ•´æ•°stateç”¨æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œstate=0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;0è¡¨ç¤ºæœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;1è¡¨ç¤ºåŒæ­¥èµ„æºå·²ç»è¢«äº‰ç”¨äº†å¤šæ¬¡ï¼Œæ¯”å¦‚ReentrantLockå¯ä»¥å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—é”ï¼Œæ¯æ¬¡stateå€¼åŠ 1ã€‚</p><p>AQSå®ç°åŒæ­¥çš„å…³é”®åœ¨äºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåŸºäºFIFOé˜Ÿåˆ—çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œé€šè¿‡å°†ç­‰å¾…çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ—¶å€™ï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å”¤é†’ç­‰å¾…çº¿ç¨‹ï¼Œä»è€Œå®ç°äº†åŒæ­¥æœºåˆ¶ã€‚</p><p>AQSçš„å®ç°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç‹¬å å¼ï¼ˆExclusiveï¼‰å’Œå…±äº«å¼ï¼ˆSharedï¼‰ã€‚ç‹¬å å¼æ˜¯æŒ‡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockï¼Œè€Œå…±äº«å¼æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚CountDownLatchã€‚åœ¨AQSä¸­ï¼Œè¿™ä¸¤ç§æ–¹å¼çš„å®ç°æ˜¯åŸºæœ¬ç›¸åŒçš„ï¼ŒåŒºåˆ«åœ¨äºè·å–å’Œé‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ–¹å¼ä¸åŒã€‚&#x20;</p></blockquote><h3 id="15-ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”"><a href="#15-ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”" class="headerlink" title="15. ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”?"></a>15. ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>â€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œå¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p></blockquote><h3 id="16-å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#16-å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="16. å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>16. å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ul><li><p>å…¬å¹³é”ï¼šé”è¢«é‡Šæ”¾ä¹‹åï¼Œå…ˆç”³è¯·çš„çº¿ç¨‹å…ˆå¾—åˆ°é”ã€‚æ€§èƒ½è¾ƒå·®ä¸€äº›ï¼Œå› ä¸ºå…¬å¹³é”ä¸ºäº†ä¿è¯æ—¶é—´ä¸Šçš„ç»å¯¹é¡ºåºï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ›´é¢‘ç¹ã€‚</p></li><li><p>éå…¬å¹³é”ï¼šé”è¢«é‡Šæ”¾ä¹‹åï¼Œåç”³è¯·çš„çº¿ç¨‹å¯èƒ½ä¼šå…ˆè·å–åˆ°é”ï¼Œæ˜¯éšæœºæˆ–è€…æŒ‰ç…§å…¶ä»–ä¼˜å…ˆçº§æ’åºçš„ã€‚æ€§èƒ½æ›´å¥½ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æŸäº›çº¿ç¨‹æ°¸è¿œæ— æ³•è·å–åˆ°é”ã€‚&#x20;</p></li></ul></blockquote><h3 id="17-ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½"><a href="#17-ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½" class="headerlink" title="17. ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½?"></a>17. ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>å…¬å¹³é”æ‰§è¡Œæµç¨‹ï¼šè·å–é”æ—¶ï¼Œå…ˆå°†çº¿ç¨‹è‡ªå·±æ·»åŠ åˆ°åŒæ­¥é˜Ÿåˆ—çš„é˜Ÿå°¾å¹¶ä¼‘çœ ï¼Œå½“æŸçº¿ç¨‹ç”¨å®Œé”ä¹‹åï¼Œä¼šå»å”¤é†’åŒæ­¥é˜Ÿåˆ—é˜Ÿé¦–çš„çº¿ç¨‹å°è¯•å»è·å–é”ï¼Œé”çš„ä½¿ç”¨åŒæ­¥ä¹Ÿå°±æ˜¯é˜Ÿåˆ—ä¸­çš„å…ˆåé¡ºåºï¼Œåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¼šä»è¿è¡ŒçŠ¶æ€åˆ‡æ¢åˆ°ä¼‘çœ çŠ¶æ€ï¼Œå†ä»ä¼‘çœ çŠ¶æ€æ¢å¤æˆè¿è¡ŒçŠ¶æ€ï¼Œä½†çº¿ç¨‹æ¯æ¬¡ä¼‘çœ å’Œæ¢å¤éƒ½éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢æˆå†…æ ¸æ€ï¼Œè€Œè¿™ä¸ªçŠ¶æ€çš„è½¬æ¢æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œæ‰€ä»¥å…¬å¹³é”çš„æ‰§è¡Œé€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ã€‚</p></li><li><p>éå…¬å¹³é”æ‰§è¡Œæµç¨‹ï¼šå½“çº¿ç¨‹è·å–é”æ—¶ï¼Œä¼šå…ˆé€šè¿‡CASå°è¯•è·å–é”ï¼Œå¦‚æœè·å–æˆåŠŸå°±ç›´æ¥æ‹¥æœ‰é”ï¼Œå¦‚æœè·å–é”å¤±è´¥æ‰ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸‹æ¬¡å°è¯•è·å–é”ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œè·å–é”ä¸éµå¾ªå…ˆåˆ°å…ˆå¾—çš„è§„åˆ™ï¼Œä»è€Œé¿å…äº†ä¸€æ¬¡çº¿ç¨‹ä¼‘çœ å’Œæ¢å¤çš„æ“ä½œï¼Œè¿™æ ·å°±åŠ é€Ÿäº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚&#x20;</p></li></ul></blockquote><h3 id="18-ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„-éå…¬å¹³é”çš„"><a href="#18-ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„-éå…¬å¹³é”çš„" class="headerlink" title="18. ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„? éå…¬å¹³é”çš„?"></a>18. ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„? éå…¬å¹³é”çš„?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ReentrantLockç±»å†…éƒ¨æ€»å…±å­˜åœ¨Syncã€NonfairSyncã€FairSyncä¸‰ä¸ªç±»ï¼ŒNonfairSyncä¸FairSyncç±»ç»§æ‰¿è‡ªSyncç±»ï¼ŒSyncç±»ç»§æ‰¿è‡ªAbstractQueueuedSynchronizeræŠ½è±¡ç±»ã€‚</p><p>éå…¬å¹³é”æ˜¯ReentrantLockçš„é»˜è®¤å®ç°ã€‚å…¬å¹³é”å¯¹æ¯”éå…¬å¹³é”çš„å®ç°å·®å¼‚ä¸»è¦ä½“ç°åœ¨tryAcquireæ–¹æ³•ï¼ˆè·å–é”ï¼‰è¿™é‡Œã€‚éå…¬å¹³é”ï¼ˆNonfairSyncï¼‰çš„tryAcquireå®ç°ç›´æ¥è°ƒç”¨äº†çˆ¶ç±»Syncä¸­çš„nonfairTryAcquireã€‚</p><p>è€Œå…¬å¹³é”tryAcquireçš„å”¯ä¸€ä¸åŒçš„ç‚¹ä¸ºåˆ¤æ–­æ¡ä»¶å¤šäº†hasQueuedPredecessors()æ–¹æ³•ï¼Œå³åŠ å…¥äº†åŒæ­¥é˜Ÿåˆ—ä¸­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹çš„åˆ¤æ–­ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›trueï¼Œåˆ™è¡¨ç¤ºæœ‰çº¿ç¨‹æ¯”å½“å‰çº¿ç¨‹æ›´æ—©åœ°è¯·æ±‚è·å–é”ï¼Œå› æ­¤éœ€è¦ç­‰å¾…å‰é©±çº¿ç¨‹è·å–å¹¶é‡Šæ”¾é”ä¹‹åæ‰èƒ½ç»§ç»­è·å–é”ï¼ˆè¿™å°±å«å…¬å¹³ï¼‰ã€‚</p></blockquote><h3 id="19-ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ"><a href="#19-ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ" class="headerlink" title="19. ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ?"></a>19. ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼š<code>ReentrantReadWriteLock</code>å®ç°äº†<code>ReadWriteLock</code>ï¼Œæ˜¯ä¸€ä¸ªå¯é‡å…¥çš„è¯»å†™é”ï¼Œæ—¢å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»çš„æ•ˆç‡ï¼ŒåŒæ—¶åˆå¯ä»¥ä¿è¯æœ‰å†™å…¥æ“ä½œæ—¶çš„çº¿ç¨‹å®‰å…¨ã€‚</p><p><code>ReentrantReadWriteLock</code>å…¶å®æ˜¯ä¸¤æŠŠé”ï¼Œä¸€æŠŠæ˜¯WriteLockï¼ˆå†™é”ï¼‰ï¼Œä¸€æŠŠæ˜¯ReadLockï¼ˆè¯»é”ï¼‰ã€‚è¯»é”æ˜¯å…±äº«é”ï¼Œå†™é”æ˜¯ç‹¬å é”ã€‚è¯»é”å¯ä»¥è¢«åŒæ—¶è¯»ï¼Œå¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æŒæœ‰ï¼Œè€Œå†™é”æœ€å¤šåªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ã€‚&#x20;</p></blockquote><h3 id="20-å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#20-å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="20. å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>20. å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>å…±äº«é”ï¼šä¸€æŠŠé”å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—ã€‚</p></li><li><p>ç‹¬å é”ï¼šä¸€æŠŠé”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å¾—ã€‚</p></li></ul></blockquote><h3 id="21-çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—"><a href="#21-çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—" class="headerlink" title="21. çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—?"></a>21. çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>åœ¨çº¿ç¨‹æŒæœ‰è¯»é”çš„æƒ…å†µä¸‹ï¼šè¯¥çº¿ç¨‹ä¸èƒ½å–å¾—å†™é”(å› ä¸ºè·å–å†™é”çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å½“å‰çš„è¯»é”è¢«å ç”¨ï¼Œå°±é©¬ä¸Šè·å–å¤±è´¥ï¼Œä¸ç®¡è¯»é”æ˜¯ä¸æ˜¯è¢«å½“å‰çº¿ç¨‹æŒæœ‰)ã€‚</p><p>åœ¨çº¿ç¨‹æŒæœ‰å†™é”çš„æƒ…å†µä¸‹ï¼šè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å–è¯»é”ï¼ˆè·å–è¯»é”æ—¶å¦‚æœå‘ç°å†™é”è¢«å ç”¨ï¼Œåªæœ‰å†™é”æ²¡æœ‰è¢«å½“å‰çº¿ç¨‹å ç”¨çš„æƒ…å†µæ‰ä¼šè·å–å¤±è´¥ï¼‰ã€‚</p></blockquote><h3 id="22-ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§-RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§"><a href="#22-ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§-RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§" class="headerlink" title="22. ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§? RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§?"></a>22. ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§? RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>å†™é”å¯ä»¥é™çº§ä¸ºè¯»é”ï¼Œä½†æ˜¯è¯»é”å´ä¸èƒ½å‡çº§ä¸ºå†™é”ã€‚è¿™æ˜¯å› ä¸ºè¯»é”å‡çº§ä¸ºå†™é”ä¼šå¼•èµ·çº¿ç¨‹çš„äº‰å¤ºï¼Œæ¯•ç«Ÿå†™é”å±äºæ˜¯ç‹¬å é”ï¼Œè¿™æ ·çš„è¯ï¼Œä¼šå½±å“æ€§èƒ½ã€‚å¦å¤–ï¼Œè¿˜å¯èƒ½ä¼šæœ‰æ­»é”é—®é¢˜å‘ç”Ÿã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ä¸¤ä¸ªçº¿ç¨‹çš„è¯»é”éƒ½æƒ³å‡çº§å†™é”ï¼Œåˆ™éœ€è¦å¯¹æ–¹éƒ½é‡Šæ”¾è‡ªå·±é”ï¼Œè€ŒåŒæ–¹éƒ½ä¸é‡Šæ”¾ï¼Œå°±ä¼šäº§ç”Ÿæ­»é”ã€‚&#x20;</p></blockquote><h3 id="23-ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„"><a href="#23-ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„" class="headerlink" title="23. ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„?"></a>23. ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šé«˜16ä½ä¸ºè¯»é”ï¼Œä½16ä½ä¸ºå†™é”ã€‚&#x20;</p></blockquote><h2 id="å¹¶å‘å®‰å…¨å®¹å™¨-å¹¶å‘å·¥å…·ç±»"><a href="#å¹¶å‘å®‰å…¨å®¹å™¨-å¹¶å‘å·¥å…·ç±»" class="headerlink" title="å¹¶å‘å®‰å…¨å®¹å™¨/å¹¶å‘å·¥å…·ç±»"></a>å¹¶å‘å®‰å…¨å®¹å™¨/å¹¶å‘å·¥å…·ç±»</h2><h3 id="1-JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ"><a href="#1-JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="1. JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ"></a>1. JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ</h3><blockquote><ol><li><p>JDK8ä¸­æ–°å¢äº†çº¢é»‘æ ‘ï¼ŒJDK8æ˜¯é€šè¿‡æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘æ¥å®ç°çš„ï¼›</p></li><li><p>JDK7ä¸­é“¾è¡¨çš„æ’å…¥æ˜¯ç”¨çš„å¤´æ’æ³•ï¼Œè€ŒJDK8ä¸­åˆ™æ”¹ä¸ºäº†å°¾æ’æ³•ï¼›</p></li><li><p>JDK8ä¸­å› ä¸ºä½¿ç”¨äº†çº¢é»‘æ ‘ä¿è¯äº†æ’å…¥å’ŒæŸ¥è¯¢çš„æ•ˆç‡ï¼Œæ‰€ä»¥å®é™…ä¸ŠJDK8ä¸­çš„Hashç®—æ³•å®ç°çš„å¤æ‚åº¦é™ä½äº†ï¼›</p></li><li><p>JDK8ä¸­æ•°ç»„æ‰©å®¹çš„æ¡ä»¶ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œåªä¼šåˆ¤æ–­æ˜¯å¦å½“å‰å…ƒç´ ä¸ªæ•°æ˜¯å¦è¶…è¿‡äº†é˜ˆå€¼ï¼Œè€Œä¸å†åˆ¤æ–­å½“å‰putè¿›æ¥çš„å…ƒç´ å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ä½ç½®æ˜¯å¦æœ‰å€¼ï¼›</p></li><li><p>JDK7ä¸­æ˜¯å…ˆæ‰©å®¹å†æ·»åŠ æ–°å…ƒç´ ï¼ŒJDK8ä¸­æ˜¯å…ˆæ·»åŠ æ–°å…ƒç´ ç„¶åå†æ‰©å®¹ã€‚&#x20;</p></li></ol></blockquote><h3 id="2-ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«"><a href="#2-ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«" class="headerlink" title="2. ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«?"></a>2. ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p><p><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼šJDK1.7çš„ConcurrentHashMapåº•å±‚é‡‡ç”¨åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨å®ç°ï¼ŒJDK1.8é‡‡ç”¨çš„æ•°æ®ç»“æ„è·ŸHashMap1.8çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚Hashtableå’ŒJDK1.8ä¹‹å‰çš„HashMapçš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</p><p><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰</strong>ï¼š</p><p>åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapå¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segmentï¼Œåˆ†æ®µé”)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚</p><p>åˆ°äº†JDK1.8çš„æ—¶å€™ï¼ŒConcurrentHashMapå·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨Nodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨synchronizedå’ŒCASæ¥æ“ä½œã€‚(JDK1.6ä»¥åsynchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–) æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„HashMapï¼Œè™½ç„¶åœ¨JDK1.8ä¸­è¿˜èƒ½çœ‹åˆ°Segmentçš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å·²ç»ç®€åŒ–äº†å±æ€§ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ï¼›</p><p>Hashtable(åŒä¸€æŠŠé”)ï¼šä½¿ç”¨synchronizedæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨putæ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨putæ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚&#x20;</p></blockquote><h3 id="3-ConcurrentHashMap-JDK1-7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ"><a href="#3-ConcurrentHashMap-JDK1-7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="3. ConcurrentHashMap JDK1.7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?"></a>3. ConcurrentHashMap JDK1.7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µï¼ˆè¿™ä¸ªâ€œæ®µâ€å°±æ˜¯Segmentï¼‰çš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®æ—¶ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</p></li><li><p>ConcurrentHashMapæ˜¯ç”±Segmentæ•°ç»„ç»“æ„å’ŒHashEntryæ•°ç»„ç»“æ„ç»„æˆã€‚</p></li><li><p>Segmentç»§æ‰¿äº†ReentrantLockï¼Œæ‰€ä»¥Segmentæ˜¯ä¸€ç§å¯é‡å…¥é”ï¼Œæ‰®æ¼”é”çš„è§’è‰²ã€‚HashEntryç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚</p></li><li><p>ä¸€ä¸ªConcurrentHashMapé‡ŒåŒ…å«ä¸€ä¸ªSegmentæ•°ç»„ï¼ŒSegmentçš„ä¸ªæ•°ä¸€æ—¦åˆå§‹åŒ–å°±ä¸èƒ½æ”¹å˜ã€‚Segmentæ•°ç»„çš„å¤§å°é»˜è®¤æ˜¯16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤å¯ä»¥åŒæ—¶æ”¯æŒ16ä¸ªçº¿ç¨‹å¹¶å‘å†™ã€‚</p></li><li><p>Segmentçš„ç»“æ„å’ŒHashMapç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ªSegmentåŒ…å«ä¸€ä¸ªHashEntryæ•°ç»„ï¼Œæ¯ä¸ªHashEntryæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ªSegmentå®ˆæŠ¤ç€ä¸€ä¸ªHashEntryæ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹HashEntryæ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å¯¹åº”çš„Segmentçš„é”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹åŒä¸€Segmentçš„å¹¶å‘å†™å…¥ä¼šè¢«é˜»å¡ï¼Œä¸åŒSegmentçš„å†™å…¥æ˜¯å¯ä»¥å¹¶å‘æ‰§è¡Œçš„ã€‚&#x20;</p></li></ul></blockquote><h3 id="4-ConcurrentHashMap-JDK1-8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ"><a href="#4-ConcurrentHashMap-JDK1-8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="4. ConcurrentHashMap JDK1.8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?"></a>4. ConcurrentHashMap JDK1.8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>JDK1.8 ConcurrentHashMapå–æ¶ˆäº†Segmentåˆ†æ®µé”ï¼Œé‡‡ç”¨Node + CAS + synchronizedæ¥ä¿è¯å¹¶å‘å®‰å…¨ã€‚æ•°æ®ç»“æ„è·ŸHashMap 1.8çš„ç»“æ„ç±»ä¼¼ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚Java 8åœ¨é“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼8ï¼ˆåŒæ—¶æ»¡è¶³å®¹é‡&gt;=64ï¼‰æ—¶å°†é“¾è¡¨ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼‰è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸ºO(log(N))ï¼‰ã€‚</p><p>Java 8ä¸­ï¼Œé”ç²’åº¦æ›´ç»†ï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦hashä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œå°±ä¸ä¼šå½±å“å…¶ä»–Nodeçš„è¯»å†™ï¼Œæ•ˆç‡å¤§å¹…æå‡ã€‚</p></blockquote><h3 id="5-ConcurrentHashMap-JDK1-7çš„å®ç°å’Œ1-8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#5-ConcurrentHashMap-JDK1-7çš„å®ç°å’Œ1-8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="5. ConcurrentHashMap JDK1.7çš„å®ç°å’Œ1.8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>5. ConcurrentHashMap JDK1.7çš„å®ç°å’Œ1.8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p><strong>çº¿ç¨‹å®‰å…¨å®ç°æ–¹å¼</strong>ï¼šJDK 1.7é‡‡ç”¨Segmentåˆ†æ®µé”æ¥ä¿è¯å®‰å…¨ï¼ŒSegmentæ˜¯ç»§æ‰¿è‡ªReentrantLockã€‚JDK1.8æ”¾å¼ƒäº†Segmentåˆ†æ®µé”çš„è®¾è®¡ï¼Œé‡‡ç”¨Node + CAS + synchronizedä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé”ç²’åº¦æ›´ç»†ï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ã€‚</p></li><li><p><strong>Hashç¢°æ’è§£å†³æ–¹æ³•</strong>ï¼šJDK 1.7é‡‡ç”¨æ‹‰é“¾æ³•ï¼ŒJDK1.8é‡‡ç”¨æ‹‰é“¾æ³•ç»“åˆçº¢é»‘æ ‘ï¼ˆé“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰ã€‚</p></li><li><p><strong>å¹¶å‘åº¦</strong>ï¼šJDK 1.7æœ€å¤§å¹¶å‘åº¦æ˜¯Segmentçš„ä¸ªæ•°ï¼Œé»˜è®¤æ˜¯16ã€‚JDK 1.8æœ€å¤§å¹¶å‘åº¦æ˜¯Nodeæ•°ç»„çš„å¤§å°ï¼Œå¹¶å‘åº¦æ›´å¤§ã€‚&#x20;</p></li></ul></blockquote><h3 id="6-JDK1-8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨"><a href="#6-JDK1-8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨" class="headerlink" title="6. JDK1.8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨?"></a>6. JDK1.8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šé“¾è¡¨é•¿åº¦å¤§äºç­‰äº8ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äºç­‰äº64ã€‚</p><p>å¹¶éä¸€å¼€å§‹å°±åˆ›å»ºçº¢é»‘æ ‘ç»“æ„ï¼Œå¦‚æœå½“å‰Nodeæ•°ç»„é•¿åº¦å°äºé˜ˆå€¼MIN_TREEIFY_CAPACITYï¼Œé»˜è®¤ä¸º64ï¼Œå…ˆé€šè¿‡æ‰©å¤§æ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ä¸¤å€ä»¥ç¼“è§£å•ä¸ªé“¾è¡¨å…ƒç´ è¿‡å¤§çš„æ€§èƒ½é—®é¢˜ã€‚</p></blockquote><h3 id="7-JDK1-8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„"><a href="#7-JDK1-8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„" class="headerlink" title="7. JDK1.8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„?"></a>7. JDK1.8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>æ•´ä½“æµç¨‹è·ŸHashMapæ¯”è¾ƒç±»ä¼¼ï¼Œå¤§è‡´æ˜¯ä»¥ä¸‹å‡ æ­¥ï¼š</p><ul><li><p>å¦‚æœæ¡¶æ•°ç»„æœªåˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–ï¼›</p></li><li><p>å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ºç©ºï¼Œåˆ™å°è¯•æŠŠæ­¤å…ƒç´ ç›´æ¥æ’å…¥åˆ°æ¡¶çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼›</p></li><li><p>å¦‚æœæ­£åœ¨æ‰©å®¹ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¸€èµ·åŠ å…¥åˆ°æ‰©å®¹çš„è¿‡ç¨‹ä¸­ï¼›</p></li><li><p>å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ä¸ºç©ºä¸”æ²¡åœ¨è¿ç§»å…ƒç´ ï¼Œåˆ™é”ä½è¿™ä¸ªæ¡¶ï¼›</p></li><li><p>å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥é“¾è¡¨æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p></li><li><p>å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥çº¢é»‘æ ‘æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨çº¢é»‘æ ‘ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p></li><li><p>å¦‚æœå…ƒç´ å­˜åœ¨ï¼Œåˆ™è¦†ç›–æ—§å€¼ï¼›</p></li><li><p>å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œæ•´ä¸ªMapçš„å…ƒç´ ä¸ªæ•°åŠ 1ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ï¼›&#x20;</p></li></ul></blockquote><h3 id="8-ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ"><a href="#8-ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ" class="headerlink" title="8. ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ?"></a>8. ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šä¸éœ€è¦ã€‚getæ–¹æ³•ä¸æ¶‰åŠå¯¹å˜é‡çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å¹¶å‘ä¸‹å¯èƒ½å¤„é—®é¢˜çš„åŸå› å°±æ˜¯è¯»å…±äº«å˜é‡çš„å¯è§æ€§é—®é¢˜ã€‚è€ŒConcurrentHashMapä¸­ï¼Œå¯¹getæ–¹æ³•ä¸­ç”¨åˆ°çš„å…±äº«å˜é‡éƒ½ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥æ•´ä¸ªgetæ–¹æ³•ä¸åŠ é”ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ã€‚</p></blockquote><h3 id="9-ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘"><a href="#9-ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘" class="headerlink" title="9. ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘?"></a>9. ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šåˆå§‹å®¹é‡ä¸º16</p></blockquote><h3 id="10-ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull"><a href="#10-ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull" class="headerlink" title="10. ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull?"></a>10. ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šä¸è¡Œã€‚å¦‚æœkeyæˆ–è€…valueä¸ºnullä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚(åŸå› æ˜¯å› ä¸ºæ²¡åŠæ³•è§£å†³getè¿”å›å€¼ä¸ºnullæ—¶çš„äºŒä¹‰æ€§é—®é¢˜ï¼Œå³æ²¡åŠæ³•ç¡®å®šæ˜¯å­˜å‚¨çš„å€¼æœ¬èº«ä¸ºnullï¼Œè¿˜æ˜¯è¯´å€¼ä¸å­˜åœ¨)ï¼›</p><p>æ³¨æ„ï¼šHashMapå…è®¸ä½¿ç”¨nullä½œä¸ºå€¼å’Œé”®ã€‚(å› ä¸ºHashMapåªèƒ½å•çº¿ç¨‹ä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥hashmapå¯ä»¥ç”¨containsKeyæ¥äºŒæ¬¡åˆ¤æ–­ï¼Œæ’é™¤äºŒä¹‰æ€§é—®é¢˜)&#x20;</p></blockquote><h3 id="11-å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡"><a href="#11-å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡" class="headerlink" title="11.å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡?"></a>11.å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šå®ƒæ˜¯å®ç°Map.Entry\<K, V>æ¥å£ã€‚é‡Œé¢å­˜æ”¾äº†hashï¼Œkeyï¼Œvalueï¼Œä»¥åŠnextèŠ‚ç‚¹ã€‚å®ƒçš„valueå’ŒnextèŠ‚ç‚¹æ˜¯ç”¨volatileè¿›è¡Œä¿®é¥°ï¼Œå¯ä»¥ä¿è¯å¤šçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ã€‚</p></blockquote><h3 id="12-ä»€ä¹ˆæ˜¯BlockingQueue"><a href="#12-ä»€ä¹ˆæ˜¯BlockingQueue" class="headerlink" title="12. ä»€ä¹ˆæ˜¯BlockingQueue?"></a>12. ä»€ä¹ˆæ˜¯BlockingQueue?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>é˜»å¡é˜Ÿåˆ—(BlockingQueue)æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚è¿™ä¸¤ä¸ªé™„åŠ çš„æ“ä½œæ”¯æŒé˜»å¡çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•ã€‚</p><ol><li><p>æ”¯æŒé˜»å¡çš„æ’å…¥æ–¹æ³•ï¼šæ„æ€æ˜¯å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡æ’å…¥å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸æ»¡ã€‚</p></li><li><p>æ”¯æŒé˜»å¡çš„ç§»é™¤æ–¹æ³•ï¼šæ„æ€æ˜¯åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚&#x20;</p></li></ol></blockquote><h3 id="13-ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—"><a href="#13-ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—" class="headerlink" title="13.ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—"></a>13.ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—</h3><blockquote><ul><li><p>ArrayBlockingQueueï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</p></li><li><p>LinkedBlockingQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„é˜»å¡é˜Ÿåˆ—ã€‚æ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¯ä»¥ä¸æŒ‡å®šå®¹é‡å¤§å°ï¼Œé»˜è®¤æ˜¯Integer.MAX_VALUEï¼Œä¹Ÿå°±æ˜¯æ— ç•Œçš„ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šé˜Ÿåˆ—å¤§å°ï¼Œä»è€Œæˆä¸ºæœ‰ç•Œçš„ã€‚</p></li><li><p>PriorityBlockingQueueï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹å…ƒç´ é‡‡å–è‡ªç„¶é¡ºåºå‡åºæ’åˆ—ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç±»å®ç°compareTo()æ–¹æ³•æ¥æŒ‡å®šå…ƒç´ æ’åºè§„åˆ™ã€‚</p></li><li><p>DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä½¿ç”¨PriorityQueueæ¥å®ç°ã€‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œåœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰èƒ½ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ã€‚åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ ã€‚ï¼ˆå¸¸ç”¨åœ¨ç¼“å­˜æœ‰æ•ˆæœŸï¼Œå®šæ—¶ä»»åŠ¡è°ƒåº¦ç­‰åœºæ™¯ï¼‰</p></li><li><p>SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸€ä¸ªputæ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªtakeæ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚é˜Ÿåˆ—æœ¬èº«å¹¶ä¸å­˜å‚¨ä»»ä½•å…ƒç´ ï¼Œéå¸¸é€‚åˆä¼ é€’æ€§åœºæ™¯ã€‚</p></li><li><p>LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„å•å‘æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚å®ƒè®¾è®¡äº†ä¸€ç§ç›´æ¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ä¼ è¾“å…ƒç´ çš„æœºåˆ¶ï¼Œç§°ä¸ºâ€œtransferâ€ã€‚å½“ç”Ÿäº§è€…è°ƒç”¨transfer(e)æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé˜»å¡ç›´åˆ°æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶è¯¥å…ƒç´ ã€‚é€‚ç”¨äºéœ€è¦é«˜æ•ˆåœ°åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ç›´æ¥ä¼ è¾“æ•°æ®çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯å½“ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„é€Ÿåº¦å¤§è‡´åŒ¹é…æ—¶ã€‚</p></li><li><p>LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚æ‰€è°“åŒå‘é˜Ÿåˆ—æŒ‡çš„æ˜¯å¯ä»¥ä»é˜Ÿåˆ—çš„ä¸¤ç«¯æ’å…¥å’Œç§»å‡ºå…ƒç´ ã€‚ç›¸æ¯”å…¶ä»–çš„é˜»å¡é˜Ÿåˆ—ï¼ŒLinkedBlockingDequeå¤šäº†addFirstã€addLastã€offerFirstã€offerLastã€peekFirstå’ŒpeekLastç­‰æ–¹æ³•ã€‚åŒå‘é˜»å¡é˜Ÿåˆ—å¯ä»¥è¿ç”¨åœ¨â€œå·¥ä½œçªƒå–â€æ¨¡å¼ä¸­ã€‚&#x20;</p></li></ul></blockquote><h3 id="14-ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#14-ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="14. ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«?"></a>14. ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šArrayBlockingQueueå’ŒLinkedBlockingQueueæ˜¯Javaå¹¶å‘åŒ…ä¸­å¸¸ç”¨çš„ä¸¤ç§é˜»å¡é˜Ÿåˆ—å®ç°ï¼Œå®ƒä»¬éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨ä¸‹é¢è¿™äº›åŒºåˆ«ï¼š</p><ul><li><p>åº•å±‚å®ç°ï¼šArrayBlockingQueueåŸºäºæ•°ç»„å®ç°ï¼Œè€ŒLinkedBlockingQueueåŸºäºé“¾è¡¨å®ç°ã€‚</p></li><li><p>æ˜¯å¦æœ‰ç•Œï¼šArrayBlockingQueueæ˜¯æœ‰ç•Œé˜Ÿåˆ—ï¼Œå¿…é¡»åœ¨åˆ›å»ºæ—¶æŒ‡å®šå®¹é‡å¤§å°ã€‚LinkedBlockingQueueåˆ›å»ºæ—¶å¯ä»¥ä¸æŒ‡å®šå®¹é‡å¤§å°ï¼Œé»˜è®¤æ˜¯Integer.MAX_VALUEï¼Œä¹Ÿå°±æ˜¯æ— ç•Œçš„ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šé˜Ÿåˆ—å¤§å°ï¼Œä»è€Œæˆä¸ºæœ‰ç•Œçš„ã€‚</p></li><li><p>é”æ˜¯å¦åˆ†ç¦»ï¼šArrayBlockingQueueä¸­çš„é”æ˜¯æ²¡æœ‰åˆ†ç¦»çš„ï¼Œå³ç”Ÿäº§å’Œæ¶ˆè´¹ç”¨çš„æ˜¯åŒä¸€ä¸ªé”ï¼›LinkedBlockingQueueä¸­çš„é”æ˜¯åˆ†ç¦»çš„ï¼Œå³ç”Ÿäº§ç”¨çš„æ˜¯putLockï¼Œæ¶ˆè´¹æ˜¯takeLockï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä¹‹é—´çš„é”äº‰å¤ºã€‚</p></li><li><p>å†…å­˜å ç”¨ï¼šArrayBlockingQueueéœ€è¦æå‰åˆ†é…æ•°ç»„å†…å­˜ï¼Œè€ŒLinkedBlockingQueueåˆ™æ˜¯åŠ¨æ€åˆ†é…é“¾è¡¨èŠ‚ç‚¹å†…å­˜ã€‚è¿™æ„å‘³ç€ï¼ŒArrayBlockingQueueåœ¨åˆ›å»ºæ—¶å°±ä¼šå ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œä¸”å¾€å¾€ç”³è¯·çš„å†…å­˜æ¯”å®é™…æ‰€ç”¨çš„å†…å­˜æ›´å¤§ï¼Œè€ŒLinkedBlockingQueueåˆ™æ˜¯æ ¹æ®å…ƒç´ çš„å¢åŠ è€Œé€æ¸å ç”¨å†…å­˜ç©ºé—´ã€‚&#x20;</p></li></ul></blockquote><h3 id="15-å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢"><a href="#15-å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢" class="headerlink" title="15. å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢?"></a>15. å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><p>ç­”ï¼šä½¿ç”¨é€šçŸ¥æ¨¡å¼å®ç°ã€‚æ‰€è°“é€šçŸ¥æ¨¡å¼ï¼Œå½“æ¶ˆè´¹è€…ä»ç©ºçš„é˜Ÿåˆ—è·å–å…ƒç´ æ—¶ä¼šé˜»å¡ä½æ¶ˆè´¹è€…ï¼Œæ­¤æ—¶å¦‚æœç”Ÿäº§è€…æ”¾äº†ä¸€ä¸ªå…ƒç´ è¿›å…¥é˜Ÿåˆ—ï¼Œåˆ™éœ€è¦é€šçŸ¥é˜»å¡ä½æ¶ˆè´¹è€…å½“å‰æœ‰å…ƒç´ å¯å–ã€‚åŒç†å½“ç”Ÿäº§è€…å¾€æ»¡çš„é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ æ—¶ä¼šé˜»å¡ä½ç”Ÿäº§è€…ï¼Œå½“æ¶ˆè´¹è€…æ¶ˆè´¹äº†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„å…ƒç´ åï¼Œä¼šé€šçŸ¥ç”Ÿäº§è€…å½“å‰é˜Ÿåˆ—å¯ç”¨ã€‚é€šè¿‡æŸ¥çœ‹JDKæºç å‘ç°éƒ¨åˆ†é˜»å¡é˜Ÿåˆ—ä½¿ç”¨äº†Conditionæ¥å®ç°ã€‚&#x20;</p></blockquote><h3 id="16-CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—"><a href="#16-CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—" class="headerlink" title="16. CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—?"></a>16. CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—?</h3><blockquote><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><ul><li><p>CountDownLatchï¼šå€’è®¡æ•°å™¨ã€‚å…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œã€‚</p></li><li><p>CyclicBarrierçš„å­—é¢æ„æ€æ˜¯å¯å¾ªç¯ä½¿ç”¨ï¼ˆCyclicï¼‰çš„å±éšœï¼ˆBarrierï¼‰ã€‚å®ƒè¦åšçš„äº‹æƒ…æ˜¯ï¼Œè®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å«åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡ï¼Œç›´åˆ°æœ€åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­è¿è¡Œã€‚</p></li><li><p>Semaphoreï¼ˆä¿¡å·é‡ï¼‰ï¼šæ˜¯ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡ï¼Œå®ƒé€šè¿‡åè°ƒå„ä¸ªçº¿ç¨‹ï¼Œä»¥ä¿è¯åˆç†çš„ä½¿ç”¨å…¬å…±èµ„æºã€‚</p></li><li><p>Exchangerï¼ˆäº¤æ¢è€…ï¼‰ï¼šæ˜¯ä¸€ä¸ªç”¨äºçº¿ç¨‹é—´åä½œçš„å·¥å…·ç±»ã€‚Exchangerç”¨äºè¿›è¡Œçº¿ç¨‹é—´çš„æ•°æ®äº¤æ¢ã€‚å®ƒæä¾›ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œåœ¨è¿™ä¸ªåŒæ­¥ç‚¹ï¼Œä¸¤ä¸ªçº¿ç¨‹å¯ä»¥äº¤æ¢å½¼æ­¤çš„æ•°æ®ã€‚&#x20;</p></li></ul></blockquote><h3 id="17-CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#17-CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="17. CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«?"></a>17. CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«?</h3><p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p><blockquote><ol><li>CyclicBarrieræ˜¯å¯é‡ç”¨çš„ï¼Œå…¶ä¸­çš„çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆä»»åŠ¡ã€‚å±Šæ—¶ï¼Œå±éšœå°†è¢«æ‹†é™¤ï¼Œå¹¶å¯ä»¥é€‰æ‹©æ€§åœ°åšä¸€äº›ç‰¹å®šçš„åŠ¨ä½œã€‚</li></ol><p>CountDownLatchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨åŒä¸€ä¸ªè®¡æ•°å™¨ä¸Šå·¥ä½œï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º0.</p><ul><li>CyclicBarrieré¢å‘çš„æ˜¯çº¿ç¨‹æ•°ï¼›</li></ul><p>CountDownLatché¢å‘çš„æ˜¯ä»»åŠ¡æ•°ã€‚</p><ul><li><p>åœ¨ä½¿ç”¨CyclicBarrieræ—¶ï¼Œä½ å¿…é¡»åœ¨æ„é€ ä¸­æŒ‡å®šå‚ä¸åä½œçš„çº¿ç¨‹æ•°ï¼Œè¿™äº›çº¿ç¨‹å¿…é¡»è°ƒç”¨await()æ–¹æ³•ï¼›ä½¿ç”¨CountDownLatchæ—¶ï¼Œåˆ™å¿…é¡»è¦æŒ‡å®šä»»åŠ¡æ•°ï¼Œè‡³äºè¿™äº›ä»»åŠ¡ç”±å“ªäº›çº¿ç¨‹å®Œæˆæ— å…³ç´§è¦ã€‚</p></li><li><p>CyclicBarrierå¯ä»¥åœ¨æ‰€æœ‰çš„çº¿ç¨‹é‡Šæ”¾åé‡æ–°ä½¿ç”¨ï¼›CountDownLatchåœ¨è®¡æ•°å™¨ä¸º0æ—¶ä¸èƒ½å†ä½¿ç”¨ã€‚&#x20;</p></li></ul></blockquote><h3 id="18-å¸¸è§å‡½æ•°"><a href="#18-å¸¸è§å‡½æ•°" class="headerlink" title="18.å¸¸è§å‡½æ•°"></a>18.å¸¸è§å‡½æ•°</h3><blockquote><p>åœ¨ JUCï¼ˆJava.util.concurrentï¼‰ä¸­ï¼Œä¸€äº›å¸¸ç”¨çš„å‡½æ•°åŠå…¶ä½œç”¨å¦‚ä¸‹ï¼š</p><ol><li><p><code>park()</code> å’Œ <code>unpark()</code>ï¼š</p><ul><li><p><code>park()</code>ï¼šç”¨äºé˜»å¡å½“å‰çº¿ç¨‹ã€‚</p></li><li><p><code>unpark(Thread thread)</code>ï¼šç”¨äºå”¤é†’æŒ‡å®šçš„è¢« <code>park()</code> é˜»å¡çš„çº¿ç¨‹ã€‚</p></li></ul></li><li><p><code>wait()</code>ã€<code>notify()</code> å’Œ <code>notifyAll()</code>ï¼š</p><ul><li><p><code>wait()</code>ï¼šä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ <code>notify()</code> æ–¹æ³•æˆ– <code>notifyAll()</code> æ–¹æ³•ã€‚</p></li><li><p><code>notify()</code>ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚</p></li><li><p><code>notifyAll()</code>ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚</p></li></ul></li><li><p><code>Thread.sleep(long millis)</code>ï¼šä½¿å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœæŒ‡å®šçš„æ¯«ç§’æ•°ã€‚</p></li><li><p><code>CountDownLatch</code>ï¼š</p><ul><li><p><code>countDown()</code>ï¼šä½¿è®¡æ•°å™¨å‡ 1ã€‚</p></li><li><p><code>await()</code>ï¼šç­‰å¾…è®¡æ•°å™¨å˜ä¸º 0ã€‚</p></li></ul></li><li><p><code>CyclicBarrier</code>ï¼š</p><ul><li><code>await()</code>ï¼šç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœç‚¹ã€‚</li></ul></li><li><p><code>Semaphore</code>ï¼š</p><ul><li><p><code>acquire()</code>ï¼šè·å–ä¸€ä¸ªè®¸å¯ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨è®¸å¯åˆ™é˜»å¡ã€‚</p></li><li><p><code>release()</code>ï¼šé‡Šæ”¾ä¸€ä¸ªè®¸å¯ã€‚</p></li></ul></li><li><p><code>Future</code> å’Œ <code>CompletableFuture</code>ï¼šç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚</p></li></ol><p>è¿™äº›å‡½æ•°å’Œç±»ä¸ºå¤šçº¿ç¨‹ç¼–ç¨‹æä¾›äº†ä¸°å¯Œçš„å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°ç®¡ç†çº¿ç¨‹çš„åŒæ­¥ã€åä½œå’Œå¼‚æ­¥æ“ä½œã€‚&#x20;</p></blockquote>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„JUCåŸºç¡€é¢è¯•æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="JUC" scheme="https://outoflovenicoo.github.io/tags/JUC/"/>
    
  </entry>
  
  <entry>
    <title>SpringåŸºç¡€é¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-Spring%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-Spring%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-Springé¢è¯•é¢˜"><a href="#1-Springé¢è¯•é¢˜" class="headerlink" title="1.Springé¢è¯•é¢˜"></a>1.Springé¢è¯•é¢˜</h1><h2 id="ä¸€ã€Springæ¦‚è¿°"><a href="#ä¸€ã€Springæ¦‚è¿°" class="headerlink" title="ä¸€ã€Springæ¦‚è¿°"></a>ä¸€ã€Springæ¦‚è¿°</h2><h3 id="1-Springä¸­çš„è®¾è®¡æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ"><a href="#1-Springä¸­çš„è®¾è®¡æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="1. Springä¸­çš„è®¾è®¡æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ"></a>1. Springä¸­çš„è®¾è®¡æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ</h3><ul><li><p><strong>å·¥å‚æ¨¡å¼</strong>ï¼šSpringå®¹å™¨æœ¬è´¨æ˜¯å·¥å‚ï¼Œé€šè¿‡BeanFactoryã€ApplicationContextç­‰åˆ©ç”¨è¯¥æ¨¡å¼åˆ›å»ºbeanå¯¹è±¡ï¼Œå°†å¯¹è±¡åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ï¼Œä¾¿äºç®¡ç†å’Œç»´æŠ¤beanå®ä¾‹ã€‚</p></li><li><p><strong>ä»£ç†æ¨¡å¼</strong>ï¼šSpring AOPåŠŸèƒ½å€ŸåŠ©æ­¤æ¨¡å¼å®ç°ï¼Œåˆ†åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†ï¼Œç”¨äºåœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡ä»£ç çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¶æ·»åŠ é¢å¤–åŠŸèƒ½ï¼Œå¦‚æ—¥å¿—è®°å½•ã€äº‹åŠ¡ç®¡ç†ç­‰ã€‚</p></li><li><p><strong>å•ä¾‹æ¨¡å¼</strong>ï¼šSpringä¸­Beané»˜è®¤æ˜¯å•ä¾‹çš„ï¼Œå³æ•´ä¸ªåº”ç”¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œåˆ©äºå®¹å™¨å¯¹Beanç»Ÿä¸€ç®¡ç†ï¼Œå‡å°‘èµ„æºæ¶ˆè€—ã€‚</p></li><li><p><strong>æ¨¡æ¿æ¨¡å¼</strong>ï¼šåƒJdbcTemplateã€RestTemplateç­‰ä»¥Templateç»“å°¾çš„ç±»ï¼Œå®šä¹‰äº†æ“ä½œæ•°æ®åº“ã€ç½‘ç»œç­‰çš„é€šç”¨éª¨æ¶ï¼Œå…·ä½“å®ç°æ­¥éª¤ç”±å­ç±»å®Œæˆï¼Œæé«˜äº†ä»£ç å¤ç”¨æ€§ã€‚</p></li><li><p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>ï¼šSpringäº‹ä»¶é©±åŠ¨æ¨¡å‹æ˜¯å…¶ç»å…¸åº”ç”¨ï¼Œå­˜åœ¨äº‹ä»¶å‘å¸ƒè€…ã€äº‹ä»¶å’Œäº‹ä»¶ç›‘å¬å™¨ï¼Œå‘å¸ƒè€…å‘å¸ƒäº‹ä»¶ï¼Œç›‘å¬å™¨ç›‘å¬å¹¶åšå‡ºå“åº”ï¼Œå®ç°ç»„ä»¶é—´è§£è€¦ã€‚</p></li><li><p><strong>é€‚é…å™¨æ¨¡å¼</strong>ï¼šSpring AOPçš„å¢å¼ºæˆ–é€šçŸ¥ï¼ˆAdviceï¼‰ä½¿ç”¨è¯¥æ¨¡å¼ï¼Œåœ¨Spring MVCä¸­ä¹Ÿç”¨äºé€‚é…Controllerï¼Œè®©ä¸å…¼å®¹çš„æ¥å£ååŒå·¥ä½œã€‚</p></li><li><p><strong>ç­–ç•¥æ¨¡å¼</strong>ï¼šSpringçš„Resourceæ¥å£æœ‰ä¸åŒå®ç°ç±»ï¼Œæ ¹æ®ä¸åŒç­–ç•¥è®¿é—®èµ„æºï¼Œä¾¿äºåœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©ç®—æ³•æˆ–è¡Œä¸ºã€‚&#x20;</p></li></ul><h3 id="2-IOCçš„å®ç°åŸç†"><a href="#2-IOCçš„å®ç°åŸç†" class="headerlink" title="2.IOCçš„å®ç°åŸç†"></a>2.IOCçš„å®ç°åŸç†</h3><ol><li><p>æ‰«æå’Œè§£æé…ç½®æ–‡ä»¶æˆ–æ³¨è§£ä¿¡æ¯ï¼Œå°†å…¶è½¬æ¢ä¸ºå†…éƒ¨çš„å¯¹è±¡å®šä¹‰å’Œä¾èµ–å…³ç³»ï¼›</p></li><li><p>æ ¹æ®å¯¹è±¡å®šä¹‰å’Œä¾èµ–å…³ç³»ï¼Œä½¿ç”¨åå°„æœºåˆ¶åŠ¨æ€åˆ›å»ºå’Œåˆå§‹åŒ–å¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡æ³¨å…¥åˆ°éœ€è¦ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹ã€‚</p></li></ol><p>å…·ä½“æ¥è¯´ï¼ŒSpring IOCçš„å®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>è¯»å–é…ç½®æ–‡ä»¶æˆ–è§£ææ³¨è§£ä¿¡æ¯ï¼Œå°†å…¶è½¬æ¢ä¸ºå†…éƒ¨çš„å¯¹è±¡å®šä¹‰å’Œä¾èµ–å…³ç³»ã€‚åœ¨Springä¸­ï¼Œå¯ä»¥ä½¿ç”¨XMLæ–‡ä»¶æˆ–æ³¨è§£æ¥é…ç½®å¯¹è±¡å’Œä¾èµ–å…³ç³»ã€‚Springé€šè¿‡è§£æé…ç½®æ–‡ä»¶æˆ–æ³¨è§£ä¿¡æ¯ï¼Œå°†å…¶è½¬æ¢ä¸ºå†…éƒ¨çš„å¯¹è±¡å®šä¹‰å’Œä¾èµ–å…³ç³»ï¼ˆBeanDefinitionï¼‰æ”¾åˆ°å®¹å™¨ï¼ˆBeanFactoryï¼‰ä¸­ã€‚å¯¹è±¡å®šä¹‰åŒ…æ‹¬å¯¹è±¡çš„ç±»å‹ã€å±æ€§ã€æ„é€ å‡½æ•°ç­‰ä¿¡æ¯ï¼Œä¾èµ–å…³ç³»åŒ…æ‹¬å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€ä¾èµ–æ³¨å…¥æ–¹å¼ç­‰ä¿¡æ¯ã€‚</p></li><li><p>å®ä¾‹åŒ–beanå¯¹è±¡ï¼šSpringä¼šæ ¹æ®å¯¹è±¡å®šä¹‰çš„ç±»å‹å’Œæ„é€ å‡½æ•°ä¿¡æ¯ï¼Œä½¿ç”¨åå°„æœºåˆ¶æ¥åˆ›å»ºå¯¹è±¡ã€‚</p></li><li><p>è®¾ç½®å±æ€§ï¼šå®ä¾‹åŒ–åçš„ä»ç„¶æ˜¯ä¸€ä¸ªåŸç”Ÿçš„çŠ¶æ€ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚è¿™ä¸€æ­¥Springæ ¹æ®BeanDefinitionä¸­çš„ä¿¡æ¯è¿›è¡Œå±æ€§å¡«å……ï¼Œä¾èµ–æ³¨å…¥ã€‚</p></li><li><p>è°ƒç”¨Awareæ¥å£ï¼šSpringä¼šæ£€æµ‹è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº†xxxAwareæ¥å£ï¼Œå¦‚æœæœ‰ä¼šåœ¨è¿™é‡Œæ‰§è¡Œå®Œæˆã€‚Awareä¸»è¦æ˜¯èƒ½è·å–åˆ°Springå®¹å™¨ä¸­çš„ä¸€äº›èµ„æºï¼Œç„¶åå¯ä»¥ä¾›åç»­æ­¥éª¤ï¼Œä¾‹å¦‚åˆå§‹åŒ–é˜¶æ®µä½¿ç”¨ã€‚</p></li><li><p>BeanPostProcessorå‰ç½®å¤„ç†ï¼špostProcessBeforeInitializationæ–¹æ³•ã€‚ä¸Šè¿°å‡ ä¸ªæ­¥éª¤åï¼Œbeanå¯¹è±¡å·²ç»è¢«æ­£ç¡®æ„é€ ï¼Œä½†å¦‚æœæƒ³è¦å¯¹è±¡è¢«åˆå§‹åŒ–å‰å†è¿›è¡Œä¸€äº›è‡ªå®šä¹‰çš„å¤„ç†ï¼Œå°±å¯ä»¥é€šè¿‡BeanPostProcessoræ¥å£çš„è¯¥æ–¹æ³•æ¥å®ç°ã€‚</p></li><li><p>åˆå§‹åŒ–é˜¶æ®µï¼šè¯¥é˜¶æ®µSpringé¦–å…ˆä¼šçœ‹æ˜¯å¦å®ç°äº†InitializingBeanæ¥å£çš„afterPropertiesSetæ–¹æ³•ä»¥åŠæ˜¯å¦æœ‰è‡ªå®šä¹‰çš„init - methodç­‰ï¼Œå¦‚æœæœ‰ä¼šè¿›è¡Œè°ƒç”¨æ‰§è¡Œã€‚</p></li><li><p>BeanPostProcessoråç½®å¤„ç†ï¼špostProcessAfterInitializationæ–¹æ³•ã€‚å½“å‰æ­£åœ¨åˆå§‹åŒ–çš„beanå¯¹è±¡ä¼šè¢«ä¼ é€’è¿›æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™ä¸ªbeanä½œä»»ä½•å¤„ç†ï¼Œä¸å‰é¢å‰ç½®å¤„ç†ç›¸å¯¹çš„ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨InitializationBeanå®Œæˆåæ‰§è¡Œï¼Œå› æ­¤ä¸ºåç½®å¤„ç†ã€‚</p></li><li><p>beanåˆå§‹åŒ–å®Œæˆå¯ä»¥è¢«ä½¿ç”¨äº†ã€‚</p></li></ul><p>æ€»çš„æ¥è¯´ï¼ŒSpring IOCçš„å®ç°åŸç†æ˜¯é€šè¿‡åå°„æœºåˆ¶åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼Œä¾èµ–æ³¨å…¥ï¼Œå¯¹è±¡åˆå§‹åŒ–ã€‚é€šè¿‡è§£è€¦å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•ã€‚&#x20;</p><h3 id="3-IOCå’ŒDIæœ‰ä»€ä¹ˆå…³ç³»"><a href="#3-IOCå’ŒDIæœ‰ä»€ä¹ˆå…³ç³»" class="headerlink" title="3.IOCå’ŒDIæœ‰ä»€ä¹ˆå…³ç³»"></a>3.IOCå’ŒDIæœ‰ä»€ä¹ˆå…³ç³»</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image3.png" alt=""></p><h3 id="4-è°ˆè°ˆä½ å¯¹Springçš„ç†è§£"><a href="#4-è°ˆè°ˆä½ å¯¹Springçš„ç†è§£" class="headerlink" title="4. è°ˆè°ˆä½ å¯¹Springçš„ç†è§£"></a>4. è°ˆè°ˆä½ å¯¹Springçš„ç†è§£</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image4.png" alt=""></p><h3 id="5-Springæœ‰å“ªäº›ç¼ºç‚¹"><a href="#5-Springæœ‰å“ªäº›ç¼ºç‚¹" class="headerlink" title="5. Springæœ‰å“ªäº›ç¼ºç‚¹"></a>5. Springæœ‰å“ªäº›ç¼ºç‚¹</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image5.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image6.png" alt=""></p><h3 id="6-â­ï¸Spring-Iocå®¹å™¨çš„åŠ è½½è¿‡ç¨‹"><a href="#6-â­ï¸Spring-Iocå®¹å™¨çš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="6. â­ï¸Spring-Iocå®¹å™¨çš„åŠ è½½è¿‡ç¨‹"></a>6. â­ï¸Spring-Iocå®¹å™¨çš„åŠ è½½è¿‡ç¨‹</h3><p>Springçš„IOCå®¹å™¨å·¥ä½œçš„è¿‡ç¨‹ï¼Œå…¶å®å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šé…ç½®è§£æé˜¶æ®µå’ŒBeançš„åˆ›å»ºæ®µã€‚å…¶ä¸­ï¼š</p><ul><li><p>é…ç½®è§£æé˜¶æ®µä¸»è¦åšçš„å·¥ä½œæ˜¯åŠ è½½å’Œ<strong>è§£æé…ç½®æ–‡ä»¶</strong>ï¼Œå°†é…ç½®çš„beanè§£ææˆBeanDefinitionã€‚</p><ul><li><p>æ•´ä¸ªè¿‡ç¨‹æ˜¯ï¼š</p><ol><li><p>è¯»å–é…ç½®ï¼šé€šè¿‡BeanDefinitionReaderè¯»å–é…ç½®æ–‡ä»¶æˆ–é…ç½®ç±»ã€‚</p></li><li><p>è§£æé…ç½®ä¿¡æ¯ï¼šå¦‚ComponentScanã€Beané…ç½®ç­‰ã€‚</p></li><li><p>æ‰«æç±»æ³¨è§£ï¼šæ ¹æ®ComponentScanæ‰«æ@Componentã€@Beanã€@Configurationã€@Importç­‰æ³¨è§£â€¦</p></li><li><p>å°†ç¬¦åˆçš„beanæ³¨å†Œä¸ºBeanDefinitionã€‚</p></li></ol></li></ul></li><li><p>Beançš„åˆ›å»ºè¿‡ç¨‹ä¸»è¦åšçš„å·¥ä½œæ˜¯æ ¹æ®BeanDefinitionåˆ›å»ºBeanã€‚</p><ul><li><p><strong>å¤§æ¦‚è¿‡ç¨‹ï¼š</strong></p><ol><li><p>å®ä¾‹åŒ–Beanï¼šå®¹å™¨æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„Beanå®šä¹‰ï¼Œå®ä¾‹åŒ–Beanå¯¹è±¡ã€‚å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°å®ä¾‹åŒ–ã€å·¥å‚æ–¹æ³•å®ä¾‹åŒ–ã€é™æ€å·¥å‚æ–¹æ³•å®ä¾‹åŒ–ç­‰æ–¹å¼æ¥åˆ›å»ºBeanå¯¹è±¡ã€‚</p></li><li><p>æ³¨å…¥Beanå±æ€§ï¼šå®¹å™¨ä¼šä¸ºå®ä¾‹åŒ–çš„Beanå¯¹è±¡è®¾ç½®å±æ€§ï¼Œå¯ä»¥é€šè¿‡setteræ–¹æ³•æ³¨å…¥å±æ€§å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥å±æ€§å€¼ã€‚</p></li><li><p>å¤„ç†ä¾èµ–å…³ç³»ï¼šå®¹å™¨ä¼šå¤„ç†Beanä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå°†ä¾èµ–çš„Beanæ³¨å…¥åˆ°éœ€è¦çš„åœ°æ–¹ã€‚</p></li><li><p>æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ï¼šå®¹å™¨ä¼šè°ƒç”¨Beançš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å®ç°InitializingBeanæ¥å£æˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•æ¥å®šä¹‰Beançš„åˆå§‹åŒ–é€»è¾‘ã€‚</p></li><li><p>æ³¨å†ŒBeanï¼šå®¹å™¨ä¼šå°†å®ä¾‹åŒ–ã€å±æ€§è®¾ç½®å’Œåˆå§‹åŒ–å®Œæˆçš„Beanå¯¹è±¡æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œä»¥ä¾¿åç»­çš„ä½¿ç”¨å’Œç®¡ç†ã€‚</p></li><li><p>å®ŒæˆåŠ è½½ï¼šå®¹å™¨å®Œæˆæ‰€æœ‰Beançš„åŠ è½½å’Œåˆå§‹åŒ–åï¼Œå³å®Œæˆäº†IOCå®¹å™¨çš„åŠ è½½è¿‡ç¨‹ã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡å®¹å™¨è°ƒç”¨getBeanè·å–Beanå¯¹è±¡ã€‚&#x20;</p></li></ol></li></ul></li></ul><h2 id="äºŒã€Spring-Bean"><a href="#äºŒã€Spring-Bean" class="headerlink" title="äºŒã€Spring Bean"></a>äºŒã€Spring Bean</h2><h3 id="1-ä»€ä¹ˆæ˜¯Bean"><a href="#1-ä»€ä¹ˆæ˜¯Bean" class="headerlink" title="1.ä»€ä¹ˆæ˜¯Bean"></a>1.ä»€ä¹ˆæ˜¯Bean</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image8.png" alt=""></p><h3 id="2-â­ï¸Beanç”Ÿå‘½å‘¨æœŸ"><a href="#2-â­ï¸Beanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2.â­ï¸Beanç”Ÿå‘½å‘¨æœŸ"></a>2.â­ï¸Beanç”Ÿå‘½å‘¨æœŸ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image9.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image10.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image11.png" alt=""></p><h3 id="3-ä»€ä¹ˆæ˜¯FactoryBeanï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯FactoryBeanï¼Ÿ" class="headerlink" title="3. ä»€ä¹ˆæ˜¯FactoryBeanï¼Ÿ"></a>3. ä»€ä¹ˆæ˜¯FactoryBeanï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image12.png" alt=""></p><h3 id="4-â­ï¸BeanFactory-å’Œ-FactoryBeanåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-â­ï¸BeanFactory-å’Œ-FactoryBeanåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. â­ï¸BeanFactory å’Œ FactoryBeanåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. â­ï¸BeanFactory å’Œ FactoryBeanåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image13.png" alt=""></p><h3 id="5-â­ï¸BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5-â­ï¸BeanFactory-å’Œ-ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5.â­ï¸BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5.â­ï¸BeanFactory å’Œ ApplicationContextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image14.png" alt=""></p><h3 id="6-Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ"><a href="#6-Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="6. Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ"></a>6. Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image15.png" alt=""></p><hr><h3 id="7-â­ï¸Bean-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ"><a href="#7-â­ï¸Bean-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ" class="headerlink" title="7. â­ï¸Bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ"></a>7. â­ï¸Bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image16.png" alt=""></p><h3 id="8-å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-Spring-çš„-Bean-çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"><a href="#8-å°†ä¸€ä¸ªç±»å£°æ˜ä¸º-Spring-çš„-Bean-çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="8. å°†ä¸€ä¸ªç±»å£°æ˜ä¸º Spring çš„ Bean çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"></a>8. å°†ä¸€ä¸ªç±»å£°æ˜ä¸º Spring çš„ Bean çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image17.png" alt=""></p><h3 id="9-æ³¨å…¥Bean-çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"><a href="#9-æ³¨å…¥Bean-çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="9. æ³¨å…¥Bean çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"></a>9. æ³¨å…¥Bean çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image18.png" alt=""></p><hr><h3 id="10-Autowiredåº•å±‚çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#10-Autowiredåº•å±‚çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="10. @Autowiredåº•å±‚çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>10. @Autowiredåº•å±‚çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image19.png" alt=""></p><h3 id="11-â­ï¸AutoWired-ä¸-Resource-åŒºåˆ«"><a href="#11-â­ï¸AutoWired-ä¸-Resource-åŒºåˆ«" class="headerlink" title="11.â­ï¸AutoWired ä¸ Resource åŒºåˆ«"></a>11.â­ï¸AutoWired ä¸ Resource åŒºåˆ«</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image20.png" alt=""></p><h3 id="12-â“ä»€ä¹ˆæ˜¯ä¸‰çº§ç¼“å­˜ï¼Ÿ"><a href="#12-â“ä»€ä¹ˆæ˜¯ä¸‰çº§ç¼“å­˜ï¼Ÿ" class="headerlink" title="12. â“ä»€ä¹ˆæ˜¯ä¸‰çº§ç¼“å­˜ï¼Ÿ"></a>12. â“ä»€ä¹ˆæ˜¯ä¸‰çº§ç¼“å­˜ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image21.png" alt=""></p><hr><h3 id="13-â­ï¸-ä¸ºä»€ä¹ˆéœ€è¦ä¸‰çº§ç¼“å­˜ï¼Ÿ"><a href="#13-â­ï¸-ä¸ºä»€ä¹ˆéœ€è¦ä¸‰çº§ç¼“å­˜ï¼Ÿ" class="headerlink" title="13.â­ï¸ ä¸ºä»€ä¹ˆéœ€è¦ä¸‰çº§ç¼“å­˜ï¼Ÿ"></a>13.â­ï¸ ä¸ºä»€ä¹ˆéœ€è¦ä¸‰çº§ç¼“å­˜ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image22.png" alt=""></p><h3 id="14-â“Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ"><a href="#14-â“Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ" class="headerlink" title="14. â“Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ"></a>14. â“Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image23.png" alt=""></p><h3 id="15-â­ï¸Beanæœ‰å“ªå‡ ç§é…ç½®æ–¹å¼ï¼Ÿ"><a href="#15-â­ï¸Beanæœ‰å“ªå‡ ç§é…ç½®æ–¹å¼ï¼Ÿ" class="headerlink" title="15.â­ï¸Beanæœ‰å“ªå‡ ç§é…ç½®æ–¹å¼ï¼Ÿ"></a>15.â­ï¸Beanæœ‰å“ªå‡ ç§é…ç½®æ–¹å¼ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image24.png" alt=""></p><hr><h2 id="ä¸‰ã€Spring-AOP"><a href="#ä¸‰ã€Spring-AOP" class="headerlink" title="ä¸‰ã€Spring AOP"></a>ä¸‰ã€Spring AOP</h2><h3 id="1-â­ï¸ä»€ä¹ˆæ˜¯AOP"><a href="#1-â­ï¸ä»€ä¹ˆæ˜¯AOP" class="headerlink" title="1.â­ï¸ä»€ä¹ˆæ˜¯AOP?"></a>1.â­ï¸ä»€ä¹ˆæ˜¯AOP?</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image25.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image26.png" alt=""></p><hr><h3 id="2-è°ˆè°ˆä½ å¯¹AOPçš„ç†è§£"><a href="#2-è°ˆè°ˆä½ å¯¹AOPçš„ç†è§£" class="headerlink" title="2.è°ˆè°ˆä½ å¯¹AOPçš„ç†è§£"></a>2.è°ˆè°ˆä½ å¯¹AOPçš„ç†è§£</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image27.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image28.png" alt=""></p><h3 id="3-AOPæœ‰å“ªäº›å®ç°æ–¹å¼"><a href="#3-AOPæœ‰å“ªäº›å®ç°æ–¹å¼" class="headerlink" title="3.AOPæœ‰å“ªäº›å®ç°æ–¹å¼"></a>3.AOPæœ‰å“ªäº›å®ç°æ–¹å¼</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image29.png" alt=""></p><h3 id="4-â­ï¸Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#4-â­ï¸Spring-AOP-and-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="4. â­ï¸Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>4. â­ï¸Spring AOP and AspectJ AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image30.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image31.png" alt=""></p><h3 id="5-Spring-AOPé€šçŸ¥å’Œæ‰§è¡Œé¡ºåºï¼Ÿ"><a href="#5-Spring-AOPé€šçŸ¥å’Œæ‰§è¡Œé¡ºåºï¼Ÿ" class="headerlink" title="5. Spring-AOPé€šçŸ¥å’Œæ‰§è¡Œé¡ºåºï¼Ÿ"></a>5. Spring-AOPé€šçŸ¥å’Œæ‰§è¡Œé¡ºåºï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image32.png" alt=""></p><hr><h3 id="6-â­ï¸â­ï¸â­ï¸JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«"><a href="#6-â­ï¸â­ï¸â­ï¸JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«" class="headerlink" title="6.â­ï¸â­ï¸â­ï¸JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«"></a>6.â­ï¸â­ï¸â­ï¸JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„åŒºåˆ«</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image33.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image34.png" alt=""></p><h3 id="7-â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹AOPä¼šå¤±æ•ˆï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ"><a href="#7-â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹AOPä¼šå¤±æ•ˆï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ" class="headerlink" title="7. â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹AOPä¼šå¤±æ•ˆï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ"></a>7. â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹AOPä¼šå¤±æ•ˆï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image35.png" alt=""></p><hr><h2 id="å››ã€Springæ³¨è§£"><a href="#å››ã€Springæ³¨è§£" class="headerlink" title="å››ã€Springæ³¨è§£"></a>å››ã€Springæ³¨è§£</h2><h3 id="1-Configurationå’Œ-Componentæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#1-Configurationå’Œ-Componentæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="1. @Configurationå’Œ@Componentæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>1. @Configurationå’Œ@Componentæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image36.png" alt=""></p><h3 id="2-â­ï¸-Componentï¼Œ-Controllerï¼Œ-Repositoryï¼Œ-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ"><a href="#2-â­ï¸-Componentï¼Œ-Controllerï¼Œ-Repositoryï¼Œ-Service-æœ‰ä½•åŒºåˆ«ï¼Ÿ" class="headerlink" title="2. â­ï¸@Componentï¼Œ @Controllerï¼Œ @Repositoryï¼Œ @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ"></a>2. â­ï¸@Componentï¼Œ @Controllerï¼Œ @Repositoryï¼Œ @Service æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image37.png" alt=""></p><h3 id="3-â­ï¸-Component-å’Œ-Bean-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#3-â­ï¸-Component-å’Œ-Bean-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="3. â­ï¸@Component å’Œ @Bean æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>3. â­ï¸@Component å’Œ @Bean æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image38.png" alt=""></p><hr><h3 id="4-Required-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#4-Required-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="4. @Required æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>4. @Required æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image39.png" alt=""></p><h3 id="5-â­ï¸â­ï¸â­ï¸-Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#5-â­ï¸â­ï¸â­ï¸-Qualifier-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="5. â­ï¸â­ï¸â­ï¸@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>5. â­ï¸â­ï¸â­ï¸@Qualifier æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image40.png" alt=""></p><hr><h3 id="6-RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#6-RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="6. @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>6. @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image41.png" alt=""></p><h3 id="7-RequestMapping-å’Œ-GetMapping-æ³¨è§£çš„ä¸åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿ"><a href="#7-RequestMapping-å’Œ-GetMapping-æ³¨è§£çš„ä¸åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="7. @RequestMapping å’Œ @GetMapping æ³¨è§£çš„ä¸åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿ"></a>7. @RequestMapping å’Œ @GetMapping æ³¨è§£çš„ä¸åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image42.png" alt=""></p><h3 id="8-Controller-æ³¨è§£æœ‰ä»€ä¹ˆç”¨"><a href="#8-Controller-æ³¨è§£æœ‰ä»€ä¹ˆç”¨" class="headerlink" title="8. @Controller æ³¨è§£æœ‰ä»€ä¹ˆç”¨"></a>8. @Controller æ³¨è§£æœ‰ä»€ä¹ˆç”¨</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image43.png" alt=""></p><h3 id="9-â­ï¸-RestController-å’Œ-Controller-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#9-â­ï¸-RestController-å’Œ-Controller-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="9. â­ï¸@RestController å’Œ @Controller æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>9. â­ï¸@RestController å’Œ @Controller æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image44.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image45.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image46.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image47.png" alt=""></p><h3 id="10-â­ï¸-RequestParam-å’Œ-PathVariable-ä¸¤ä¸ªæ³¨è§£çš„åŒºåˆ«ï¼Ÿ"><a href="#10-â­ï¸-RequestParam-å’Œ-PathVariable-ä¸¤ä¸ªæ³¨è§£çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="10. â­ï¸@RequestParam å’Œ @PathVariable ä¸¤ä¸ªæ³¨è§£çš„åŒºåˆ«ï¼Ÿ"></a>10. â­ï¸@RequestParam å’Œ @PathVariable ä¸¤ä¸ªæ³¨è§£çš„åŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image48.png" alt=""></p><hr><h2 id="äº”ã€Springäº‹åŠ¡"><a href="#äº”ã€Springäº‹åŠ¡" class="headerlink" title="äº”ã€Springäº‹åŠ¡"></a>äº”ã€Springäº‹åŠ¡</h2><h3 id="1-â­ï¸è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ"><a href="#1-â­ï¸è¯´ä¸€ä¸‹-spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ" class="headerlink" title="1. â­ï¸è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ"></a>1. â­ï¸è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image49.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image50.png" alt=""></p><h3 id="2-â­ï¸-è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#2-â­ï¸-è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="2.â­ï¸ è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a>2.â­ï¸ è¯´ä¸€ä¸‹Springçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h3><p><a href="https://mp.weixin.qq.com/s/tRFoa76ElLFIrZRTwHIUMQ">https://mp.weixin.qq.com/s/tRFoa76ElLFIrZRTwHIUMQ</a></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image51.png" alt=""></p><hr><h3 id="3-â­ï¸Springäº‹ä»¶ç›‘å¬çš„æ ¸å¿ƒæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-â­ï¸Springäº‹ä»¶ç›‘å¬çš„æ ¸å¿ƒæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. â­ï¸Springäº‹ä»¶ç›‘å¬çš„æ ¸å¿ƒæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. â­ï¸Springäº‹ä»¶ç›‘å¬çš„æ ¸å¿ƒæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Springäº‹ä»¶ç›‘å¬çš„æ ¸å¿ƒæœºåˆ¶å›´ç»•è§‚å¯Ÿè€…æ¨¡å¼å±•å¼€ï¼š</p><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼šå®ƒå…è®¸ä¸€ä¸ªå¯¹è±¡ï¼ˆç§°ä¸ºä¸»é¢˜æˆ–è¢«è§‚å¯Ÿè€…ï¼‰ç»´æŠ¤ä¸€ç»„ä¾èµ–äºå®ƒçš„å¯¹è±¡ï¼ˆç§°ä¸ºè§‚å¯Ÿè€…ï¼‰ï¼Œå¹¶åœ¨ä¸»é¢˜çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥è§‚å¯Ÿè€…ã€‚</p><p>å®ƒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒï¼š</p><ol><li><p><strong>äº‹ä»¶ï¼š</strong>&#x4E8B;ä»¶æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„ä¸»é¢˜çŠ¶æ€å˜åŒ–çš„å…·ä½“è¡¨ç¤ºï¼Œå®ƒå°è£…äº†äº‹ä»¶å‘ç”Ÿæ—¶çš„ä¿¡æ¯ã€‚åœ¨Springä¸­ï¼Œäº‹ä»¶é€šå¸¸æ˜¯æ™®é€šçš„Javaå¯¹è±¡ï¼Œç”¨äºä¼ é€’æ•°æ®æˆ–ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p></li><li><p><strong>äº‹ä»¶å‘å¸ƒè€…ï¼š</strong>&#x5728;Springä¸­ï¼Œäº‹ä»¶å‘å¸ƒè€…å……å½“ä¸»é¢˜çš„è§’è‰²ï¼Œè´Ÿè´£è§¦å‘å¹¶å‘å¸ƒäº‹ä»¶ã€‚å®ƒé€šå¸¸å®ç°äº†ApplicationEventPublisheræ¥å£æˆ–ä½¿ç”¨æ³¨è§£@Autowiredæ¥è·å¾—äº‹ä»¶å‘å¸ƒåŠŸèƒ½ã€‚</p></li><li><p><strong>äº‹ä»¶ç›‘å¬å™¨</strong>ï¼šäº‹ä»¶ç›‘å¬å™¨å……å½“è§‚å¯Ÿè€…çš„è§’è‰²ï¼Œè´Ÿè´£ç›‘å¬å¹¶å“åº”äº‹ä»¶çš„å‘ç”Ÿã€‚å®ƒå®ç°äº†ApplicationListeneræ¥å£ï¼Œé€šè¿‡onApplicationEvent()æ–¹æ³•æ¥å¤„ç†äº‹ä»¶ã€‚</p></li></ol><p>æ€»ä¹‹ï¼ŒSpringäº‹ä»¶ç›‘å¬æœºåˆ¶çš„æ ¸å¿ƒæœºåˆ¶æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œé€šè¿‡äº‹ä»¶ã€äº‹ä»¶å‘å¸ƒè€…å’Œäº‹ä»¶ç›‘å¬å™¨çš„åä½œï¼Œå®ç°äº†æ¾è€¦åˆçš„ç»„ä»¶é€šä¿¡ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»å’Œå¯ç»´æŠ¤ã€‚&#x20;</p><h3 id="4-â­ï¸Springäº‹åŠ¡çš„å¤±æ•ˆåŸå› ï¼Ÿ"><a href="#4-â­ï¸Springäº‹åŠ¡çš„å¤±æ•ˆåŸå› ï¼Ÿ" class="headerlink" title="4. â­ï¸Springäº‹åŠ¡çš„å¤±æ•ˆåŸå› ï¼Ÿ"></a>4. â­ï¸Springäº‹åŠ¡çš„å¤±æ•ˆåŸå› ï¼Ÿ</h3><ol><li><p><strong>è‡ªèº«è°ƒç”¨é—®é¢˜ï¼š</strong>&#x73;pringæ˜¯é€šè¿‡aopçš„æ–¹å¼ï¼Œå¯¹éœ€è¦springç®¡ç†äº‹åŠ¡çš„beanç”Ÿæˆäº†ä»£ç†å¯¹è±¡ï¼Œç„¶åé€šè¿‡ä»£ç†å¯¹è±¡æ‹¦æˆªäº†ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œï¼Œåœ¨æ–¹æ³•å‰åæ·»åŠ äº†äº‹åŠ¡çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¿…é¡»é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„æ—¶å€™ï¼Œäº‹åŠ¡æ‰ä¼šèµ·æ•ˆã€‚</p></li><li><p><strong>épublicæ–¹æ³•å¯¼è‡´çš„äº‹åŠ¡æ—¶æ•ˆï¼š</strong>&#x5F53;äº‹åŠ¡æ–¹æ³•è¢«æ ‡è®°ä¸ºépublicæ—¶ï¼ŒSpringçš„äº‹åŠ¡ä»£ç†é€šå¸¸æ˜¯é€šè¿‡JavaåŠ¨æ€ä»£ç†æˆ–CGLIBåŠ¨æ€ä»£ç†ç”Ÿæˆçš„ï¼Œè¿™äº›ä»£ç†è¦æ±‚ç›®æ ‡æ–¹æ³•æ˜¯å…¬å¼€å¯è®¿é—®çš„publicã€‚</p></li><li><p><strong>æ–¹æ³•æœ¬èº«è‡ªå·±æ•æ‰äº†å¼‚å¸¸</strong>ï¼Œè¿™æ ·å³ä½¿å‡ºç°å¼‚å¸¸ä¹Ÿä¸ä¼šè§¦å‘äº‹åŠ¡çš„å›æ»šï¼Œæ‰€ä»¥è¦è¿›è¡ŒæŠ›å‡ºï¼Œè€Œä¸æ˜¯è‡ªå·±æ•æ‰ã€‚</p></li><li><p>é€ æˆäº‹åŠ¡å›æ»šçš„å¼‚å¸¸ä¸€èˆ¬æ˜¯<strong>Errorç±»å¼‚å¸¸æˆ–è€…æ˜¯è¿è¡Œæ—¶å¼‚å¸¸</strong>ï¼Œå¦‚æœæŠ›å‡ºçš„æ˜¯æ£€æŸ¥å‹å¼‚å¸¸çš„è¯ï¼Œé‚£ä¹ˆä¸ä¼šé€ æˆäº‹åŠ¡å›æ»šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†rollbackforé…ç½®ä¸ºExceptionã€‚</p></li><li><p>å¼€å¯äº‹åŠ¡çš„bean<strong>æ²¡æœ‰äº¤ç»™springå®¹å™¨ç®¡ç†</strong>ã€‚</p></li><li><p><strong>æ•°æ®åº“ä¸æ”¯æŒäº‹åŠ¡ã€‚&#x20;</strong></p></li></ol><h3 id="5-Spring-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"><a href="#5-Spring-äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="5. Spring äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"></a>5. Spring äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image54.png" alt=""></p><h3 id="6-å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ"><a href="#6-å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ" class="headerlink" title="6. å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ"></a>6. å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image55.png" alt=""></p><h3 id="7-â­ï¸-protected-å’Œ-private-åŠ äº‹åŠ¡ä¼šç”Ÿæ•ˆå—ï¼Ÿ"><a href="#7-â­ï¸-protected-å’Œ-private-åŠ äº‹åŠ¡ä¼šç”Ÿæ•ˆå—ï¼Ÿ" class="headerlink" title="7.â­ï¸ protected å’Œ private åŠ äº‹åŠ¡ä¼šç”Ÿæ•ˆå—ï¼Ÿ"></a>7.â­ï¸ protected å’Œ private åŠ äº‹åŠ¡ä¼šç”Ÿæ•ˆå—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image56.png" alt=""></p><h3 id="8-Spring-å£°æ˜å¼äº‹åŠ¡æ— æ•ˆå¯èƒ½çš„åŸå› æœ‰å“ªäº›ï¼Ÿ"><a href="#8-Spring-å£°æ˜å¼äº‹åŠ¡æ— æ•ˆå¯èƒ½çš„åŸå› æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="8. Spring å£°æ˜å¼äº‹åŠ¡æ— æ•ˆå¯èƒ½çš„åŸå› æœ‰å“ªäº›ï¼Ÿ"></a>8. Spring å£°æ˜å¼äº‹åŠ¡æ— æ•ˆå¯èƒ½çš„åŸå› æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image57.png" alt=""></p><hr><h2 id="å…­ã€Spring-MVC"><a href="#å…­ã€Spring-MVC" class="headerlink" title="å…­ã€Spring MVC"></a>å…­ã€Spring MVC</h2><h3 id="1-MVCæ˜¯ä»€ä¹ˆï¼ŸMVCè®¾è®¡æ¨¡å¼çš„å¥½å¤„æœ‰å“ªäº›"><a href="#1-MVCæ˜¯ä»€ä¹ˆï¼ŸMVCè®¾è®¡æ¨¡å¼çš„å¥½å¤„æœ‰å“ªäº›" class="headerlink" title="1. MVCæ˜¯ä»€ä¹ˆï¼ŸMVCè®¾è®¡æ¨¡å¼çš„å¥½å¤„æœ‰å“ªäº›"></a>1. MVCæ˜¯ä»€ä¹ˆï¼ŸMVCè®¾è®¡æ¨¡å¼çš„å¥½å¤„æœ‰å“ªäº›</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image58.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image59.png" alt=""></p><hr><h3 id="2-SpringMVCæœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ"><a href="#2-SpringMVCæœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ" class="headerlink" title="2. SpringMVCæœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ"></a>2. SpringMVCæœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image60.png" alt=""></p><h3 id="3-â­ï¸SpringMVCçš„æ‰§è¡Œæµç¨‹äº†è§£å—ï¼Ÿ"><a href="#3-â­ï¸SpringMVCçš„æ‰§è¡Œæµç¨‹äº†è§£å—ï¼Ÿ" class="headerlink" title="3. â­ï¸SpringMVCçš„æ‰§è¡Œæµç¨‹äº†è§£å—ï¼Ÿ"></a>3. â­ï¸SpringMVCçš„æ‰§è¡Œæµç¨‹äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image61.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image62.png" alt=""></p><h3 id="4-Spring-MVC-æ‹¦æˆªå™¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-Spring-MVC-æ‹¦æˆªå™¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. Spring MVC æ‹¦æˆªå™¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. Spring MVC æ‹¦æˆªå™¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image63.png" alt=""></p><h3 id="5-æ‹¦æˆªå™¨çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"><a href="#5-æ‹¦æˆªå™¨çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="5. æ‹¦æˆªå™¨çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"></a>5. æ‹¦æˆªå™¨çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image64.png" alt=""></p><hr><h3 id="6-â­ï¸å¦‚ä½•å®ç°è¿‡æ»¤å™¨ï¼Ÿ"><a href="#6-â­ï¸å¦‚ä½•å®ç°è¿‡æ»¤å™¨ï¼Ÿ" class="headerlink" title="6. â­ï¸å¦‚ä½•å®ç°è¿‡æ»¤å™¨ï¼Ÿ"></a>6. â­ï¸å¦‚ä½•å®ç°è¿‡æ»¤å™¨ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image65.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image66.png" alt=""></p><hr><h3 id="7-â­ï¸SpringMVCçš„æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ‰§è¡Œé¡ºåºï¼Ÿ"><a href="#7-â­ï¸SpringMVCçš„æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ‰§è¡Œé¡ºåºï¼Ÿ" class="headerlink" title="7. â­ï¸SpringMVCçš„æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ‰§è¡Œé¡ºåºï¼Ÿ"></a>7. â­ï¸SpringMVCçš„æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ‰§è¡Œé¡ºåºï¼Ÿ</h3><p>æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹5ç‚¹ï¼š</p><ol><li><p>å‡ºèº«ä¸åŒï¼šè¿‡æ»¤å™¨æ¥è‡ªäºServletï¼Œè€Œæ‹¦æˆªå™¨æ¥è‡ªäºSpringæ¡†æ¶ï¼›</p></li><li><p>è§¦å‘æ—¶æœºä¸åŒï¼šè¯·æ±‚çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼šè¯·æ±‚è¿›å…¥å®¹å™¨ &gt; è¿›å…¥è¿‡æ»¤å™¨ &gt; è¿›å…¥Servlet &gt; è¿›å…¥æ‹¦æˆªå™¨ &gt; æ‰§è¡Œæ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€‚æ‰€ä»¥è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„æ‰§è¡Œæ—¶æœºï¼Œæ˜¯è¿‡æ»¤å™¨å…ˆæ‰§è¡Œï¼Œç„¶åæ‰ä¼šæ‰§è¡Œæ‹¦æˆªå™¨ï¼Œæœ€åæ‰ä¼šè¿›å…¥çœŸæ­£è¦è°ƒç”¨çš„æ–¹æ³•ï¼›</p></li><li><p>åº•å±‚å®ç°ä¸åŒï¼šè¿‡æ»¤å™¨æ˜¯åŸºäºæ–¹æ³•å›è°ƒå®ç°çš„ï¼Œæ‹¦æˆªå™¨æ˜¯åŸºäºåŠ¨æ€ä»£ç†ï¼ˆåº•å±‚æ˜¯åå°„ï¼‰å®ç°çš„ï¼›</p></li><li><p>æ”¯æŒçš„é¡¹ç›®ç±»å‹ä¸åŒï¼šè¿‡æ»¤å™¨æ˜¯Servletè§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ‰€ä»¥è¿‡æ»¤å™¨è¦ä¾èµ–Servletå®¹å™¨ï¼Œå®ƒåªèƒ½ç”¨åœ¨Webé¡¹ç›®ä¸­ï¼›è€Œæ‹¦æˆªå™¨æ˜¯Springä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå› æ­¤æ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨åœ¨Webé¡¹ç›®ä¸­ï¼ŒåŒæ—¶è¿˜å¯ä»¥ç”¨åœ¨Applicationæˆ–Swingç¨‹åºä¸­ï¼›&#x20;</p></li><li><p>ä½¿ç”¨çš„åœºæ™¯ä¸åŒï¼šå› ä¸ºæ‹¦æˆªå™¨æ›´æ¥è¿‘ä¸šåŠ¡ç³»ç»Ÿï¼Œæ‰€ä»¥æ‹¦æˆªå™¨ä¸»è¦ç”¨æ¥å®ç°é¡¹ç›®ä¸­çš„ä¸šåŠ¡åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼šç™»å½•åˆ¤æ–­ã€æƒé™åˆ¤æ–­ã€æ—¥å¿—è®°å½•ç­‰ä¸šåŠ¡ï¼›è€Œè¿‡æ»¤å™¨é€šå¸¸æ˜¯ç”¨æ¥å®ç°é€šç”¨åŠŸèƒ½è¿‡æ»¤çš„ï¼Œæ¯”å¦‚ï¼šæ•æ„Ÿè¯è¿‡æ»¤ã€å­—ç¬¦é›†ç¼–ç è®¾ç½®ã€å“åº”æ•°æ®å‹ç¼©ç­‰åŠŸèƒ½ ã€‚&#x20;</p></li></ol><h3 id="8-â­ï¸Spring-MVCå¼‚å¸¸å¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#8-â­ï¸Spring-MVCå¼‚å¸¸å¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="8. â­ï¸Spring MVCå¼‚å¸¸å¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>8. â­ï¸Spring MVCå¼‚å¸¸å¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image68.png" alt=""></p><hr><h1 id="2-SpringBooté¢è¯•é¢˜"><a href="#2-SpringBooté¢è¯•é¢˜" class="headerlink" title="2.SpringBooté¢è¯•é¢˜"></a>2.SpringBooté¢è¯•é¢˜</h1><h3 id="1-SpringBootå¯ä»¥åŒæ—¶å¤„ç†å¤šå°‘è¯·æ±‚"><a href="#1-SpringBootå¯ä»¥åŒæ—¶å¤„ç†å¤šå°‘è¯·æ±‚" class="headerlink" title="1. SpringBootå¯ä»¥åŒæ—¶å¤„ç†å¤šå°‘è¯·æ±‚"></a>1. SpringBootå¯ä»¥åŒæ—¶å¤„ç†å¤šå°‘è¯·æ±‚</h3><p>SpringBooté»˜è®¤çš„å†…åµŒå®¹å™¨æ˜¯Tomcatï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç¨‹åºå®é™…ä¸Šæ˜¯è¿è¡Œåœ¨Tomcaté‡Œçš„ã€‚æ‰€ä»¥ä¸å…¶è¯´SpringBootå¯ä»¥å¤„ç†å¤šå°‘è¯·æ±‚ï¼Œåˆ°ä¸å¦‚è¯´Tomcatå¯ä»¥å¤„ç†å¤šå°‘è¯·æ±‚ã€‚</p><p>åœ¨SpringBootä¸­å¤„ç†è¯·æ±‚æ•°é‡ç›¸å…³çš„å‚æ•°æœ‰å››ä¸ªï¼š</p><ul><li><p>server.tomcat.threads.min - spareï¼šæœ€å°‘çš„å·¥ä½œçº¿ç¨‹æ•°ï¼Œé»˜è®¤å¤§å°æ˜¯10ã€‚è¯¥å‚æ•°ç›¸å½“äºé•¿æœŸå·¥ï¼Œå¦‚æœå¹¶å‘è¯·æ±‚çš„æ•°é‡è¾¾åˆ°ä¸åˆ°10ï¼Œå°±ä¼šä¾æ¬¡ä½¿ç”¨è¿™å‡ ä¸ªçº¿ç¨‹å»å¤„ç†è¯·æ±‚ã€‚</p></li><li><p>server.tomcat.threads.maxï¼šæœ€å¤šçš„å·¥ä½œçº¿ç¨‹æ•°ï¼Œé»˜è®¤å¤§å°æ˜¯200ã€‚è¯¥å‚æ•°ç›¸å½“äºä¸´æ—¶å·¥ï¼Œå¦‚æœå¹¶å‘è¯·æ±‚çš„æ•°é‡åœ¨10åˆ°200ä¹‹é—´ï¼Œå°±ä¼šä½¿ç”¨è¿™äº›ä¸´æ—¶å·¥çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p></li><li><p>server.tomcat.max - connectionsï¼šæœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤å¤§å°æ˜¯8192ã€‚è¡¨ç¤ºTomcatå¯ä»¥å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°é‡ï¼Œè¶…è¿‡8192çš„è¯·æ±‚å°±ä¼šè¢«æ”¾å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ã€‚</p></li><li><p>server.tomcat.accept - countï¼šç­‰å¾…é˜Ÿåˆ—çš„é•¿åº¦ï¼Œé»˜è®¤å¤§å°æ˜¯100ã€‚</p></li></ul><p>å¦‚æœæŠŠTomcatæ¯”ä½œä¸€å®¶é¥­åº—çš„è¯ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯·æ±‚å…¶å®å°±ç›¸å½“äºä¸€ä½å®¢äººã€‚min - spareå°±æ˜¯å¨å¸ˆ(é•¿æœŸå·¥)ï¼›maxæ˜¯å¨å¸ˆæ€»æ•°(é•¿æœŸå·¥+ä¸´æ—¶å·¥)ï¼›max - connectionså°±æ˜¯é¥­åº—é‡Œçš„åº§ä½æ•°é‡ï¼›accept - countæ˜¯é—¨å£å°æ¿å‡³çš„æ•°é‡ã€‚æ¥çš„å®¢äººä¼˜å…ˆååˆ°é¥­åº—é‡Œé¢ï¼Œç„¶åå¨å¸ˆå¼€å§‹å¿™æ´»ï¼Œå¦‚æœé•¿æœŸå·¥å¯ä»¥å¹²çš„ï¼Œå°±è®©é•¿æœŸå·¥å¹²ï¼Œå¦‚æœé•¿æœŸå·¥å¹²ä¸å®Œï¼Œå°±å†è®©ä¸´æ—¶å·¥å¹²ã€‚å›¾ä¸­çš„å¨å¸ˆä¸€å…±15äººï¼Œé¥­åº—é‡Œæœ‰30ä¸ªåº§ä½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç°åœ¨æ¥äº†20ä¸ªå®¢äººï¼Œé‚£ä¹ˆå°±ä¼šæœ‰5ä¸ªäººå…ˆåœ¨é¥­åº—é‡Œç­‰ç€ã€‚å¦‚æœç°åœ¨æ¥äº†35ä¸ªäººï¼Œé¥­åº—é‡Œåä¸ä¸‹ï¼Œå°±ä¼šè®©5ä¸ªäººå…ˆåˆ°é—¨å£åä¸€ä¸‹ã€‚å¦‚æœæ¥äº†50ä¸ªäººï¼Œé‚£ä¹ˆé¥­åº—åº§ä½+é—¨å£å°æ¿å‡³ä¸€å…±40ä¸ªï¼Œæ‰€ä»¥å°±ä¼šæœ‰10äººç¦»å¼€ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒSpringBootåŒæ—¶æ‰€èƒ½å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°é‡æ˜¯max - connections+accept - countï¼Œè¶…è¿‡è¯¥æ•°é‡çš„è¯·æ±‚ç›´æ¥å°±ä¼šè¢«ä¸¢æ‰ã€‚&#x20;</p><h3 id="2-â“SpringBootå¯åŠ¨åŸç†"><a href="#2-â“SpringBootå¯åŠ¨åŸç†" class="headerlink" title="2.â“SpringBootå¯åŠ¨åŸç†"></a>2.â“SpringBootå¯åŠ¨åŸç†</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image70.jpeg" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image71.png" alt=""></p><hr><h3 id="3-â­ï¸ä¸ºä»€ä¹ˆSpringBootçš„jarå¯ä»¥ç›´æ¥è¿è¡Œï¼Ÿ"><a href="#3-â­ï¸ä¸ºä»€ä¹ˆSpringBootçš„jarå¯ä»¥ç›´æ¥è¿è¡Œï¼Ÿ" class="headerlink" title="3. â­ï¸ä¸ºä»€ä¹ˆSpringBootçš„jarå¯ä»¥ç›´æ¥è¿è¡Œï¼Ÿ"></a>3. â­ï¸ä¸ºä»€ä¹ˆSpringBootçš„jarå¯ä»¥ç›´æ¥è¿è¡Œï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image72.png" alt=""></p><h3 id="4-â­ï¸Spring-Bootä¸ºä»€ä¹ˆé»˜è®¤ä½¿ç”¨CGLIB"><a href="#4-â­ï¸Spring-Bootä¸ºä»€ä¹ˆé»˜è®¤ä½¿ç”¨CGLIB" class="headerlink" title="4. â­ï¸Spring Bootä¸ºä»€ä¹ˆé»˜è®¤ä½¿ç”¨CGLIB"></a>4. â­ï¸Spring Bootä¸ºä»€ä¹ˆé»˜è®¤ä½¿ç”¨CGLIB</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image73.png" alt=""></p><h3 id="5-â­ï¸Springä¸Spring-Bootçš„åŒºåˆ«ï¼Ÿ"><a href="#5-â­ï¸Springä¸Spring-Bootçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="5. â­ï¸Springä¸Spring Bootçš„åŒºåˆ«ï¼Ÿ"></a>5. â­ï¸Springä¸Spring Bootçš„åŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image74.png" alt=""></p><hr><h3 id="6-â­ï¸Springã€-Spring-MVCå’ŒSpringBootæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#6-â­ï¸Springã€-Spring-MVCå’ŒSpringBootæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="6. â­ï¸Springã€ Spring MVCå’ŒSpringBootæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>6. â­ï¸Springã€ Spring MVCå’ŒSpringBootæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image75.png" alt=""></p><h3 id="7-é¡¹ç›®æ€ä¹ˆç”¨SpringBootçš„ï¼Ÿ"><a href="#7-é¡¹ç›®æ€ä¹ˆç”¨SpringBootçš„ï¼Ÿ" class="headerlink" title="7. é¡¹ç›®æ€ä¹ˆç”¨SpringBootçš„ï¼Ÿ"></a>7. é¡¹ç›®æ€ä¹ˆç”¨SpringBootçš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image76.png" alt=""></p><h3 id="8-è¿è¡Œ-Spring-Boot-æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"><a href="#8-è¿è¡Œ-Spring-Boot-æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ" class="headerlink" title="8. è¿è¡Œ Spring Boot æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"></a>8. è¿è¡Œ Spring Boot æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image77.png" alt=""></p><hr><h3 id="9-â­ï¸-Spring-Boot-è‡ªåŠ¨è£…é…æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#9-â­ï¸-Spring-Boot-è‡ªåŠ¨è£…é…æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="9.â­ï¸ Spring Boot è‡ªåŠ¨è£…é…æ˜¯ä»€ä¹ˆï¼Ÿ"></a>9.â­ï¸ Spring Boot è‡ªåŠ¨è£…é…æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image78.png" alt=""></p><h3 id="10-â­ï¸SpringBoot-è‡ªåŠ¨åŒ–é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#10-â­ï¸SpringBoot-è‡ªåŠ¨åŒ–é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="10. â­ï¸SpringBoot è‡ªåŠ¨åŒ–é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>10. â­ï¸SpringBoot è‡ªåŠ¨åŒ–é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image79.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image80.png" alt=""></p><h3 id="11-â­ï¸Spring-Boot-æœ‰å‡ ç§æ–¹å¼è¯»å–é…ç½®æ–‡ä»¶ï¼Ÿ"><a href="#11-â­ï¸Spring-Boot-æœ‰å‡ ç§æ–¹å¼è¯»å–é…ç½®æ–‡ä»¶ï¼Ÿ" class="headerlink" title="11. â­ï¸Spring Boot æœ‰å‡ ç§æ–¹å¼è¯»å–é…ç½®æ–‡ä»¶ï¼Ÿ"></a>11. â­ï¸Spring Boot æœ‰å‡ ç§æ–¹å¼è¯»å–é…ç½®æ–‡ä»¶ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image81.png" alt=""></p><h3 id="12-Spring-Boot-é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºï¼Ÿ"><a href="#12-Spring-Boot-é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºï¼Ÿ" class="headerlink" title="12. Spring Boot é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºï¼Ÿ"></a>12. Spring Boot é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image82.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image83.png" alt=""></p><hr><h3 id="13-â­ï¸bootstrap-properties-å’Œ-application-ï¼Œproperties-æœ‰ä½•åŒºåˆ«ï¼Ÿ"><a href="#13-â­ï¸bootstrap-properties-å’Œ-application-ï¼Œproperties-æœ‰ä½•åŒºåˆ«ï¼Ÿ" class="headerlink" title="13. â­ï¸bootstrap.properties å’Œ application.ï¼Œproperties æœ‰ä½•åŒºåˆ«ï¼Ÿ"></a>13. â­ï¸bootstrap.properties å’Œ application.ï¼Œproperties æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image84.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image85.png" alt=""></p><h3 id="14-Spring-Boot-Actuatoræ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#14-Spring-Boot-Actuatoræ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="14. Spring Boot Actuatoræ˜¯ä»€ä¹ˆï¼Ÿ"></a>14. Spring Boot Actuatoræ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>Spring Boot Actuator</strong>æ˜¯Spring Bootæä¾›çš„ä¸€ä¸ªç”¨äº<strong>ç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åº</strong>çš„æ¨¡å—ã€‚åŒ…æ‹¬ä¸é™äºå¥åº·æ£€æŸ¥ã€æ—¥å¿—ç›‘æ§ã€æŒ‡æ ‡æ”¶é›†ã€å®¡è®¡åŠŸèƒ½ã€æŠ¥è­¦åŠŸèƒ½ç­‰ã€‚å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡è¿™äº›ç›‘æ§åŠæ—¶å‘ç°é—®é¢˜å¹¶è§£å†³ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot Actuatorå·²ç»é›†æˆåœ¨Spring Bootä¸­ï¼Œåªéœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¾èµ–å¹¶é…ç½®ä¸€äº›å‚æ•°å³å¯ä½¿ç”¨ã€‚&#x20;</p><h3 id="15-Spring-Boot-é¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ"><a href="#15-Spring-Boot-é¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ" class="headerlink" title="15. Spring Boot é¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ"></a>15. Spring Boot é¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image87.png" alt=""></p><h3 id="16-â­ï¸Spring-Boot-ä¸­çš„-starter-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#16-â­ï¸Spring-Boot-ä¸­çš„-starter-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="16. â­ï¸Spring Boot ä¸­çš„ starter æ˜¯ä»€ä¹ˆï¼Ÿ"></a>16. â­ï¸Spring Boot ä¸­çš„ starter æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image88.png" alt=""></p><h3 id="17-Spring-Boot-æœ‰å“ªäº›-starter-ï¼Ÿ"><a href="#17-Spring-Boot-æœ‰å“ªäº›-starter-ï¼Ÿ" class="headerlink" title="17. Spring Boot æœ‰å“ªäº› starter ï¼Ÿ"></a>17. Spring Boot æœ‰å“ªäº› starter ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image89.png" alt=""></p><h3 id="18-Spring-Boot-æ‰“åŒ…æˆçš„jar-å’Œæ™®é€šçš„jar-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#18-Spring-Boot-æ‰“åŒ…æˆçš„jar-å’Œæ™®é€šçš„jar-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="18. Spring Boot æ‰“åŒ…æˆçš„jar å’Œæ™®é€šçš„jar æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>18. Spring Boot æ‰“åŒ…æˆçš„jar å’Œæ™®é€šçš„jar æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>Spring  bootæ‰“åŒ…æˆçš„jaråŒ…å¯æ‰§è¡Œä½†æ˜¯ä¸èƒ½å¼•ç”¨ã€‚</p><p><strong>SpringBootå¦‚ä½•å®ç°æ‰“åŒ…</strong></p><ul><li><p>è¿›å…¥é¡¹ç›®ç›®å½•åœ¨æ§åˆ¶å°è¾“å…¥mvn clean packageï¼Œcleanæ˜¯æ¸…ç©ºå·²å­˜åœ¨çš„é¡¹ç›®åŒ…ï¼Œpackageè¿›è¡Œæ‰“åŒ…ã€‚</p></li><li><p>æˆ–è€…ç‚¹å‡»å·¦è¾¹é€‰é¡¹æ ä¸­çš„Mavenï¼Œå…ˆç‚¹å‡»cleanå†ç‚¹å‡»packageã€‚&#x20;</p></li></ul><p>Spring Booté¡¹ç›®æœ€ç»ˆæ‰“åŒ…æˆçš„jaræ˜¯å¯æ‰§è¡Œjarï¼Œè¿™ç§jarå¯ä»¥ç›´æ¥é€šè¿‡java -jar xxx.jarå‘½ä»¤æ¥è¿è¡Œï¼Œè¿™ç§jarä¸å¯ä»¥ä½œä¸ºæ™®é€šçš„jarè¢«å…¶ä»–é¡¹ç›®ä¾èµ–ï¼Œå³ä½¿ä¾èµ–äº†ä¹Ÿæ— æ³•ä½¿ç”¨å…¶ä¸­çš„ç±»ã€‚</p><p>Spring Bootçš„jaræ— æ³•è¢«å…¶ä»–é¡¹ç›®ä¾èµ–ï¼Œä¸»è¦è¿˜æ˜¯ä»–å’Œæ™®é€šjarçš„ç»“æ„ä¸åŒã€‚æ™®é€šçš„jaråŒ…ï¼Œè§£å‹åç›´æ¥å°±æ˜¯åŒ…åï¼ŒåŒ…é‡Œå°±æ˜¯æˆ‘ä»¬çš„ä»£ç ï¼Œè€ŒSpring Bootæ‰“åŒ…æˆçš„å¯æ‰§è¡Œjarè§£å‹åï¼Œåœ¨\BOOT - INF\classesç›®å½•ä¸‹æ‰æ˜¯æˆ‘ä»¬çš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¢«ç›´æ¥å¼•ç”¨ã€‚å¦‚æœéè¦å¼•ç”¨ï¼Œå¯ä»¥åœ¨pom.xmlæ–‡ä»¶ä¸­å¢åŠ é…ç½®ï¼Œå°†Spring Booté¡¹ç›®æ‰“åŒ…æˆä¸¤ä¸ªjarï¼Œä¸€ä¸ªå¯æ‰§è¡Œï¼Œä¸€ä¸ªå¯å¼•ç”¨ã€‚&#x20;</p><hr><h3 id="19-â­ï¸-SpringBoot-çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ"><a href="#19-â­ï¸-SpringBoot-çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ" class="headerlink" title="19.â­ï¸ SpringBoot çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ"></a>19.â­ï¸ SpringBoot çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image92.png" alt=""></p><h3 id="20-SpringBootäº‹åŠ¡çš„ä½¿ç”¨"><a href="#20-SpringBootäº‹åŠ¡çš„ä½¿ç”¨" class="headerlink" title="20. SpringBootäº‹åŠ¡çš„ä½¿ç”¨"></a>20. SpringBootäº‹åŠ¡çš„ä½¿ç”¨</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image93.png" alt=""></p><h3 id="21-â­ï¸ä»€ä¹ˆæ˜¯-JavaConfigï¼Ÿ"><a href="#21-â­ï¸ä»€ä¹ˆæ˜¯-JavaConfigï¼Ÿ" class="headerlink" title="21. â­ï¸ä»€ä¹ˆæ˜¯ JavaConfigï¼Ÿ"></a>21. â­ï¸ä»€ä¹ˆæ˜¯ JavaConfigï¼Ÿ</h3><p>Spring JavaConfig æ˜¯Springç¤¾åŒºçš„äº§å“ï¼ŒSpring 3.0å¼•å…¥äº†å®ƒï¼Œå®ƒæä¾›äº†é…ç½®Spring IOCå®¹å™¨çš„çº¯Javaæ–¹æ³•ï¼Œæœ‰åŠ©äºé¿å…ä½¿ç”¨XMLé…ç½®ã€‚ä½¿ç”¨JavaConfigçš„ä¼˜ç‚¹åœ¨äºï¼š</p><ul><li><p>é¢å‘å¯¹è±¡çš„é…ç½®ã€‚é…ç½®è¢«å®šä¹‰ä¸ºJavaConfigä¸­çš„ç±»ï¼Œç”¨æˆ·å¯åˆ©ç”¨Javaé¢å‘å¯¹è±¡åŠŸèƒ½ï¼Œé…ç½®ç±»å¯ç»§æ‰¿ã€é‡å†™@Beanæ–¹æ³•ç­‰ã€‚</p></li><li><p>å‡å°‘æˆ–æ¶ˆé™¤XMLé…ç½®ã€‚è®¸å¤šå¼€å‘äººå‘˜ä¸å¸Œæœ›åœ¨XMLå’ŒJavaé—´æ¥å›åˆ‡æ¢ï¼ŒJavaConfigæä¾›çº¯Javaé…ç½®Springå®¹å™¨çš„æ–¹æ³•ï¼Œè™½ç„¶ä»…ç”¨JavaConfigé…ç½®å®¹å™¨å¯è¡Œï¼Œä½†å¸¸å°†å…¶ä¸XMLæ··åˆåŒ¹é…ã€‚</p></li><li><p>ç±»å‹å®‰å…¨å’Œé‡æ„å‹å¥½ã€‚Java 5.0å¯¹æ³›å‹çš„æ”¯æŒï¼Œä½¿æŒ‰ç±»å‹æ£€ç´¢beanï¼Œæ— éœ€å¼ºåˆ¶è½¬æ¢æˆ–åŸºäºå­—ç¬¦ä¸²æŸ¥æ‰¾ã€‚</p></li></ul><p>å¸¸ç”¨çš„Java configï¼š</p><ul><li><p>@Configurationï¼šåœ¨ç±»ä¸Šæ ‡æ³¨æ­¤æ³¨è§£ï¼Œè¡¨ç¤ºè¯¥ç±»æ˜¯é…ç½®ç±»ã€‚</p></li><li><p>@ComponentScanï¼šåœ¨é…ç½®ç±»ä¸Šæ·»åŠ æ­¤æ³¨è§£ï¼Œé»˜è®¤æ‰«æè¯¥ç±»æ‰€åœ¨åŒ…ä¸‹æ‰€æœ‰é…ç½®ç±»ï¼Œç›¸å½“äºä¹‹å‰çš„\<context:component-scan>ã€‚</p></li><li><p>@Beanï¼šbeançš„æ³¨å…¥ï¼Œç›¸å½“äºä»¥å‰çš„&lt; bean id=â€objectMapperâ€ class=â€org.codehaus.jackson.map.ObjectMapperâ€ /&gt;ã€‚&#x20;</p></li><li><p>@EnableWebMvcï¼šç›¸å½“äºxmlçš„\<mvc:annotation-driven>ã€‚</p></li><li><p>@ImportResourceï¼šç›¸å½“äºxmlçš„&lt; import resource=â€applicationContext-cache.xmlâ€&gt; ã€‚&#x20;</p></li></ul><h3 id="22-ä»€ä¹ˆæ˜¯-YAMLï¼Ÿ"><a href="#22-ä»€ä¹ˆæ˜¯-YAMLï¼Ÿ" class="headerlink" title="22. ä»€ä¹ˆæ˜¯ YAMLï¼Ÿ"></a>22. ä»€ä¹ˆæ˜¯ YAMLï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image95.png" alt=""></p><h3 id="23-â­ï¸ä»€ä¹ˆæ˜¯-Spring-Profilesï¼Ÿ"><a href="#23-â­ï¸ä»€ä¹ˆæ˜¯-Spring-Profilesï¼Ÿ" class="headerlink" title="23. â­ï¸ä»€ä¹ˆæ˜¯ Spring Profilesï¼Ÿ"></a>23. â­ï¸ä»€ä¹ˆæ˜¯ Spring Profilesï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image96.png" alt=""></p><h3 id="24-SpringBootå¤šæ•°æ®æºæ‹†åˆ†çš„æ€è·¯"><a href="#24-SpringBootå¤šæ•°æ®æºæ‹†åˆ†çš„æ€è·¯" class="headerlink" title="24. SpringBootå¤šæ•°æ®æºæ‹†åˆ†çš„æ€è·¯"></a>24. SpringBootå¤šæ•°æ®æºæ‹†åˆ†çš„æ€è·¯</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image97.png" alt=""></p><h3 id="25-ä¿æŠ¤-Spring-Boot-åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"><a href="#25-ä¿æŠ¤-Spring-Boot-åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ" class="headerlink" title="25. ä¿æŠ¤ Spring Boot åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"></a>25. ä¿æŠ¤ Spring Boot åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image98.png" alt=""></p><h3 id="26-â­ï¸Spring-Boot-ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ"><a href="#26-â­ï¸Spring-Boot-ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ" class="headerlink" title="26. â­ï¸Spring Boot ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ"></a>26. â­ï¸Spring Boot ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image99.png" alt=""></p><h3 id="27-Spring-Boot-ä¸­çš„ç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#27-Spring-Boot-ä¸­çš„ç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="27. Spring Boot ä¸­çš„ç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>27. Spring Boot ä¸­çš„ç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image100.png" alt=""></p><h3 id="28-âœ…å¦‚ä½•ä½¿ç”¨-Spring-Boot-å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ï¼Ÿ"><a href="#28-âœ…å¦‚ä½•ä½¿ç”¨-Spring-Boot-å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ï¼Ÿ" class="headerlink" title="28. âœ…å¦‚ä½•ä½¿ç”¨ Spring Boot å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ï¼Ÿ"></a>28. âœ…å¦‚ä½•ä½¿ç”¨ Spring Boot å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ï¼Ÿ</h3><p><strong>@ControllerAdvice + @ExceptionHandler</strong></p><p>åœ¨è¿™ç§å¼‚å¸¸å¤„ç†æ–¹å¼ä¸‹ï¼Œä¼šç»™æ‰€æœ‰æˆ–è€…æŒ‡å®šçš„Controllerç»‡å…¥å¼‚å¸¸å¤„ç†çš„é€»è¾‘ï¼ˆAOPï¼‰ï¼Œå½“Controllerä¸­çš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ï¼Œç”±è¢«@ExceptionHandleræ³¨è§£ä¿®é¥°çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚&#x20;</p><h3 id="29-å¦‚ä½•é‡æ–°åŠ è½½-Spring-Boot-ä¸Šçš„æ›´æ”¹ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼ŸSpring-Booté¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ"><a href="#29-å¦‚ä½•é‡æ–°åŠ è½½-Spring-Boot-ä¸Šçš„æ›´æ”¹ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼ŸSpring-Booté¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ" class="headerlink" title="29. å¦‚ä½•é‡æ–°åŠ è½½ Spring Boot ä¸Šçš„æ›´æ”¹ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼ŸSpring Booté¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ"></a>29. å¦‚ä½•é‡æ–°åŠ è½½ Spring Boot ä¸Šçš„æ›´æ”¹ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼ŸSpring Booté¡¹ç›®å¦‚ä½•çƒ­éƒ¨ç½²ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image102.png" alt=""></p><h3 id="30æ‚¨ä½¿ç”¨äº†å“ªäº›-starter-maven-ä¾èµ–é¡¹ï¼Ÿ"><a href="#30æ‚¨ä½¿ç”¨äº†å“ªäº›-starter-maven-ä¾èµ–é¡¹ï¼Ÿ" class="headerlink" title="30æ‚¨ä½¿ç”¨äº†å“ªäº› starter maven ä¾èµ–é¡¹ï¼Ÿ"></a>30æ‚¨ä½¿ç”¨äº†å“ªäº› starter maven ä¾èµ–é¡¹ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image103.png" alt=""></p><hr><h1 id="3-Spring-Cloudé¢è¯•é¢˜"><a href="#3-Spring-Cloudé¢è¯•é¢˜" class="headerlink" title="3.Spring Cloudé¢è¯•é¢˜"></a>3.Spring Cloudé¢è¯•é¢˜</h1><h2 id="ä¸€ã€å¾®æœåŠ¡æ¦‚å¿µ"><a href="#ä¸€ã€å¾®æœåŠ¡æ¦‚å¿µ" class="headerlink" title="ä¸€ã€å¾®æœåŠ¡æ¦‚å¿µ"></a>ä¸€ã€å¾®æœåŠ¡æ¦‚å¿µ</h2><h3 id="1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image104.png" alt=""></p><h3 id="2-â­ï¸å¾®æœåŠ¡ç›¸è¾ƒäºä¼ ç»Ÿçš„webé¡¹ç›®æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"><a href="#2-â­ï¸å¾®æœåŠ¡ç›¸è¾ƒäºä¼ ç»Ÿçš„webé¡¹ç›®æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ" class="headerlink" title="2. â­ï¸å¾®æœåŠ¡ç›¸è¾ƒäºä¼ ç»Ÿçš„webé¡¹ç›®æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"></a>2. â­ï¸å¾®æœåŠ¡ç›¸è¾ƒäºä¼ ç»Ÿçš„webé¡¹ç›®æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image105.png" alt=""></p><h3 id="3å¾®æœåŠ¡çš„é€šè®¯æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"><a href="#3å¾®æœåŠ¡çš„é€šè®¯æ–¹å¼æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="3å¾®æœåŠ¡çš„é€šè®¯æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"></a>3å¾®æœåŠ¡çš„é€šè®¯æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image106.png" alt=""></p><h3 id="4-â­ï¸åˆ†å¸ƒå¼å’Œå¾®æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#4-â­ï¸åˆ†å¸ƒå¼å’Œå¾®æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="4. â­ï¸åˆ†å¸ƒå¼å’Œå¾®æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>4. â­ï¸åˆ†å¸ƒå¼å’Œå¾®æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image107.png" alt=""></p><hr><h3 id="5-â­ï¸ç°åœ¨æœ‰å“ªäº›æµè¡Œçš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Ÿ"><a href="#5-â­ï¸ç°åœ¨æœ‰å“ªäº›æµè¡Œçš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="5. â­ï¸ç°åœ¨æœ‰å“ªäº›æµè¡Œçš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Ÿ"></a>5. â­ï¸ç°åœ¨æœ‰å“ªäº›æµè¡Œçš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image108.png" alt=""></p><hr><h3 id="6-è¯´ä¸‹å¾®æœåŠ¡æœ‰å“ªäº›ç»„ä»¶ï¼Ÿ"><a href="#6-è¯´ä¸‹å¾®æœåŠ¡æœ‰å“ªäº›ç»„ä»¶ï¼Ÿ" class="headerlink" title="6. è¯´ä¸‹å¾®æœåŠ¡æœ‰å“ªäº›ç»„ä»¶ï¼Ÿ"></a>6. è¯´ä¸‹å¾®æœåŠ¡æœ‰å“ªäº›ç»„ä»¶ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image109.png" alt=""></p><h3 id="7-â­ï¸-å¾®æœåŠ¡æ¶æ„å¦‚ä½•è¿è¡Œçš„ï¼Ÿ"><a href="#7-â­ï¸-å¾®æœåŠ¡æ¶æ„å¦‚ä½•è¿è¡Œçš„ï¼Ÿ" class="headerlink" title="7.â­ï¸ å¾®æœåŠ¡æ¶æ„å¦‚ä½•è¿è¡Œçš„ï¼Ÿ"></a>7.â­ï¸ å¾®æœåŠ¡æ¶æ„å¦‚ä½•è¿è¡Œçš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image110.png" alt=""></p><h2 id="äºŒã€Spring-Cloud"><a href="#äºŒã€Spring-Cloud" class="headerlink" title="äºŒã€Spring Cloud"></a>äºŒã€Spring Cloud</h2><h3 id="1-Spring-Cloudæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Spring-Cloudæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. Spring Cloudæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. Spring Cloudæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image111.png" alt=""></p><h3 id="2-Spring-Boot-å’Œ-Spring-Cloud-çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-Spring-Boot-å’Œ-Spring-Cloud-çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. Spring Boot å’Œ Spring Cloud çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2. Spring Boot å’Œ Spring Cloud çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image112.png" alt=""></p><h3 id="3-Spring-Cloud-ç”±ä»€ä¹ˆç»„æˆï¼Ÿ"><a href="#3-Spring-Cloud-ç”±ä»€ä¹ˆç»„æˆï¼Ÿ" class="headerlink" title="3. Spring Cloud ç”±ä»€ä¹ˆç»„æˆï¼Ÿ"></a>3. Spring Cloud ç”±ä»€ä¹ˆç»„æˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image113.png" alt=""></p><h2 id="ä¸‰ã€æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#ä¸‰ã€æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="ä¸‰ã€æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>ä¸‰ã€æœåŠ¡æ³¨å†Œä¸å‘ç°</h2><h3 id="1-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›æ³¨å†Œä¸­å¿ƒï¼Ÿ"><a href="#1-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›æ³¨å†Œä¸­å¿ƒï¼Ÿ" class="headerlink" title="1. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›æ³¨å†Œä¸­å¿ƒï¼Ÿ"></a>1. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›æ³¨å†Œä¸­å¿ƒï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image114.png" alt=""></p><h3 id="2-â­ï¸Nacosã€-Eurekaã€-Zookeeperæ³¨å†Œä¸­å¿ƒçš„åŒºåˆ«"><a href="#2-â­ï¸Nacosã€-Eurekaã€-Zookeeperæ³¨å†Œä¸­å¿ƒçš„åŒºåˆ«" class="headerlink" title="2. â­ï¸Nacosã€ Eurekaã€ Zookeeperæ³¨å†Œä¸­å¿ƒçš„åŒºåˆ«"></a>2. â­ï¸Nacosã€ Eurekaã€ Zookeeperæ³¨å†Œä¸­å¿ƒçš„åŒºåˆ«</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image115.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image116.png" alt=""></p><h3 id="3-â­ï¸Nacosçš„æœåŠ¡æ³¨å†Œè¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#3-â­ï¸Nacosçš„æœåŠ¡æ³¨å†Œè¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="3. â­ï¸Nacosçš„æœåŠ¡æ³¨å†Œè¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"></a>3. â­ï¸Nacosçš„æœåŠ¡æ³¨å†Œè¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image117.png" alt=""></p><h3 id="4-Nacosä¸­çš„Namespaceæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç»„ç»‡å’Œç®¡ç†å¾®æœåŠ¡ï¼Ÿ"><a href="#4-Nacosä¸­çš„Namespaceæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç»„ç»‡å’Œç®¡ç†å¾®æœåŠ¡ï¼Ÿ" class="headerlink" title="4. Nacosä¸­çš„Namespaceæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç»„ç»‡å’Œç®¡ç†å¾®æœåŠ¡ï¼Ÿ"></a>4. Nacosä¸­çš„Namespaceæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç»„ç»‡å’Œç®¡ç†å¾®æœåŠ¡ï¼Ÿ</h3><p>Nacosä¸­çš„<strong>Namespace</strong>æ˜¯ç”¨äºéš”ç¦»ä¸åŒç¯å¢ƒæˆ–åº”ç”¨ä¹‹é—´çš„é…ç½®å’ŒæœåŠ¡ä¿¡æ¯çš„æ¦‚å¿µã€‚é€šè¿‡ä½¿ç”¨Namespaceï¼Œå¯ä»¥å°†ä¸åŒçš„ç¯å¢ƒï¼ˆä¾‹å¦‚å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ï¼‰æˆ–ä¸åŒçš„åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚Webåº”ç”¨å’Œç§»åŠ¨åº”ç”¨ï¼‰çš„é…ç½®å’ŒæœåŠ¡ä¿¡æ¯åˆ†ç¦»å¼€æ¥ï¼Œä»¥é¿å…å†²çªå’Œé”™è¯¯ã€‚</p><p>åœ¨Nacosä¸­ï¼Œæ¯ä¸ªNamespaceéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„é…ç½®å’ŒæœåŠ¡æ³¨å†Œè¡¨ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‚¨æœ‰å¤šä¸ªåº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨Nacosï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬åˆ†åˆ«æ”¾ç½®åœ¨ä¸åŒçš„Namespaceä¸­ã€‚æ¯ä¸ªNamespaceéƒ½æœ‰è‡ªå·±çš„å‘½åç©ºé—´IDï¼Œç”¨äºæ ‡è¯†è¯¥Namespaceã€‚è¦ä½¿ç”¨Namespaceï¼Œåœ¨Nacoså®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶ï¼Œæ‚¨éœ€è¦æŒ‡å®šè¦ä½¿ç”¨çš„Namespace IDã€‚</p><p>é€šè¿‡ä½¿ç”¨Namespaceï¼Œæ‚¨å¯ä»¥å¯¹ä¸åŒNamespaceä¸‹çš„æœåŠ¡è¿›è¡Œåˆ†ç»„å’Œç®¡ç†ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨Nacosæä¾›çš„<strong>Group</strong>åŠŸèƒ½å¯¹åŒä¸€Namespaceä¸‹çš„æœåŠ¡è¿›è¡Œåˆ†ç»„ï¼Œæ–¹ä¾¿ç®¡ç†å’ŒæŸ¥æ‰¾ã€‚åŒæ—¶ï¼Œä½¿ç”¨Namespaceè¿˜å¯ä»¥å¯¹ä¸åŒç¯å¢ƒä¸‹çš„é…ç½®è¿›è¡Œéš”ç¦»ï¼Œé¿å…ä¸åŒç¯å¢ƒä¹‹é—´çš„é…ç½®å†²çªã€‚&#x20;</p><hr><h2 id="å››ã€è´Ÿè½½å‡è¡¡"><a href="#å››ã€è´Ÿè½½å‡è¡¡" class="headerlink" title="å››ã€è´Ÿè½½å‡è¡¡"></a>å››ã€è´Ÿè½½å‡è¡¡</h2><h3 id="1-åœ¨Spring-Cloudä¸­ï¼Œæ€ä¹ˆå®ç°æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼Ÿ"><a href="#1-åœ¨Spring-Cloudä¸­ï¼Œæ€ä¹ˆå®ç°æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼Ÿ" class="headerlink" title="1. åœ¨Spring Cloudä¸­ï¼Œæ€ä¹ˆå®ç°æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼Ÿ"></a>1. åœ¨Spring Cloudä¸­ï¼Œæ€ä¹ˆå®ç°æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image119.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image120.png" alt=""></p><h3 id="2-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆç­–ç•¥ï¼Ÿ"><a href="#2-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆç­–ç•¥ï¼Ÿ" class="headerlink" title="2. è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆç­–ç•¥ï¼Ÿ"></a>2. è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆç­–ç•¥ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image121.png" alt=""></p><hr><h2 id="äº”ã€â­ï¸è¿œç¨‹è°ƒç”¨"><a href="#äº”ã€â­ï¸è¿œç¨‹è°ƒç”¨" class="headerlink" title="äº”ã€â­ï¸è¿œç¨‹è°ƒç”¨"></a>äº”ã€â­ï¸è¿œç¨‹è°ƒç”¨</h2><h3 id="1-èƒ½è¯´ä¸‹HTTPå’ŒRPCçš„åŒºåˆ«å—ï¼Ÿ"><a href="#1-èƒ½è¯´ä¸‹HTTPå’ŒRPCçš„åŒºåˆ«å—ï¼Ÿ" class="headerlink" title="1. èƒ½è¯´ä¸‹HTTPå’ŒRPCçš„åŒºåˆ«å—ï¼Ÿ"></a>1. èƒ½è¯´ä¸‹HTTPå’ŒRPCçš„åŒºåˆ«å—ï¼Ÿ</h3><p>ä¸¥æ ¼æ¥è®²ï¼ŒHTTPå’Œä¸æ˜¯ä¸€ä¸ªå±‚é¢çš„ä¸œè¥¿ï¼š</p><ul><li><p>HTTPï¼ˆHypertext Transfer Protocolï¼‰æ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ï¼Œä¸»è¦å¼ºè°ƒçš„æ˜¯ç½‘ç»œé€šä¿¡ï¼›</p></li><li><p>RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„åè®®ï¼Œå¼ºè°ƒçš„æ˜¯æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨ã€‚</p></li></ul><p>ä¸€äº›RPCæ¡†æ¶æ¯”å¦‚gRPCï¼Œåº•å±‚ä¼ è¾“åè®®å…¶å®ä¹Ÿæ˜¯ç”¨çš„HTTP2ï¼ŒåŒ…æ‹¬Dubbo3ï¼Œä¹Ÿå…¼å®¹äº†gRPCï¼Œä½¿ç”¨äº†HTTP2ä½œä¸ºä¼ è¾“å±‚çš„ä¸€å±‚åè®®ã€‚&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image.png" alt=""></p><p>åœ¨å¾®æœåŠ¡ä½“ç³»é‡Œï¼š</p><ul><li><p>åŸºäºHTTPé£æ ¼çš„è¿œç¨‹è°ƒç”¨é€šå¸¸ä½¿ç”¨æ¡†æ¶å¦‚Feignæ¥å®ç°</p></li><li><p>åŸºäºRPCçš„è¿œç¨‹è°ƒç”¨é€šå¸¸ä½¿ç”¨æ¡†æ¶å¦‚Dubboæ¥å®ç°</p></li></ul><hr><h3 id="2-â­ï¸ä»€ä¹ˆæ˜¯Feignï¼Ÿ"><a href="#2-â­ï¸ä»€ä¹ˆæ˜¯Feignï¼Ÿ" class="headerlink" title="2. â­ï¸ä»€ä¹ˆæ˜¯Feignï¼Ÿ"></a>2. â­ï¸ä»€ä¹ˆæ˜¯Feignï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image125.png" alt=""></p><h3 id="3-ä¸ºä»€ä¹ˆFeignç¬¬ä¸€æ¬¡è°ƒç”¨è€—æ—¶å¾ˆé•¿ï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆFeignç¬¬ä¸€æ¬¡è°ƒç”¨è€—æ—¶å¾ˆé•¿ï¼Ÿ" class="headerlink" title="3. ä¸ºä»€ä¹ˆFeignç¬¬ä¸€æ¬¡è°ƒç”¨è€—æ—¶å¾ˆé•¿ï¼Ÿ"></a>3. ä¸ºä»€ä¹ˆFeignç¬¬ä¸€æ¬¡è°ƒç”¨è€—æ—¶å¾ˆé•¿ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image126.png" alt=""></p><h3 id="4-Feginæ€ä¹ˆåšè´Ÿè½½å‡è¡¡ï¼ŸRibbonï¼Ÿ"><a href="#4-Feginæ€ä¹ˆåšè´Ÿè½½å‡è¡¡ï¼ŸRibbonï¼Ÿ" class="headerlink" title="4. Feginæ€ä¹ˆåšè´Ÿè½½å‡è¡¡ï¼ŸRibbonï¼Ÿ"></a>4. Feginæ€ä¹ˆåšè´Ÿè½½å‡è¡¡ï¼ŸRibbonï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image127.png" alt=""></p><h3 id="5-Feignå’ŒDubboçš„åŒºåˆ«å‘¢ï¼Ÿ"><a href="#5-Feignå’ŒDubboçš„åŒºåˆ«å‘¢ï¼Ÿ" class="headerlink" title="5. Feignå’ŒDubboçš„åŒºåˆ«å‘¢ï¼Ÿ"></a>5. Feignå’ŒDubboçš„åŒºåˆ«å‘¢ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image128.png" alt=""></p><h3 id="6-Feignä¸-OpenFeignçš„åŒºåˆ«ï¼Ÿ"><a href="#6-Feignä¸-OpenFeignçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="6. Feignä¸ OpenFeignçš„åŒºåˆ«ï¼Ÿ"></a>6. Feignä¸ OpenFeignçš„åŒºåˆ«ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image129.png" alt=""></p><h3 id="7-Ribbonå’Œ-Feign-è°ƒç”¨æœåŠ¡çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#7-Ribbonå’Œ-Feign-è°ƒç”¨æœåŠ¡çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="7. Ribbonå’Œ Feign è°ƒç”¨æœåŠ¡çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>7. Ribbonå’Œ Feign è°ƒç”¨æœåŠ¡çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image130.png" alt=""></p><hr><h2 id="å…­ã€æœåŠ¡å®¹ç¾"><a href="#å…­ã€æœåŠ¡å®¹ç¾" class="headerlink" title="å…­ã€æœåŠ¡å®¹ç¾"></a>å…­ã€æœåŠ¡å®¹ç¾</h2><h3 id="1-â­ï¸ä»€ä¹ˆæ˜¯æ–­è·¯å™¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ–­è·¯å™¨"><a href="#1-â­ï¸ä»€ä¹ˆæ˜¯æ–­è·¯å™¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ–­è·¯å™¨" class="headerlink" title="1. â­ï¸ä»€ä¹ˆæ˜¯æ–­è·¯å™¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ–­è·¯å™¨"></a>1. â­ï¸ä»€ä¹ˆæ˜¯æ–­è·¯å™¨ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ–­è·¯å™¨</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image131.png" alt=""></p><h3 id="2-ä»€ä¹ˆæ˜¯Hystrixï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯Hystrixï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯Hystrixï¼Ÿ"></a>2. ä»€ä¹ˆæ˜¯Hystrixï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image132.png" alt=""></p><h3 id="3-â­ï¸å¾®æœåŠ¡é›ªå´©æ•ˆåº”æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-â­ï¸å¾®æœåŠ¡é›ªå´©æ•ˆåº”æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. â­ï¸å¾®æœåŠ¡é›ªå´©æ•ˆåº”æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. â­ï¸å¾®æœåŠ¡é›ªå´©æ•ˆåº”æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image133.png" alt=""></p><h3 id="4-â­ï¸æœåŠ¡é™çº§ï¼Œä½ äº†è§£å—ï¼Ÿ"><a href="#4-â­ï¸æœåŠ¡é™çº§ï¼Œä½ äº†è§£å—ï¼Ÿ" class="headerlink" title="4. â­ï¸æœåŠ¡é™çº§ï¼Œä½ äº†è§£å—ï¼Ÿ"></a>4. â­ï¸æœåŠ¡é™çº§ï¼Œä½ äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image134.png" alt=""></p><h3 id="5-æœåŠ¡ç†”æ–­ï¼Œä½ äº†è§£å—ï¼Ÿ"><a href="#5-æœåŠ¡ç†”æ–­ï¼Œä½ äº†è§£å—ï¼Ÿ" class="headerlink" title="5. æœåŠ¡ç†”æ–­ï¼Œä½ äº†è§£å—ï¼Ÿ"></a>5. æœåŠ¡ç†”æ–­ï¼Œä½ äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image135.png" alt=""></p><hr><h3 id="6-æœåŠ¡é™æµï¼Œä½ äº†è§£å—ï¼Ÿ"><a href="#6-æœåŠ¡é™æµï¼Œä½ äº†è§£å—ï¼Ÿ" class="headerlink" title="6. æœåŠ¡é™æµï¼Œä½ äº†è§£å—ï¼Ÿ"></a>6. æœåŠ¡é™æµï¼Œä½ äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image136.png" alt=""></p><h3 id="7-ä»€ä¹ˆæ˜¯é™çº§ç†”æ–­ï¼Ÿä¸ºä»€ä¹ˆè¦è¿›è¡Œç†”æ–­ï¼Ÿ"><a href="#7-ä»€ä¹ˆæ˜¯é™çº§ç†”æ–­ï¼Ÿä¸ºä»€ä¹ˆè¦è¿›è¡Œç†”æ–­ï¼Ÿ" class="headerlink" title="7. ä»€ä¹ˆæ˜¯é™çº§ç†”æ–­ï¼Ÿä¸ºä»€ä¹ˆè¦è¿›è¡Œç†”æ–­ï¼Ÿ"></a>7. ä»€ä¹ˆæ˜¯é™çº§ç†”æ–­ï¼Ÿä¸ºä»€ä¹ˆè¦è¿›è¡Œç†”æ–­ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image137.png" alt=""></p><h3 id="8-â­ï¸æœ‰å“ªäº›ç†”æ–­é™çº§æ–¹æ¡ˆå®ç°ï¼Ÿ"><a href="#8-â­ï¸æœ‰å“ªäº›ç†”æ–­é™çº§æ–¹æ¡ˆå®ç°ï¼Ÿ" class="headerlink" title="8. â­ï¸æœ‰å“ªäº›ç†”æ–­é™çº§æ–¹æ¡ˆå®ç°ï¼Ÿ"></a>8. â­ï¸æœ‰å“ªäº›ç†”æ–­é™çº§æ–¹æ¡ˆå®ç°ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image138.png" alt=""></p><h3 id="9-â­ï¸Sentinel-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"><a href="#9-â­ï¸Sentinel-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" class="headerlink" title="9. â­ï¸Sentinel æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>9. â­ï¸Sentinel æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image139.png" alt=""></p><h3 id="10-Sentinelæ€ä¹ˆå®ç°é™æµçš„ï¼Ÿ"><a href="#10-Sentinelæ€ä¹ˆå®ç°é™æµçš„ï¼Ÿ" class="headerlink" title="10. Sentinelæ€ä¹ˆå®ç°é™æµçš„ï¼Ÿ"></a>10. Sentinelæ€ä¹ˆå®ç°é™æµçš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image140.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image142.png" alt=""></p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image141.png" alt=""></p><h3 id="11-Sentinelé‡‡ç”¨çš„ä»€ä¹ˆé™æµç®—æ³•ï¼Ÿ"><a href="#11-Sentinelé‡‡ç”¨çš„ä»€ä¹ˆé™æµç®—æ³•ï¼Ÿ" class="headerlink" title="11. Sentinelé‡‡ç”¨çš„ä»€ä¹ˆé™æµç®—æ³•ï¼Ÿ"></a>11. Sentinelé‡‡ç”¨çš„ä»€ä¹ˆé™æµç®—æ³•ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image143.png" alt=""></p><h3 id="12-Sentinelæ€ä¹ˆå®ç°é›†ç¾¤é™æµï¼Ÿ"><a href="#12-Sentinelæ€ä¹ˆå®ç°é›†ç¾¤é™æµï¼Ÿ" class="headerlink" title="12. Sentinelæ€ä¹ˆå®ç°é›†ç¾¤é™æµï¼Ÿ"></a>12. Sentinelæ€ä¹ˆå®ç°é›†ç¾¤é™æµï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image144.png" alt=""></p><h3 id="13-Sentinel-ä¸Hystrixçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#13-Sentinel-ä¸Hystrixçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="13. Sentinel ä¸Hystrixçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>13. Sentinel ä¸Hystrixçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image145.png" alt=""></p><hr><h2 id="ä¸ƒã€æœåŠ¡ç½‘å…³"><a href="#ä¸ƒã€æœåŠ¡ç½‘å…³" class="headerlink" title="ä¸ƒã€æœåŠ¡ç½‘å…³"></a>ä¸ƒã€æœåŠ¡ç½‘å…³</h2><h3 id="1-â­ï¸ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘å…³ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ç½‘å…³ï¼Ÿ"><a href="#1-â­ï¸ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘å…³ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ç½‘å…³ï¼Ÿ" class="headerlink" title="1. â­ï¸ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘å…³ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ç½‘å…³ï¼Ÿ"></a>1. â­ï¸ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘å…³ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ç½‘å…³ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image146.png" alt=""></p><h3 id="2-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›APlç½‘å…³ï¼Ÿ"><a href="#2-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›APlç½‘å…³ï¼Ÿ" class="headerlink" title="2. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›APlç½‘å…³ï¼Ÿ"></a>2. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›APlç½‘å…³ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image147.png" alt=""></p><hr><h3 id="3-ä»€ä¹ˆæ˜¯é™æµç®—æ³•ï¼Œç½‘å…³å¦‚ä½•å®ç°é™æµï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯é™æµç®—æ³•ï¼Œç½‘å…³å¦‚ä½•å®ç°é™æµï¼Ÿ" class="headerlink" title="3. ä»€ä¹ˆæ˜¯é™æµç®—æ³•ï¼Œç½‘å…³å¦‚ä½•å®ç°é™æµï¼Ÿ"></a>3. ä»€ä¹ˆæ˜¯é™æµç®—æ³•ï¼Œç½‘å…³å¦‚ä½•å®ç°é™æµï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image148.png" alt=""></p><h3 id="4-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway"><a href="#4-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway" class="headerlink" title="4.ä»€ä¹ˆæ˜¯Spring Cloud Gateway"></a>4.ä»€ä¹ˆæ˜¯Spring Cloud Gateway</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image149.png" alt=""></p><h3 id="5-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µï¼Ÿ"><a href="#5-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µï¼Ÿ" class="headerlink" title="5. Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µï¼Ÿ"></a>5. Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image150.png" alt=""></p><hr><h3 id="6-ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©GateWayï¼Ÿ"><a href="#6-ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©GateWayï¼Ÿ" class="headerlink" title="6. ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©GateWayï¼Ÿ"></a>6. ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©GateWayï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image151.png" alt=""></p><h3 id="7-Spring-Cloud-GateWayå·¥ä½œæµç¨‹ï¼Ÿ"><a href="#7-Spring-Cloud-GateWayå·¥ä½œæµç¨‹ï¼Ÿ" class="headerlink" title="7. Spring Cloud GateWayå·¥ä½œæµç¨‹ï¼Ÿ"></a>7. Spring Cloud GateWayå·¥ä½œæµç¨‹ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image152.png" alt=""></p><hr><h2 id="å…«ã€é…ç½®ä¸­å¿ƒ"><a href="#å…«ã€é…ç½®ä¸­å¿ƒ" class="headerlink" title="å…«ã€é…ç½®ä¸­å¿ƒ"></a>å…«ã€é…ç½®ä¸­å¿ƒ</h2><h3 id="1-â­ï¸ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒï¼Ÿä¸ºä»€ä¹ˆéœ€è¦é…ç½®ä¸­å¿ƒï¼Ÿ"><a href="#1-â­ï¸ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒï¼Ÿä¸ºä»€ä¹ˆéœ€è¦é…ç½®ä¸­å¿ƒï¼Ÿ" class="headerlink" title="1. â­ï¸ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒï¼Ÿä¸ºä»€ä¹ˆéœ€è¦é…ç½®ä¸­å¿ƒï¼Ÿ"></a>1. â­ï¸ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒï¼Ÿä¸ºä»€ä¹ˆéœ€è¦é…ç½®ä¸­å¿ƒï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image153.png" alt=""></p><h3 id="2-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›é…ç½®ä¸­å¿ƒï¼Ÿ"><a href="#2-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›é…ç½®ä¸­å¿ƒï¼Ÿ" class="headerlink" title="2. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›é…ç½®ä¸­å¿ƒï¼Ÿ"></a>2. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›é…ç½®ä¸­å¿ƒï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image154.png" alt=""></p><h3 id="3-Nacosé…ç½®ä¸­å¿ƒçš„åŸç†äº†è§£å—ï¼Ÿ"><a href="#3-Nacosé…ç½®ä¸­å¿ƒçš„åŸç†äº†è§£å—ï¼Ÿ" class="headerlink" title="3. Nacosé…ç½®ä¸­å¿ƒçš„åŸç†äº†è§£å—ï¼Ÿ"></a>3. Nacosé…ç½®ä¸­å¿ƒçš„åŸç†äº†è§£å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image155.png" alt=""></p><h3 id="4-Nacosé…ç½®ä¸­å¿ƒé•¿è½®è¯¢æœºåˆ¶ï¼Ÿ"><a href="#4-Nacosé…ç½®ä¸­å¿ƒé•¿è½®è¯¢æœºåˆ¶ï¼Ÿ" class="headerlink" title="4. Nacosé…ç½®ä¸­å¿ƒé•¿è½®è¯¢æœºåˆ¶ï¼Ÿ"></a>4. Nacosé…ç½®ä¸­å¿ƒé•¿è½®è¯¢æœºåˆ¶ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image156.png" alt=""></p><h3 id="5-é“¾è·¯è·Ÿè¸ª"><a href="#5-é“¾è·¯è·Ÿè¸ª" class="headerlink" title="5. é“¾è·¯è·Ÿè¸ª"></a>5. é“¾è·¯è·Ÿè¸ª</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image157.png" alt=""></p><h3 id="6-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›å¾®æœåŠ¡é“¾è·¯è¿½è¸ªæ–¹æ¡ˆï¼Ÿ"><a href="#6-SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›å¾®æœåŠ¡é“¾è·¯è¿½è¸ªæ–¹æ¡ˆï¼Ÿ" class="headerlink" title="6. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›å¾®æœåŠ¡é“¾è·¯è¿½è¸ªæ–¹æ¡ˆï¼Ÿ"></a>6. SpringCloudå¯ä»¥é€‰æ‹©å“ªäº›å¾®æœåŠ¡é“¾è·¯è¿½è¸ªæ–¹æ¡ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image158.png" alt=""></p><h2 id="ä¹ã€åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#ä¹ã€åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="ä¹ã€åˆ†å¸ƒå¼äº‹åŠ¡"></a>ä¹ã€åˆ†å¸ƒå¼äº‹åŠ¡</h2><h3 id="1-â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿæœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ"><a href="#1-â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿæœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="1. â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿæœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ"></a>1. â­ï¸ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿæœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image159.png" alt=""></p><h3 id="2-ä»€ä¹ˆæ˜¯Seataï¼Ÿè°ˆè°ˆä½ å¯¹Seataçš„ç†è§£ï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯Seataï¼Ÿè°ˆè°ˆä½ å¯¹Seataçš„ç†è§£ï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯Seataï¼Ÿè°ˆè°ˆä½ å¯¹Seataçš„ç†è§£ï¼Ÿ"></a>2. ä»€ä¹ˆæ˜¯Seataï¼Ÿè°ˆè°ˆä½ å¯¹Seataçš„ç†è§£ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image160.png" alt=""></p><h3 id="3-Seataæ”¯æŒå“ªäº›æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"><a href="#3-Seataæ”¯æŒå“ªäº›æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ" class="headerlink" title="3. Seataæ”¯æŒå“ªäº›æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"></a>3. Seataæ”¯æŒå“ªäº›æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image161.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image162.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image163.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image164.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image165.png" alt=""></p><hr><h3 id="4-äº†è§£Seataçš„å®ç°åŸç†å—ï¼Ÿ"><a href="#4-äº†è§£Seataçš„å®ç°åŸç†å—ï¼Ÿ" class="headerlink" title="4. äº†è§£Seataçš„å®ç°åŸç†å—ï¼Ÿ"></a>4. äº†è§£Seataçš„å®ç°åŸç†å—ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image166.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image167.png" alt=""></p><p>&#x20;</p><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image168.png" alt=""></p><hr><h3 id="5-Seataçš„äº‹åŠ¡æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#5-Seataçš„äº‹åŠ¡æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="5. Seataçš„äº‹åŠ¡æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>5. Seataçš„äº‹åŠ¡æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image169.png" alt=""></p><h3 id="6-Seataçš„äº‹åŠ¡å›æ»šæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ"><a href="#6-Seataçš„äº‹åŠ¡å›æ»šæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ" class="headerlink" title="6. Seataçš„äº‹åŠ¡å›æ»šæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ"></a>6. Seataçš„äº‹åŠ¡å›æ»šæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image170.png" alt=""></p><h2 id="åã€å…¶å®ƒ"><a href="#åã€å…¶å®ƒ" class="headerlink" title="åã€å…¶å®ƒ"></a>åã€å…¶å®ƒ</h2><h3 id="1-ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšç›‘æ§å’Œå‘Šè­¦ï¼Ÿ"><a href="#1-ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšç›‘æ§å’Œå‘Šè­¦ï¼Ÿ" class="headerlink" title="1. ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšç›‘æ§å’Œå‘Šè­¦ï¼Ÿ"></a>1. ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšç›‘æ§å’Œå‘Šè­¦ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image171.png" alt=""></p><h3 id="2-ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšæ—¥å¿—æ”¶é›†ï¼Ÿ"><a href="#2-ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšæ—¥å¿—æ”¶é›†ï¼Ÿ" class="headerlink" title="2. ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšæ—¥å¿—æ”¶é›†ï¼Ÿ"></a>2. ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšæ—¥å¿—æ”¶é›†ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image172.png" alt=""></p><h3 id="3-è¯´ä¸‹ä½ å¯¹DDDçš„ç†è§£ï¼Ÿ"><a href="#3-è¯´ä¸‹ä½ å¯¹DDDçš„ç†è§£ï¼Ÿ" class="headerlink" title="3. è¯´ä¸‹ä½ å¯¹DDDçš„ç†è§£ï¼Ÿ"></a>3. è¯´ä¸‹ä½ å¯¹DDDçš„ç†è§£ï¼Ÿ</h3><p><img src="2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜/image173.png" alt=""></p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„SpringåŸºç¡€é¢è¯•æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="Spring" scheme="https://outoflovenicoo.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼å­¦ä¹ ç¬”è®°</title>
    <link href="https://outoflovenicoo.github.io/posts/2025331n.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025331n.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-åˆ†å¸ƒå¼ç†è®ºï¼ˆCAP-amp-BASEï¼‰ï¼š"><a href="#1-åˆ†å¸ƒå¼ç†è®ºï¼ˆCAP-amp-BASEï¼‰ï¼š" class="headerlink" title="1.åˆ†å¸ƒå¼ç†è®ºï¼ˆCAP &amp; BASEï¼‰ï¼š"></a>1.åˆ†å¸ƒå¼ç†è®ºï¼ˆCAP &amp; BASEï¼‰ï¼š</h1><h2 id="1-CAP"><a href="#1-CAP" class="headerlink" title="(1) CAP:"></a>(1) CAP:</h2><p><img src="./assets/(null" alt="img">-20250331104223525.(null))</p><p>é¦–å…ˆï¼Œæˆ‘è§£é‡Šä¸‹<strong>CAPå®šç†</strong>çš„å«ä¹‰ï¼Œcæ˜¯æŒ‡ä¸€è‡´æ€§ï¼Œå°±æ˜¯æŒ‡æ‰€æœ‰èŠ‚ç‚¹è®¿é—®åŒä¸€ä»½æœ€æ–°çš„æ•°æ®å‰¯æœ¬ã€‚Aæ˜¯æŒ‡å¯ç”¨æ€§ï¼Œè¡¨ç¤ºéæ•…éšœçš„èŠ‚ç‚¹åœ¨åˆç†çš„æ—¶é—´å†…è¿”å›åˆç†çš„å“åº”ï¼ˆä¸æ˜¯é”™è¯¯æˆ–è€…è¶…æ—¶çš„å“åº”ï¼‰ï¼ŒAæ˜¯æŒ‡åˆ†åŒºå®¹é”™æ€§åˆ†å¸ƒå¼ç³»ç»Ÿå‡ºç°ç½‘ç»œåˆ†åŒºçš„æ—¶å€™ï¼Œä»ç„¶èƒ½å¤Ÿå¯¹å¤–æä¾›æœåŠ¡ã€‚</p><p>å¦‚æœæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè‚¯å®šæœ‰å¾ˆå¤šä¸ªèŠ‚ç‚¹ï¼Œä¸ºäº†ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚Pæ˜¯ä¸€å®šè¦æ»¡è¶³çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¼ºä¸€è‡´æ€§å’Œå¯ç”¨æ€§åªèƒ½æ»¡è¶³äºŒé€‰ä¸€ã€‚å› ä¸ºå¦‚æœè¦æ»¡è¶³å¼ºä¸€è‡´æ€§ï¼Œé‚£ä¹ˆåœ¨è¯»å†™æ—¶å¿…é¡»è¦å¯¹å…¶åŠ é”ã€‚è¿™æ—¶å€™å…¶å®ƒèŠ‚ç‚¹çš„è¯»å†™æ“ä½œå°±è¢«ç¦ç”¨äº†ï¼Œé‚£ä¹ˆå…¶å®ƒèŠ‚ç‚¹çš„å¯ç”¨æ€§å°±æ— æ³•ä¿è¯ã€‚è€Œå¦‚æœä¿è¯å¯ç”¨æ€§ï¼Œé‚£æ¯ä¸ªèŠ‚ç‚¹çš„å®æ—¶æ•°æ®æ— æ³•ä¿è¯å¼ºä¸€è‡´æ€§ã€‚å¯¹äºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå› æ­¤åªèƒ½å®ŒæˆCPå’ŒAPã€‚æ— æ³•å®ŒæˆCAã€‚</p><h1 id="2-åˆ†å¸ƒå¼-paxoså’Œraftçš„åŒºåˆ«"><a href="#2-åˆ†å¸ƒå¼-paxoså’Œraftçš„åŒºåˆ«" class="headerlink" title="2.åˆ†å¸ƒå¼-paxoså’Œraftçš„åŒºåˆ«"></a>2.åˆ†å¸ƒå¼-paxoså’Œraftçš„åŒºåˆ«</h1><p><a href="https://learn.lianglianglee.com/ä¸“æ /24è®²åƒé€åˆ†å¸ƒå¼æ•°æ®åº“-å®Œ/20  å…±è¯†ç®—æ³•ï¼šä¸€æ¬¡æ€§è¯´æ¸…æ¥š Paxosã€Raft ç­‰ç®—æ³•çš„åŒºåˆ«.md">20 å…±è¯†ç®—æ³•:ä¸€æ¬¡æ€§è¯´æ¸…æ¥š Paxosã€Raft ç­‰ç®—æ³•çš„åŒºåˆ«</a></p><p>ç­”ï¼šPaxosåœ¨ä¸€ä¸ªèŠ‚ç‚¹å½“é€‰ä¸ºå°±æ˜¯ leader èŠ‚ç‚¹ä¹‹åï¼Œå…¶ä»–çš„ä»èŠ‚ç‚¹å¦‚æœä¸æ»¡ä¸»èŠ‚ç‚¹çš„é‚£ä¸ªæŠ•ç¥¨ç­–ç•¥çš„è¯ï¼Œæ˜¯å¯ä»¥å¯¹ä¸»èŠ‚ç‚¹çš„æŠ•ç¥¨å°±æ˜¯è¿›è¡Œå¦å†³çš„ã€‚Paxoså°±æ˜¯ä¸‰é˜¶æ®µæäº¤ã€‚ä½†æ˜¯ raft çš„è¯å°±æ˜¯åªè¦é›†ç¾¤ä¸­å­˜åœ¨ leader èŠ‚ç‚¹çš„è¯ï¼Œä»èŠ‚ç‚¹å°±æ˜¯ä¼šæŒ‰ç…§ä¸»èŠ‚ç‚¹çš„ç­–ç•¥æ¥è¿›è¡Œä¸€è‡´æ€§çš„æ‰§è¡Œã€‚</p><h1 id="3-åˆ†å¸ƒå¼-ä¸ºä»€ä¹ˆå°±æ˜¯åˆ†å¸ƒå¼çš„å…±è¯†ç®—æ³•éƒ½éœ€è¦è¦æ±‚å¤šæ•°æ´¾æäº¤æ‰èƒ½å®Œæˆå®ƒçš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ï¼Ÿ"><a href="#3-åˆ†å¸ƒå¼-ä¸ºä»€ä¹ˆå°±æ˜¯åˆ†å¸ƒå¼çš„å…±è¯†ç®—æ³•éƒ½éœ€è¦è¦æ±‚å¤šæ•°æ´¾æäº¤æ‰èƒ½å®Œæˆå®ƒçš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ï¼Ÿ" class="headerlink" title="3.åˆ†å¸ƒå¼-ä¸ºä»€ä¹ˆå°±æ˜¯åˆ†å¸ƒå¼çš„å…±è¯†ç®—æ³•éƒ½éœ€è¦è¦æ±‚å¤šæ•°æ´¾æäº¤æ‰èƒ½å®Œæˆå®ƒçš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ï¼Ÿ"></a>3.åˆ†å¸ƒå¼-ä¸ºä»€ä¹ˆå°±æ˜¯åˆ†å¸ƒå¼çš„å…±è¯†ç®—æ³•éƒ½éœ€è¦è¦æ±‚å¤šæ•°æ´¾æäº¤æ‰èƒ½å®Œæˆå®ƒçš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ï¼Ÿ</h1><p>æœ‰ä½œæ¶èŠ‚ç‚¹ï¼Œæ¶ˆæ¯å¯èƒ½åˆ°çš„é¡ºåºä¸ä¸€æ ·ï¼Œæ‹œå åº­é—®é¢˜</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„åˆ†å¸ƒå¼å­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="åˆ†å¸ƒå¼" scheme="https://outoflovenicoo.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-%E9%98%BF%E9%87%8C%E5%BC%80%E5%8F%91%E8%A7%84%E7%BA%A6%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-%E9%98%BF%E9%87%8C%E5%BC%80%E5%8F%91%E8%A7%84%E7%BA%A6%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç¼–ç¨‹è§„çº¦"><a href="#ä¸€ã€ç¼–ç¨‹è§„çº¦" class="headerlink" title="ä¸€ã€ç¼–ç¨‹è§„çº¦"></a>ä¸€ã€ç¼–ç¨‹è§„çº¦</h1><h2 id="1-åº”è¯¥ç”¨ç¡®å®šæœ‰å€¼çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•"><a href="#1-åº”è¯¥ç”¨ç¡®å®šæœ‰å€¼çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•" class="headerlink" title="1.åº”è¯¥ç”¨ç¡®å®šæœ‰å€¼çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•"></a>1.åº”è¯¥ç”¨ç¡®å®šæœ‰å€¼çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-14.png" alt=""></p><h2 id="2-åŒ…è£…ç±»å¯¹è±¡åº”è¯¥ç”¨equalsæ¯”è¾ƒè€Œä¸è¦ç”¨"><a href="#2-åŒ…è£…ç±»å¯¹è±¡åº”è¯¥ç”¨equalsæ¯”è¾ƒè€Œä¸è¦ç”¨" class="headerlink" title="2.åŒ…è£…ç±»å¯¹è±¡åº”è¯¥ç”¨equalsæ¯”è¾ƒè€Œä¸è¦ç”¨=="></a>2.åŒ…è£…ç±»å¯¹è±¡åº”è¯¥ç”¨equalsæ¯”è¾ƒè€Œä¸è¦ç”¨==</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-11.png" alt=""></p><h2 id="3-ä»»ä½•è´§å¸é‡‘é¢ï¼Œå‡ä»¥æœ€å°è´§å¸å•ä½ä¸”æ•´å‹ç±»å‹æ¥è¿›è¡Œå­˜å‚¨ã€‚"><a href="#3-ä»»ä½•è´§å¸é‡‘é¢ï¼Œå‡ä»¥æœ€å°è´§å¸å•ä½ä¸”æ•´å‹ç±»å‹æ¥è¿›è¡Œå­˜å‚¨ã€‚" class="headerlink" title="3.ä»»ä½•è´§å¸é‡‘é¢ï¼Œå‡ä»¥æœ€å°è´§å¸å•ä½ä¸”æ•´å‹ç±»å‹æ¥è¿›è¡Œå­˜å‚¨ã€‚"></a>3.ä»»ä½•è´§å¸é‡‘é¢ï¼Œå‡ä»¥æœ€å°è´§å¸å•ä½ä¸”æ•´å‹ç±»å‹æ¥è¿›è¡Œå­˜å‚¨ã€‚</h2><h2 id="4-â­ï¸æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒfloatåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨-æ¥æ¯”è¾ƒï¼Œæµ®ç‚¹æ•°åŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨-equalsæ¥åˆ¤æ–­"><a href="#4-â­ï¸æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒfloatåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨-æ¥æ¯”è¾ƒï¼Œæµ®ç‚¹æ•°åŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨-equalsæ¥åˆ¤æ–­" class="headerlink" title="4.â­ï¸æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒfloatåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨==æ¥æ¯”è¾ƒï¼Œæµ®ç‚¹æ•°åŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨ equalsæ¥åˆ¤æ–­"></a>4.â­ï¸æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒfloatåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨==æ¥æ¯”è¾ƒï¼Œæµ®ç‚¹æ•°åŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨ equalsæ¥åˆ¤æ–­</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-10.png" alt=""></p><p>å› ä¸ºï¼š</p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-9.png" alt=""></p><h2 id="5-ç¦æ­¢ä½¿ç”¨æ„é€ æ–¹æ³•-BigDecimal-double-çš„æ–¹å¼æŠŠ-double-å€¼è½¬åŒ–ä¸º-BigDecimal-å¯¹è±¡"><a href="#5-ç¦æ­¢ä½¿ç”¨æ„é€ æ–¹æ³•-BigDecimal-double-çš„æ–¹å¼æŠŠ-double-å€¼è½¬åŒ–ä¸º-BigDecimal-å¯¹è±¡" class="headerlink" title="5.ç¦æ­¢ä½¿ç”¨æ„é€ æ–¹æ³• BigDecimal(double)çš„æ–¹å¼æŠŠ double å€¼è½¬åŒ–ä¸º BigDecimal å¯¹è±¡"></a>5.ç¦æ­¢ä½¿ç”¨æ„é€ æ–¹æ³• BigDecimal(double)çš„æ–¹å¼æŠŠ double å€¼è½¬åŒ–ä¸º BigDecimal å¯¹è±¡</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-13.png" alt=""></p><h2 id="6-POJOç”¨åŒ…è£…æ•°æ®ç±»å‹"><a href="#6-POJOç”¨åŒ…è£…æ•°æ®ç±»å‹" class="headerlink" title="6.POJOç”¨åŒ…è£…æ•°æ®ç±»å‹"></a>6.POJOç”¨åŒ…è£…æ•°æ®ç±»å‹</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-12.png" alt=""></p><h2 id="7-ä½¿ç”¨ç´¢å¼•è®¿é—®ç”¨-String-çš„-split-æ–¹æ³•å¾—åˆ°çš„æ•°ç»„æ—¶ï¼Œéœ€åšæœ€åä¸€ä¸ªåˆ†éš”ç¬¦åæœ‰æ— å†…å®¹çš„æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæœ‰æŠ›-IndexOutOfBoundsException-çš„é£é™©"><a href="#7-ä½¿ç”¨ç´¢å¼•è®¿é—®ç”¨-String-çš„-split-æ–¹æ³•å¾—åˆ°çš„æ•°ç»„æ—¶ï¼Œéœ€åšæœ€åä¸€ä¸ªåˆ†éš”ç¬¦åæœ‰æ— å†…å®¹çš„æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæœ‰æŠ›-IndexOutOfBoundsException-çš„é£é™©" class="headerlink" title="7.ä½¿ç”¨ç´¢å¼•è®¿é—®ç”¨ String çš„ split æ–¹æ³•å¾—åˆ°çš„æ•°ç»„æ—¶ï¼Œéœ€åšæœ€åä¸€ä¸ªåˆ†éš”ç¬¦åæœ‰æ— å†…å®¹çš„æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæœ‰æŠ› IndexOutOfBoundsException çš„é£é™©"></a>7.ä½¿ç”¨ç´¢å¼•è®¿é—®ç”¨ String çš„ split æ–¹æ³•å¾—åˆ°çš„æ•°ç»„æ—¶ï¼Œéœ€åšæœ€åä¸€ä¸ªåˆ†éš”ç¬¦åæœ‰æ— å†…å®¹çš„æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæœ‰æŠ› IndexOutOfBoundsException çš„é£é™©</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-7.png" alt=""></p><h2 id="8-å¾ªç¯ä½“å†…ï¼Œå­—ç¬¦ä¸²çš„è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨-StringBuilder-çš„-append-æ–¹æ³•è¿›è¡Œæ‰©å±•"><a href="#8-å¾ªç¯ä½“å†…ï¼Œå­—ç¬¦ä¸²çš„è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨-StringBuilder-çš„-append-æ–¹æ³•è¿›è¡Œæ‰©å±•" class="headerlink" title="8.å¾ªç¯ä½“å†…ï¼Œå­—ç¬¦ä¸²çš„è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨ StringBuilder çš„ append æ–¹æ³•è¿›è¡Œæ‰©å±•"></a>8.å¾ªç¯ä½“å†…ï¼Œå­—ç¬¦ä¸²çš„è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨ StringBuilder çš„ append æ–¹æ³•è¿›è¡Œæ‰©å±•</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-8.png" alt=""></p><h2 id="9-æ…ç”¨-Object-çš„-clone-æ–¹æ³•æ¥æ‹·è´å¯¹è±¡"><a href="#9-æ…ç”¨-Object-çš„-clone-æ–¹æ³•æ¥æ‹·è´å¯¹è±¡" class="headerlink" title="9.æ…ç”¨ Object çš„ clone æ–¹æ³•æ¥æ‹·è´å¯¹è±¡"></a>9.æ…ç”¨ Object çš„ clone æ–¹æ³•æ¥æ‹·è´å¯¹è±¡</h2><p>è¯´æ˜ï¼š å¯¹è±¡ clone æ–¹æ³•é»˜è®¤æ˜¯æµ…æ‹·è´ï¼Œè‹¥æƒ³å®ç°æ·±æ‹·è´ï¼Œ éœ€è¦†å†™ clone æ–¹æ³•å®ç°åŸŸå¯¹è±¡çš„æ·±åº¦éå†å¼æ‹·è´</p><h2 id="10-ç±»æˆå‘˜ä¸æ–¹æ³•è®¿é—®æ§åˆ¶ä»ä¸¥"><a href="#10-ç±»æˆå‘˜ä¸æ–¹æ³•è®¿é—®æ§åˆ¶ä»ä¸¥" class="headerlink" title="10.ç±»æˆå‘˜ä¸æ–¹æ³•è®¿é—®æ§åˆ¶ä»ä¸¥"></a>10.ç±»æˆå‘˜ä¸æ–¹æ³•è®¿é—®æ§åˆ¶ä»ä¸¥</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image.png" alt=""></p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-1.png" alt=""></p><h2 id="11-æ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œä¼ å…¥-pattern-ä¸­è¡¨ç¤ºå¹´ä»½ç»Ÿä¸€ä½¿ç”¨å°å†™çš„-y"><a href="#11-æ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œä¼ å…¥-pattern-ä¸­è¡¨ç¤ºå¹´ä»½ç»Ÿä¸€ä½¿ç”¨å°å†™çš„-y" class="headerlink" title="11.æ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œä¼ å…¥ pattern ä¸­è¡¨ç¤ºå¹´ä»½ç»Ÿä¸€ä½¿ç”¨å°å†™çš„ y"></a>11.æ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œä¼ å…¥ pattern ä¸­è¡¨ç¤ºå¹´ä»½ç»Ÿä¸€ä½¿ç”¨å°å†™çš„ y</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-2.png" alt=""></p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-3.png" alt=""></p><h2 id="12-å…³äº-hashCode-å’Œ-equals-çš„å¤„ç†ï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š"><a href="#12-å…³äº-hashCode-å’Œ-equals-çš„å¤„ç†ï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š" class="headerlink" title="12.å…³äº hashCode å’Œ equals çš„å¤„ç†ï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š"></a>12.å…³äº hashCode å’Œ equals çš„å¤„ç†ï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-4.png" alt=""></p><h2 id="13-ArrayList-çš„-subList-ç»“æœä¸å¯å¼ºè½¬æˆ-ArrayListï¼Œå¦åˆ™ä¼šæŠ›å‡º-ClassCastException-å¼‚å¸¸"><a href="#13-ArrayList-çš„-subList-ç»“æœä¸å¯å¼ºè½¬æˆ-ArrayListï¼Œå¦åˆ™ä¼šæŠ›å‡º-ClassCastException-å¼‚å¸¸" class="headerlink" title="13.ArrayList çš„ subList ç»“æœä¸å¯å¼ºè½¬æˆ ArrayListï¼Œå¦åˆ™ä¼šæŠ›å‡º ClassCastException å¼‚å¸¸"></a>13.ArrayList çš„ subList ç»“æœä¸å¯å¼ºè½¬æˆ ArrayListï¼Œå¦åˆ™ä¼šæŠ›å‡º ClassCastException å¼‚å¸¸</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-5.png" alt=""></p><h2 id="14-ä¸å…è®¸åœ¨ç¨‹åºä»»ä½•åœ°æ–¹ä¸­ä½¿ç”¨ï¼š-x20"><a href="#14-ä¸å…è®¸åœ¨ç¨‹åºä»»ä½•åœ°æ–¹ä¸­ä½¿ç”¨ï¼š-x20" class="headerlink" title="14.ä¸å…è®¸åœ¨ç¨‹åºä»»ä½•åœ°æ–¹ä¸­ä½¿ç”¨ï¼š&#x20;"></a>14.ä¸å…è®¸åœ¨ç¨‹åºä»»ä½•åœ°æ–¹ä¸­ä½¿ç”¨ï¼š&#x20;</h2><h3 id="1ï¼‰-java-sql-Dateã€‚-x20"><a href="#1ï¼‰-java-sql-Dateã€‚-x20" class="headerlink" title="1ï¼‰ java.sql.Dateã€‚&#x20;"></a>1ï¼‰ java.sql.Dateã€‚&#x20;</h3><p>ä¸è®°å½•æ—¶é—´ï¼Œ getHours()æŠ›å‡ºå¼‚å¸¸</p><h3 id="2ï¼‰-java-sql-Timeã€‚"><a href="#2ï¼‰-java-sql-Timeã€‚" class="headerlink" title="2ï¼‰ java.sql.Timeã€‚"></a>2ï¼‰ java.sql.Timeã€‚</h3><p>ä¸è®°å½•æ—¥æœŸï¼Œ getYear()æŠ›å‡ºå¼‚å¸¸</p><h3 id="3ï¼‰-java-sql-Timestampã€‚"><a href="#3ï¼‰-java-sql-Timestampã€‚" class="headerlink" title="3ï¼‰ java.sql.Timestampã€‚"></a>3ï¼‰ java.sql.Timestampã€‚</h3><p>åœ¨æ„é€ </p><p>æ–¹æ³• super((time/1000)*1000)ï¼Œ åœ¨ Timestamp å±æ€§ fastTime å’Œ nanos åˆ†åˆ«å­˜å‚¨ç§’å’Œçº³ç§’ä¿¡æ¯ã€‚</p><h2 id="15-ä½¿ç”¨å·¥å…·ç±»-Arrays-asList-æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆæ—¶ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä¿®æ”¹é›†åˆç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒçš„-add-remove-clear-æ–¹æ³•ä¼šæŠ›å‡º-UnsupportedOperationException-å¼‚å¸¸"><a href="#15-ä½¿ç”¨å·¥å…·ç±»-Arrays-asList-æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆæ—¶ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä¿®æ”¹é›†åˆç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒçš„-add-remove-clear-æ–¹æ³•ä¼šæŠ›å‡º-UnsupportedOperationException-å¼‚å¸¸" class="headerlink" title="15.ä½¿ç”¨å·¥å…·ç±» Arrays.asList()æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆæ—¶ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä¿®æ”¹é›†åˆç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒçš„ add/remove/clear æ–¹æ³•ä¼šæŠ›å‡º UnsupportedOperationException å¼‚å¸¸"></a>15.ä½¿ç”¨å·¥å…·ç±» Arrays.asList()æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆæ—¶ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä¿®æ”¹é›†åˆç›¸å…³çš„æ–¹æ³•ï¼Œå®ƒçš„ add/remove/clear æ–¹æ³•ä¼šæŠ›å‡º UnsupportedOperationException å¼‚å¸¸</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-6.png" alt=""></p><h2 id="16-æ³›å‹é€šé…ç¬¦-lt-extends-T-gt-æ¥æ¥æ”¶è¿”å›çš„æ•°æ®ï¼Œæ­¤å†™æ³•çš„æ³›å‹é›†åˆä¸èƒ½ä½¿ç”¨-add-æ–¹æ³•ï¼Œè€Œ-lt-super-T-gt-ä¸èƒ½ä½¿ç”¨-get-æ–¹æ³•ï¼Œ-ä¸¤è€…åœ¨æ¥å£è°ƒç”¨èµ‹å€¼çš„åœºæ™¯ä¸­å®¹æ˜“å‡ºé”™ã€‚"><a href="#16-æ³›å‹é€šé…ç¬¦-lt-extends-T-gt-æ¥æ¥æ”¶è¿”å›çš„æ•°æ®ï¼Œæ­¤å†™æ³•çš„æ³›å‹é›†åˆä¸èƒ½ä½¿ç”¨-add-æ–¹æ³•ï¼Œè€Œ-lt-super-T-gt-ä¸èƒ½ä½¿ç”¨-get-æ–¹æ³•ï¼Œ-ä¸¤è€…åœ¨æ¥å£è°ƒç”¨èµ‹å€¼çš„åœºæ™¯ä¸­å®¹æ˜“å‡ºé”™ã€‚" class="headerlink" title="16.æ³›å‹é€šé…ç¬¦\&lt;? extends T&gt;æ¥æ¥æ”¶è¿”å›çš„æ•°æ®ï¼Œæ­¤å†™æ³•çš„æ³›å‹é›†åˆä¸èƒ½ä½¿ç”¨ add æ–¹æ³•ï¼Œè€Œ\&lt;? super T&gt;ä¸èƒ½ä½¿ç”¨ get æ–¹æ³•ï¼Œ ä¸¤è€…åœ¨æ¥å£è°ƒç”¨èµ‹å€¼çš„åœºæ™¯ä¸­å®¹æ˜“å‡ºé”™ã€‚"></a>16.æ³›å‹é€šé…ç¬¦\&lt;? extends T&gt;æ¥æ¥æ”¶è¿”å›çš„æ•°æ®ï¼Œæ­¤å†™æ³•çš„æ³›å‹é›†åˆä¸èƒ½ä½¿ç”¨ add æ–¹æ³•ï¼Œè€Œ\&lt;? super T&gt;ä¸èƒ½ä½¿ç”¨ get æ–¹æ³•ï¼Œ ä¸¤è€…åœ¨æ¥å£è°ƒç”¨èµ‹å€¼çš„åœºæ™¯ä¸­å®¹æ˜“å‡ºé”™ã€‚</h2><p>è¯´æ˜ï¼š æ‰©å±•è¯´ä¸€ä¸‹ PECS(Producer Extends Consumer Super)åŸåˆ™ï¼š ç¬¬ä¸€ã€ é¢‘ç¹å¾€å¤–è¯»å–å†…å®¹çš„ï¼Œé€‚åˆç”¨</p><p>\&lt;? extends T&gt;ã€‚ ç¬¬äºŒã€ ç»å¸¸å¾€é‡Œæ’å…¥çš„ï¼Œé€‚åˆç”¨\&lt;? super T&gt;</p><h2 id="17-ä¸è¦åœ¨-foreach-å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„-remove-add-æ“ä½œã€‚-remove-å…ƒç´ è¯·ä½¿ç”¨-Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹-Iterator-å¯¹è±¡åŠ é”ã€‚"><a href="#17-ä¸è¦åœ¨-foreach-å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„-remove-add-æ“ä½œã€‚-remove-å…ƒç´ è¯·ä½¿ç”¨-Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹-Iterator-å¯¹è±¡åŠ é”ã€‚" class="headerlink" title="17.ä¸è¦åœ¨ foreach å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„ remove/add æ“ä½œã€‚ remove å…ƒç´ è¯·ä½¿ç”¨ Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹ Iterator å¯¹è±¡åŠ é”ã€‚"></a>17.ä¸è¦åœ¨ foreach å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„ remove/add æ“ä½œã€‚ remove å…ƒç´ è¯·ä½¿ç”¨ Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹ Iterator å¯¹è±¡åŠ é”ã€‚</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-22.png" alt=""></p><h2 id="18-â­ï¸ä½¿ç”¨-entrySet-éå†-Map-ç±»é›†åˆ-KVï¼Œè€Œä¸æ˜¯-keySet-æ–¹å¼è¿›è¡Œéå†ã€‚"><a href="#18-â­ï¸ä½¿ç”¨-entrySet-éå†-Map-ç±»é›†åˆ-KVï¼Œè€Œä¸æ˜¯-keySet-æ–¹å¼è¿›è¡Œéå†ã€‚" class="headerlink" title="18.â­ï¸ä½¿ç”¨ entrySet éå† Map ç±»é›†åˆ KVï¼Œè€Œä¸æ˜¯ keySet æ–¹å¼è¿›è¡Œéå†ã€‚"></a>18.â­ï¸ä½¿ç”¨ entrySet éå† Map ç±»é›†åˆ KVï¼Œè€Œä¸æ˜¯ keySet æ–¹å¼è¿›è¡Œéå†ã€‚</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-19.png" alt=""></p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-21.png" alt=""></p><h2 id="19-çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨-Executors-å»åˆ›å»ºï¼Œè€Œæ˜¯é€šThreadPoolExecutor-çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©"><a href="#19-çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨-Executors-å»åˆ›å»ºï¼Œè€Œæ˜¯é€šThreadPoolExecutor-çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©" class="headerlink" title="19.çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©"></a>19.çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</h2><p>è¯´æ˜ï¼š Executors è¿”å›çš„çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p><p>1ï¼‰ FixedThreadPool å’Œ SingleThreadPoolï¼š</p><p>å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p><p>2ï¼‰ CachedThreadPoolï¼š</p><p>å…è®¸çš„åˆ›å»ºçº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUEï¼Œ å¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p><h2 id="20-å¿…é¡»å›æ”¶è‡ªå®šä¹‰çš„-ThreadLocal-å˜é‡"><a href="#20-å¿…é¡»å›æ”¶è‡ªå®šä¹‰çš„-ThreadLocal-å˜é‡" class="headerlink" title="20.å¿…é¡»å›æ”¶è‡ªå®šä¹‰çš„ ThreadLocal å˜é‡"></a>20.å¿…é¡»å›æ”¶è‡ªå®šä¹‰çš„ ThreadLocal å˜é‡</h2><p>å°¤å…¶åœ¨çº¿ç¨‹æ± åœºæ™¯ä¸‹ï¼Œçº¿ç¨‹ç»å¸¸ä¼šè¢«å¤ç”¨ï¼Œå¦‚æœä¸æ¸…ç†è‡ªå®šä¹‰çš„ ThreadLocal å˜é‡ï¼Œå¯èƒ½ä¼šå½±å“åç»­ä¸šåŠ¡é€»è¾‘å’Œé€ æˆå†…å­˜æ³„éœ²ç­‰é—®é¢˜ã€‚å°½é‡åœ¨ä»£ç†ä¸­ä½¿ç”¨ try-finally å—è¿›è¡Œå›æ”¶ã€‚</p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-18.png" alt=""></p><h2 id="21-åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨-try-ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸-try-ä»£ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨-finally-ä¸­æ— æ³•è§£é”ã€‚"><a href="#21-åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨-try-ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸-try-ä»£ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨-finally-ä¸­æ— æ³•è§£é”ã€‚" class="headerlink" title="21.åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨ try ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸ try ä»£ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨ finally ä¸­æ— æ³•è§£é”ã€‚"></a>21.åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨ try ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸ try ä»£ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨ finally ä¸­æ— æ³•è§£é”ã€‚</h2><p><strong>è¯´æ˜ä¸€ï¼š</strong> å¦‚æœåœ¨ lock æ–¹æ³•ä¸ try ä»£ç å—ä¹‹é—´çš„æ–¹æ³•è°ƒç”¨æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæ— æ³•è§£é”ï¼Œé€ æˆå…¶å®ƒçº¿ç¨‹æ— æ³•æˆåŠŸè·å–é”ã€‚</p><p><strong>è¯´æ˜äºŒï¼š</strong> å¦‚æœ lock æ–¹æ³•åœ¨ try ä»£ç å—ä¹‹å†…ï¼Œå¯èƒ½ç”±äºå…¶å®ƒæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´åœ¨ finally ä»£ç å—ä¸­ï¼Œ unlockå¯¹æœªåŠ é”çš„å¯¹è±¡è§£é”ï¼Œå®ƒä¼šè°ƒç”¨ AQS çš„ tryRelease æ–¹æ³•ï¼ˆå–å†³äºå…·ä½“å®ç°ç±»ï¼‰ï¼ŒæŠ›å‡ºllegalMonitorStateException å¼‚å¸¸ã€‚</p><p><strong>è¯´æ˜ä¸‰ï¼š</strong> åœ¨ Lock å¯¹è±¡çš„ lock æ–¹æ³•å®ç°ä¸­å¯èƒ½æŠ›å‡º unchecked å¼‚å¸¸ï¼Œäº§ç”Ÿçš„åæœä¸è¯´æ˜äºŒç›¸åŒã€‚</p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-20.png" alt=""></p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-15.png" alt=""></p><h2 id="22-ä¹è§‚é”ä¸æ‚²è§‚é”çš„é€‰æ‹©"><a href="#22-ä¹è§‚é”ä¸æ‚²è§‚é”çš„é€‰æ‹©" class="headerlink" title="22.ä¹è§‚é”ä¸æ‚²è§‚é”çš„é€‰æ‹©"></a>22.ä¹è§‚é”ä¸æ‚²è§‚é”çš„é€‰æ‹©</h2><p>å¹¶å‘ä¿®æ”¹åŒä¸€è®°å½•æ—¶ï¼Œé¿å…æ›´æ–°ä¸¢å¤±ï¼Œ éœ€è¦åŠ é”ã€‚ è¦ä¹ˆåœ¨åº”ç”¨å±‚åŠ é”ï¼Œè¦ä¹ˆåœ¨ç¼“å­˜åŠ </p><p>é”ï¼Œè¦ä¹ˆåœ¨æ•°æ®åº“å±‚ä½¿ç”¨ä¹è§‚é”ï¼Œä½¿ç”¨ version ä½œä¸ºæ›´æ–°ä¾æ®ã€‚</p><p><strong>è¯´æ˜ï¼š</strong> å¦‚æœæ¯æ¬¡è®¿é—®å†²çªæ¦‚ç‡å°äº 20%ï¼Œæ¨èä½¿ç”¨ä¹è§‚é”ï¼Œå¦åˆ™ä½¿ç”¨æ‚²è§‚é”ã€‚ä¹è§‚é”çš„é‡è¯•æ¬¡æ•°ä¸å¾—å°äº3 æ¬¡ã€‚</p><p><strong>èµ„é‡‘ç›¸å…³çš„é‡‘èæ•æ„Ÿä¿¡æ¯ï¼Œä½¿ç”¨æ‚²è§‚é”ç­–ç•¥ã€‚</strong></p><p>è¯´æ˜ï¼š ä¹è§‚é”åœ¨è·å¾—é”çš„åŒæ—¶å·²ç»å®Œæˆäº†æ›´æ–°æ“ä½œï¼Œæ ¡éªŒé€»è¾‘å®¹æ˜“å‡ºç°æ¼æ´ï¼Œå¦å¤–ï¼Œä¹è§‚é”å¯¹å†²çªçš„è§£å†³ç­–ç•¥æœ‰è¾ƒå¤æ‚çš„è¦æ±‚ï¼Œå¤„ç†ä¸å½“å®¹æ˜“é€ æˆç³»ç»Ÿå‹åŠ›æˆ–æ•°æ®å¼‚å¸¸ï¼Œæ‰€ä»¥èµ„é‡‘ç›¸å…³çš„é‡‘èæ•æ„Ÿä¿¡æ¯ä¸å»ºè®®ä½¿ç”¨ä¹è§‚é”æ›´æ–°ã€‚</p><p>æ­£ä¾‹ï¼š æ‚²è§‚é”éµå¾ªä¸€é”ã€ äºŒåˆ¤ã€ ä¸‰æ›´æ–°ã€ å››é‡Šæ”¾çš„åŸåˆ™ã€‚</p><h2 id="23-ä½¿ç”¨-CountDownLatch-è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œ"><a href="#23-ä½¿ç”¨-CountDownLatch-è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œ" class="headerlink" title="23.ä½¿ç”¨ CountDownLatch è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œ"></a>23.ä½¿ç”¨ CountDownLatch è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œ</h2><p>ä½¿ç”¨ CountDownLatch è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œï¼Œæ¯ä¸ªçº¿ç¨‹é€€å‡ºå‰å¿…é¡»è°ƒç”¨ countDown æ–¹</p><p>æ³•ï¼Œçº¿ç¨‹æ‰§è¡Œä»£ç æ³¨æ„ catch å¼‚å¸¸ï¼Œç¡®ä¿ countDown æ–¹æ³•è¢«æ‰§è¡Œåˆ°ï¼Œé¿å…ä¸»çº¿ç¨‹æ— æ³•æ‰§è¡Œè‡³</p><p>await æ–¹æ³•ï¼Œç›´åˆ°è¶…æ—¶æ‰è¿”å›ç»“æœã€‚</p><p><strong>è¯´æ˜ï¼š</strong> æ³¨æ„ï¼Œå­çº¿ç¨‹æŠ›å‡º<strong>å¼‚å¸¸å †æ ˆ</strong>ï¼Œä¸èƒ½åœ¨ä¸»çº¿ç¨‹ try-catch åˆ°</p><h2 id="24-â­ï¸é¿å…-Random-å®ä¾‹è¢«å¤šçº¿ç¨‹ä½¿ç”¨ï¼Œè™½ç„¶å…±äº«è¯¥å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ä¼šå› ç«äº‰åŒä¸€-seedå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚"><a href="#24-â­ï¸é¿å…-Random-å®ä¾‹è¢«å¤šçº¿ç¨‹ä½¿ç”¨ï¼Œè™½ç„¶å…±äº«è¯¥å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ä¼šå› ç«äº‰åŒä¸€-seedå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚" class="headerlink" title="24.â­ï¸é¿å… Random å®ä¾‹è¢«å¤šçº¿ç¨‹ä½¿ç”¨ï¼Œè™½ç„¶å…±äº«è¯¥å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ä¼šå› ç«äº‰åŒä¸€ seedå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚"></a>24.â­ï¸é¿å… Random å®ä¾‹è¢«å¤šçº¿ç¨‹ä½¿ç”¨ï¼Œè™½ç„¶å…±äº«è¯¥å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ä¼šå› ç«äº‰åŒä¸€ seedå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> Random å®ä¾‹åŒ…æ‹¬ java.util.Random çš„å®ä¾‹æˆ–è€… Math.random()çš„æ–¹å¼ã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> åœ¨ JDK7 ä¹‹åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ API ThreadLocalRandomï¼Œ è€Œåœ¨ JDK7 ä¹‹å‰ï¼Œ éœ€è¦ç¼–ç ä¿è¯æ¯ä¸ªçº¿ç¨‹æŒæœ‰ä¸€ä¸ªå•ç‹¬çš„ Random å®ä¾‹ã€‚</p><h2 id="25-å½“-switch-æ‹¬å·å†…çš„å˜é‡ç±»å‹ä¸º-String-å¹¶ä¸”æ­¤å˜é‡ä¸ºå¤–éƒ¨å‚æ•°æ—¶ï¼Œå¿…é¡»å…ˆè¿›è¡Œ-nullåˆ¤æ–­ã€‚"><a href="#25-å½“-switch-æ‹¬å·å†…çš„å˜é‡ç±»å‹ä¸º-String-å¹¶ä¸”æ­¤å˜é‡ä¸ºå¤–éƒ¨å‚æ•°æ—¶ï¼Œå¿…é¡»å…ˆè¿›è¡Œ-nullåˆ¤æ–­ã€‚" class="headerlink" title="25.å½“ switch æ‹¬å·å†…çš„å˜é‡ç±»å‹ä¸º String å¹¶ä¸”æ­¤å˜é‡ä¸ºå¤–éƒ¨å‚æ•°æ—¶ï¼Œå¿…é¡»å…ˆè¿›è¡Œ nullåˆ¤æ–­ã€‚"></a>25.å½“ switch æ‹¬å·å†…çš„å˜é‡ç±»å‹ä¸º String å¹¶ä¸”æ­¤å˜é‡ä¸ºå¤–éƒ¨å‚æ•°æ—¶ï¼Œå¿…é¡»å…ˆè¿›è¡Œ nullåˆ¤æ–­ã€‚</h2><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-16.png" alt=""></p><h2 id="26-åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œé¿å…ä½¿ç”¨â€-ç­‰äºâ€-åˆ¤æ–­ä½œä¸ºä¸­æ–­æˆ–é€€å‡ºçš„æ¡ä»¶ã€‚"><a href="#26-åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œé¿å…ä½¿ç”¨â€-ç­‰äºâ€-åˆ¤æ–­ä½œä¸ºä¸­æ–­æˆ–é€€å‡ºçš„æ¡ä»¶ã€‚" class="headerlink" title="26.åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œé¿å…ä½¿ç”¨â€ ç­‰äºâ€ åˆ¤æ–­ä½œä¸ºä¸­æ–­æˆ–é€€å‡ºçš„æ¡ä»¶ã€‚"></a>26.åœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œé¿å…ä½¿ç”¨â€ ç­‰äºâ€ åˆ¤æ–­ä½œä¸ºä¸­æ–­æˆ–é€€å‡ºçš„æ¡ä»¶ã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> å¦‚æœå¹¶å‘æ§åˆ¶æ²¡æœ‰å¤„ç†å¥½ï¼Œå®¹æ˜“äº§ç”Ÿç­‰å€¼åˆ¤æ–­è¢«â€œå‡»ç©¿â€ çš„æƒ…å†µï¼Œä½¿ç”¨å¤§äºæˆ–å°äºçš„åŒºé—´åˆ¤æ–­æ¡ä»¶æ¥ä»£æ›¿ã€‚</p><p><strong>åä¾‹ï¼š</strong> åˆ¤æ–­å‰©ä½™å¥–å“æ•°é‡ç­‰äº 0 æ—¶ï¼Œç»ˆæ­¢å‘æ”¾å¥–å“ï¼Œä½†å› ä¸ºå¹¶å‘å¤„ç†é”™è¯¯å¯¼è‡´å¥–å“æ•°é‡ç¬é—´å˜æˆäº†è´Ÿæ•°ï¼Œè¿™æ ·çš„è¯ï¼Œæ´»åŠ¨æ— æ³•ç»ˆæ­¢ã€‚</p><h2 id="27-é¿å…é‡‡ç”¨å–åé€»è¾‘è¿ç®—ç¬¦ã€‚"><a href="#27-é¿å…é‡‡ç”¨å–åé€»è¾‘è¿ç®—ç¬¦ã€‚" class="headerlink" title="27.é¿å…é‡‡ç”¨å–åé€»è¾‘è¿ç®—ç¬¦ã€‚"></a>27.é¿å…é‡‡ç”¨å–åé€»è¾‘è¿ç®—ç¬¦ã€‚</h2><p>è¯´æ˜ï¼š å–åé€»è¾‘ä¸åˆ©äºå¿«é€Ÿç†è§£ï¼Œå¹¶ä¸”å–åé€»è¾‘å†™æ³•ä¸€èˆ¬éƒ½å­˜åœ¨å¯¹åº”çš„æ­£å‘é€»è¾‘å†™æ³•ã€‚</p><p>æ­£ä¾‹ï¼š ä½¿ç”¨ if (x &lt; 628) æ¥è¡¨è¾¾ x å°äº 628ã€‚</p><p>åä¾‹ï¼š ä½¿ç”¨ if (!(x &gt;= 628)) æ¥è¡¨è¾¾ x å°äº 628ã€‚</p><h1 id="äºŒã€æ³¨é‡Šè§„çº¦ï¼š"><a href="#äºŒã€æ³¨é‡Šè§„çº¦ï¼š" class="headerlink" title="äºŒã€æ³¨é‡Šè§„çº¦ï¼š"></a>äºŒã€æ³¨é‡Šè§„çº¦ï¼š</h1><h2 id="1-åŠæ—¶æ¸…ç†ä¸å†ä½¿ç”¨çš„ä»£ç æ®µæˆ–é…ç½®ä¿¡æ¯ã€‚"><a href="#1-åŠæ—¶æ¸…ç†ä¸å†ä½¿ç”¨çš„ä»£ç æ®µæˆ–é…ç½®ä¿¡æ¯ã€‚" class="headerlink" title="1.åŠæ—¶æ¸…ç†ä¸å†ä½¿ç”¨çš„ä»£ç æ®µæˆ–é…ç½®ä¿¡æ¯ã€‚"></a>1.åŠæ—¶æ¸…ç†ä¸å†ä½¿ç”¨çš„ä»£ç æ®µæˆ–é…ç½®ä¿¡æ¯ã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> å¯¹äºåƒåœ¾ä»£ç æˆ–è¿‡æ—¶é…ç½®ï¼Œåšå†³æ¸…ç†å¹²å‡€ï¼Œé¿å…ç¨‹åºè¿‡åº¦è‡ƒè‚¿ï¼Œä»£ç å†—ä½™ã€‚</p><p>æ­£ä¾‹ï¼š å¯¹äºæš‚æ—¶è¢«æ³¨é‡Šæ‰ï¼Œåç»­å¯èƒ½æ¢å¤ä½¿ç”¨çš„ä»£ç ç‰‡æ®µï¼Œåœ¨æ³¨é‡Šä»£ç ä¸Šæ–¹ï¼Œç»Ÿä¸€è§„å®šä½¿ç”¨ä¸‰ä¸ªæ–œæ (///)æ¥è¯´æ˜æ³¨é‡Šæ‰ä»£ç çš„ç†ç”±ã€‚ å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">/// ä¸šåŠ¡æ–¹é€šçŸ¥æ´»åŠ¨æš‚åœ</span></span><br><span class="line">    <span class="comment">// Business business = new Business();</span></span><br><span class="line">    <span class="comment">// business.active();</span></span><br><span class="line">    System.out.println(<span class="string">&quot;it&#x27;s finished&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å‰åç«¯è§„çº¦"><a href="#ä¸‰ã€å‰åç«¯è§„çº¦" class="headerlink" title="ä¸‰ã€å‰åç«¯è§„çº¦"></a>ä¸‰ã€å‰åç«¯è§„çº¦</h1><h2 id="1-å‰åç«¯æ•°æ®åˆ—è¡¨ç›¸å…³çš„æ¥å£è¿”å›ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„-æˆ–ç©ºé›†åˆ"><a href="#1-å‰åç«¯æ•°æ®åˆ—è¡¨ç›¸å…³çš„æ¥å£è¿”å›ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„-æˆ–ç©ºé›†åˆ" class="headerlink" title="1.å‰åç«¯æ•°æ®åˆ—è¡¨ç›¸å…³çš„æ¥å£è¿”å›ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„[]æˆ–ç©ºé›†åˆ{}"></a>1.å‰åç«¯æ•°æ®åˆ—è¡¨ç›¸å…³çš„æ¥å£è¿”å›ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„[]æˆ–ç©ºé›†åˆ{}</h2><p><strong>è¯´æ˜ï¼š&#x20;</strong>&#x6B64;æ¡çº¦å®šæœ‰åˆ©äºæ•°æ®å±‚é¢ä¸Šçš„åä½œæ›´åŠ é«˜æ•ˆï¼Œå‡å°‘å‰ç«¯å¾ˆå¤šçç¢çš„ null åˆ¤æ–­ã€‚</p><h2 id="2-å¯¹äºéœ€è¦ä½¿ç”¨è¶…å¤§æ•´æ•°çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯ä¸€å¾‹ä½¿ç”¨-String-å­—ç¬¦ä¸²ç±»å‹è¿”å›ï¼Œç¦æ­¢ä½¿ç”¨Long-ç±»å‹ã€‚"><a href="#2-å¯¹äºéœ€è¦ä½¿ç”¨è¶…å¤§æ•´æ•°çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯ä¸€å¾‹ä½¿ç”¨-String-å­—ç¬¦ä¸²ç±»å‹è¿”å›ï¼Œç¦æ­¢ä½¿ç”¨Long-ç±»å‹ã€‚" class="headerlink" title="2.å¯¹äºéœ€è¦ä½¿ç”¨è¶…å¤§æ•´æ•°çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯ä¸€å¾‹ä½¿ç”¨ String å­—ç¬¦ä¸²ç±»å‹è¿”å›ï¼Œç¦æ­¢ä½¿ç”¨Long ç±»å‹ã€‚"></a>2.å¯¹äºéœ€è¦ä½¿ç”¨è¶…å¤§æ•´æ•°çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯ä¸€å¾‹ä½¿ç”¨ String å­—ç¬¦ä¸²ç±»å‹è¿”å›ï¼Œç¦æ­¢ä½¿ç”¨Long ç±»å‹ã€‚</h2><h1 id="å››ã€å¼‚å¸¸æ—¥å¿—"><a href="#å››ã€å¼‚å¸¸æ—¥å¿—" class="headerlink" title="å››ã€å¼‚å¸¸æ—¥å¿—"></a>å››ã€å¼‚å¸¸æ—¥å¿—</h1><h2 id="1-äº‹åŠ¡åœºæ™¯ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸è¢«-catch-åï¼Œå¦‚æœéœ€è¦å›æ»šï¼Œä¸€å®šè¦æ³¨æ„æ‰‹åŠ¨å›æ»šäº‹åŠ¡ã€‚"><a href="#1-äº‹åŠ¡åœºæ™¯ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸è¢«-catch-åï¼Œå¦‚æœéœ€è¦å›æ»šï¼Œä¸€å®šè¦æ³¨æ„æ‰‹åŠ¨å›æ»šäº‹åŠ¡ã€‚" class="headerlink" title="1.äº‹åŠ¡åœºæ™¯ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸è¢« catch åï¼Œå¦‚æœéœ€è¦å›æ»šï¼Œä¸€å®šè¦æ³¨æ„æ‰‹åŠ¨å›æ»šäº‹åŠ¡ã€‚"></a>1.äº‹åŠ¡åœºæ™¯ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸è¢« catch åï¼Œå¦‚æœéœ€è¦å›æ»šï¼Œä¸€å®šè¦æ³¨æ„æ‰‹åŠ¨å›æ»šäº‹åŠ¡ã€‚</h2><h2 id="2-ä¸è¦åœ¨-finally-å—ä¸­ä½¿ç”¨-returnã€‚"><a href="#2-ä¸è¦åœ¨-finally-å—ä¸­ä½¿ç”¨-returnã€‚" class="headerlink" title="2.ä¸è¦åœ¨ finally å—ä¸­ä½¿ç”¨ returnã€‚"></a>2.ä¸è¦åœ¨ finally å—ä¸­ä½¿ç”¨ returnã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> try å—ä¸­çš„ return è¯­å¥æ‰§è¡ŒæˆåŠŸåï¼Œå¹¶ä¸é©¬ä¸Šè¿”å›ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œ finally å—ä¸­çš„è¯­å¥ï¼Œå¦‚æœæ­¤å¤„å­˜åœ¨ return è¯­å¥ï¼Œåˆ™åœ¨æ­¤ç›´æ¥è¿”å›ï¼Œæ— æƒ…ä¸¢å¼ƒæ‰ try å—ä¸­çš„è¿”å›ç‚¹ã€‚</p><p><img src="2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“/image-17.png" alt=""></p><h2 id="3-é˜²æ­¢-NPEï¼Œæ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ä¿®å…»ï¼Œæ³¨æ„-NPE-äº§ç”Ÿçš„åœºæ™¯ï¼š"><a href="#3-é˜²æ­¢-NPEï¼Œæ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ä¿®å…»ï¼Œæ³¨æ„-NPE-äº§ç”Ÿçš„åœºæ™¯ï¼š" class="headerlink" title="3.é˜²æ­¢ NPEï¼Œæ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ä¿®å…»ï¼Œæ³¨æ„ NPE äº§ç”Ÿçš„åœºæ™¯ï¼š"></a>3.é˜²æ­¢ NPEï¼Œæ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ä¿®å…»ï¼Œæ³¨æ„ NPE äº§ç”Ÿçš„åœºæ™¯ï¼š</h2><p>1ï¼‰ è¿”å›ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œ return åŒ…è£…æ•°æ®ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œè‡ªåŠ¨æ‹†ç®±æœ‰å¯èƒ½äº§ç”Ÿ NPEã€‚</p><p>åä¾‹ï¼š public int f() { return Integer å¯¹è±¡}ï¼Œ å¦‚æœä¸º nullï¼Œè‡ªåŠ¨è§£ç®±æŠ› NPEã€‚</p><p>2ï¼‰ æ•°æ®åº“çš„æŸ¥è¯¢ç»“æœå¯èƒ½ä¸º nullã€‚</p><p>3ï¼‰ é›†åˆé‡Œçš„å…ƒç´ å³ä½¿ isNotEmptyï¼Œå–å‡ºçš„æ•°æ®å…ƒç´ ä¹Ÿå¯èƒ½ä¸º nullã€‚</p><p>4ï¼‰ è¿œç¨‹è°ƒç”¨è¿”å›å¯¹è±¡æ—¶ï¼Œä¸€å¾‹è¦æ±‚è¿›è¡Œç©ºæŒ‡é’ˆåˆ¤æ–­ï¼Œé˜²æ­¢ NPEã€‚</p><p>5ï¼‰ å¯¹äº Session ä¸­è·å–çš„æ•°æ®ï¼Œå»ºè®®è¿›è¡Œ NPE æ£€æŸ¥ï¼Œé¿å…ç©ºæŒ‡é’ˆã€‚</p><p>6ï¼‰ çº§è”è°ƒç”¨ obj.getA().getB().getC()ï¼›ä¸€è¿ä¸²è°ƒç”¨ï¼Œæ˜“äº§ç”Ÿ NPEã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> ä½¿ç”¨ JDK8 çš„ Optional ç±»æ¥é˜²æ­¢ NPE é—®é¢˜</p><h2 id="4-åœ¨æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå­—ç¬¦ä¸²å˜é‡ä¹‹é—´çš„æ‹¼æ¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼ã€‚"><a href="#4-åœ¨æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå­—ç¬¦ä¸²å˜é‡ä¹‹é—´çš„æ‹¼æ¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼ã€‚" class="headerlink" title="4.åœ¨æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå­—ç¬¦ä¸²å˜é‡ä¹‹é—´çš„æ‹¼æ¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼ã€‚"></a>4.åœ¨æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå­—ç¬¦ä¸²å˜é‡ä¹‹é—´çš„æ‹¼æ¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼ã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> å› ä¸º String å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¼šä½¿ç”¨ StringBuilder çš„ append()æ–¹å¼ï¼Œæœ‰ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚ä½¿ç”¨å ä½ç¬¦ä»…æ˜¯æ›¿æ¢åŠ¨ä½œï¼Œå¯ä»¥æœ‰æ•ˆæå‡æ€§èƒ½ã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> logger.debug(â€œProcessing trade with id: {} and symbol: {}â€, id, symbol);</p><h2 id="5-ç”Ÿäº§ç¯å¢ƒç¦æ­¢ç›´æ¥ä½¿ç”¨-System-out-æˆ–-System-err-è¾“å‡ºæ—¥å¿—æˆ–ä½¿ç”¨e-printStackTrace-æ‰“å°å¼‚å¸¸å †æ ˆã€‚"><a href="#5-ç”Ÿäº§ç¯å¢ƒç¦æ­¢ç›´æ¥ä½¿ç”¨-System-out-æˆ–-System-err-è¾“å‡ºæ—¥å¿—æˆ–ä½¿ç”¨e-printStackTrace-æ‰“å°å¼‚å¸¸å †æ ˆã€‚" class="headerlink" title="5.ç”Ÿäº§ç¯å¢ƒç¦æ­¢ç›´æ¥ä½¿ç”¨ System.out æˆ– System.err è¾“å‡ºæ—¥å¿—æˆ–ä½¿ç”¨e.printStackTrace()æ‰“å°å¼‚å¸¸å †æ ˆã€‚"></a>5.ç”Ÿäº§ç¯å¢ƒç¦æ­¢ç›´æ¥ä½¿ç”¨ System.out æˆ– System.err è¾“å‡ºæ—¥å¿—æˆ–ä½¿ç”¨e.printStackTrace()æ‰“å°å¼‚å¸¸å †æ ˆã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> æ ‡å‡†æ—¥å¿—è¾“å‡ºä¸æ ‡å‡†é”™è¯¯è¾“å‡ºæ–‡ä»¶æ¯æ¬¡ Jboss é‡å¯æ—¶æ‰æ»šåŠ¨ï¼Œå¦‚æœå¤§é‡è¾“å‡ºé€å¾€è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå®¹æ˜“é€ æˆæ–‡ä»¶å¤§å°è¶…è¿‡æ“ä½œç³»ç»Ÿå¤§å°é™åˆ¶ã€‚</p><h1 id="äº”ï¼Œå®‰å…¨è§„çº¦"><a href="#äº”ï¼Œå®‰å…¨è§„çº¦" class="headerlink" title="äº”ï¼Œå®‰å…¨è§„çº¦"></a>äº”ï¼Œå®‰å…¨è§„çº¦</h1><h2 id="x20-1-ç”¨æˆ·è¾“å…¥çš„-SQL-å‚æ•°ä¸¥æ ¼ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–è€…-METADATA-å­—æ®µå€¼é™å®šï¼Œé˜²æ­¢-SQL-æ³¨å…¥ï¼Œç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥-SQL-è®¿é—®æ•°æ®åº“ã€‚"><a href="#x20-1-ç”¨æˆ·è¾“å…¥çš„-SQL-å‚æ•°ä¸¥æ ¼ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–è€…-METADATA-å­—æ®µå€¼é™å®šï¼Œé˜²æ­¢-SQL-æ³¨å…¥ï¼Œç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥-SQL-è®¿é—®æ•°æ®åº“ã€‚" class="headerlink" title="&#x20;1.ç”¨æˆ·è¾“å…¥çš„ SQL å‚æ•°ä¸¥æ ¼ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–è€… METADATA å­—æ®µå€¼é™å®šï¼Œé˜²æ­¢ SQL æ³¨å…¥ï¼Œç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥ SQL è®¿é—®æ•°æ®åº“ã€‚"></a>&#x20;1.ç”¨æˆ·è¾“å…¥çš„ SQL å‚æ•°ä¸¥æ ¼ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–è€… METADATA å­—æ®µå€¼é™å®šï¼Œé˜²æ­¢ SQL æ³¨å…¥ï¼Œç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥ SQL è®¿é—®æ•°æ®åº“ã€‚</h2><p><strong>åä¾‹ï¼š</strong> æŸç³»ç»Ÿç­¾åå¤§é‡è¢«æ¶æ„ä¿®æ”¹ï¼Œå³æ˜¯å› ä¸ºå¯¹äºå±é™©å­—ç¬¦ # â€”æ²¡æœ‰è¿›è¡Œè½¬ä¹‰ï¼Œå¯¼è‡´æ•°æ®åº“æ›´æ–°æ—¶ï¼Œ whereåè¾¹çš„ä¿¡æ¯è¢«æ³¨é‡Šæ‰ï¼Œå¯¹å…¨åº“è¿›è¡Œæ›´æ–°ã€‚</p><h2 id="2-ç”¨æˆ·è¯·æ±‚ä¼ å…¥çš„ä»»ä½•å‚æ•°å¿…é¡»åšæœ‰æ•ˆæ€§éªŒè¯ã€‚"><a href="#2-ç”¨æˆ·è¯·æ±‚ä¼ å…¥çš„ä»»ä½•å‚æ•°å¿…é¡»åšæœ‰æ•ˆæ€§éªŒè¯ã€‚" class="headerlink" title="2.ç”¨æˆ·è¯·æ±‚ä¼ å…¥çš„ä»»ä½•å‚æ•°å¿…é¡»åšæœ‰æ•ˆæ€§éªŒè¯ã€‚"></a>2.ç”¨æˆ·è¯·æ±‚ä¼ å…¥çš„ä»»ä½•å‚æ•°å¿…é¡»åšæœ‰æ•ˆæ€§éªŒè¯ã€‚</h2><p><strong>è¯´æ˜ï¼š å¿½ç•¥å‚æ•°æ ¡éªŒå¯èƒ½å¯¼è‡´ï¼š</strong></p><p>âš« page size è¿‡å¤§å¯¼è‡´å†…å­˜æº¢å‡º</p><p>âš« æ¶æ„ order by å¯¼è‡´æ•°æ®åº“æ…¢æŸ¥è¯¢</p><p>âš« ç¼“å­˜å‡»ç©¿</p><p>âš« SSRF</p><p>âš« ä»»æ„é‡å®šå‘</p><p>âš« SQL æ³¨å…¥ï¼Œ Shell æ³¨å…¥ï¼Œ ååºåˆ—åŒ–æ³¨å…¥</p><p>âš« æ­£åˆ™è¾“å…¥æºä¸²æ‹’ç»æœåŠ¡ ReDoS</p><p>Java ä»£ç ç”¨æ­£åˆ™æ¥éªŒè¯å®¢æˆ·ç«¯çš„è¾“å…¥ï¼Œæœ‰äº›æ­£åˆ™å†™æ³•éªŒè¯æ™®é€šç”¨æˆ·è¾“å…¥æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæ”»å‡»äººå‘˜ä½¿ç”¨çš„æ˜¯ç‰¹æ®Šæ„é€ çš„å­—ç¬¦ä¸²æ¥éªŒè¯ï¼Œæœ‰å¯èƒ½å¯¼è‡´æ­»å¾ªç¯çš„ç»“æœ</p><h1 id="å…­ã€æ•°æ®åº“è§„çº¦"><a href="#å…­ã€æ•°æ®åº“è§„çº¦" class="headerlink" title="å…­ã€æ•°æ®åº“è§„çº¦"></a>å…­ã€æ•°æ®åº“è§„çº¦</h1><h2 id="1-è¡¨è¾¾æ˜¯ä¸å¦æ¦‚å¿µçš„å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨-is-xxx-çš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹æ˜¯-unsigned-tinyint"><a href="#1-è¡¨è¾¾æ˜¯ä¸å¦æ¦‚å¿µçš„å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨-is-xxx-çš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹æ˜¯-unsigned-tinyint" class="headerlink" title="1.è¡¨è¾¾æ˜¯ä¸å¦æ¦‚å¿µçš„å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨ is_xxx çš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹æ˜¯ unsigned tinyint"></a>1.è¡¨è¾¾æ˜¯ä¸å¦æ¦‚å¿µçš„å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨ is_xxx çš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹æ˜¯ unsigned tinyint</h2><p><strong>è¯´æ˜ï¼š</strong> ä»»ä½•å­—æ®µå¦‚æœä¸ºéè´Ÿæ•°ï¼Œå¿…é¡»æ˜¯ unsignedã€‚</p><p><strong>æ³¨æ„ï¼š</strong> POJO ç±»ä¸­çš„ä»»ä½•å¸ƒå°”ç±»å‹çš„å˜é‡ï¼Œéƒ½ä¸è¦åŠ  is å‰ç¼€ï¼Œæ‰€ä»¥ï¼Œéœ€è¦åœ¨\<resultMap>è®¾ç½®ä» is_xxx åˆ°Xxx çš„æ˜ å°„å…³ç³»ã€‚æ•°æ®åº“è¡¨ç¤ºæ˜¯ä¸å¦çš„å€¼ï¼Œä½¿ç”¨ tinyint ç±»å‹ï¼ŒåšæŒ is_xxx çš„å‘½åæ–¹å¼æ˜¯ä¸ºäº†æ˜ç¡®å…¶å–å€¼å«ä¹‰ä¸å–å€¼èŒƒå›´ã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> è¡¨è¾¾é€»è¾‘åˆ é™¤çš„å­—æ®µå is_deletedï¼Œ 1 è¡¨ç¤ºåˆ é™¤ï¼Œ 0 è¡¨ç¤ºæœªåˆ é™¤ã€‚</p><h2 id="2-ç´¢å¼•å‘½å"><a href="#2-ç´¢å¼•å‘½å" class="headerlink" title="2.ç´¢å¼•å‘½å"></a>2.ç´¢å¼•å‘½å</h2><p>ä¸»é”®ç´¢å¼•åä¸º pk_å­—æ®µåï¼›å”¯ä¸€ç´¢å¼•åä¸º uk_å­—æ®µåï¼› æ™®é€šç´¢å¼•ååˆ™ä¸º idx_å­—æ®µåã€‚</p><p>è¯´æ˜ï¼š pk_ å³ primary keyï¼› uk_ å³ unique keyï¼› idx_ å³ index çš„ç®€ç§°ã€‚</p><h2 id="3-å°æ•°ç±»å‹ä¸º-decimalï¼Œç¦æ­¢ä½¿ç”¨-float-å’Œ-doubleã€‚"><a href="#3-å°æ•°ç±»å‹ä¸º-decimalï¼Œç¦æ­¢ä½¿ç”¨-float-å’Œ-doubleã€‚" class="headerlink" title="3.å°æ•°ç±»å‹ä¸º decimalï¼Œç¦æ­¢ä½¿ç”¨ float å’Œ doubleã€‚"></a>3.å°æ•°ç±»å‹ä¸º decimalï¼Œç¦æ­¢ä½¿ç”¨ float å’Œ doubleã€‚</h2><p>è¯´æ˜ï¼š åœ¨å­˜å‚¨çš„æ—¶å€™ï¼Œ float å’Œ double éƒ½å­˜åœ¨ç²¾åº¦æŸå¤±çš„é—®é¢˜ï¼Œå¾ˆå¯èƒ½åœ¨æ¯”è¾ƒå€¼çš„æ—¶å€™ï¼Œå¾—åˆ°ä¸æ­£ç¡®çš„ç»“æœã€‚å¦‚æœå­˜å‚¨çš„æ•°æ®èŒƒå›´è¶…è¿‡ decimal çš„èŒƒå›´ï¼Œå»ºè®®å°†æ•°æ®æ‹†æˆæ•´æ•°å’Œå°æ•°å¹¶åˆ†å¼€å­˜å‚¨ã€‚</p><h2 id="4-varcharä½¿ç”¨"><a href="#4-varcharä½¿ç”¨" class="headerlink" title="4.varcharä½¿ç”¨"></a>4.varcharä½¿ç”¨</h2><p>varchar æ˜¯å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œä¸é¢„å…ˆåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œé•¿åº¦ä¸è¦è¶…è¿‡ 5000ï¼Œå¦‚æœå­˜å‚¨é•¿åº¦å¤§äºæ­¤å€¼ï¼Œå®šä¹‰å­—æ®µç±»å‹ä¸º textï¼Œç‹¬ç«‹å‡ºæ¥ä¸€å¼ è¡¨ï¼Œç”¨ä¸»é”®æ¥å¯¹åº”ï¼Œé¿å…å½±å“å…¶å®ƒå­—æ®µç´¢å¼•æ•ˆç‡</p><h2 id="5-è¡¨å¿…å¤‡ä¸‰å­—æ®µï¼š-id-create-time-update-time"><a href="#5-è¡¨å¿…å¤‡ä¸‰å­—æ®µï¼š-id-create-time-update-time" class="headerlink" title="5.è¡¨å¿…å¤‡ä¸‰å­—æ®µï¼š id, create_time, update_time"></a>5.è¡¨å¿…å¤‡ä¸‰å­—æ®µï¼š id, create_time, update_time</h2><p>è¯´æ˜ï¼š å…¶ä¸­ id å¿…ä¸ºä¸»é”®ï¼Œç±»å‹ä¸º bigint unsignedã€å•è¡¨æ—¶è‡ªå¢ã€æ­¥é•¿ä¸º 1ã€‚ create_time, update_timeçš„ç±»å‹å‡ä¸º datetime ç±»å‹ï¼Œå‰è€…ç°åœ¨æ—¶è¡¨ç¤ºä¸»åŠ¨å¼åˆ›å»ºï¼Œåè€…è¿‡å»åˆ†è¯è¡¨ç¤ºè¢«åŠ¨å¼æ›´æ–°ã€‚</p><h2 id="6-ä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯ç»„åˆå­—æ®µï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•"><a href="#6-ä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯ç»„åˆå­—æ®µï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•" class="headerlink" title="6.ä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯ç»„åˆå­—æ®µï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•"></a>6.ä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯ç»„åˆå­—æ®µï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•</h2><p><strong>è¯´æ˜ï¼š</strong> ä¸è¦ä»¥ä¸ºå”¯ä¸€ç´¢å¼•å½±å“äº† insert é€Ÿåº¦ï¼Œè¿™ä¸ªé€Ÿåº¦æŸè€—å¯ä»¥å¿½ç•¥ï¼Œä½†æé«˜æŸ¥æ‰¾é€Ÿåº¦æ˜¯æ˜æ˜¾çš„ï¼› å¦å¤–ï¼Œå³ä½¿åœ¨åº”ç”¨å±‚åšäº†éå¸¸å®Œå–„çš„æ ¡éªŒæ§åˆ¶ï¼Œåªè¦æ²¡æœ‰å”¯ä¸€ç´¢å¼•ï¼Œæ ¹æ®å¢¨è²å®šå¾‹ï¼Œå¿…ç„¶æœ‰è„æ•°æ®äº§ç”Ÿã€‚</p><h2 id="7-åˆ©ç”¨è¦†ç›–ç´¢å¼•æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ-é¿å…å›è¡¨ã€‚"><a href="#7-åˆ©ç”¨è¦†ç›–ç´¢å¼•æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ-é¿å…å›è¡¨ã€‚" class="headerlink" title="7.åˆ©ç”¨è¦†ç›–ç´¢å¼•æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ é¿å…å›è¡¨ã€‚"></a>7.åˆ©ç”¨è¦†ç›–ç´¢å¼•æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ é¿å…å›è¡¨ã€‚</h2><p><strong>è¯´æ˜ï¼š</strong> å¦‚æœä¸€æœ¬ä¹¦éœ€è¦çŸ¥é“ç¬¬ 11 ç« æ˜¯ä»€ä¹ˆæ ‡é¢˜ï¼Œä¼šç¿»å¼€ç¬¬ 11 ç« å¯¹åº”çš„é‚£ä¸€é¡µå—ï¼Ÿç›®å½•æµè§ˆä¸€ä¸‹å°±å¥½ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯èµ·åˆ°è¦†ç›–ç´¢å¼•çš„ä½œç”¨ã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> èƒ½å¤Ÿå»ºç«‹ç´¢å¼•çš„ç§ç±»åˆ†ä¸ºä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€æ™®é€šç´¢å¼•ä¸‰ç§ï¼Œè€Œè¦†ç›–ç´¢å¼•åªæ˜¯ä¸€ç§æŸ¥è¯¢çš„ä¸€ç§æ•ˆæœï¼Œç”¨ explain çš„ç»“æœï¼Œ extra åˆ—ä¼šå‡ºç°ï¼š using indexã€‚</p><h2 id="8-â­ï¸åˆ©ç”¨å»¶è¿Ÿå…³è”æˆ–è€…å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯"><a href="#8-â­ï¸åˆ©ç”¨å»¶è¿Ÿå…³è”æˆ–è€…å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯" class="headerlink" title="8.â­ï¸åˆ©ç”¨å»¶è¿Ÿå…³è”æˆ–è€…å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯"></a>8.â­ï¸åˆ©ç”¨å»¶è¿Ÿå…³è”æˆ–è€…å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯</h2><p><strong>è¯´æ˜ï¼š</strong> MySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQLæ”¹å†™ã€‚</p><p><strong>æ­£ä¾‹ï¼š</strong> å…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”ï¼š</p><p>SELECT t1.* FROM è¡¨ 1 as t1, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) as t2 where t1.id=t2.id</p><h2 id="9-å½“æŸä¸€åˆ—çš„å€¼å…¨æ˜¯-NULL-æ—¶ï¼Œ-count-col-çš„è¿”å›ç»“æœä¸º-0ï¼Œä½†-sum-col-çš„è¿”å›ç»“æœä¸ºNULLï¼Œå› æ­¤ä½¿ç”¨-sum-æ—¶éœ€æ³¨æ„-NPE-é—®é¢˜ã€‚"><a href="#9-å½“æŸä¸€åˆ—çš„å€¼å…¨æ˜¯-NULL-æ—¶ï¼Œ-count-col-çš„è¿”å›ç»“æœä¸º-0ï¼Œä½†-sum-col-çš„è¿”å›ç»“æœä¸ºNULLï¼Œå› æ­¤ä½¿ç”¨-sum-æ—¶éœ€æ³¨æ„-NPE-é—®é¢˜ã€‚" class="headerlink" title="9.å½“æŸä¸€åˆ—çš„å€¼å…¨æ˜¯ NULL æ—¶ï¼Œ count(col)çš„è¿”å›ç»“æœä¸º 0ï¼Œä½† sum(col)çš„è¿”å›ç»“æœä¸ºNULLï¼Œå› æ­¤ä½¿ç”¨ sum()æ—¶éœ€æ³¨æ„ NPE é—®é¢˜ã€‚"></a>9.å½“æŸä¸€åˆ—çš„å€¼å…¨æ˜¯ NULL æ—¶ï¼Œ count(col)çš„è¿”å›ç»“æœä¸º 0ï¼Œä½† sum(col)çš„è¿”å›ç»“æœä¸ºNULLï¼Œå› æ­¤ä½¿ç”¨ sum()æ—¶éœ€æ³¨æ„ NPE é—®é¢˜ã€‚</h2><p><strong>æ­£ä¾‹ï¼š</strong> å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥é¿å… sum çš„ NPE é—®é¢˜ï¼š SELECT IFNULL(SUM(column), 0) FROM table;</p><h2 id="10-ä½¿ç”¨-ISNULL-æ¥åˆ¤æ–­æ˜¯å¦ä¸º-NULL-å€¼"><a href="#10-ä½¿ç”¨-ISNULL-æ¥åˆ¤æ–­æ˜¯å¦ä¸º-NULL-å€¼" class="headerlink" title="10.ä½¿ç”¨ ISNULL()æ¥åˆ¤æ–­æ˜¯å¦ä¸º NULL å€¼"></a>10.ä½¿ç”¨ ISNULL()æ¥åˆ¤æ–­æ˜¯å¦ä¸º NULL å€¼</h2><p><strong>è¯´æ˜ï¼š</strong> NULL ä¸ä»»ä½•å€¼çš„ç›´æ¥æ¯”è¾ƒéƒ½ä¸º NULLã€‚</p><p>1ï¼‰ NULL&lt;&gt;NULL çš„è¿”å›ç»“æœæ˜¯ NULLï¼Œ è€Œä¸æ˜¯ falseã€‚</p><p>2ï¼‰ NULL=NULL çš„è¿”å›ç»“æœæ˜¯ NULLï¼Œ è€Œä¸æ˜¯ trueã€‚</p><p>3ï¼‰ NULL&lt;&gt;1 çš„è¿”å›ç»“æœæ˜¯ NULLï¼Œè€Œä¸æ˜¯ trueã€‚</p><p><strong>åä¾‹ï¼š</strong> åœ¨ SQL è¯­å¥ä¸­ï¼Œå¦‚æœåœ¨ null å‰æ¢è¡Œï¼Œå½±å“å¯è¯»æ€§ã€‚ select * from table where column1 is null and column3 is not null; è€Œ<code>ISNULL(column)</code>æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œç®€æ´æ˜“æ‡‚ã€‚ä»æ€§èƒ½æ•°æ®ä¸Šåˆ†æï¼Œ <code>ISNULL(column)</code>æ‰§è¡Œæ•ˆç‡æ›´å¿«ä¸€äº›ã€‚</p><h2 id="11-â­ï¸æ•°æ®åº“å±‚é¢ç¦æ­¢ä½¿ç”¨"><a href="#11-â­ï¸æ•°æ®åº“å±‚é¢ç¦æ­¢ä½¿ç”¨" class="headerlink" title="11.â­ï¸æ•°æ®åº“å±‚é¢ç¦æ­¢ä½¿ç”¨"></a><strong>11.â­ï¸æ•°æ®åº“å±‚é¢ç¦æ­¢ä½¿ç”¨</strong></h2><h3 id="ï¼ˆ1ï¼‰ä¸å¾—ä½¿ç”¨å¤–é”®ä¸çº§è”ï¼Œä¸€åˆ‡å¤–é”®æ¦‚å¿µå¿…é¡»åœ¨åº”ç”¨å±‚è§£å†³ã€‚"><a href="#ï¼ˆ1ï¼‰ä¸å¾—ä½¿ç”¨å¤–é”®ä¸çº§è”ï¼Œä¸€åˆ‡å¤–é”®æ¦‚å¿µå¿…é¡»åœ¨åº”ç”¨å±‚è§£å†³ã€‚" class="headerlink" title="ï¼ˆ1ï¼‰ä¸å¾—ä½¿ç”¨å¤–é”®ä¸çº§è”ï¼Œä¸€åˆ‡å¤–é”®æ¦‚å¿µå¿…é¡»åœ¨åº”ç”¨å±‚è§£å†³ã€‚"></a>ï¼ˆ1ï¼‰ä¸å¾—ä½¿ç”¨å¤–é”®ä¸çº§è”ï¼Œä¸€åˆ‡å¤–é”®æ¦‚å¿µå¿…é¡»åœ¨åº”ç”¨å±‚è§£å†³ã€‚</h3><p><strong>è¯´æ˜ï¼š</strong> å­¦ç”Ÿè¡¨ä¸­çš„ student_id æ˜¯ä¸»é”®ï¼Œé‚£ä¹ˆæˆç»©è¡¨ä¸­çš„ student_id åˆ™ä¸ºå¤–é”®ã€‚å¦‚æœæ›´æ–°å­¦ç”Ÿè¡¨ä¸­çš„ student_idï¼ŒåŒæ—¶è§¦å‘æˆç»©è¡¨ä¸­çš„ student_id æ›´æ–°ï¼Œ å³ä¸ºçº§è”æ›´æ–°ã€‚å¤–é”®ä¸çº§è”æ›´æ–°é€‚ç”¨äºå•æœºä½å¹¶å‘ï¼Œä¸é€‚åˆåˆ†å¸ƒå¼ã€é«˜å¹¶å‘é›†ç¾¤ï¼›çº§è”æ›´æ–°æ˜¯å¼ºé˜»å¡ï¼Œå­˜åœ¨æ•°æ®åº“æ›´æ–°é£æš´çš„é£é™©ï¼›å¤–é”®å½±å“æ•°æ®åº“çš„æ’å…¥é€Ÿåº¦ã€‚</p><h3 id="ï¼ˆ2ï¼‰ç¦æ­¢ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹éš¾ä»¥è°ƒè¯•å’Œæ‰©å±•ï¼Œæ›´æ²¡æœ‰ç§»æ¤æ€§"><a href="#ï¼ˆ2ï¼‰ç¦æ­¢ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹éš¾ä»¥è°ƒè¯•å’Œæ‰©å±•ï¼Œæ›´æ²¡æœ‰ç§»æ¤æ€§" class="headerlink" title="ï¼ˆ2ï¼‰ç¦æ­¢ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹éš¾ä»¥è°ƒè¯•å’Œæ‰©å±•ï¼Œæ›´æ²¡æœ‰ç§»æ¤æ€§"></a>ï¼ˆ2ï¼‰ç¦æ­¢ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹éš¾ä»¥è°ƒè¯•å’Œæ‰©å±•ï¼Œæ›´æ²¡æœ‰ç§»æ¤æ€§</h3><h2 id="12-åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œä¸€å¾‹ä¸è¦ä½¿ç”¨-ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œéœ€è¦å“ªäº›å­—æ®µå¿…é¡»æ˜ç¡®å†™æ˜"><a href="#12-åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œä¸€å¾‹ä¸è¦ä½¿ç”¨-ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œéœ€è¦å“ªäº›å­—æ®µå¿…é¡»æ˜ç¡®å†™æ˜" class="headerlink" title="12. åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œä¸€å¾‹ä¸è¦ä½¿ç”¨ * ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œéœ€è¦å“ªäº›å­—æ®µå¿…é¡»æ˜ç¡®å†™æ˜"></a>12. åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œä¸€å¾‹ä¸è¦ä½¿ç”¨ * ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œéœ€è¦å“ªäº›å­—æ®µå¿…é¡»æ˜ç¡®å†™æ˜</h2><p><strong>è¯´æ˜ï¼š</strong> 1ï¼‰å¢åŠ æŸ¥è¯¢åˆ†æå™¨è§£ææˆæœ¬ã€‚ 2ï¼‰å¢å‡å­—æ®µå®¹æ˜“ä¸ resultMap é…ç½®ä¸ä¸€è‡´ã€‚ 3ï¼‰æ— ç”¨å­—æ®µå¢åŠ ç½‘ç»œæ¶ˆè€—ï¼Œå°¤å…¶æ˜¯ text ç±»å‹çš„å­—æ®µ</p>]]></content>
    
    
    <summary type="html">ğŸ¥§é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="å¼€å‘è§„èŒƒ" scheme="https://outoflovenicoo.github.io/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>Redisé¢è¯•é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-Redis%E9%9D%A2%E8%AF%95%E9%A2%98.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-Redis%E9%9D%A2%E8%AF%95%E9%A2%98.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h1><h2 id="1-å¤§keyçƒ­keyé—®é¢˜"><a href="#1-å¤§keyçƒ­keyé—®é¢˜" class="headerlink" title="1.å¤§keyçƒ­keyé—®é¢˜"></a>1.å¤§keyçƒ­keyé—®é¢˜</h2><blockquote><p><a href="https://xiaolincoding.com/redis/storage/bigkey_aof_rdb.html">Redis å¤§ Key å¯¹æŒä¹…åŒ–æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</a></p><p><a href="https://www.cnblogs.com/rjzheng/p/10874537.html">ã€åŸåˆ›ã€‘è°ˆè°ˆredisçš„çƒ­keyé—®é¢˜å¦‚ä½•è§£å†³ - å­¤ç‹¬çƒŸ - åšå®¢å›­</a></p><p><a href="https://xiaolincoding.com/redis/cluster/cache_problem.html">ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©ã€å‡»ç©¿ã€ç©¿é€ï¼Ÿ</a></p></blockquote><p><img src="2025-01-09-Redisé¢è¯•é¢˜/diagram.png" alt=""></p><h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><h2 id="1-è¯´è¯´ä½ å¯¹Redisçš„ç†è§£"><a href="#1-è¯´è¯´ä½ å¯¹Redisçš„ç†è§£" class="headerlink" title="1. è¯´è¯´ä½ å¯¹Redisçš„ç†è§£"></a>1. è¯´è¯´ä½ å¯¹Redisçš„ç†è§£</h2><p>Redisæ˜¯ä¸€ä¸ªåŸºäºKey - Valueå­˜å‚¨ç»“æ„çš„å¼€æºå†…å­˜æ•°æ®åº“ï¼Œä¹Ÿæ˜¯ä¸€ç§NoSQLæ•°æ®åº“ã€‚</p><p>å®ƒæ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬Stringã€Mapã€Setã€ZSetå’ŒListï¼Œä»¥æ»¡è¶³ä¸åŒåº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚</p><p>Redisä»¥å†…å­˜å­˜å‚¨å’Œä¼˜åŒ–çš„æ•°æ®ç»“æ„ä¸ºåŸºç¡€ï¼Œæä¾›äº†å¿«é€Ÿçš„è¯»å†™æ€§èƒ½å’Œé«˜æ•ˆçš„æ•°æ®è®¿é—®ã€‚å¸¸è¢«ç”¨ä½œåº”ç”¨ä¸æ•°æ®åº“ä¹‹é—´çš„ç¼“å­˜ç»„ä»¶ï¼Œæå‡æ•°æ®IOæ•ˆç‡ã€‚</p><p>æ­¤å¤–ï¼ŒRedisæ”¯æŒä¸»ä»å¤åˆ¶ã€å“¨å…µæœºåˆ¶å’Œé›†ç¾¤æ–¹å¼ï¼Œå®ç°é«˜å¯ç”¨æ€§å’Œæ°´å¹³æ‰©å±•ã€‚&#x20;</p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image2.png" alt=""></p><ol><li><p><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šä¸»ä»å¤åˆ¶æ˜¯Redisæœ€åŸºæœ¬çš„é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå®ƒé€šè¿‡å°†ä¸€ä¸ªRediså®ä¾‹ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œå°†å¤šä¸ªRediså®ä¾‹ä½œä¸ºä»èŠ‚ç‚¹ï¼Œå®ç°æ•°æ®çš„åŒæ­¥å¤åˆ¶ã€‚ä¸»èŠ‚ç‚¹è´Ÿè´£å†™å…¥æ•°æ®ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»å–æ•°æ®ï¼Œå½“ä¸»èŠ‚ç‚¹å®•æœºæ—¶ï¼Œä»èŠ‚ç‚¹å¯ä»¥è‡ªåŠ¨åˆ‡æ¢æˆä¸»èŠ‚ç‚¹ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p></li><li><p><strong>å“¨å…µæœºåˆ¶</strong>ï¼šå“¨å…µæœºåˆ¶æ˜¯Redisæä¾›çš„ä¸€ç§è‡ªåŠ¨æ•…éšœè½¬ç§»æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥ç›‘æ§ä¸»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå½“ä¸»èŠ‚ç‚¹å®•æœºæ—¶ï¼Œè‡ªåŠ¨å°†ä»èŠ‚ç‚¹åˆ‡æ¢æˆä¸»èŠ‚ç‚¹ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚å“¨å…µæœºåˆ¶è¿˜å¯ä»¥ç›‘æ§ä»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå½“ä»èŠ‚ç‚¹å®•æœºæ—¶ï¼Œè‡ªåŠ¨å°†ä»å…¶ä»–ä»èŠ‚ç‚¹ä¸­é€‰ä¸¾ä¸€ä¸ªèŠ‚ç‚¹åˆ‡æ¢æˆä¸»èŠ‚ç‚¹ã€‚</p></li><li><p><strong>é›†ç¾¤æ–¹å¼</strong>ï¼šé›†ç¾¤æ–¹å¼æ˜¯Redisæä¾›çš„ä¸€ç§åˆ†å¸ƒå¼æ–¹æ¡ˆï¼Œå®ƒå°†å¤šä¸ªRediså®ä¾‹ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œæ¯ä¸ªå®ä¾‹è´Ÿè´£ä¸€éƒ¨åˆ†æ•°æ®ã€‚é›†ç¾¤æ–¹å¼å¯ä»¥è‡ªåŠ¨å°†æ•°æ®åˆ†é…åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ‰©å±•æ€§ã€‚é›†ç¾¤æ–¹å¼è¿˜å¯ä»¥è‡ªåŠ¨å°†æ•°æ®å¤‡ä»½åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šï¼Œä¿è¯æ•°æ®çš„å¯é æ€§ã€‚&#x20;</p></li></ol><h2 id="2-â­ï¸Redisçš„çƒ­Keyé—®é¢˜å¦‚ä½•è§£å†³"><a href="#2-â­ï¸Redisçš„çƒ­Keyé—®é¢˜å¦‚ä½•è§£å†³" class="headerlink" title="2. â­ï¸Redisçš„çƒ­Keyé—®é¢˜å¦‚ä½•è§£å†³"></a>2. â­ï¸Redisçš„çƒ­Keyé—®é¢˜å¦‚ä½•è§£å†³</h2><p>é¦–å…ˆä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒç”¨çš„éƒ½æ˜¯redisé›†ç¾¤æ¥åšç¼“å­˜ï¼Œhotkeyä¸»è¦æ˜¯æŒ‡æŸä¸ªç‰¹å®šçš„keyï¼Œåˆ†å¸ƒåˆ°äº†redisé›†ç¾¤æŸä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯ç›¸æ¯”äºå…¶ä»–åŒç±»å‹çš„keyï¼Œè¿™ä¸ªkeyçš„è®¿é—®é¢‘ç‡æé«˜ï¼Œå¯¼è‡´å­˜å‚¨è¿™ä¸ªkeyçš„redisèŠ‚ç‚¹è´Ÿè½½è¿‡é«˜ï¼Œå¯èƒ½å¯¼è‡´redisä¸å¯ç”¨ï¼Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸­æ¯”å¦‚æœ‰ï¼šæŸä¸ªå•†å“çªç„¶æˆä¸ºçˆ†å“ï¼Œç»“æœå¤§å®¶éƒ½å»ä¹°ä»–ï¼Œå¤§é‡çš„æŸ¥è¯¢è¾¾åˆ°å¯¹åº”å•†å“ç¼“å­˜æ‰€åœ¨redisèŠ‚ç‚¹ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>&#x5BF9;äºå¯é¢„çŸ¥çš„hot keyé—®é¢˜ï¼Œæ¯”å¦‚å•†å“ç§’æ€ï¼Œæˆ‘ä»¬åœ¨å‘å¸ƒå•†å“çš„æ—¶å€™å°±éœ€è¦å¯¹è¿™äº›æ´»åŠ¨å•†å“è¿›è¡Œ<strong>ç¼“å­˜é¢„çƒ­</strong>ï¼Œå¹¶ä¸”åˆ©ç”¨åˆ†å¸ƒå¼ç¼“å­˜æœ¬åœ°ç¼“å­˜æ¥å¸®åŠ©æé«˜æˆ‘ä»¬çš„æŸ¥è¯¢æ€§èƒ½ï¼Œå¯¹äºä¸å¯é¢„çŸ¥çš„åœºæ™¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ¥è¯´éƒ½ä¼šæ¥å…¥æˆ‘ä»¬çš„çƒ­ç‚¹æ¢æµ‹ç³»ç»Ÿï¼Œå®šæœŸä¸ŠæŠ¥æˆ‘ä»¬å¯¹åº”keyçš„è°ƒç”¨æ¬¡æ•°ï¼Œæœ‰çƒ­ç‚¹æ¢æµ‹ç³»ç»Ÿæ£€æµ‹æ˜¯å¦æ˜¯çƒ­keyï¼Œç„¶åé€šè¿‡sdké€šçŸ¥å„ä¸ªåº”ç”¨èŠ‚ç‚¹å¿«é€Ÿæ„å»ºæœ¬åœ°ç¼“å­˜ï¼Œæ¥æŠ—ä½è¿™äº›çƒ­keyå¸¦æ¥çš„æµé‡ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿæœ‰å…œåº•çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼šé™æµç†”æ–­ç­‰ã€‚&#x20;</p><h2 id="3-ä¸€ä¸ªREDISå®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘KEYS"><a href="#3-ä¸€ä¸ªREDISå®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘KEYS" class="headerlink" title="3. ä¸€ä¸ªREDISå®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘KEYS"></a>3. ä¸€ä¸ªREDISå®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘KEYS</h2><p>Redisçš„æ¯ä¸ªå®ä¾‹æœ€å¤šå¯ä»¥å­˜æ”¾<strong>2^32 - 1</strong>ä¸ªkeysï¼Œå³å¤§çº¦42äº¿ä¸ªkeysï¼Œè¿™æ˜¯ç”±Rediså†…éƒ¨ä½¿ç”¨çš„å“ˆå¸Œè¡¨å†³å®šçš„ï¼Œå®ƒä½¿ç”¨32ä½æ— ç¬¦å·æ•´æ•°ä½œä¸ºç´¢å¼•ã€‚Redisä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°å’Œè´Ÿè½½å› å­ç­‰å› ç´ ä¹Ÿä¼šå½±å“å®é™…å¯å­˜æ”¾é”®çš„æ•°é‡ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡Rediså…è®¸å­˜å‚¨æ•°é‡åºå¤§çš„é”®ï¼Œä½†åœ¨å®è·µä¸­ï¼Œå­˜å‚¨è¿‡å¤šçš„é”®å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™å’Œå†…å­˜æ¶ˆè€—å¢åŠ ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦æ ¹æ®å®é™…éœ€æ±‚å’Œç¡¬ä»¶èµ„æºæ¥åˆç†è§„åˆ’é”®çš„æ•°é‡ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨Rediså®ä¾‹é€ æˆè´Ÿæ‹…ã€‚å¦‚æœéœ€è¦å­˜å‚¨æ›´å¤šçš„é”®å€¼å¯¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Redisé›†ç¾¤æˆ–åˆ†ç‰‡æŠ€æœ¯ï¼Œä»¥æ‰©å±•æ•´ä½“å­˜å‚¨å®¹é‡ã€‚&#x20;</p><h2 id="4-Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"><a href="#4-Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«" class="headerlink" title="4. Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"></a>4. Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h2><ol><li><p>é¦–å…ˆredisæ˜¯åŸºäºå†…å­˜çš„nosqlæ•°æ®åº“ï¼ŒåŸºäºå†…å­˜çš„è¯»å†™æ•ˆç‡æœ¬èº«å°±éå¸¸é«˜</p></li><li><p>rediså†…éƒ¨å¯¹åº”æ ¸å¿ƒå‘½ä»¤çš„æ‰§è¡Œé‡‡ç”¨äº†å•çº¿ç¨‹æ¨¡å‹ï¼Œå¹¶ä¸”ç»™äºˆå†…å­˜æ¨¡å‹ï¼Œå•æ¡å‘½ä»¤çš„æ‰§è¡Œé€Ÿåº¦è¿œå°äºçº¿ç¨‹ä¸Šä¸‹æ–‡çš„å¼€é”€ï¼Œæ‰€ä»¥ä½¿ç”¨å•çº¿ç¨‹èƒ½å¤Ÿå¤§å¤§æå‡æˆ‘ä»¬redisçš„ååé‡</p></li><li><p>å†…éƒ¨æä¾›äº†é«˜äº®æŸ¥è¯¢å’Œæ“ä½œçš„æ•°æ®ç»“æ„</p></li><li><p>é‡‡ç”¨IOå¤šè·¯å¤ç”¨æ¨¡å‹ï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç†å¤§é‡è¿æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨reatoræ¨¡å‹ï¼Œèƒ½å¤Ÿå¹¶å‘çš„å¤„ç†è¿æ¥ä»¥åŠå¯¹è¿æ¥è¿›è¡Œå“åº”ï¼Œä½†æ˜¯å†…éƒ¨å‘½ä»¤æ‰§è¡Œè¿˜æ˜¯å•çº¿ç¨‹çš„</p></li><li><p>5.å¯¹rediså¸¸ç”¨æ“ä½œè¿›è¡Œä¼˜åŒ–ï¼Œæä¾›äº†ç®¡é“æŠ€æœ¯å’Œæ‰¹é‡æ“ä½œæŠ€æœ¯ï¼Œèƒ½å¤Ÿå‡å°‘å•æ¬¡redisæ“ä½œçš„ç½‘ç»œå¼€é”€</p></li></ol><h2 id="5-æ€ä¹ˆå®ç°Redisçš„é«˜å¯ç”¨ï¼Ÿ"><a href="#5-æ€ä¹ˆå®ç°Redisçš„é«˜å¯ç”¨ï¼Ÿ" class="headerlink" title="5. æ€ä¹ˆå®ç°Redisçš„é«˜å¯ç”¨ï¼Ÿ"></a>5. æ€ä¹ˆå®ç°Redisçš„é«˜å¯ç”¨ï¼Ÿ</h2><ol><li><p><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šé€šè¿‡è®¾ç½®ä¸»ä»å¤åˆ¶ï¼Œå°†ä¸»èŠ‚ç‚¹çš„æ•°æ®åŒæ­¥åˆ°å¤šä¸ªä»èŠ‚ç‚¹ä¸Šã€‚ä¸»èŠ‚ç‚¹è´Ÿè´£å¤„ç†å†™æ“ä½œï¼Œå¹¶å°†å†™æ“ä½œçš„æ—¥å¿—å¤åˆ¶ç»™ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹åˆ™è´Ÿè´£å¤„ç†è¯»è¯·æ±‚ã€‚å¦‚æœä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå¯ä»¥å°†ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä»è€Œå®ç°æ•…éšœè½¬ç§»å’Œé«˜å¯ç”¨ã€‚</p></li><li><p><strong>å“¨å…µæœºåˆ¶</strong>ï¼šä½¿ç”¨Rediså“¨å…µæ¥ç›‘æ§ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹çš„çŠ¶æ€ã€‚å“¨å…µæ˜¯ä¸€ç»„ç‹¬ç«‹è¿è¡Œçš„è¿›ç¨‹ï¼Œå®ƒä¼šç›‘æ§Rediså®ä¾‹çš„å¥åº·çŠ¶æ€ï¼Œå¹¶åœ¨ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶è‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»ã€‚å®ƒè¿˜èƒ½å¤Ÿç›‘æ§ä»èŠ‚ç‚¹ï¼Œå¹¶åœ¨éœ€è¦æ—¶å°†å…¶æå‡ä¸ºä¸»èŠ‚ç‚¹ã€‚</p></li><li><p><strong>é›†ç¾¤æ¨¡å¼</strong>ï¼šRedisé›†ç¾¤æ˜¯ä¸€ç§åˆ†å¸ƒå¼æ–¹æ¡ˆï¼Œå¯ä»¥å°†å¤šä¸ªRedisèŠ‚ç‚¹ç»„æˆä¸€ä¸ªé€»è¾‘é›†ç¾¤ï¼Œæä¾›æ•°æ®åˆ†ç‰‡å’Œè‡ªåŠ¨æ•…éšœæ¢å¤ã€‚æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å­˜å‚¨å’Œå¤„ç†éƒ¨åˆ†æ•°æ®ï¼Œé€šè¿‡èŠ‚ç‚¹é—´çš„æ•°æ®åˆ†ç‰‡å’Œåˆ†å¸ƒå¼ç®—æ³•ä¿è¯æ•°æ®çš„å¯ç”¨æ€§å’Œè´Ÿè½½å‡è¡¡ã€‚å½“é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼Œé›†ç¾¤ä¼šè‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»å’Œæ¢å¤ã€‚&#x20;</p></li></ol><h2 id="6-Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹"><a href="#6-Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹" class="headerlink" title="6. Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹"></a>6. Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹</h2><p>Redis 6.xç‰ˆæœ¬å¼•å…¥äº†å¤šçº¿ç¨‹çš„I/Oå¤„ç†ï¼Œä½†è¿™å¹¶ä¸æ”¹å˜å…¶æ ¸å¿ƒæ•°æ®å¤„ç†çš„å•çº¿ç¨‹ç‰¹æ€§ã€‚å¤šçº¿ç¨‹I/Oå¤„ç†ä¸»è¦ç”¨äºå¤„ç†ç½‘ç»œI/Oï¼Œä»¥æé«˜<strong>ç½‘ç»œååé‡</strong>ï¼Œè€Œæ ¸å¿ƒçš„æ•°æ®æ“ä½œä»ç„¶ç”±å•ä¸ªä¸»çº¿ç¨‹å¤„ç†ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒRedisçš„å•çº¿ç¨‹æ¨¡å‹æ˜¯å…¶è®¾è®¡çš„ä¸€ä¸ªæ ¸å¿ƒç‰¹ç‚¹ï¼Œå®ƒä½¿å¾—Redisåœ¨ä¿æŒç®€å•æ€§çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæä¾›æé«˜çš„æ€§èƒ½ã€‚&#x20;</p><h2 id="7-â­ï¸ä¸ºä»€ä¹ˆRedis-å•çº¿ç¨‹æ¨¡å‹æ•ˆç‡ä¹Ÿèƒ½é‚£ä¹ˆé«˜"><a href="#7-â­ï¸ä¸ºä»€ä¹ˆRedis-å•çº¿ç¨‹æ¨¡å‹æ•ˆç‡ä¹Ÿèƒ½é‚£ä¹ˆé«˜" class="headerlink" title="7. â­ï¸ä¸ºä»€ä¹ˆRedis å•çº¿ç¨‹æ¨¡å‹æ•ˆç‡ä¹Ÿèƒ½é‚£ä¹ˆé«˜"></a>7. â­ï¸ä¸ºä»€ä¹ˆRedis å•çº¿ç¨‹æ¨¡å‹æ•ˆç‡ä¹Ÿèƒ½é‚£ä¹ˆé«˜</h2><p>å°½ç®¡Redisé‡‡ç”¨äº†å•çº¿ç¨‹æ¨¡å‹ï¼Œä½†å…¶æ•ˆç‡ä»ç„¶éå¸¸é«˜ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›åŸå› ï¼š</p><ol><li><p><strong>éé˜»å¡IO</strong>ï¼šRedisä½¿ç”¨äº†äº‹ä»¶é©±åŠ¨çš„éé˜»å¡IOæœºåˆ¶ã€‚å®ƒé€šè¿‡äº‹ä»¶å¾ªç¯å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œåœ¨ç­‰å¾…æ•°æ®IOæ—¶å¹¶ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œè€Œæ˜¯ç»§ç»­å¤„ç†å…¶ä»–è¯·æ±‚ã€‚è¿™ç§æœºåˆ¶å…è®¸Redisä»¥é«˜æ•ˆåœ°æ–¹å¼å¤„ç†å¤§é‡çš„å¹¶å‘è¿æ¥ã€‚</p></li><li><p><strong>å†…å­˜æ“ä½œ</strong>ï¼šRedisä¸»è¦å°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”ç”±äºå•çº¿ç¨‹æ¨¡å‹çš„å­˜åœ¨ï¼Œåœ¨å†…å­˜æ“ä½œçš„æƒ…å†µä¸‹ï¼ŒRediså¯ä»¥é€šè¿‡ç®€å•çš„æŒ‡é’ˆæ“ä½œæ¥å®ç°å¿«é€Ÿè¯»å†™ï¼Œè€Œä¸éœ€è¦è€ƒè™‘å¤æ‚çš„æ•°æ®åŒæ­¥å’Œç«äº‰æ¡ä»¶ã€‚</p></li><li><p><strong>å•çº¿ç¨‹é¿å…çš„å¼€é”€</strong>ï¼šä¸å¤šçº¿ç¨‹æ¨¡å‹ç›¸æ¯”ï¼Œå•çº¿ç¨‹æ¨¡å‹é¿å…äº†çº¿ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€é”ç«äº‰å’Œèµ„æºç®¡ç†å¼€é”€ã€‚è¿™ä½¿å¾—Rediså¯ä»¥æ›´é«˜æ•ˆåœ°ä½¿ç”¨CPUèµ„æºï¼Œå¹¶å‡å°‘äº†å¤§é‡ä¸çº¿ç¨‹ç›¸å…³çš„å¼€é”€ã€‚</p></li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRediså•çº¿ç¨‹æ¨¡å‹é€‚åˆäºå¤„ç†å¤§é‡çš„çŸ­æœŸæ“ä½œå’Œå¿«é€Ÿå“åº”çš„åœºæ™¯ï¼Œä½†åœ¨å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„è®¡ç®—å¯†é›†å‹ä»»åŠ¡æ—¶å¯èƒ½ä¼šæœ‰æ€§èƒ½ä¸Šçš„ä¸è¶³ã€‚ä¸ºäº†æé«˜å¤„ç†èƒ½åŠ›å’Œå¹¶å‘æ€§ï¼Œå¯ä»¥ä½¿ç”¨Redisçš„é›†ç¾¤æ¨¡å¼ã€å¤šå®ä¾‹éƒ¨ç½²æˆ–å°†è®¡ç®—å¯†é›†å‹ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–æ›´é€‚åˆçš„å·¥å…·æˆ–è¯­è¨€æ¥å¤„ç†ã€‚</p><h2 id="8-è¯´è¯´ä½ å¯¹Redisæ“ä½œåŸå­æ€§çš„ç†è§£"><a href="#8-è¯´è¯´ä½ å¯¹Redisæ“ä½œåŸå­æ€§çš„ç†è§£" class="headerlink" title="8. è¯´è¯´ä½ å¯¹Redisæ“ä½œåŸå­æ€§çš„ç†è§£"></a>8. è¯´è¯´ä½ å¯¹Redisæ“ä½œåŸå­æ€§çš„ç†è§£</h2><p>Redisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œè¿™æ˜¯å› ä¸ºRedisçš„æ¯ä¸ªå‘½ä»¤éƒ½æ˜¯ä»¥å•çº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œçš„ï¼Œæ•´ä¸ªå‘½ä»¤çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä¸å¯ä¸­æ–­çš„ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚</p><p>åœ¨Redisä¸­ï¼Œæ¯ä¸ªå‘½ä»¤éƒ½ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªæˆ–å¤šä¸ªåº•å±‚æ“ä½œï¼Œè¿™äº›æ“ä½œä¼šåŸºäºæ•°æ®ç»“æ„çš„ç‰¹å®šå®ç°æ¥æ‰§è¡Œã€‚æ¯”å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸²ç±»å‹ï¼Œè·å–ä¸€ä¸ªé”®å€¼å¯¹ã€è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ç­‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚åœ¨æ‰§è¡Œè¿™äº›åº•å±‚æ“ä½œæ—¶ï¼ŒRedisä¼šä½¿ç”¨ä¸€äº›æŠ€æœ¯æ¥ä¿è¯åŸå­æ€§ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li><p>Redisä½¿ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œé¿å…äº†å¤šçº¿ç¨‹ä¹‹é—´çš„ç«äº‰æ¡ä»¶å’Œé”å¼€é”€ï¼Œä»è€Œä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€‚</p></li><li><p>Redisåœ¨æ‰§è¡Œä¸€äº›å¤æ‚çš„æ“ä½œæ—¶ï¼Œæ¯”å¦‚äº‹åŠ¡ã€Luaè„šæœ¬ç­‰ï¼Œä¼šå°†å¤šä¸ªåº•å±‚æ“ä½œæ‰“åŒ…æˆä¸€ä¸ªåŸå­æ€§æ“ä½œï¼Œè¿™äº›åº•å±‚æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚åœ¨äº‹åŠ¡å’ŒLuaè„šæœ¬ä¸­ï¼ŒRedisåŒæ—¶æ”¯æŒå›æ»šæ“ä½œï¼Œå³å½“ä¸€äº›å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåé¢çš„å‘½ä»¤å‡ºé”™æ—¶ï¼ŒRediså¯ä»¥è‡ªåŠ¨æ’¤é”€å·²ç»æ‰§è¡Œçš„å‘½ä»¤ã€‚</p></li></ol><p>å› æ­¤ï¼ŒRedisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œè¿™å¾—ç›ŠäºRediså•çº¿ç¨‹æ¨¡å‹å’Œåº•å±‚æ“ä½œçš„å®ç°æ–¹å¼ã€‚è¿™ç§åŸå­æ€§æ“ä½œä¿è¯äº†Redisèƒ½å¤Ÿæä¾›é«˜æ•ˆå’Œå¯é çš„æœåŠ¡ã€‚&#x20;</p><h1 id="æ•°æ®ç»“æ„-x20"><a href="#æ•°æ®ç»“æ„-x20" class="headerlink" title="æ•°æ®ç»“æ„&#x20;"></a>æ•°æ®ç»“æ„&#x20;</h1><h2 id="1-è¯´è¯´-Redis-çš„æ•°æ®ç±»å‹"><a href="#1-è¯´è¯´-Redis-çš„æ•°æ®ç±»å‹" class="headerlink" title="1. è¯´è¯´ Redis çš„æ•°æ®ç±»å‹"></a>1. è¯´è¯´ Redis çš„æ•°æ®ç±»å‹</h2><p>Redisæ”¯æŒäº”ç§ä¸»è¦çš„æ•°æ®ç±»å‹ï¼š</p><ol><li><p><strong>String</strong>ï¼šStringæ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œåœ¨Redisä¸­ä»¥äºŒè¿›åˆ¶å®‰å…¨çš„æ–¹å¼å­˜å‚¨å­—ç¬¦ä¸²ã€‚å®ƒå¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚æ–‡æœ¬ã€æ•´æ•°æˆ–äºŒè¿›åˆ¶æ•°æ®ã€‚</p></li><li><p><strong>Hash</strong>ï¼šHashæ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½ä¸ä¸€ä¸ªå€¼ç›¸å…³è”ã€‚åœ¨Redisä¸­ï¼ŒHashå¯ä»¥ç”¨äºå­˜å‚¨å’Œæ“ä½œå¯¹è±¡ï¼Œæ¯ä¸ªé”®å€¼å¯¹ç›¸å½“äºå¯¹è±¡çš„å­—æ®µå’Œå€¼ã€‚</p></li><li><p><strong>List</strong>ï¼šListæ˜¯ä¸€ä¸ªæŒ‰ç…§æ’å…¥é¡ºåºæ’åºçš„å­—ç¬¦ä¸²å…ƒç´ é›†åˆã€‚é›†åˆä¸­çš„å…ƒç´ å¯ä»¥é‡å¤ï¼Œå¯ä»¥ä»åˆ—è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå¯ç”¨äºå®ç°é˜Ÿåˆ—ã€æ ˆç­‰æ•°æ®ç»“æ„ã€‚</p></li><li><p><strong>Set</strong>ï¼šSetæ˜¯ä¸€ä¸ªæ— åºã€å”¯ä¸€çš„å­—ç¬¦ä¸²é›†åˆï¼Œä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚å¯ä»¥å¯¹é›†åˆæ‰§è¡Œæ·»åŠ ã€åˆ é™¤å’Œåˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨ç­‰æ“ä½œï¼Œä¹Ÿæ”¯æŒé›†åˆé—´çš„äº¤é›†ã€å¹¶é›†å’Œå·®é›†è¿ç®—ã€‚</p></li><li><p><strong>Sorted Set</strong>ï¼šSorted Setæ˜¯ä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²é›†åˆï¼Œæ¯ä¸ªæˆå‘˜éƒ½å…³è”ç€ä¸€ä¸ªåˆ†æ•°ã€‚é›†åˆä¸­çš„æˆå‘˜æ ¹æ®åˆ†æ•°çš„å¤§å°è¿›è¡Œæ’åºï¼Œå¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥è¯¢å’ŒæŒ‰åˆ†æ•°æ’åæ“ä½œã€‚</p></li></ol><p>é™¤äº†è¿™äº›ä¸»è¦çš„æ•°æ®ç±»å‹ï¼ŒRedisè¿˜æä¾›äº†å…¶ä»–ä¸€äº›ç‰¹æ®Šçš„æ•°æ®ç»“æ„å’ŒåŠŸèƒ½ï¼Œå¦‚HyperLogLogç”¨äºåŸºæ•°ç»Ÿè®¡ã€Geoç”¨äºåœ°ç†ä½ç½®ä¿¡æ¯å­˜å‚¨ã€Pub/Subç”¨äºå‘å¸ƒä¸è®¢é˜…ç­‰ã€‚&#x20;</p><h2 id="2-â“Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ"><a href="#2-â“Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ" class="headerlink" title="2.â“Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ"></a>2.â“Redisåº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h2><p><a href="https://xiaolincoding.com/redis/data_struct/command.html">Redis å¸¸è§æ•°æ®ç±»å‹å’Œåº”ç”¨åœºæ™¯</a></p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/diagram-1.png" alt=""></p><p><a href="https://xiaolincoding.com/redis/data_struct/data_struct.html#%E9%94%AE%E5%80%BC%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84">Redis æ•°æ®ç»“æ„</a></p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image-1.png" alt=""></p><h2 id="3-â“ä¸ºä»€ä¹ˆç”¨è·³è¡¨ï¼Œä¸ç”¨çº¢é»‘æ ‘ã€B-æ ‘"><a href="#3-â“ä¸ºä»€ä¹ˆç”¨è·³è¡¨ï¼Œä¸ç”¨çº¢é»‘æ ‘ã€B-æ ‘" class="headerlink" title="3.â“ä¸ºä»€ä¹ˆç”¨è·³è¡¨ï¼Œä¸ç”¨çº¢é»‘æ ‘ã€B+æ ‘"></a>3.â“ä¸ºä»€ä¹ˆç”¨è·³è¡¨ï¼Œä¸ç”¨çº¢é»‘æ ‘ã€B+æ ‘</h2><p>ç­”ï¼šå› ä¸ºZSetæœ‰ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½æ˜¯èŒƒå›´æŸ¥æ‰¾ï¼Œé‡‡ç”¨è·³è¡¨å¯ä»¥æ¯”è¾ƒå®¹æ˜“æŸ¥æ‰¾åˆ°ä¸€ä¸ªèŒƒå›´çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼ˆä¾æ¬¡å¾€åæŸ¥æ‰¾ï¼‰ï¼Œè€Œçº¢é»‘æ ‘ä¸è¡Œã€‚ä¸”è·³è¡¨æ¯”çº¢é»‘æ ‘å®ç°æ›´ç®€å•ï¼Œæ›´å®¹æ˜“å®ç°ï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶è·³è¡¨çš„ç´¢å¼•å±‚çº§æ¥æ§åˆ¶å†…å­˜çš„æ¶ˆè€—ã€‚</p><h1 id="æŒä¹…åŒ–"><a href="#æŒä¹…åŒ–" class="headerlink" title="æŒä¹…åŒ–"></a>æŒä¹…åŒ–</h1><h2 id="1-è¯´è¯´Redisçš„æŒä¹…åŒ–æœºåˆ¶"><a href="#1-è¯´è¯´Redisçš„æŒä¹…åŒ–æœºåˆ¶" class="headerlink" title="1. è¯´è¯´Redisçš„æŒä¹…åŒ–æœºåˆ¶"></a>1. è¯´è¯´Redisçš„æŒä¹…åŒ–æœºåˆ¶</h2><p>Redisæœ‰ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ï¼šRDBå’ŒAOFã€‚</p><ul><li><p><strong>RDB</strong>ï¼šæ˜¯ä¸€ç§å¿«ç…§æŒä¹…åŒ–çš„æ–¹å¼ï¼Œå®ƒä¼šå°†Redisåœ¨æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®çŠ¶æ€ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚RDBæŒä¹…åŒ–å¯ä»¥é€šè¿‡é…ç½®å®šæ—¶æˆ–æ‰‹åŠ¨è§¦å‘ï¼Œä¹Ÿå¯ä»¥è®¾ç½®è‡ªåŠ¨è§¦å‘çš„æ¡ä»¶ã€‚RDBçš„ä¼˜ç‚¹æ˜¯ç”Ÿæˆçš„æ–‡ä»¶æ¯”AOFæ–‡ä»¶æ›´å°ï¼Œæ¢å¤é€Ÿåº¦ä¹Ÿæ›´å¿«ï¼Œé€‚åˆç”¨äºå¤‡ä»½å’Œç¾éš¾æ¢å¤ã€‚</p></li><li><p><strong>AOF</strong>ï¼šæ˜¯ä¸€ç§è¿½åŠ æ—¥å¿—æŒä¹…åŒ–æ–¹å¼ï¼Œå®ƒä¼šå°†Redisæ‰§è¡Œçš„å†™å‘½ä»¤è¿½åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶çš„æœ«å°¾ã€‚å½“Redisé‡å¯æ—¶ï¼Œå®ƒä¼šé‡æ–°æ‰§è¡Œè¿™äº›å†™å‘½ä»¤æ¥æ¢å¤æ•°æ®çŠ¶æ€ã€‚AOFæä¾›äº†æ›´å¯é çš„æŒä¹…åŒ–æ–¹å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¿è¯æ¯ä¸ªå†™æ“ä½œéƒ½è¢«è®°å½•ä¸‹æ¥ï¼Œå¹¶ä¸”ä¸ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±çš„æƒ…å†µã€‚AOFæ–‡ä»¶å¯ä»¥æ ¹æ®é…ç½®è¿›è¡ŒåŒæ­¥å†™å…¥ç¡¬ç›˜çš„é¢‘ç‡ï¼ŒåŒ…æ‹¬æ¯ç§’åŒæ­¥ã€æ¯å†™å…¥å‘½ä»¤åŒæ­¥å’Œç¦ç”¨åŒæ­¥ä¸‰ç§æ¨¡å¼ã€‚&#x20;</p></li></ul><h2 id="2-AOFçš„ä¸‰ç§å†™å›ç­–ç•¥ï¼Ÿâ€‹"><a href="#2-AOFçš„ä¸‰ç§å†™å›ç­–ç•¥ï¼Ÿâ€‹" class="headerlink" title="2.AOFçš„ä¸‰ç§å†™å›ç­–ç•¥ï¼Ÿâ€‹"></a>2.AOFçš„ä¸‰ç§å†™å›ç­–ç•¥ï¼Ÿâ€‹</h2><p>Alwaysã€Everysec å’Œ Noï¼Œè¿™ä¸‰ç§ç­–ç•¥åœ¨å¯é æ€§ä¸Šæ˜¯ä»é«˜åˆ°ä½ï¼Œè€Œåœ¨æ€§èƒ½ä¸Šä»ä½åˆ°é«˜ã€‚</p><p>Alwaysæ˜¯æ¯æ¬¡å†™æ“ä½œå‘½ä»¤æ‰§è¡Œå®Œåï¼ŒåŒæ­¥å°† AOF æ—¥å¿—æ•°æ®å†™å›ç¡¬ç›˜ï¼›Everysecæ¯æ¬¡å†™æ“ä½œå‘½ä»¤æ‰§è¡Œå®Œåï¼Œå…ˆå°†å‘½ä»¤å†™å…¥åˆ° AOF æ–‡ä»¶çš„å†…æ ¸ç¼“å†²åŒºï¼Œç„¶åæ¯éš”ä¸€ç§’å°†ç¼“å†²åŒºé‡Œçš„å†…å®¹å†™å›åˆ°ç¡¬ç›˜ï¼›Noå°±æ˜¯ä¸æ§åˆ¶å†™å›ç¡¬ç›˜çš„æ—¶æœºã€‚æ¯æ¬¡å†™æ“ä½œå‘½ä»¤æ‰§è¡Œå®Œåï¼Œå…ˆå°†å‘½ä»¤å†™å…¥åˆ° AOF æ–‡ä»¶çš„å†…æ ¸ç¼“å†²åŒºï¼Œå†ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å†²åŒºå†…å®¹å†™å›ç¡¬ç›˜ã€‚</p><h2 id="3-AOFçš„ç£ç›˜é‡å†™æœºåˆ¶ï¼Ÿâ€‹"><a href="#3-AOFçš„ç£ç›˜é‡å†™æœºåˆ¶ï¼Ÿâ€‹" class="headerlink" title="3.AOFçš„ç£ç›˜é‡å†™æœºåˆ¶ï¼Ÿâ€‹"></a>3.AOFçš„ç£ç›˜é‡å†™æœºåˆ¶ï¼Ÿâ€‹</h2><p>éšç€æ‰§è¡Œçš„å‘½ä»¤è¶Šå¤šï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯è‡ªç„¶ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†é¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼Œ Redis æä¾›äº† AOF é‡å†™æœºåˆ¶ï¼Œå®ƒä¼šç›´æ¥æ‰«ææ•°æ®ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹æ•°æ®ï¼Œç„¶åä¸ºæ¯ä¸€ä¸ªé”®å€¼å¯¹ç”Ÿæˆä¸€æ¡å†™æ“ä½œå‘½ä»¤ï¼Œæ¥ç€å°†è¯¥å‘½ä»¤å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ï¼Œé‡å†™å®Œæˆåï¼Œå°±æ›¿æ¢æ‰ç°æœ‰çš„ AOF æ—¥å¿—ã€‚é‡å†™çš„è¿‡ç¨‹æ˜¯ç”±åå°å­è¿›ç¨‹å®Œæˆçš„ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—ä¸»è¿›ç¨‹å¯ä»¥ç»§ç»­æ­£å¸¸å¤„ç†å‘½ä»¤ã€‚</p><h2 id="4-AOFçš„é‡å†™çš„å…·ä½“è¿‡ç¨‹ï¼Ÿâ€‹"><a href="#4-AOFçš„é‡å†™çš„å…·ä½“è¿‡ç¨‹ï¼Ÿâ€‹" class="headerlink" title="4.AOFçš„é‡å†™çš„å…·ä½“è¿‡ç¨‹ï¼Ÿâ€‹"></a>4.AOFçš„é‡å†™çš„å…·ä½“è¿‡ç¨‹ï¼Ÿâ€‹</h2><p>è§¦å‘é‡å†™æœºåˆ¶åï¼Œä¸»è¿›ç¨‹ä¼šåˆ›å»ºé‡å†™ AOF çš„å­è¿›ç¨‹ï¼Œæ­¤æ—¶çˆ¶å­è¿›ç¨‹å…±äº«ç‰©ç†å†…å­˜ï¼Œé‡å†™å­è¿›ç¨‹åªä¼šå¯¹è¿™ä¸ªå†…å­˜è¿›è¡Œåªè¯»ã€‚é‡å†™ AOF å­è¿›ç¨‹è¯»å–æ•°æ®åº“é‡Œçš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶é€ä¸€æŠŠå†…å­˜æ•°æ®çš„é”®å€¼å¯¹è½¬æ¢æˆä¸€æ¡å‘½ä»¤ï¼Œå†å°†å‘½ä»¤è®°å½•åˆ°é‡å†™æ—¥å¿—ã€‚</p><p>åœ¨å‘ç”Ÿå†™æ“ä½œçš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šå»å¤åˆ¶ç‰©ç†å†…å­˜ï¼Œè¿™æ ·æ˜¯ä¸ºäº†é˜²æ­¢ fork åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œç”±äºç‰©ç†å†…å­˜æ•°æ®çš„å¤åˆ¶æ—¶é—´è¿‡é•¿è€Œå¯¼è‡´çˆ¶è¿›ç¨‹é•¿æ—¶é—´é˜»å¡çš„é—®é¢˜ã€‚</p><h2 id="5-ä¸ºä»€ä¹ˆå…ˆæ‰§è¡ŒRediså‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥AOFæ—¥å¿—å‘¢ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆå…ˆæ‰§è¡ŒRediså‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥AOFæ—¥å¿—å‘¢ï¼Ÿ" class="headerlink" title="5.ä¸ºä»€ä¹ˆå…ˆæ‰§è¡ŒRediså‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥AOFæ—¥å¿—å‘¢ï¼Ÿ"></a>5.ä¸ºä»€ä¹ˆå…ˆæ‰§è¡ŒRediså‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥AOFæ—¥å¿—å‘¢ï¼Ÿ</h2><p>å¥½å¤„:</p><ul><li><p>ä¿è¯æ­£ç¡®å†™å…¥ï¼šå¦‚æœå½“å‰çš„å‘½ä»¤è¯­æ³•æœ‰é—®é¢˜ï¼Œé”™è¯¯çš„å‘½ä»¤è®°å½•åˆ°AOFæ—¥å¿—é‡Œåå¯èƒ½è¿˜ä¼šè¿›è¡Œè¯­æ³•æ£€æŸ¥ã€‚å…ˆæ‰§è¡ŒRediså‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥AOFæ—¥å¿—å¯ä»¥ä¿è¯å†™å…¥çš„éƒ½æ˜¯æ­£ç¡®å¯æ‰§è¡Œçš„å‘½ä»¤ã€‚</p></li><li><p>ä¸é˜»å¡å½“å‰å†™æ“ä½œï¼šå› ä¸ºå½“å†™æ“ä½œå‘½ä»¤æ‰§è¡ŒæˆåŠŸåæ‰ä¼šå°†å‘½ä»¤è®°å½•åˆ°AOFæ—¥å¿—ï¼Œé¿å…å†™å…¥é˜»å¡ã€‚</p></li></ul><p>ç¼ºé™·ï¼š</p><ul><li><p>æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ï¼šæ‰§è¡Œå†™æ“ä½œå‘½ä»¤å’Œè®°å½•æ—¥å¿—æ˜¯ä¸¤ä¸ªè¿‡ç¨‹ï¼ŒRedisè¿˜æ²¡æ¥å¾—åŠå°†å‘½ä»¤å†™å…¥åˆ°ç¡¬ç›˜æ—¶å‘ç”Ÿå®•æœºï¼Œæ•°æ®ä¼šæœ‰ä¸¢å¤±çš„é£é™©ã€‚</p></li><li><p>é˜»å¡å…¶ä»–æ“ä½œï¼šä¸ä¼šé˜»å¡å½“å‰å‘½ä»¤çš„æ‰§è¡Œï¼Œä½†å› ä¸ºAOFæ—¥å¿—ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥å½“RedisæŠŠæ—¥å¿—æ–‡ä»¶å†™å…¥ç£ç›˜çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šé˜»å¡åç»­çš„æ“ä½œæ— æ³•æ‰§è¡Œã€‚&#x20;</p></li></ul><h2 id="6-AOFå­è¿›ç¨‹çš„å†…å­˜æ•°æ®è·Ÿä¸»è¿›ç¨‹çš„å†…å­˜æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿâ€‹"><a href="#6-AOFå­è¿›ç¨‹çš„å†…å­˜æ•°æ®è·Ÿä¸»è¿›ç¨‹çš„å†…å­˜æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿâ€‹" class="headerlink" title="6.AOFå­è¿›ç¨‹çš„å†…å­˜æ•°æ®è·Ÿä¸»è¿›ç¨‹çš„å†…å­˜æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿâ€‹"></a>6.AOFå­è¿›ç¨‹çš„å†…å­˜æ•°æ®è·Ÿä¸»è¿›ç¨‹çš„å†…å­˜æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿâ€‹</h2><p>Redisè®¾ç½®äº†ä¸€ä¸ª AOF é‡å†™ç¼“å†²åŒºï¼Œè¿™ä¸ªç¼“å†²åŒºåœ¨åˆ›å»º bgrewriteaof å­è¿›ç¨‹ä¹‹åå¼€å§‹ä½¿ç”¨ã€‚åœ¨é‡å†™ AOF æœŸé—´ï¼Œå½“ Redis æ‰§è¡Œå®Œä¸€ä¸ªå†™å‘½ä»¤ä¹‹åï¼Œå®ƒä¼šåŒæ—¶å°†è¿™ä¸ªå†™å‘½ä»¤å†™å…¥åˆ°AOF ç¼“å†²åŒºå’ŒAOF é‡å†™ç¼“å†²åŒºã€‚å½“å­è¿›ç¨‹å®Œæˆ AOF é‡å†™å·¥ä½œåï¼Œä¼šå‘ä¸»è¿›ç¨‹å‘é€ä¸€æ¡ä¿¡å·ã€‚ä¸»è¿›ç¨‹æ”¶åˆ°è¯¥ä¿¡å·åï¼Œä¼šè°ƒç”¨ä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼Œå°† AOF é‡å†™ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å†…å®¹è¿½åŠ åˆ°æ–°çš„ AOF çš„æ–‡ä»¶ä¸­ï¼Œä½¿å¾—æ–°æ—§ä¸¤ä¸ª AOF æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®åº“çŠ¶æ€ä¸€è‡´ï¼›æ–°çš„ AOF çš„æ–‡ä»¶è¿›è¡Œæ”¹åï¼Œè¦†ç›–ç°æœ‰çš„ AOF æ–‡ä»¶ã€‚</p><h2 id="7-RDB-åœ¨æ‰§è¡Œå¿«ç…§çš„æ—¶å€™ï¼Œæ•°æ®èƒ½ä¿®æ”¹å—ï¼Ÿâ€‹"><a href="#7-RDB-åœ¨æ‰§è¡Œå¿«ç…§çš„æ—¶å€™ï¼Œæ•°æ®èƒ½ä¿®æ”¹å—ï¼Ÿâ€‹" class="headerlink" title="7.RDB åœ¨æ‰§è¡Œå¿«ç…§çš„æ—¶å€™ï¼Œæ•°æ®èƒ½ä¿®æ”¹å—ï¼Ÿâ€‹"></a>7.RDB åœ¨æ‰§è¡Œå¿«ç…§çš„æ—¶å€™ï¼Œæ•°æ®èƒ½ä¿®æ”¹å—ï¼Ÿâ€‹</h2><p>å¯ä»¥ã€‚æ‰§è¡Œ bgsave è¿‡ç¨‹ä¸­ï¼ŒRedis ä¾ç„¶å¯ä»¥ç»§ç»­å¤„ç†æ“ä½œå‘½ä»¤çš„ï¼Œæ•°æ®æ˜¯èƒ½è¢«ä¿®æ”¹çš„ï¼Œé‡‡ç”¨çš„æ˜¯å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆCopy-On-Write, COWï¼‰ã€‚æ‰§è¡Œ bgsave å‘½ä»¤çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ forkï¼ˆï¼‰åˆ›å»ºå­è¿›ç¨‹ï¼Œæ­¤æ—¶å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹æ˜¯å…±äº«åŒä¸€ç‰‡å†…å­˜æ•°æ®çš„ï¼Œå› ä¸ºåˆ›å»ºå­è¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„é¡µè¡¨ï¼Œä½†æ˜¯é¡µè¡¨æŒ‡å‘çš„ç‰©ç†å†…å­˜è¿˜æ˜¯ä¸€ä¸ªï¼Œç”±äºå…±äº«çˆ¶è¿›ç¨‹çš„æ‰€æœ‰æ•°æ®ï¼Œå¯ä»¥ç›´æ¥è¯»å–ä¸»çº¿ç¨‹é‡Œçš„å†…å­˜æ•°æ®ï¼Œå¹¶å°†æ•°æ®å†™å…¥åˆ° RDB æ–‡ä»¶ã€‚æ­¤æ—¶å¦‚æœä¸»çº¿ç¨‹æ‰§è¡Œè¯»æ“ä½œï¼Œåˆ™ä¸»çº¿ç¨‹å’Œ bgsave å­è¿›ç¨‹äº’ç›¸ä¸å½±å“ã€‚å¦‚æœä¸»çº¿ç¨‹è¦ä¿®æ”¹å…±äº«æ•°æ®é‡Œçš„æŸä¸€å—æ•°æ®ï¼Œå°±ä¼šå‘ç”Ÿå†™æ—¶å¤åˆ¶ï¼Œæ•°æ®çš„ç‰©ç†å†…å­˜å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½ï¼Œä¸»çº¿ç¨‹åœ¨è¿™ä¸ªæ•°æ®å‰¯æœ¬è¿›è¡Œä¿®æ”¹æ“ä½œã€‚ä¸æ­¤åŒæ—¶ï¼Œå­è¿›ç¨‹å¯ä»¥ç»§ç»­æŠŠåŸæ¥çš„æ•°æ®å†™å…¥åˆ° RDB æ–‡ä»¶ã€‚</p><h2 id="11-è¯´è¯´Redisçš„è¿‡æœŸç­–ç•¥"><a href="#11-è¯´è¯´Redisçš„è¿‡æœŸç­–ç•¥" class="headerlink" title="11. è¯´è¯´Redisçš„è¿‡æœŸç­–ç•¥"></a>11. è¯´è¯´Redisçš„è¿‡æœŸç­–ç•¥</h2><p>å¯¹äºredisçš„æ•°æ®ï¼Œå¦‚æœè¿‡æœŸäº†ï¼Œå¹¶ä¸ä¼šç«‹åˆ»è‡ªåŠ¨å–åˆ é™¤ä»–ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œç¬¬ä¸€ç§æƒ°æ€§åˆ é™¤ï¼Œåªæœ‰å½“æˆ‘ä»¬ä¸‹ä¸€æ¬¡å†æŸ¥è¯¢ä»–çš„æ—¶å€™ï¼Œå‘ç°ä»–å·²ç»è¿‡æœŸäº†ï¼Œå†åˆ é™¤ï¼Œå¦åˆ™ä¼šå¸¸é©»åœ¨å†…å­˜ä¸­ï¼Œä¼˜ç‚¹æ˜¯å‡å°‘åˆ é™¤çš„å¼€é”€ï¼Œä½†æ˜¯ä¼šæµªè´¹å†…å­˜ã€‚</p><p>ç¬¬äºŒç§æ˜¯ï¼šå®šæœŸåˆ é™¤ï¼Œredisæ¯ä¸ªä¸€æ®µæ—¶é—´å†…ï¼Œä¼šå»æ£€æŸ¥å“ªäº›keyå·²ç»è¿‡æœŸï¼Œç„¶åé‡Šæ”¾è¿‡æœŸkeyå ç”¨çš„ç©ºé—´</p><p>ç¬¬ä¸‰ç§ï¼šä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¼šé…åˆäºŒè€…ä¸€èµ·ä½¿ç”¨</p><p><strong>Redis é€‰æ‹©æƒ°æ€§åˆ é™¤+å®šæœŸåˆ é™¤è¿™ä¸¤ç§ç­–ç•¥é…å’Œä½¿ç”¨</strong>ï¼Œä»¥æ±‚åœ¨åˆç†ä½¿ç”¨ CPU æ—¶é—´å’Œé¿å…å†…å­˜æµªè´¹ä¹‹é—´å–å¾—å¹³è¡¡ã€‚Redis åœ¨è®¿é—®æˆ–è€…ä¿®æ”¹ key ä¹‹å‰ï¼Œéƒ½ä¼šè°ƒç”¨ expireIfNeeded å‡½æ•°å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œæ£€æŸ¥ key æ˜¯å¦è¿‡æœŸï¼šâ€‹å¦‚æœè¿‡æœŸï¼Œåˆ™åˆ é™¤è¯¥ keyï¼Œç„¶åè¿”å› null å®¢æˆ·ç«¯ï¼›â€‹å¦‚æœæ²¡æœ‰è¿‡æœŸï¼Œä¸åšä»»ä½•å¤„ç†ï¼Œç„¶åè¿”å›æ­£å¸¸çš„é”®å€¼å¯¹ç»™å®¢æˆ·ç«¯ï¼›â€‹</p><p>æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œä»è¿‡æœŸå­—å…¸ä¸­éšæœºæŠ½å– 20 ä¸ª keyï¼›æ£€æŸ¥è¿™ 20 ä¸ª key æ˜¯å¦è¿‡æœŸï¼Œå¹¶åˆ é™¤å·²è¿‡æœŸçš„ keyï¼›å·²è¿‡æœŸ key çš„æ•°é‡å æ¯”éšæœºæŠ½å– key çš„æ•°é‡å¤§äº 25%ï¼Œåˆ™ç»§ç»­é‡å¤æ­¥éª¤ç›´åˆ°æ¯”é‡å°äº25%ã€‚</p><h2 id="12-è¯´è¯´Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥"><a href="#12-è¯´è¯´Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥" class="headerlink" title="12.è¯´è¯´Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥"></a>12.è¯´è¯´Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥</h2><p><strong>ä¸è¿›è¡Œæ•°æ®æ·˜æ±°çš„ç­–ç•¥</strong></p><p>å®ƒè¡¨ç¤ºå½“è¿è¡Œå†…å­˜è¶…è¿‡æœ€å¤§è®¾ç½®å†…å­˜æ—¶ï¼Œä¸æ·˜æ±°ä»»ä½•æ•°æ®ï¼Œè¿™æ—¶å¦‚æœæœ‰æ–°çš„æ•°æ®å†™å…¥ï¼Œåˆ™ä¼šè§¦å‘OOMï¼Œåªæ˜¯å•çº¯çš„æŸ¥è¯¢æˆ–è€…åˆ é™¤æ“ä½œçš„è¯è¿˜æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p><strong>è¿›è¡Œæ•°æ®æ·˜æ±°çš„ç­–ç•¥</strong></p><p>åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­è¿›è¡Œæ·˜æ±°ï¼š</p><p>åœ¨æ‰€æœ‰æ•°æ®èŒƒå›´å†…è¿›è¡Œæ·˜æ±°ï¼š</p><h2 id="13-RedisæŒä¹…åŒ–æ—¶å¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†çš„ï¼Ÿâ€‹"><a href="#13-RedisæŒä¹…åŒ–æ—¶å¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†çš„ï¼Ÿâ€‹" class="headerlink" title="13.RedisæŒä¹…åŒ–æ—¶å¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†çš„ï¼Ÿâ€‹"></a>13.RedisæŒä¹…åŒ–æ—¶å¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†çš„ï¼Ÿâ€‹</h2><p><strong>RDB</strong></p><p>RDBåˆ†æ–‡ç”Ÿæˆé˜¶æ®µå’ŒåŠ è½½é˜¶æ®µï¼Œç”Ÿæˆé˜¶æ®µä¼šå¯¹keyè¿›è¡Œè¿‡æœŸæ£€æŸ¥ï¼Œè¿‡æœŸçš„keyä¸ä¼šä¿å­˜åˆ°RDBæ–‡ä»¶ä¸­ï¼›åŠ è½½é˜¶æ®µçœ‹æœåŠ¡å™¨æ˜¯ä¸»æœåŠ¡å™¨è¿˜æ˜¯ä»æœåŠ¡å™¨ï¼Œå¦‚æœæ˜¯ä¸»æœåŠ¡å™¨ï¼Œåœ¨è½½å…¥ RDB æ–‡ä»¶æ—¶ï¼Œç¨‹åºä¼šå¯¹æ–‡ä»¶ä¸­ä¿å­˜çš„é”®è¿›è¡Œæ£€æŸ¥ï¼Œè¿‡æœŸé”®ä¸ä¼šè¢«è½½å…¥åˆ°æ•°æ®åº“ä¸­ï¼›å¦‚æœä»æœåŠ¡å™¨ï¼Œåœ¨è½½å…¥ RDB æ–‡ä»¶æ—¶ï¼Œä¸è®ºé”®æ˜¯å¦è¿‡æœŸéƒ½ä¼šè¢«è½½å…¥åˆ°æ•°æ®åº“ä¸­ã€‚ä½†ç”±äºä¸»ä»æœåŠ¡å™¨åœ¨è¿›è¡Œæ•°æ®åŒæ­¥æ—¶ï¼Œä»æœåŠ¡å™¨çš„æ•°æ®ä¼šè¢«æ¸…ç©ºã€‚è¿‡æœŸé”®å¯¹è½½å…¥ RDB æ–‡ä»¶çš„ä»æœåŠ¡å™¨ä¹Ÿä¸ä¼šé€ æˆå½±å“ã€‚</p><p><strong>AOF</strong></p><p>AOFæ–‡ä»¶å†™å…¥é˜¶æ®µå’ŒAOFé‡å†™é˜¶æ®µã€‚å†™å…¥é˜¶æ®µå¦‚æœæ•°æ®åº“æŸä¸ªè¿‡æœŸé”®è¿˜æ²¡è¢«åˆ é™¤ï¼ŒAOF æ–‡ä»¶ä¼šä¿ç•™æ­¤è¿‡æœŸé”®ï¼Œå½“æ­¤è¿‡æœŸé”®è¢«åˆ é™¤åï¼ŒRedis ä¼šå‘ AOF æ–‡ä»¶è¿½åŠ ä¸€æ¡ DEL å‘½ä»¤æ¥æ˜¾å¼åœ°åˆ é™¤è¯¥é”®å€¼ã€‚é‡å†™é˜¶æ®µä¼šå¯¹ Redis ä¸­çš„é”®å€¼å¯¹è¿›è¡Œæ£€æŸ¥ï¼Œå·²è¿‡æœŸçš„é”®ä¸ä¼šè¢«ä¿å­˜åˆ°é‡å†™åçš„ AOF æ–‡ä»¶ä¸­ã€‚</p><h2 id="14-Redisä¸»ä»æ¨¡å¼ä¸­ï¼Œå¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#14-Redisä¸»ä»æ¨¡å¼ä¸­ï¼Œå¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="14.Redisä¸»ä»æ¨¡å¼ä¸­ï¼Œå¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ"></a>14.Redisä¸»ä»æ¨¡å¼ä¸­ï¼Œå¯¹è¿‡æœŸé”®ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ</h2><p>ä»åº“ä¸ä¼šè¿›è¡Œè¿‡æœŸæ‰«æï¼Œä»åº“çš„è¿‡æœŸé”®å¤„ç†ä¾é ä¸»æœåŠ¡å™¨æ§åˆ¶ï¼Œä¸»åº“åœ¨ key åˆ°æœŸæ—¶ï¼Œä¼šåœ¨ AOF æ–‡ä»¶é‡Œå¢åŠ ä¸€æ¡ del æŒ‡ä»¤ï¼ŒåŒæ­¥åˆ°æ‰€æœ‰çš„ä»åº“ï¼Œä»åº“é€šè¿‡æ‰§è¡Œè¿™æ¡ del æŒ‡ä»¤æ¥åˆ é™¤è¿‡æœŸçš„ keyã€‚</p><p>å¦‚æœä¸»ä»åŒæ­¥å‘ç”Ÿæ„å¤–ï¼ŒåŸæœ¬ä¸»åº“çš„ key è¿‡æœŸäº†ï¼Œä½†æ˜¯ del æŒ‡ä»¤æ²¡æœ‰åŒæ­¥ç»™ä»åº“æˆåŠŸï¼Œå¯¼è‡´ä»åº“å†…å­˜ä¸­å­˜åœ¨å·²ç»è¿‡æœŸä½†æ²¡æœ‰åˆ é™¤çš„ keyï¼Œè¿™æ—¶å€™æœ‰å®¢æˆ·ç«¯è®¿é—®ä»åº“æ—¶ï¼Œå³ä½¿ key è¿˜æ˜¯åœ¨å†…å­˜çš„ï¼Œä½†æ˜¯ä»åº“å‘ç° key æ˜¯è¿‡æœŸï¼ˆæ ¹æ®è¿‡æœŸæ—¶é—´ï¼‰çš„ï¼Œå°±ä¸ä¼šè¿”å› key çš„æ•°æ®ç»™å®¢æˆ·ç«¯äº†ã€‚</p><h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="1-Redisæœ‰å“ªäº›å¸¸ç”¨åº”ç”¨åœºæ™¯"><a href="#1-Redisæœ‰å“ªäº›å¸¸ç”¨åº”ç”¨åœºæ™¯" class="headerlink" title="1. Redisæœ‰å“ªäº›å¸¸ç”¨åº”ç”¨åœºæ™¯"></a>1. Redisæœ‰å“ªäº›å¸¸ç”¨åº”ç”¨åœºæ™¯</h2><ol><li><p><strong>ç¼“å­˜</strong>ï¼šRediså¯ä»¥ä½œä¸ºç¼“å­˜å±‚ï¼ŒåŠ é€Ÿè®¿é—®é¢‘ç¹çš„æ•°æ®ã€‚ç”±äºå…¶é«˜æ€§èƒ½ã€æ”¯æŒæŒä¹…åŒ–å’Œæ•°æ®ç»“æ„ä¸°å¯Œç­‰ç‰¹ç‚¹ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªç†æƒ³çš„ç¼“å­˜è§£å†³æ–¹æ¡ˆã€‚åœ¨ç¼“å­˜æ–¹é¢ï¼ŒRedisèƒ½å¤Ÿå­˜å‚¨çƒ­ç‚¹æ•°æ®ã€é¢‘ç¹æŸ¥è¯¢ç»“æœã€ä¼šè¯æ•°æ®ç­‰ï¼Œä»è€Œå‡è½»æ•°æ®åº“è´Ÿè½½ï¼Œæé«˜ç³»ç»Ÿæ•´ä½“æ€§èƒ½ã€‚</p></li><li><p><strong>ä¼šè¯å­˜å‚¨</strong>ï¼šRediså¯ä»¥ç”¨äºå­˜å‚¨ç”¨æˆ·ä¼šè¯æ•°æ®ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªæœåŠ¡å™¨ä¹‹é—´å…±äº«ä¼šè¯æ•°æ®éå¸¸æ–¹ä¾¿ã€‚è¿™åœ¨ç½‘ç«™ã€åº”ç”¨ç¨‹åºä¸­ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ä¿¡æ¯ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šRedisçš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½ä»¥åŠListæ•°æ®ç»“æ„çš„å¼¹æ€§ç‰¹æ€§ï¼Œä½¿å…¶å¯ä»¥ä½œä¸ºè½»é‡çº§æ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨ã€‚åº”ç”¨ç¨‹åºå¯ä»¥å°†æ¶ˆæ¯å‘å¸ƒåˆ°Redisï¼Œè€Œå…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥è®¢é˜…è¿™äº›æ¶ˆæ¯å¹¶å¤„ç†å®ƒä»¬ï¼Œå®ç°è§£è€¦å’Œå¼‚æ­¥é€šä¿¡ã€‚</p></li><li><p><strong>è®¡æ•°å™¨</strong>ï¼šRedisçš„åŸå­æ“ä½œå’Œè®¡æ•°å™¨æ•°æ®ç»“æ„ä½¿å…¶æˆä¸ºå®ç°å„ç§è®¡æ•°åŠŸèƒ½çš„ç†æƒ³é€‰æ‹©ã€‚æ¯”å¦‚ï¼Œå¯ä»¥ç”¨æ¥ç»Ÿè®¡ç½‘ç«™çš„ç‚¹å‡»é‡ã€ç‚¹èµæ•°ã€åœ¨çº¿ç”¨æˆ·æ•°ç­‰ã€‚</p></li><li><p><strong>å®æ—¶æ’è¡Œæ¦œ</strong>ï¼šRedisçš„æœ‰åºé›†åˆæ•°æ®ç»“æ„éå¸¸é€‚åˆå®ç°å®æ—¶æ’è¡Œæ¦œåŠŸèƒ½ã€‚é€šè¿‡å°†ç”¨æˆ·å¾—åˆ†ä½œä¸ºæœ‰åºé›†åˆçš„æˆå‘˜ï¼Œå¯ä»¥è½»æ¾åœ°è·å–æ’è¡Œæ¦œæ•°æ®å¹¶æ”¯æŒå¿«é€Ÿçš„æ›´æ–°ã€‚</p></li><li><p><strong>åˆ†å¸ƒå¼é”</strong>ï¼šRedisçš„SETNXå‘½ä»¤å¯ä»¥ç”¨æ¥å®ç°åˆ†å¸ƒå¼é”ï¼Œä¿è¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ã€‚</p></li><li><p><strong>åˆ†å¸ƒå¼çŠ¶æ€å­˜å‚¨</strong>ï¼šé™¤äº†ä¼šè¯æ•°æ®ï¼ŒRedisè¿˜å¯ä»¥ç”¨æ¥å­˜å‚¨åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„åå¥½è®¾ç½®ã€ä¸´æ—¶çŠ¶æ€ç­‰ã€‚&#x20;</p></li></ol><h2 id="2-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©"><a href="#2-ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©" class="headerlink" title="2. ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©"></a>2. ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©</h2><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image14.png" alt=""></p><p><a href="https://ls8sck0zrg.feishu.cn/wiki/IqzrwXjITiFZ6mkqQoHcsPq8nkg#share-N16YdrTvOo1CyVxr2ttcxJR1n0d">https://ls8sck0zrg.feishu.cn/wiki/IqzrwXjITiFZ6mkqQoHcsPq8nkg#share-N16YdrTvOo1CyVxr2ttcxJR1n0d</a></p><h2 id="3-å¸ƒéš†è¿‡æ»¤å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"><a href="#3-å¸ƒéš†è¿‡æ»¤å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ" class="headerlink" title="3.å¸ƒéš†è¿‡æ»¤å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"></a>3.å¸ƒéš†è¿‡æ»¤å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h2><p>å¸ƒéš†è¿‡æ»¤å™¨ç”±åˆå§‹å€¼éƒ½ä¸º0çš„ä½å›¾æ•°ç»„å’ŒNä¸ªå“ˆå¸Œå‡½æ•°ä¸¤éƒ¨åˆ†ç»„æˆã€‚åœ¨å†™å…¥æ•°æ®åº“æ•°æ®æ—¶ï¼Œåœ¨å¸ƒéš†è¿‡æ»¤å™¨é‡Œåšä¸ªæ ‡è®°ï¼Œè¿™æ ·ä¸‹æ¬¡æŸ¥è¯¢æ•°æ®æ˜¯å¦åœ¨æ•°æ®åº“æ—¶ï¼Œåªéœ€è¦æŸ¥è¯¢å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¦‚æœæŸ¥è¯¢åˆ°æ•°æ®æ²¡æœ‰è¢«æ ‡è®°ï¼Œè¯´æ˜ä¸åœ¨æ•°æ®åº“ä¸­ã€‚</p><ul><li><p>ç¬¬ä¸€æ­¥ï¼Œä½¿ç”¨Nä¸ªå“ˆå¸Œå‡½æ•°åˆ†åˆ«å¯¹æ•°æ®åšå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°Nä¸ªå“ˆå¸Œå€¼</p></li><li><p>ç¬¬äºŒæ­¥ï¼Œå°†ç¬¬ä¸€æ­¥å¾—åˆ°çš„Nä¸ªå“ˆå¸Œå€¼å¯¹ä½å›¾æ•°ç»„çš„é•¿åº¦å–æ¨¡ï¼Œå¾—åˆ°æ¯ä¸ªå“ˆå¸Œå€¼åœ¨ä½å›¾æ•°ç»„çš„å¯¹åº”ä½ç½®</p></li><li><p>ç¬¬ä¸‰æ­¥ï¼Œå°†æ¯ä¸ªå“ˆå¸Œå€¼åœ¨ä½å›¾æ•°ç»„çš„å¯¹åº”ä½ç½®çš„å€¼è®¾ç½®ä¸º1ã€</p></li></ul><p>ç¼ºé™·</p><ul><li><p>å¸ƒéš†è¿‡æ»¤å™¨ç”±äºæ˜¯åŸºäºå“ˆå¸Œå‡½æ•°å®ç°æŸ¥æ‰¾çš„ï¼Œä¼šå­˜åœ¨å“ˆå¸Œå†²çªçš„å¯èƒ½æ€§ï¼Œæ•°æ®å¯èƒ½è½åœ¨ç›¸åŒä½ç½®ï¼Œå­˜åœ¨è¯¯åˆ¤çš„æƒ…å†µã€‚æŸ¥è¯¢å¸ƒéš†è¿‡æ»¤å™¨è¯´æ•°æ®å­˜åœ¨ï¼Œå¹¶ä¸ä¸€å®šè¯æ˜æ•°æ®åº“ä¸­å­˜åœ¨è¿™ä¸ªæ•°æ®ï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°æ•°æ®ä¸å­˜åœ¨ï¼Œæ•°æ®åº“ä¸­ä¸€å®šå°±ä¸å­˜åœ¨è¿™ä¸ªæ•°æ®ã€‚</p></li><li><p>ä¸æ”¯æŒä¸€ä¸ªå…³é”®å­—çš„åˆ é™¤ï¼Œå› ä¸ºä¸€ä¸ªå…³é”®å­—çš„åˆ é™¤ä¼šç‰µè¿å…¶ä»–çš„å…³é”®å­—ã€‚æ”¹è¿›æ–¹æ³•å°±æ˜¯counting Bloom filterï¼Œç”¨ä¸€ä¸ªcounteræ•°ç»„ä»£æ›¿ä½æ•°ç»„ï¼Œå°±å¯ä»¥æ”¯æŒåˆ é™¤äº†ã€‚</p></li><li><p>å¯¹äºè¾“å…¥çš„nä¸ªå…ƒç´ ï¼Œè¦ç¡®å®šæ•°ç»„må¤§å°å’Œhashå‡½æ•°çš„ä¸ªæ•°ï¼Œhashå‡½æ•°ä¸ªæ•°k = (ln2) * (m/n) æ—¶ï¼Œé”™è¯¯ç‡æœ€å°ã€‚åœ¨é”™è¯¯ç‡ä¸å¤§äºEæƒ…å†µä¸‹ï¼Œmè‡³å°‘è¦ç­‰äºn*lg(1/E)æ‰èƒ½è¡¨ç¤ºnä¸ªå…ƒç´ çš„é›†åˆã€‚&#x20;</p></li></ul><h2 id="4-å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿ"><a href="#4-å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿ" class="headerlink" title="4.å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿ"></a>4.å¦‚ä½•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿ</h2><p><a href="https://mcnfxurl5vzo.feishu.cn/wiki/Tfj8wjNOei9by3kjWjVcL0pwn5g#share-ZIJvdlLucoi7wyxvThSc9iPFnbc"> 11.åœºæ™¯é¢˜</a></p><h3 id="Cache-Aside"><a href="#Cache-Aside" class="headerlink" title="Cache Aside"></a>Cache Aside</h3><ul><li><p>åŸç†ï¼š<strong>å…ˆä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å°±å†å»æ•°æ®åº“é‡Œé¢è¯»æ•°æ®ï¼Œç„¶åæŠŠæ•°æ®æ”¾å›ç¼“å­˜ä¸­ï¼Œå¦‚æœç¼“å­˜ä¸­å¯ä»¥æ‰¾åˆ°æ•°æ®å°±ç›´æ¥è¿”å›æ•°æ®ï¼›</strong>&#x66F4;æ–°æ•°æ®çš„æ—¶å€™å…ˆæŠŠæ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“ï¼Œç„¶åå†è®©ç¼“å­˜å¤±æ•ˆã€‚</p></li><li><p>é—®é¢˜ï¼šå‡å¦‚æœ‰ä¸¤ä¸ªæ“ä½œä¸€ä¸ªæ›´æ–°ä¸€ä¸ªæŸ¥è¯¢ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œè¿˜æ¥ä¸åŠåˆ é™¤ç¼“å­˜ï¼ŒæŸ¥è¯¢æ“ä½œå¯èƒ½æ‹¿åˆ°çš„å°±æ˜¯æ—§çš„æ•°æ®ï¼›æ›´æ–°æ“ä½œé©¬ä¸Šè®©ç¼“å­˜å¤±æ•ˆäº†ï¼Œæ‰€ä»¥åç»­çš„æŸ¥è¯¢å¯ä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼›<strong>è¿˜æœ‰çš„é—®é¢˜å°±æ˜¯æœ‰ä¸€ä¸ªæ˜¯è¯»æ“ä½œæ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œç„¶åå°±åˆ°æ•°æ®åº“ä¸­å–æ•°æ®ï¼Œæ­¤æ—¶æ¥äº†ä¸€ä¸ªå†™æ“ä½œï¼Œå†™å®Œæ•°æ®åº“åï¼Œè®©ç¼“å­˜å¤±æ•ˆï¼Œç„¶åï¼Œä¹‹å‰çš„é‚£ä¸ªè¯»æ“ä½œå†æŠŠè€çš„æ•°æ®æ”¾è¿›å»ï¼Œä¹Ÿä¼šé€ æˆè„æ•°æ®ã€‚</strong></p></li><li><p>å¯è¡Œæ€§ï¼šå‡ºç°ä¸Šè¿°é—®é¢˜çš„æ¦‚ç‡å…¶å®éå¸¸ä½ï¼Œéœ€è¦åŒæ—¶è¾¾æˆè¯»ç¼“å­˜æ—¶ç¼“å­˜å¤±æ•ˆå¹¶ä¸”æœ‰å¹¶å‘å†™çš„æ“ä½œã€‚æ•°æ®åº“è¯»å†™è¦æ¯”ç¼“å­˜æ…¢å¾—å¤šï¼Œæ‰€ä»¥è¯»æ“ä½œåœ¨å†™æ“ä½œä¹‹å‰è¿›å…¥æ•°æ®åº“ï¼Œå¹¶ä¸”åœ¨å†™æ“ä½œä¹‹åæ›´æ–°ï¼Œæ¦‚ç‡æ¯”è¾ƒä½ã€‚</p></li></ul><h3 id="Read-Write-Through"><a href="#Read-Write-Through" class="headerlink" title="Read/Write Through"></a>Read/Write Through</h3><ul><li><p>åŸç†ï¼šRead/Write ThroughåŸç†æ˜¯æŠŠæ›´æ–°æ•°æ®åº“ï¼ˆRepositoryï¼‰çš„æ“ä½œç”±ç¼“å­˜ä»£ç†ï¼Œåº”ç”¨è®¤ä¸ºåç«¯æ˜¯ä¸€ä¸ªå•ä¸€çš„å­˜å‚¨ï¼Œè€Œå­˜å‚¨è‡ªå·±ç»´æŠ¤è‡ªå·±çš„ç¼“å­˜ã€‚</p></li><li><p>Read Throughï¼šå°±æ˜¯åœ¨æŸ¥è¯¢æ“ä½œä¸­æ›´æ–°ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¼“å­˜å¤±æ•ˆçš„æ—¶å€™ï¼ŒCache Asideç­–ç•¥æ˜¯ç”±è°ƒç”¨æ–¹è´Ÿè´£æŠŠæ•°æ®åŠ è½½å…¥ç¼“å­˜ï¼Œè€ŒRead Throughåˆ™ç”¨ç¼“å­˜æœåŠ¡è‡ªå·±æ¥åŠ è½½ï¼Œä»è€Œå¯¹è°ƒç”¨æ–¹æ˜¯é€æ˜çš„ã€‚</p></li><li><p>Write Throughï¼šå½“æœ‰æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œç›´æ¥æ›´æ–°æ•°æ®åº“ï¼Œç„¶åè¿”å›ã€‚å¦‚æœå‘½ä¸­äº†ç¼“å­˜ï¼Œåˆ™æ›´æ–°ç¼“å­˜ï¼Œç„¶åå†ç”±ç¼“å­˜è‡ªå·±æ›´æ–°æ•°æ®åº“ï¼ˆè¿™æ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼‰ã€‚&#x20;</p></li></ul><h3 id="Write-Behind"><a href="#Write-Behind" class="headerlink" title="Write Behind"></a>Write Behind</h3><p>åŸç†ï¼šåœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œåªæ›´æ–°ç¼“å­˜ï¼Œä¸æ›´æ–°æ•°æ®åº“ï¼Œè€Œç¼“å­˜ä¼šå¼‚æ­¥åœ°æ‰¹é‡æ›´æ–°æ•°æ®åº“ã€‚è¿™ä¸ªè®¾è®¡çš„å¥½å¤„å°±æ˜¯è®©æ•°æ®çš„I/Oæ“ä½œéå¸¸å¿«ï¼Œå¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œæ•°æ®ä¸æ˜¯å¼ºä¸€è‡´æ€§çš„ï¼Œè€Œä¸”å¯èƒ½ä¼šä¸¢ã€‚</p><h2 id="5-å¦‚ä½•ä¿è¯åˆ é™¤ç¼“å­˜æ“ä½œä¸€å®šèƒ½æˆåŠŸï¼Ÿâ€‹"><a href="#5-å¦‚ä½•ä¿è¯åˆ é™¤ç¼“å­˜æ“ä½œä¸€å®šèƒ½æˆåŠŸï¼Ÿâ€‹" class="headerlink" title="5.å¦‚ä½•ä¿è¯åˆ é™¤ç¼“å­˜æ“ä½œä¸€å®šèƒ½æˆåŠŸï¼Ÿâ€‹"></a>5.å¦‚ä½•ä¿è¯åˆ é™¤ç¼“å­˜æ“ä½œä¸€å®šèƒ½æˆåŠŸï¼Ÿâ€‹</h2><p><strong>é‡è¯•æœºåˆ¶</strong></p><p>å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ é™¤ç¼“å­˜çš„æ“ä½œç”±æ¶ˆè´¹è€…æ¥åšï¼Œåˆ é™¤å¤±è´¥çš„è¯é‡æ–°å»æ¶ˆæ¯é˜Ÿåˆ—æ‹‰å–ç›¸åº”çš„æ“ä½œï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°æ²¡æœ‰åˆ é™¤æˆåŠŸå°±åƒä¸šåŠ¡å±‚æŠ¥é”™ã€‚</p><p><strong>è®¢é˜…BINLog</strong></p><p>è®¢é˜… binlog æ—¥å¿—ï¼Œæ‹¿åˆ°å…·ä½“è¦æ“ä½œçš„æ•°æ®ï¼Œç„¶åå†æ‰§è¡Œç¼“å­˜åˆ é™¤ã€‚å¯ä»¥è®©åˆ é™¤æœåŠ¡æ¨¡æ‹Ÿè‡ªå·±ä¼ªè£…æˆä¸€ä¸ª MySQL çš„ä»èŠ‚ç‚¹ï¼Œå‘ MySQL ä¸»èŠ‚ç‚¹å‘é€ dump è¯·æ±‚ï¼Œä¸»èŠ‚ç‚¹æ”¶åˆ°è¯·æ±‚åï¼Œå°±ä¼šå¼€å§‹æ¨é€ BINLog ï¼Œåˆ é™¤æœåŠ¡è§£æ BINLog å­—èŠ‚æµä¹‹åï¼Œè½¬æ¢ä¸ºä¾¿äºè¯»å–çš„ç»“æ„åŒ–æ•°æ®ï¼Œå†è¿›è¡Œåˆ é™¤ã€‚</p><p>è®¢é˜…bin logä¼šè·Ÿ mq ç»“åˆä¸€èµ·ç”¨ï¼Œé€šè¿‡ è®¢é˜…bin logçŸ¥é“æ•°æ®å‘ç”Ÿæ›´æ–°ï¼Œç„¶åæŠ•é€’ç»™æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åè®©æ¶ˆæ¯é˜Ÿåˆ—é‡è¯•ã€‚</p><h2 id="6-ä¸šåŠ¡ä¸€è‡´æ€§è¦æ±‚é«˜æ€ä¹ˆåŠï¼Ÿ"><a href="#6-ä¸šåŠ¡ä¸€è‡´æ€§è¦æ±‚é«˜æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="6.ä¸šåŠ¡ä¸€è‡´æ€§è¦æ±‚é«˜æ€ä¹ˆåŠï¼Ÿ"></a>6.ä¸šåŠ¡ä¸€è‡´æ€§è¦æ±‚é«˜æ€ä¹ˆåŠï¼Ÿ</h2><p><strong>å…ˆæ›´æ–°æ•°æ®åº“å†æ›´æ–°ç¼“å­˜</strong></p><p>å¯ä»¥å…ˆæ›´æ–°æ•°æ®åº“å†æ›´æ–°ç¼“å­˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰å¹¶å‘æ›´æ–°çš„ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ã€‚è§£å†³åŠæ³•æ˜¯æ›´æ–°ç¼“å­˜å‰åŠ ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œä¿è¯åŒä¸€æ—¶é—´åªè¿è¡Œä¸€ä¸ªè¯·æ±‚æ›´æ–°ç¼“å­˜ï¼ŒåŠ é”åå¯¹äºå†™å…¥çš„æ€§èƒ½å°±ä¼šå¸¦æ¥å½±å“ï¼›åœ¨æ›´æ–°å®Œç¼“å­˜æ—¶ï¼Œç»™ç¼“å­˜åŠ ä¸Šè¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œå‡ºç°ç¼“å­˜ä¸ä¸€è‡´çš„æƒ…å†µç¼“å­˜çš„æ•°æ®ä¹Ÿä¼šå¾ˆå¿«è¿‡æœŸã€‚</p><p><strong>å»¶è¿ŸåŒåˆ </strong></p><p>é‡‡ç”¨å»¶è¿ŸåŒåˆ ï¼Œå…ˆåˆ é™¤ç¼“å­˜ï¼Œç„¶åæ›´æ–°æ•°æ®åº“ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´å†åˆ é™¤ç¼“å­˜ã€‚ä¿è¯ç¬¬ä¸€ä¸ªæ“ä½œå†ç¡çœ ä¹‹åï¼Œç¬¬äºŒä¸ªæ“ä½œå®Œæˆæ›´æ–°ç¼“å­˜æ“ä½œã€‚ä½†æ˜¯å…·ä½“ç¡çœ å¤šä¹…å…¶å®æ˜¯ä¸ªç„å­¦ï¼Œå¾ˆéš¾è¯„ä¼°å‡ºæ¥ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¹Ÿåªæ˜¯å°½å¯èƒ½ä¿è¯ä¸€è‡´æ€§è€Œå·²ï¼Œä¾ç„¶ä¹Ÿä¼šå‡ºç°ç¼“å­˜ä¸ä¸€è‡´çš„ç°è±¡ã€‚</p><p>æç¤ºï¼šæœ€å¥½ç»™é”è®¾ç½®è¿‡æœŸæ—¶é—´é˜²æ­¢é˜»å¡ã€‚</p><blockquote><p><a href="https://ls8sck0zrg.feishu.cn/wiki/wikcnEJdzUmS3CgUHXUCjJY5Iad">https://ls8sck0zrg.feishu.cn/wiki/wikcnEJdzUmS3CgUHXUCjJY5Iad</a></p><p><a href="https://xiaolincoding.com/redis/architecture/mysql_redis_consistency.html#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E7%BC%93%E5%AD%98%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E4%B8%80%E8%87%B4%E6%80%A7">æ•°æ®åº“å’Œç¼“å­˜å¦‚ä½•ä¿è¯ä¸€è‡´æ€§ï¼Ÿ</a></p></blockquote><h2 id="7-â­ï¸è¯´è¯´ä½ å¯¹ç¼“å­˜åŒå†™ä¸ä¸€è‡´çš„ç†è§£"><a href="#7-â­ï¸è¯´è¯´ä½ å¯¹ç¼“å­˜åŒå†™ä¸ä¸€è‡´çš„ç†è§£" class="headerlink" title="7. â­ï¸è¯´è¯´ä½ å¯¹ç¼“å­˜åŒå†™ä¸ä¸€è‡´çš„ç†è§£"></a>7. â­ï¸è¯´è¯´ä½ å¯¹ç¼“å­˜åŒå†™ä¸ä¸€è‡´çš„ç†è§£</h2><p><strong>ç¼“å­˜ä¸ä¸€è‡´</strong>ä¸»è¦æ˜¯æŒ‡æˆ‘ä»¬çš„ä¸šåŠ¡ç³»ç»Ÿé‡Œé¢å¼•å…¥äº†ç¼“å­˜æå‡æˆ‘ä»¬æŸ¥è¯¢æ€§èƒ½ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æ•°æ®åº“æ•°æ®å‘ç”Ÿå˜æ›´çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¦‚ä½•å»ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¸­æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä¸»è¦æœ‰ä¸¤å¤§ç§æ–¹æ¡ˆã€‚</p><p>é¦–å…ˆæ˜¯å¼‚æ­¥é€šçŸ¥ï¼Œå¯ä»¥åˆ©ç”¨canalç›‘å¬æˆ‘ä»¬mysqlçš„æ•°æ®å˜åŒ–ï¼Œç„¶åå‘é€å˜æ›´ç¼“å­˜æ¶ˆæ¯åˆ°mqï¼Œè®©ä¸šåŠ¡ç³»ç»Ÿå»å¯¹ç¼“å­˜è¿›è¡Œæ›´æ–°ï¼Œç”±äºæˆ‘ä»¬ä¸€èˆ¬ç›‘å¬binlogéƒ½æ˜¯åœ¨ä»mysqlä¸Šè¿›è¡Œï¼Œè€Œä¸»ä»åŒæ­¥æœ‰ä¸€å®šçš„å»¶æ—¶ï¼Œç›‘å¬å®Œæ¶ˆæ¯å‘é€åˆ°mqåˆå­˜åœ¨ä¸€å®šçš„å»¶æ—¶ï¼Œæ‰€ä»¥ä»–çš„å®æ—¶æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”è¾ƒé€‚åˆç”¨åœ¨ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„ç¼“å­˜åœºæ™¯ï¼Œå¹¶ä¸”å¼‚æ­¥é€šçŸ¥æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯è§£è€¦ï¼Œå¯¹äºæ›´æ–°ç¼“å­˜çš„é€»è¾‘ä¸éœ€è¦è€¦åˆåœ¨ä»£ç ä¸­<br>ç¬¬äºŒç§æ–¹æ¡ˆä¹Ÿæ˜¯å¾—ç‰©ä½¿ç”¨è§„èŒƒçš„ä¸­æœ€æ¨èçš„åŒæ­¥åŒå†™ï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨è¿™ç§æ–¹æ¡ˆï¼Œå°±æ˜¯éå¸¸å¤šçš„ä¸šåŠ¡ä¸­éƒ½æ¶‰åŠåˆ°é’±ç›¸å…³ï¼Œå¦‚æœç¼“å­˜é•¿æ—¶é—´ä¸ä¸€è‡´å®¹æ˜“é€ æˆå¤§é‡çš„èµ„æŸï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬å•†å“ä¸­å¿ƒå¤§é‡å•†å“æ•°æ®è¿›è¡Œäº†ç¼“å­˜ï¼Œæ­¤æ—¶æˆ‘ä»¬ç®¡ç†å‘˜ä¿®æ”¹äº†ä»·æ ¼ï¼Œè¿™ä¸ªç¼“å­˜æ€ä¹ˆåŒæ­¥ï¼Œå…¶å®å°±æ˜¯ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œå¯¹äºè¿™ç§ä¸€è‡´æ€§æ¯”è¾ƒé«˜çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬æ¨èæœ€ä½³æ–¹æ¡ˆæ˜¯é‡‡ç”¨å»¶æ—¶åŒåˆ ï¼Œå…ˆåˆ ç¼“å­˜ï¼Œç„¶åå†™æ•°æ®åº“ï¼Œç„¶åè¿‡500mså†åˆ ä¸€æ¬¡ç¼“å­˜ï¼Œè¿™ç§æ–¹æ¡ˆèƒ½å¤Ÿå°½å¯èƒ½é¿å…å‡ºç°ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æ— æ³•å®Œå…¨é¿å…ï¼Œå› ä¸ºå¯èƒ½å‡ºç°ä¸€äº›æç«¯æƒ…å†µï¼Œæ¯”å¦‚å‡ºç°äº†æ…¢SQLï¼ŒæŸ¥äº†åŠå¤©è¿˜æ˜¯æ—§æ•°æ®ï¼Œç»“æœæˆ‘ä»¬åŒåˆ ä¹Ÿåˆ å®Œäº†ï¼Œä»–åˆèµ°äº†æ—§æ•°æ®çš„é€»è¾‘ï¼Œä½†æ˜¯è¿™ç§éƒ½å¯ä»¥é€šè¿‡ç›‘æ§æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå°½æœ€å¤§å¯èƒ½ä¸å‡ºç°é—®é¢˜ã€‚</p><p>å¦‚æœæƒ³è¦ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œå…¶å®æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨è¯»å†™é”æ¥ä¿è¯äº†ï¼Œä½†æ˜¯ä¸€èˆ¬Cç«¯ä¸šåŠ¡ï¼Œä¼˜å…ˆè€ƒè™‘ç”¨æˆ·ä½“éªŒæ€§ï¼Œå¦‚æœä¸æ˜¯ç›´æ¥æ“ä½œé’±ä¸€èˆ¬ä¸ä½¿ç”¨è¿™ç§æ–¹æ¡ˆã€‚</p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image.png" alt=""></p><h2 id="8-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ"><a href="#8-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ" class="headerlink" title="8.å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ"></a>8.å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ</h2><p>ä½¿ç”¨ZSetï¼ŒZSetæœ‰ä¸€ä¸ªScoreå±æ€§å¯ä»¥ç”¨æ¥å­˜å‚¨å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚ä½¿ç”¨zadd score1 value1å‘½ä»¤ï¼Œå†åˆ©ç”¨zrangebyscoreæŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œé€šè¿‡å¾ªç¯æ‰§è¡Œé˜Ÿåˆ—ä»»åŠ¡ã€‚</p><h2 id="9-å¦‚ä½•è®¾è®¡ä¸€ä¸ªç¼“å­˜ç­–ç•¥ï¼Œå¯ä»¥åŠ¨æ€ç¼“å­˜çƒ­ç‚¹æ•°æ®å‘¢ï¼Ÿ"><a href="#9-å¦‚ä½•è®¾è®¡ä¸€ä¸ªç¼“å­˜ç­–ç•¥ï¼Œå¯ä»¥åŠ¨æ€ç¼“å­˜çƒ­ç‚¹æ•°æ®å‘¢ï¼Ÿ" class="headerlink" title="9.å¦‚ä½•è®¾è®¡ä¸€ä¸ªç¼“å­˜ç­–ç•¥ï¼Œå¯ä»¥åŠ¨æ€ç¼“å­˜çƒ­ç‚¹æ•°æ®å‘¢ï¼Ÿ"></a>9.å¦‚ä½•è®¾è®¡ä¸€ä¸ªç¼“å­˜ç­–ç•¥ï¼Œå¯ä»¥åŠ¨æ€ç¼“å­˜çƒ­ç‚¹æ•°æ®å‘¢ï¼Ÿ</h2><p>ç”±äºæ•°æ®å­˜å‚¨å—é™ï¼Œç³»ç»Ÿå¹¶ä¸æ˜¯å°†æ‰€æœ‰æ•°æ®éƒ½éœ€è¦å­˜æ”¾åˆ°ç¼“å­˜ä¸­çš„ï¼Œè€Œåªæ˜¯å°†å…¶ä¸­ä¸€éƒ¨åˆ†çƒ­ç‚¹æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªçƒ­ç‚¹æ•°æ®åŠ¨æ€ç¼“å­˜çš„ç­–ç•¥ã€‚</p><p>çƒ­ç‚¹æ•°æ®åŠ¨æ€ç¼“å­˜çš„ç­–ç•¥æ€»ä½“æ€è·¯ï¼š<strong>é€šè¿‡æ•°æ®æœ€æ–°è®¿é—®æ—¶é—´æ¥åšæ’åï¼Œå¹¶è¿‡æ»¤æ‰ä¸å¸¸è®¿é—®çš„æ•°æ®ï¼Œåªç•™ä¸‹ç»å¸¸è®¿é—®çš„æ•°æ®ã€‚ç”¨zaddæ–¹æ³•å’Œzrangeæ–¹æ³•æ¥å®Œæˆæ’åºé˜Ÿåˆ—å’Œè·å–å‰é¢å•†å“ã€‚</strong></p><p>ä¾‹å­ï¼š</p><p>ä»¥ç”µå•†å¹³å°åœºæ™¯ä¸­çš„ä¾‹å­ï¼Œç°åœ¨è¦æ±‚åªç¼“å­˜ç”¨æˆ·ç»å¸¸è®¿é—®çš„Top 1000çš„å•†å“ã€‚å…·ä½“ç»†èŠ‚å¦‚ä¸‹ï¼š</p><ul><li><p>å…ˆé€šè¿‡ç¼“å­˜ç³»ç»Ÿåšä¸€ä¸ªæ’åºé˜Ÿåˆ—ï¼ˆæ¯”å¦‚å­˜æ”¾1000ä¸ªå•†å“ï¼‰ï¼Œç³»ç»Ÿä¼šæ ¹æ®å•†å“çš„è®¿é—®æ—¶é—´ï¼Œæ›´æ–°é˜Ÿåˆ—ä¿¡æ¯ï¼Œè¶Šæ˜¯æœ€è¿‘è®¿é—®çš„å•†å“æ’åè¶Šé å‰ï¼›</p></li><li><p>åŒæ—¶ç³»ç»Ÿä¼šå®šæœŸè¿‡æ»¤æ‰é˜Ÿåˆ—ä¸­æ’åæœ€åçš„200ä¸ªå•†å“ï¼Œç„¶åå†ä»æ•°æ®åº“ä¸­éšæœºè¯»å–å‡º200ä¸ªå•†å“åŠ å…¥é˜Ÿåˆ—ä¸­ï¼›</p></li><li><p>å½“è¯·æ±‚æ¯æ¬¡åˆ°è¾¾çš„æ—¶å€™ï¼Œä¼šå…ˆä»é˜Ÿåˆ—ä¸­è·å–å•†å“IDï¼Œå¦‚æœå‘½ä¸­ï¼Œå°±æ ¹æ®IDå†ä»å¦ä¸€ä¸ªç¼“å­˜æ•°æ®ç»“æ„ä¸­è¯»å–å®é™…çš„å•†å“ä¿¡æ¯ï¼Œå¹¶è¿”å›ã€‚&#x20;</p></li></ul><h2 id="10-â­ï¸åˆ†å¸ƒå¼é”åŸç†å’Œæ½œåœ¨é£é™©"><a href="#10-â­ï¸åˆ†å¸ƒå¼é”åŸç†å’Œæ½œåœ¨é£é™©" class="headerlink" title="10.â­ï¸åˆ†å¸ƒå¼é”åŸç†å’Œæ½œåœ¨é£é™©"></a>10.â­ï¸åˆ†å¸ƒå¼é”åŸç†å’Œæ½œåœ¨é£é™©</h2><blockquote><p><a href="https://ls8sck0zrg.feishu.cn/wiki/Kdz7wj1g8il0SXkviJNcYDKEnHf">https://ls8sck0zrg.feishu.cn/wiki/Kdz7wj1g8il0SXkviJNcYDKEnHf</a></p></blockquote><ol><li><p><strong>Rediså®ç°åˆ†å¸ƒå¼é”åŸç†</strong>ï¼šä¸€ä¸ªå®¢æˆ·ç«¯æƒ³è¦åŠ é”ï¼Œå°±ä¼šå»Redisä¸­æŸ¥æ‰¾å¯¹åº”çš„keyæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºè¿™ä¸ªkeyï¼Œè¡¨ç¤ºåŠ é”æˆåŠŸï¼Œå½“å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯ä¹Ÿæƒ³åŠ é”æ—¶ï¼Œå‘ç°è¿™ä¸ªkeyå·²ç»å­˜åœ¨äº†ï¼Œå°±ä¼šè¿”å›åŠ é”å¤±è´¥ã€‚å¯ä»¥é‡‡ç”¨setnxå‘½ä»¤å°†æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ - åˆ›å»ºkeyè¿™ä¸ªè¿‡ç¨‹å˜æˆä¸€ä¸ªåŸå­æ“ä½œï¼Œæˆ–è€…ä½¿ç”¨Luaè„šæœ¬ï¼Œè®©Rediså•çº¿ç¨‹æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚</p></li><li><p><strong>æ½œåœ¨é£é™©1</strong>ï¼šå½“ä¸€ä¸ªå®¢æˆ·ç«¯æˆåŠŸæ‰§è¡Œsetnxè¿›è¡ŒåŠ é”ä¹‹åï¼Œç»“æœæ‰§è¡Œdelå‘½ä»¤é‡Šæ”¾é”ï¼Œå´ä¸€ç›´æ²¡æœ‰æˆåŠŸï¼Œå¯¼è‡´é”æ²¡æœ‰é‡Šæ”¾ï¼Œå…¶ä»–å®¢æˆ·ç«¯æ— æ³•è·å–é”ï¼Œä»è€Œå½±å“ä¸šåŠ¡ã€‚</p><ul><li><strong>è§£å†³æ–¹æ³•</strong>ï¼šç»™è¿™ä¸ªé”è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå½“è¶…è¿‡è¿‡æœŸæ—¶é—´æ—¶ï¼ŒRedisä¼šè‡ªåŠ¨å°†å…¶é‡Šæ”¾ï¼Œå¯ä»¥é‡‡ç”¨setnxå‘½ä»¤çš„nxå‚æ•°ï¼Œå†ä½¿ç”¨pxå‚æ•°è®¾ç½®æ¯«ç§’è¿‡æœŸæ—¶é—´ï¼Œæˆ–è€…exå‚æ•°ï¼ˆè¿™æ˜¯ç§’è¿‡æœŸæ—¶é—´ï¼‰ã€‚</li></ul></li><li><p><strong>æ½œåœ¨é£é™©2</strong>ï¼šå½“å®¢æˆ·ç«¯AæˆåŠŸåŠ é”ä¹‹åï¼Œä½†å´è¢«å®¢æˆ·ç«¯Bä½¿ç”¨delå‘½ä»¤è¿›è¡Œåˆ é™¤ï¼Œè€Œå¦‚æœé©¬ä¸Šæœ‰å…¶ä»–å®¢æˆ·ç«¯æ¥è·å–é”ï¼Œå°±ä¼šå’Œå®¢æˆ·ç«¯Aä¸€èµ·å…±äº«æ•°æ®ï¼Œé€ æˆä¸šåŠ¡é€»è¾‘é”™è¯¯ã€‚</p><ul><li><strong>è§£å†³æ–¹æ³•</strong>ï¼šç»™è¿™ä¸ªé”å¯¹åº”çš„Valueè®¾ç½®ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä¿è¯æ¯ä¸ªå®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è¯†ä¸åŒï¼Œå½“åˆ é™¤é”çš„æ—¶å€™ï¼Œéœ€è¦å…ˆæ£€æŸ¥è¿™ä¸ªvalueæ˜¯å¦ä¸å®¢æˆ·ç«¯æ ‡è¯†ä¸€è‡´æ‰èƒ½è¿›è¡Œåˆ é™¤ã€‚è€Œè¿™ä¹Ÿå¯¼è‡´åˆ é™¤é”æ“ä½œå˜æˆäº†è¯»å–å˜é‡ã€åˆ¤æ–­å˜é‡ã€åˆ é™¤å˜é‡å¤šä¸ªæ“ä½œï¼Œéœ€è¦ä¿è¯æ‰§è¡Œçš„åŸå­æ€§ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿéœ€è¦æ•´åˆLuaè„šæœ¬ï¼Œå‘é€ç»™Rediså•çº¿ç¨‹æ‰§è¡Œã€‚&#x20;</li></ul></li><li><p><strong>æ½œåœ¨é£é™©3</strong>ï¼šå½“é”çš„è¿‡æœŸæ—¶é—´å·²ç»åˆ°äº†ï¼Œä½†ä¸šåŠ¡è¿˜æ²¡æœ‰å®Œæˆã€‚</p><ul><li><strong>è§£å†³æ–¹æ³•</strong>ï¼šå¯åŠ¨ä¸€ä¸ªçœ‹é—¨ç‹—ï¼ˆgoå¯åŠ¨ä¸€ä¸ªgoroutineï¼‰ï¼Œåœ¨è¿‡æœŸä¹‹å‰åˆ·æ–°ä¸€ä¸‹è¿‡æœŸæ—¶é—´ã€‚&#x20;</li></ul></li></ol><h2 id="11-ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#11-ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”çš„ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="11.ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”çš„ä¼˜ç‚¹å’Œç¼ºç‚¹?"></a>11.ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”çš„ä¼˜ç‚¹å’Œç¼ºç‚¹?</h2><ul><li><p>ä¼˜ç‚¹ï¼šæ€§èƒ½é«˜æ•ˆï¼›å®ç°æ–¹ä¾¿ï¼›é¿å…å•ç‚¹æ•…éšœã€‚</p></li><li><p>ç¼ºç‚¹ï¼šè¶…æ—¶æ—¶ é—´ä¸å¥½è®¾ç½®ã€‚å¦‚æœé”çš„è¶…æ—¶é—´è®¾ç½®è¿‡é•¿ï¼Œä¼šå½±å“æ€§èƒ½ï¼Œå¦‚æœè®¾ç½®çš„è¶…æ—¶é—´è¿‡çŸ­ä¼šä¿æŠ¤ä¸åˆ°å…±äº«èµ„æºã€‚Redisä¸»ä»å¤åˆ¶æ¨¡å¼ä¸­çš„æ•°æ®æ˜¯å¼‚æ­¥å¤åˆ¶çš„ï¼Œå¯¼è‡´åˆ†å¸ƒå¼é”çš„ä¸å¯é æ€§ã€‚å¦‚æœåœ¨Redisä¸»èŠ‚ç‚¹è·å–åˆ°é”åï¼Œåœ¨æ²¡æœ‰åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹æ—¶ï¼ŒRedisä¸»èŠ‚ç‚¹å®•æœºäº†ï¼Œæ­¤æ—¶æ–°çš„Redisä¸»èŠ‚ç‚¹ä¾ç„¶å¯ä»¥è·å–é”ï¼Œæ‰€ä»¥å¤šä¸ªåº”ç”¨æœåŠ¡å°±å¯ä»¥åŒæ—¶è·å–åˆ°é”ã€‚</p></li></ul><h2 id="12-å¦‚ä½•ä¸ºåˆ†å¸ƒå¼é”è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´"><a href="#12-å¦‚ä½•ä¸ºåˆ†å¸ƒå¼é”è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´" class="headerlink" title="12.å¦‚ä½•ä¸ºåˆ†å¸ƒå¼é”è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´?"></a>12.å¦‚ä½•ä¸ºåˆ†å¸ƒå¼é”è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´?</h2><p>å¯ä»¥åŸºäºç»­çº¦çš„æ–¹å¼è®¾ç½®è¶…æ—¶æ—¶é—´ï¼šå…ˆç»™é”è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œç„¶åå¯åŠ¨ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ï¼Œè®©å®ˆæŠ¤çº¿ç¨‹åœ¨ä¸€æ®µæ—¶é—´åï¼Œé‡æ–°è®¾ç½®è¿™ä¸ªé”çš„è¶…æ—¶æ—¶é—´ã€‚å®ç°æ–¹å¼å°±æ˜¯ï¼šå†™ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ï¼Œç„¶åå»åˆ¤æ–­é”çš„æƒ…å†µï¼Œå½“é”å¿«å¤±æ•ˆçš„æ—¶å€™ï¼Œå†æ¬¡è¿›è¡Œç»­çº¦åŠ é”ï¼Œå½“ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæˆåï¼Œé”€æ¯ç»­çº¦é”å³å¯ï¼Œä¸è¿‡è¿™ç§æ–¹å¼å®ç°èµ·æ¥ç›¸å¯¹å¤æ‚ã€‚&#x20;</p><h2 id="13-â“Redisè§£å†³é›†ç¾¤æƒ…å†µä¸‹åˆ†å¸ƒå¼é”çš„å¯é æ€§"><a href="#13-â“Redisè§£å†³é›†ç¾¤æƒ…å†µä¸‹åˆ†å¸ƒå¼é”çš„å¯é æ€§" class="headerlink" title="13.â“Redisè§£å†³é›†ç¾¤æƒ…å†µä¸‹åˆ†å¸ƒå¼é”çš„å¯é æ€§?"></a>13.â“Redisè§£å†³é›†ç¾¤æƒ…å†µä¸‹åˆ†å¸ƒå¼é”çš„å¯é æ€§?</h2><p>åˆ†å¸ƒå¼é”ç®—æ³•Redlockï¼ˆçº¢é”ï¼‰ã€‚åŸºäºå¤šä¸ªRedisèŠ‚ç‚¹çš„åˆ†å¸ƒå¼é”ï¼Œå³ä½¿æœ‰èŠ‚ç‚¹å‘ç”Ÿäº†æ•…éšœï¼Œé”å˜é‡ä»ç„¶æ˜¯å­˜åœ¨çš„ï¼Œå®¢æˆ·ç«¯è¿˜æ˜¯å¯ä»¥å®Œæˆé”æ“ä½œã€‚å®˜æ–¹æ¨èæ˜¯è‡³å°‘éƒ¨ç½²5ä¸ªRedisèŠ‚ç‚¹ï¼Œè€Œä¸”éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œéƒ½æ˜¯ä¸€ä¸ªä¸ªå­¤ç«‹çš„èŠ‚ç‚¹ã€‚</p><p><strong>åŸºæœ¬æ€è·¯ï¼š</strong>&#x662F;è®©å®¢æˆ·ç«¯å’Œå¤šä¸ªç‹¬ç«‹çš„RedisèŠ‚ç‚¹ä¾æ¬¡è¯·æ±‚ç”³è¯·åŠ é”ï¼Œ<strong>å¦‚æœå®¢æˆ·ç«¯èƒ½å¤Ÿå’ŒåŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹æˆåŠŸåœ°å®ŒæˆåŠ é”æ“ä½œï¼Œé‚£ä¹ˆå°±è®¤ä¸ºï¼Œå®¢æˆ·ç«¯æˆåŠŸåœ°è·å¾—åˆ†å¸ƒå¼é”</strong>ï¼Œå¦åˆ™åŠ é”å¤±è´¥ã€‚å³ä½¿æœ‰æŸä¸ªRedisèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œé”çš„æ•°æ®åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šä¹Ÿæœ‰ä¿å­˜ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æ­£å¸¸åœ°è¿›è¡Œé”æ“ä½œï¼Œé”çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢ã€‚</p><p>Redlockç®—æ³•åŠ é”ä¸‰ä¸ªè¿‡ç¨‹ï¼š</p><p>åŠ é”æˆåŠŸè¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼šæœ‰è¶…è¿‡åŠæ•°çš„RedisèŠ‚ç‚¹æˆåŠŸçš„è·å–åˆ°äº†é”ï¼Œå¹¶ä¸”æ€»è€—æ—¶æ²¡æœ‰è¶…è¿‡é”çš„æœ‰æ•ˆæ—¶é—´ï¼Œé‚£ä¹ˆå°±æ˜¯åŠ é”æˆåŠŸã€‚</p><p>åŠ é”æˆåŠŸåï¼Œå®¢æˆ·ç«¯éœ€è¦é‡æ–°è®¡ç®—è¿™æŠŠé”çš„æœ‰æ•ˆæ—¶é—´ï¼Œè®¡ç®—çš„ç»“æœæ˜¯ã€Œé”æœ€åˆè®¾ç½®çš„è¿‡æœŸæ—¶é—´ã€å‡å»ã€Œå®¢æˆ·ç«¯ä»å¤§å¤šæ•°èŠ‚ç‚¹è·å–é”çš„æ€»è€—æ—¶ï¼ˆt2-t1ï¼‰ã€ã€‚å¦‚æœè®¡ç®—çš„ç»“æœå·²ç»æ¥ä¸åŠå®Œæˆå…±äº«æ•°æ®çš„æ“ä½œäº†ï¼Œå¯ä»¥é‡Šæ”¾é”ï¼Œä»¥å…å‡ºç°è¿˜æ²¡å®Œæˆæ•°æ®æ“ä½œï¼Œé”å°±è¿‡æœŸäº†çš„æƒ…å†µã€‚åŠ é”å¤±è´¥åï¼Œå®¢æˆ·ç«¯å‘æ‰€æœ‰RedisèŠ‚ç‚¹å‘èµ·é‡Šæ”¾é”çš„æ“ä½œï¼Œæ‰§è¡Œé‡Šæ”¾é”çš„Luaè„šæœ¬å°±å¯ä»¥ã€‚&#x20;</p><h2 id="14-Redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#14-Redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="14.Redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>14.Redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>ç®¡é“æŠ€æœ¯æ˜¯å®¢æˆ·ç«¯æä¾›çš„ä¸€ç§æ‰¹å¤„ç†æŠ€æœ¯ï¼Œç”¨äºä¸€æ¬¡å¤„ç†å¤šä¸ª Redis å‘½ä»¤ï¼Œä»è€Œæé«˜æ•´ä¸ªäº¤äº’çš„æ€§èƒ½ã€‚ä½¿ç”¨ç®¡é“æŠ€æœ¯å¯ä»¥è§£å†³å¤šä¸ªå‘½ä»¤æ‰§è¡Œæ—¶çš„ç½‘ç»œç­‰å¾…ï¼Œå®ƒæ˜¯æŠŠå¤šä¸ªå‘½ä»¤æ•´åˆåˆ°ä¸€èµ·å‘é€ç»™æœåŠ¡å™¨ç«¯å¤„ç†ä¹‹åç»Ÿä¸€è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿™æ ·å°±å…å»äº†æ¯æ¡å‘½ä»¤æ‰§è¡Œåéƒ½è¦ç­‰å¾…çš„æƒ…å†µï¼Œä»è€Œæœ‰æ•ˆåœ°æé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><p>ä½†ä½¿ç”¨ç®¡é“æŠ€æœ¯ä¹Ÿè¦æ³¨æ„é¿å…å‘é€çš„å‘½ä»¤è¿‡å¤§ï¼Œæˆ–ç®¡é“å†…çš„æ•°æ®å¤ªå¤šè€Œå¯¼è‡´çš„ç½‘ç»œé˜»å¡ã€‚ç®¡é“æŠ€æœ¯æœ¬è´¨ä¸Šæ˜¯å®¢æˆ·ç«¯æä¾›çš„åŠŸèƒ½ï¼Œè€Œé Redis æœåŠ¡å™¨ç«¯çš„åŠŸèƒ½ã€‚</p><blockquote><p>Redis çš„IOå¤šè·¯å¤ç”¨ç”¨çš„æ˜¯ç®¡é“ï¼Ÿ</p><h2 id="è¯´è¯´ä½ å¯¹PIPELINEçš„ç†è§£"><a href="#è¯´è¯´ä½ å¯¹PIPELINEçš„ç†è§£" class="headerlink" title="è¯´è¯´ä½ å¯¹PIPELINEçš„ç†è§£"></a>è¯´è¯´ä½ å¯¹PIPELINEçš„ç†è§£</h2><p>redisæœ¬ç«¯ç½‘ç»œé€šä¿¡ä½¿ç”¨çš„æ˜¯Redisåè®®ï¼Œæœ¬è´¨ä¸Šæ˜¯æŠŠæˆ‘ä»¬çš„å‘½ä»¤é€šè¿‡åè®®åŒ…è£…å‘é€ç»™redisï¼Œéœ€è¦ç»è¿‡ç¼–ç è§£ç å’Œç½‘ç»œä¼ è¾“çš„è¿‡ç¨‹ã€‚å¦‚æœæ¯æ¬¡å‘é€çš„æ•°æ®è¾ƒå°‘ï¼Œèƒ½å¤ŸæŠŠæ—¶é—´æ¶ˆè€—åœ¨è§£ç å’Œæ‹†åŒ…çš„æ—¶é—´çŸ­ï¼Œæ—¶é—´å…¨æµªè´¹åœ¨è¿™äº›æ—¶é—´ä¸Šäº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<strong>pipelineï¼Œå•æ¬¡ç½‘ç»œé€šä¿¡ä¼ è¾“ä¸€å †æŒ‡ä»¤ï¼Œå‡å°‘ç½‘ç»œé€šä¿¡æ¥å›çš„æ¬¡æ•°ã€‚&#x20;</strong></p></blockquote><h2 id="15-Rediså¦‚ä½•å¤„ç†å¤§key"><a href="#15-Rediså¦‚ä½•å¤„ç†å¤§key" class="headerlink" title="15.Rediså¦‚ä½•å¤„ç†å¤§key?"></a>15.Rediså¦‚ä½•å¤„ç†å¤§key?</h2><p><strong>å®šä¹‰ï¼šStringç±»å‹çš„å€¼å¤§äº10 KBï¼›Hashã€Listã€Setã€ZSetç±»å‹çš„å…ƒç´ çš„ä¸ªæ•°è¶…è¿‡5000ä¸ªï¼›</strong></p><p><strong>å½±å“ï¼š</strong></p><p><strong>å¤„ç†ï¼š</strong></p><ul><li><p>æŠŠå¤§keyæ‹†åˆ†æˆå¤šä¸ªå°keyæ¥å­˜å‚¨ã€‚æ¯”å¦‚æŠŠä¸€ä¸ªå¤§çš„å“ˆå¸Œç»“æ„åˆ†å‰²æˆå¤šä¸ªå°çš„å“ˆå¸Œç»“æ„ï¼Œå‡å°‘å•ä¸ªkeyçš„å¤§å°ä»¥é™ä½å†…å­˜çš„å‹åŠ›ã€‚</p><ul><li><p>å½“valueæ˜¯stringæ—¶ï¼Œæ¯”è¾ƒéš¾æ‹†åˆ†ï¼Œåˆ™ä½¿ç”¨åºåˆ—åŒ–ã€å‹ç¼©ç®—æ³•å°†keyçš„å¤§å°æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ï¼Œä½†æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½ä¼šå¸¦æ¥æ›´å¤šæ—¶é—´ä¸Šçš„æ¶ˆè€—ã€‚</p></li><li><p>å½“valueæ˜¯stringï¼Œå‹ç¼©ä¹‹åä»ç„¶æ˜¯å¤§keyï¼Œåˆ™éœ€è¦è¿›è¡Œæ‹†åˆ†ï¼Œä¸€ä¸ªå¤§keyåˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼Œè®°å½•æ¯ä¸ªéƒ¨åˆ†çš„keyï¼Œä½¿ç”¨multigetç­‰æ“ä½œå®ç°äº‹åŠ¡è¯»å–ã€‚</p></li><li><p>åˆ†æ‹†æˆå‡ ä¸ªkey-valueï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªhashä¸­ï¼Œæ¯ä¸ªfieldä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å±æ€§ï¼Œä½¿ç”¨hgetï¼Œhmgetæ¥è·å–éƒ¨åˆ†çš„valueï¼Œä½¿ç”¨hsetï¼Œhmsetæ›´æ–°éƒ¨åˆ†å±æ€§</p></li><li><p>å½“valueæ˜¯list/setç­‰é›†åˆç±»å‹æ—¶ï¼Œæ ¹æ®é¢„ä¼°çš„æ•°æ®è§„æ¨¡æ¥è¿›è¡Œåˆ†ç‰‡ï¼Œä¸åŒçš„å…ƒç´ è®¡ç®—ååˆ†åˆ°ä¸åŒçš„ç‰‡ã€‚&#x20;</p></li></ul></li><li><p>æ­å»ºredisé›†ç¾¤ï¼ŒæŠŠkeyåˆ†é…åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œé™ä½å•ä¸ªredisèŠ‚ç‚¹çš„å­˜å‚¨å‹åŠ›ã€‚</p></li></ul><h2 id="16-Redisæ”¯æŒäº‹åŠ¡å›æ»šå—ï¼Ÿ"><a href="#16-Redisæ”¯æŒäº‹åŠ¡å›æ»šå—ï¼Ÿ" class="headerlink" title="16.Redisæ”¯æŒäº‹åŠ¡å›æ»šå—ï¼Ÿ"></a>16.Redisæ”¯æŒäº‹åŠ¡å›æ»šå—ï¼Ÿ</h2><p>ä¸æ”¯æŒï¼ŒRedis æä¾›çš„ DISCARD å‘½ä»¤åªèƒ½ç”¨æ¥ä¸»åŠ¨æ”¾å¼ƒäº‹åŠ¡æ‰§è¡Œï¼ŒæŠŠæš‚å­˜çš„å‘½ä»¤é˜Ÿåˆ—æ¸…ç©ºï¼Œèµ·ä¸åˆ°å›æ»šçš„æ•ˆæœã€‚å› ä¸ºRedis äº‹åŠ¡çš„æ‰§è¡Œæ—¶ï¼Œé”™è¯¯é€šå¸¸éƒ½æ˜¯ç¼–ç¨‹é”™è¯¯é€ æˆçš„ï¼Œè¿™ç§é”™è¯¯é€šå¸¸åªä¼šå‡ºç°åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œè€Œå¾ˆå°‘ä¼šåœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œæ‰€ä»¥å®˜æ–¹è®¤ä¸ºæ²¡æœ‰å¿…è¦ä¸º Redis å¼€å‘äº‹åŠ¡å›æ»šåŠŸèƒ½ã€‚</p><h2 id="17-Redisåˆ°åº•æ”¯ä¸æ”¯æŒäº‹åŠ¡å•Šï¼Ÿ"><a href="#17-Redisåˆ°åº•æ”¯ä¸æ”¯æŒäº‹åŠ¡å•Šï¼Ÿ" class="headerlink" title="17. Redisåˆ°åº•æ”¯ä¸æ”¯æŒäº‹åŠ¡å•Šï¼Ÿ"></a>17. Redisåˆ°åº•æ”¯ä¸æ”¯æŒäº‹åŠ¡å•Šï¼Ÿ</h2><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image22.png" alt=""></p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image23.png" alt=""></p><p>Redis æ”¯æŒäº‹åŠ¡ã€‚</p><p>Redis äº‹åŠ¡å¯ä»¥è®©ä¸€ç³»åˆ—å‘½ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤æ‰“æ–­ã€‚</p><p>Redis äº‹åŠ¡ä½¿ç”¨ <code>MULTI</code> å‘½ä»¤å¼€å¯ï¼Œç„¶åå°†å¤šä¸ªå‘½ä»¤æ”¾å…¥äº‹åŠ¡ä¸­ï¼Œæœ€åä½¿ç”¨ <code>EXEC</code> å‘½ä»¤æ‰§è¡Œäº‹åŠ¡ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRedis äº‹åŠ¡ä¸æ”¯æŒå›æ»šï¼Œå³åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŸæ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œä¸ä¼šå½±å“å·²ç»æ‰§è¡ŒæˆåŠŸçš„å‘½ä»¤ï¼Œä¹Ÿä¸ä¼šå›æ»šæ•´ä¸ªäº‹åŠ¡ã€‚ä½†ä» Redis 2.6 ç‰ˆæœ¬å¼€å§‹ï¼Œå¢åŠ äº†å¯¹ä¹è§‚é”çš„æ”¯æŒï¼Œé€šè¿‡ <code>WATCH</code> å‘½ä»¤å¯ä»¥åœ¨äº‹åŠ¡æ‰§è¡Œå‰ç›‘è§†ä¸€äº›é”®ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­è¿™äº›é”®è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼Œäº‹åŠ¡ä¼šæ‰§è¡Œå¤±è´¥ã€‚</p><h1 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h1><p><img src="2025-01-09-Redisé¢è¯•é¢˜/diagram-2.png" alt=""></p><h2 id="1-REDIS-é›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆ"><a href="#1-REDIS-é›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="1. REDIS é›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆ"></a>1. REDIS é›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆ</h2><p>Redisé›†ç¾¤é€šè¿‡<strong>æ•°æ®åˆ†ç‰‡å’Œä¸»ä»å¤åˆ¶</strong>å®ç°äº†æ¨ªå‘æ‰©å±•å’Œé«˜å¯ç”¨æ€§ã€‚å®ƒå°†<strong>æ•°æ®åˆ’åˆ†ä¸º16384ä¸ªå“ˆå¸Œæ§½</strong>ï¼Œå¹¶å°†è¿™äº›æ§½å‡åŒ€åœ°åˆ†é…åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£å¤„ç†ä¸€éƒ¨åˆ†æ§½çš„æ•°æ®ï¼Œå®ç°äº†æ•°æ®çš„åˆ†æ•£å­˜å‚¨å’Œè´Ÿè½½å‡è¡¡ã€‚</p><p>åœ¨é›†ç¾¤ä¸­ï¼Œ<strong>æ¯ä¸ªå“ˆå¸Œæ§½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œå¤šä¸ªä»èŠ‚ç‚¹</strong>ã€‚ä¸»èŠ‚ç‚¹è´Ÿè´£å¤„ç†è¯»å†™è¯·æ±‚ï¼Œè€Œä»èŠ‚ç‚¹åˆ™é€šè¿‡ä¸»ä»å¤åˆ¶æœºåˆ¶å¤åˆ¶ä¸»èŠ‚ç‚¹çš„æ•°æ®ï¼Œæä¾›æ•°æ®çš„å†—ä½™å¤‡ä»½å’Œæ•…éšœæ¢å¤åŠŸèƒ½ã€‚</p><p>å½“ä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œé›†ç¾¤ä¼šè‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»ã€‚å®ƒä¼šé€‰ä¸¾ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä¿è¯æœåŠ¡çš„æŒç»­å¯ç”¨æ€§ã€‚åŒæ—¶ï¼Œé›†ç¾¤ç®¡ç†èŠ‚ç‚¹è´Ÿè´£ç›‘æ§èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå¹¶åè°ƒæ•…éšœè½¬ç§»è¿‡ç¨‹ã€‚</p><p><strong>å®¢æˆ·ç«¯åœ¨ä¸Redisé›†ç¾¤äº¤äº’æ—¶ï¼Œæ ¹æ®é”®çš„å“ˆå¸Œå€¼å°†è¯·æ±‚å‘é€åˆ°ç›¸åº”çš„èŠ‚ç‚¹ã€‚å®¢æˆ·ç«¯è¿˜å¯ä»¥é€šè¿‡é›†ç¾¤ç®¡ç†èŠ‚ç‚¹è·å–æ•´ä¸ªé›†ç¾¤çš„æ‹“æ‰‘ä¿¡æ¯ï¼Œäº†è§£å“ªäº›é”®å­˜å‚¨åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šã€‚</strong></p><p>é€šè¿‡æ•°æ®åˆ†ç‰‡å’Œä¸»ä»å¤åˆ¶ï¼ŒRedisé›†ç¾¤å®ç°äº†æ•°æ®æ°´å¹³åˆ‡åˆ†ã€è´Ÿè½½å‡è¡¡å’Œé«˜å¯ç”¨æ€§ã€‚å®ƒå…è®¸æ•°æ®è§„æ¨¡å’Œååé‡çš„çº¿æ€§æ‰©å±•ï¼Œå¹¶èƒ½è‡ªåŠ¨å¤„ç†èŠ‚ç‚¹æ•…éšœã€‚é›†ç¾¤ç®¡ç†èŠ‚ç‚¹åè°ƒé›†ç¾¤çŠ¶æ€ï¼Œå®¢æˆ·ç«¯é€šè¿‡å“ˆå¸Œæ˜ å°„ä¸é›†ç¾¤äº¤äº’ï¼Œä»è€Œå®ç°äº†ä¸€ä¸ªç¨³å®šå’Œå¯é çš„Redisåˆ†å¸ƒå¼ç³»ç»Ÿã€‚&#x20;</p><p><img src="2025-01-09-Redisé¢è¯•é¢˜/image16.png" alt=""></p><h2 id="2-REDISé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨"><a href="#2-REDISé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨" class="headerlink" title="2. REDISé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨"></a>2. REDISé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨</h2><ol><li><p>å¤šä¸ªä¸»èŠ‚ç‚¹åŒæ—¶æ•…éšœï¼šå¦‚æœå¤šä¸ªä¸»èŠ‚ç‚¹åŒæ—¶å‘ç”Ÿæ•…éšœï¼Œè€Œä¸”å®ƒä»¬çš„ä»èŠ‚ç‚¹æ— æ³•å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°†æ— æ³•æä¾›è¯»å†™æœåŠ¡ã€‚</p></li><li><p>é›†ç¾¤ç®¡ç†èŠ‚ç‚¹æ•…éšœï¼šé›†ç¾¤ç®¡ç†èŠ‚ç‚¹è´Ÿè´£ç›‘æ§é›†ç¾¤çŠ¶æ€å’Œåè°ƒæ•…éšœè½¬ç§»æ“ä½œã€‚å¦‚æœé›†ç¾¤ç®¡ç†èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå¹¶ä¸”æ— æ³•åŠæ—¶æ¢å¤æˆ–æ›¿æ¢ï¼Œé‚£ä¹ˆé›†ç¾¤å°†å¤±å»ç®¡ç†å’Œåè°ƒèƒ½åŠ›ï¼Œå¯èƒ½å¯¼è‡´é›†ç¾¤ä¸å¯ç”¨ã€‚</p></li><li><p>ç½‘ç»œåˆ†åŒºï¼šå¦‚æœé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´å‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œå³æ— æ³•äº’ç›¸é€šä¿¡ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¼•èµ·è„‘è£‚ï¼ˆsplit - brainï¼‰é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†åŒºå†…çš„èŠ‚ç‚¹å¯èƒ½ä¼šè®¤ä¸ºè‡ªå·±æ˜¯åˆæ³•çš„Redisé›†ç¾¤ï¼Œå¯¼è‡´æ•°æ®å†²çªå’Œä¸ä¸€è‡´æ€§ï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªé›†ç¾¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p></li><li><p>é…ç½®é”™è¯¯ï¼šå¦‚æœRedisé›†ç¾¤çš„é…ç½®å‡ºç°é”™è¯¯æˆ–è€…æŸäº›èŠ‚ç‚¹çš„é…ç½®ä¸ä¸€è‡´ï¼Œå¯èƒ½å¯¼è‡´é›†ç¾¤æ— æ³•æ­£å¸¸è¿è¡Œã€‚</p></li><li><p>å†…å­˜ä¸è¶³ï¼šå¦‚æœé›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹çš„å†…å­˜ä¸è¶³ä»¥å®¹çº³å½“å‰å¤„ç†çš„æ•°æ®é‡ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯¥èŠ‚ç‚¹æ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒï¼Œä»è€Œå½±å“æ•´ä¸ªé›†ç¾¤çš„å¯ç”¨æ€§ã€‚&#x20;</p></li></ol><h2 id="3-â­ï¸REDISé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆ"><a href="#3-â­ï¸REDISé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆ" class="headerlink" title="3. â­ï¸REDISé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆ"></a>3. â­ï¸REDISé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆ</h2><p>åœ¨Redisé›†ç¾¤ä¸­ï¼Œç”±äºé‡‡ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹çš„å¼‚æ­¥å¤åˆ¶æœºåˆ¶ï¼Œå†™æ“ä½œæœ‰ä¸€å®šçš„ä¸¢å¤±é£é™©ã€‚</p><p>å½“å®¢æˆ·ç«¯å‘ä¸»èŠ‚ç‚¹å‘é€å†™æ“ä½œæ—¶ï¼Œä¸»èŠ‚ç‚¹ä¼šç«‹å³è¿”å›æˆåŠŸå“åº”ï¼Œè€Œä¸ç­‰å¾…æ‰€æœ‰ä»èŠ‚ç‚¹æ‰§è¡Œå¤åˆ¶ã€‚å¦‚æœä¸»èŠ‚ç‚¹åœ¨æ‰§è¡Œå®Œå†™æ“ä½œåå‡ºç°æ•…éšœæˆ–ç½‘ç»œé—®é¢˜ï¼Œå¯¼è‡´ä»èŠ‚ç‚¹æ— æ³•åŠæ—¶æ¥æ”¶åˆ°å¤åˆ¶æ“ä½œï¼Œé‚£ä¹ˆè¿™äº›æœªå¤åˆ¶çš„å†™æ“ä½œå°†ä¼šä¸¢å¤±ã€‚&#x20;</p><h2 id="4-ä¸»ä»æ¨¡å¼çš„åŒæ­¥è¿‡ç¨‹ï¼Ÿ"><a href="#4-ä¸»ä»æ¨¡å¼çš„åŒæ­¥è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="4.ä¸»ä»æ¨¡å¼çš„åŒæ­¥è¿‡ç¨‹ï¼Ÿ"></a>4.ä¸»ä»æ¨¡å¼çš„åŒæ­¥è¿‡ç¨‹ï¼Ÿ</h2><h3 id="ç¬¬ä¸€æ¬¡åŒæ­¥"><a href="#ç¬¬ä¸€æ¬¡åŒæ­¥" class="headerlink" title="ç¬¬ä¸€æ¬¡åŒæ­¥"></a>ç¬¬ä¸€æ¬¡åŒæ­¥</h3><p>ä¸»è¦åˆ†ä¸ºå»ºç«‹è¿æ¥åå•†ã€ä¸»ä»æ•°æ®åŒæ­¥ã€å‘é€æ–°æ“ä½œä¸‰ä¸ªæ­¥éª¤ï¼š</p><ul><li><p>è¿æ¥åå•†ï¼šä»æœåŠ¡å™¨å…ˆå‘é€å‘½ä»¤ç»™ä¸»æœåŠ¡å™¨è¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå‘½ä»¤å†…å®¹åŒ…æ‹¬ä¸»æœåŠ¡å™¨çš„runIDå’Œå¤åˆ¶è¿›åº¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸»æœåŠ¡å™¨æ”¶åˆ°å‘½ä»¤ä¹‹åä¼šç»™ä»æœåŠ¡å“åº”å‘½ä»¤ï¼Œå“åº”åŒ…æ‹¬ä¸»æœåŠ¡å™¨çš„runIDå’Œå¤åˆ¶è¿›åº¦ã€‚ä»æœåŠ¡å™¨æ”¶åˆ°å“åº”ä¹‹åä¼šè®°å½•è¿™ä¸¤ä¸ªå€¼ã€‚</p></li><li><p>ä¸»ä»æ•°æ®åŒæ­¥ï¼šä¸»æœåŠ¡å™¨ç”ŸæˆRDBæ–‡ä»¶å¹¶å‘é€ç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨æ”¶åˆ°RDBä¹‹åå…ˆæ¸…ç©ºè‡ªå·±çš„æ•°æ®ï¼Œå†è½½å…¥RDBæ–‡ä»¶ã€‚ä¸ºäº†ä¸»ä»æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¿™ä¸ªæœŸé—´ä¸»æœåŠ¡å™¨åç»­çš„å†™æ“ä½œä¼šè®°å½•åˆ°replication bufferç¼“å†²åŒºé‡Œã€‚</p></li><li><p>å‘é€æ–°æ“ä½œï¼šä¸»æœåŠ¡å™¨å‘é€replication bufferé‡Œé¢çš„å†™æ“ä½œç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨æ‰§è¡Œè¿™äº›æ“ä½œã€‚ç¬¬ä¸€æ¬¡åŒæ­¥å®Œæˆã€‚</p></li></ul><h3 id="å‘½ä»¤ä¼ æ’­"><a href="#å‘½ä»¤ä¼ æ’­" class="headerlink" title="å‘½ä»¤ä¼ æ’­"></a>å‘½ä»¤ä¼ æ’­</h3><p>ç¬¬ä¸€æ¬¡åŒæ­¥å®Œæˆä¹‹ååŒæ–¹ä¼šç»´æŠ¤ä¸€ä¸ªTCPè¿æ¥ï¼Œåç»­ä¸»æœåŠ¡å™¨çš„å†™å‘½ä»¤é€šè¿‡TCPè¿æ¥å‘é€ç»™ä»æœåŠ¡å™¨ï¼Œä¿è¯ä¸»ä»ä¸€è‡´ã€‚</p><h3 id="å‹åŠ›åˆ†æ‘Š"><a href="#å‹åŠ›åˆ†æ‘Š" class="headerlink" title="å‹åŠ›åˆ†æ‘Š"></a>å‹åŠ›åˆ†æ‘Š</h3><p>ä¸ºäº†åˆ†æ‘ŠæœåŠ¡å™¨çš„å‹åŠ›ï¼Œç”Ÿæˆå’Œä¼ è¾“RDBçš„å·¥ä½œå¯ä»¥åˆ†æ‘Šåˆ°ç»ç†ä»æœåŠ¡å™¨ä¸Šã€‚</p><h3 id="å¢é‡å¤åˆ¶"><a href="#å¢é‡å¤åˆ¶" class="headerlink" title="å¢é‡å¤åˆ¶"></a>å¢é‡å¤åˆ¶</h3><p>å¦‚æœæœåŠ¡å™¨ç½‘è·¯æ–­å¼€ï¼Œåœ¨æ¢å¤ä¹‹åï¼Œä¼šæŠŠç½‘ç»œæ–­å¼€æœŸé—´ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤åŒæ­¥ç»™ä»æœåŠ¡å™¨ã€‚&#x20;</p><h2 id="5-ä¸»æœåŠ¡å™¨å¦‚ä½•çŸ¥é“è¦å°†å“ªäº›å¢é‡æ•°æ®å‘é€ç»™ä»æœåŠ¡å™¨ï¼Ÿ"><a href="#5-ä¸»æœåŠ¡å™¨å¦‚ä½•çŸ¥é“è¦å°†å“ªäº›å¢é‡æ•°æ®å‘é€ç»™ä»æœåŠ¡å™¨ï¼Ÿ" class="headerlink" title="5.ä¸»æœåŠ¡å™¨å¦‚ä½•çŸ¥é“è¦å°†å“ªäº›å¢é‡æ•°æ®å‘é€ç»™ä»æœåŠ¡å™¨ï¼Ÿ"></a>5.ä¸»æœåŠ¡å™¨å¦‚ä½•çŸ¥é“è¦å°†å“ªäº›å¢é‡æ•°æ®å‘é€ç»™ä»æœåŠ¡å™¨ï¼Ÿ</h2><p>ç½‘ç»œæ–­å¼€ä»æœåŠ¡å™¨é‡æ–°ä¸Šçº¿ä¹‹åï¼Œä¼šå‘é€è‡ªå·±çš„å¤åˆ¶åç§»é‡åˆ°ä¸»æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨æ ¹æ®åç§»é‡ä¹‹é—´çš„å·®è·åˆ¤æ–­è¦æ‰§è¡Œçš„æ“ä½œï¼šå¦‚æœä»æœåŠ¡å™¨è¦è¯»çš„æ•°æ®åœ¨repl_backlog_buffeä¸­ï¼Œåˆ™é‡‡ç”¨å¢é‡å¤åˆ¶ï¼›å¦‚æœä¸åœ¨ï¼Œé‡‡ç”¨å…¨é‡å¤åˆ¶ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯repl_backlog_bufferï¼Ÿâ€‹</p><p>repl_backlog_bufferæ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œç”¨äºä¸»ä»æœåŠ¡å™¨æ–­è¿åï¼Œä»ä¸­æ‰¾åˆ°å·®å¼‚çš„æ•°æ®ï¼›replication offsetæ ‡è®°ç¼“å†²åŒºçš„åŒæ­¥è¿›åº¦ã€‚</p></blockquote><h2 id="6-å¦‚ä½•é¿å…ä¸»ä»æ•°æ®çš„ä¸ä¸€è‡´ï¼Ÿ"><a href="#6-å¦‚ä½•é¿å…ä¸»ä»æ•°æ®çš„ä¸ä¸€è‡´ï¼Ÿ" class="headerlink" title="6.å¦‚ä½•é¿å…ä¸»ä»æ•°æ®çš„ä¸ä¸€è‡´ï¼Ÿ"></a>6.å¦‚ä½•é¿å…ä¸»ä»æ•°æ®çš„ä¸ä¸€è‡´ï¼Ÿ</h2><p>è®©ä¸»ä»èŠ‚ç‚¹å¤„äºåŒä¸€æœºæˆ¿ï¼Œé™ä½ç½‘ç»œå»¶è¿Ÿï¼›æˆ–è€…ç”±å¤–éƒ¨ç¨‹åºç›‘æ§ä¸»ä»å¤åˆ¶è¿›åº¦ï¼šå…ˆè®¡ç®—å¾—å‡ºä¸»ä»æœåŠ¡ä¹‹é—´çš„å¤åˆ¶è¿›åº¦å·®ï¼Œå¦‚æœå¤åˆ¶è¿›åº¦å·®å¤§äºç¨‹åºè®¾å®šçš„é˜ˆå€¼ï¼Œè®©å®¢æˆ·ç«¯ä¸å†åœ¨æ­¤èŠ‚ç‚¹è¯»å–æ•°æ®ï¼Œå‡å°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µå¯¹ä¸šåŠ¡çš„å½±å“ã€‚</p><p>ä¸ºäº†é¿å…å‡ºç°å®¢æˆ·ç«¯å’Œæ‰€æœ‰ä»èŠ‚ç‚¹éƒ½ä¸èƒ½è¿æ¥çš„æƒ…å†µï¼Œéœ€è¦æŠŠå¤åˆ¶è¿›åº¦å·®å€¼çš„é˜ˆå€¼è®¾ç½®å¾—å¤§ä¸€äº›ã€‚</p><p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%AE%9E%E6%88%98/32%20%20Redis%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E4%B8%8E%E6%95%85%E9%9A%9C%E5%88%87%E6%8D%A2%EF%BC%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%9D%91%EF%BC%9F.md">32 Redisä¸»ä»åŒæ­¥ä¸æ•…éšœåˆ‡æ¢ï¼Œæœ‰å“ªäº›å‘?</a></p><h2 id="7-ä»€ä¹ˆæ˜¯é›†ç¾¤çš„è„‘è£‚ï¼Ÿâ€‹"><a href="#7-ä»€ä¹ˆæ˜¯é›†ç¾¤çš„è„‘è£‚ï¼Ÿâ€‹" class="headerlink" title="7.ä»€ä¹ˆæ˜¯é›†ç¾¤çš„è„‘è£‚ï¼Ÿâ€‹"></a>7.ä»€ä¹ˆæ˜¯é›†ç¾¤çš„è„‘è£‚ï¼Ÿâ€‹</h2><p>å¦‚æœä¸»èŠ‚ç‚¹çš„ç½‘ç»œçªç„¶å‘ç”Ÿäº†é—®é¢˜ä¸æ‰€æœ‰çš„ä»èŠ‚ç‚¹éƒ½å¤±è”äº†ï¼Œä½†æ­¤æ—¶çš„ä¸»èŠ‚ç‚¹å’Œå®¢æˆ·ç«¯çš„ç½‘ç»œæ˜¯æ­£å¸¸çš„ï¼Œå®¢æˆ·ç«¯ä¸çŸ¥é“é›†ç¾¤å†…éƒ¨å·²ç»å‡ºç°äº†é—®é¢˜ï¼Œè¿˜åœ¨å‘è¿™ä¸ªå¤±è”çš„ä¸»èŠ‚ç‚¹å†™æ•°æ®ï¼Œæ­¤æ—¶è¿™äº›æ•°æ®è¢«ä¸»èŠ‚ç‚¹ç¼“å­˜åˆ°äº†ç¼“å†²åŒºé‡Œã€‚å“¨å…µä¹Ÿå‘ç°ä¸»èŠ‚ç‚¹å¤±è”äº†ï¼Œå°±ä¼šåœ¨ä»èŠ‚ç‚¹ä¸­é€‰ä¸¾å‡ºä¸€ä¸ªleaderä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œä¼šå¯¼è‡´é›†ç¾¤æœ‰ä¸¤ä¸ªä¸»èŠ‚ç‚¹ã€‚</p><p>ç½‘ç»œæ¢å¤åå“¨å…µå› ä¸ºä¹‹å‰å·²ç»é€‰ä¸¾å‡ºä¸€ä¸ªæ–°ä¸»èŠ‚ç‚¹äº†ï¼Œå®ƒå°±ä¼šæŠŠæ—§ä¸»èŠ‚ç‚¹é™çº§ï¼Œç„¶åä»æ—§ä¸»èŠ‚ç‚¹ä¼šå‘æ–°ä¸»èŠ‚ç‚¹è¯·æ±‚æ•°æ®åŒæ­¥ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡åŒæ­¥æ˜¯å…¨é‡åŒæ­¥çš„æ–¹å¼ï¼Œæ—§ä¸»èŠ‚ç‚¹ä¼šæ¸…ç©ºæ‰è‡ªå·±æœ¬åœ°çš„æ•°æ®ã€‚å®¢æˆ·ç«¯åœ¨è¿‡ç¨‹ä¹‹å‰å†™å…¥çš„æ•°æ®å°±ä¼šä¸¢å¤±äº†ã€‚æ‰€ä»¥è„‘è£‚ä¼šå¯¼è‡´é›†ç¾¤æ•°æ®çš„ä¸¢å¤±ã€‚</p><h2 id="8-å¦‚ä½•å‡å°‘ä¸»ä»åˆ‡æ¢å¸¦æ¥çš„æ•°æ®ä¸¢å¤±ï¼Ÿâ€‹"><a href="#8-å¦‚ä½•å‡å°‘ä¸»ä»åˆ‡æ¢å¸¦æ¥çš„æ•°æ®ä¸¢å¤±ï¼Ÿâ€‹" class="headerlink" title="8.å¦‚ä½•å‡å°‘ä¸»ä»åˆ‡æ¢å¸¦æ¥çš„æ•°æ®ä¸¢å¤±ï¼Ÿâ€‹"></a>8.å¦‚ä½•å‡å°‘ä¸»ä»åˆ‡æ¢å¸¦æ¥çš„æ•°æ®ä¸¢å¤±ï¼Ÿâ€‹</h2><p><strong>å¼‚æ­¥å¤åˆ¶åŒæ­¥ä¸¢å¤±</strong></p><p>é…ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œä¸€æ—¦æ‰€æœ‰çš„ä»èŠ‚ç‚¹æ•°æ®å¤åˆ¶å’ŒåŒæ­¥çš„å»¶è¿Ÿéƒ½è¶…è¿‡äº†é˜ˆå€¼ï¼Œä¸»èŠ‚ç‚¹å°±ä¼šæ‹’ç»æ¥æ”¶ä»»ä½•è¯·æ±‚ã€‚å¯¹äºå®¢æˆ·ç«¯å‘ç°ä¸»èŠ‚ç‚¹ä¸å¯å†™åï¼Œå¯ä»¥é‡‡å–é™çº§æªæ–½ã€‚å°†æ•°æ®æš‚æ—¶å†™å…¥æœ¬åœ°ç¼“å­˜å’Œç£ç›˜ä¸­ï¼Œåœ¨ä¸€æ®µæ—¶é—´åé‡æ–°å†™å…¥ä¸»èŠ‚ç‚¹æ¥ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œä¹Ÿå¯ä»¥å°†æ•°æ®å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç­‰ä¸»èŠ‚ç‚¹æ¢å¤æ­£å¸¸ï¼Œå†éš”ä¸€æ®µæ—¶é—´å»æ¶ˆè´¹æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œè®©å°†æ•°æ®é‡æ–°å†™å…¥ä¸»èŠ‚ç‚¹ã€‚</p><p><strong>é›†ç¾¤äº§ç”Ÿè„‘è£‚æ•°æ®ä¸¢å¤±</strong></p><p>å½“ä¸»èŠ‚ç‚¹å‘ç°ã€Œä»èŠ‚ç‚¹ä¸‹çº¿çš„æ•°é‡å¤ªå¤šã€ï¼Œæˆ–è€…ã€Œç½‘ç»œå»¶è¿Ÿå¤ªå¤§ã€çš„æ—¶å€™ï¼Œé‚£ä¹ˆç¦æ­¢ä¸»èŠ‚ç‚¹è¿›è¡Œå†™æ•°æ®ï¼Œç›´æ¥æŠŠé”™è¯¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è®¾ç½®ä¸»èŠ‚ç‚¹è¿æ¥çš„ä»èŠ‚ç‚¹ä¸­è‡³å°‘æœ‰ N ä¸ªä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸»èŠ‚ç‚¹è¿›è¡Œæ•°æ®å¤åˆ¶æ—¶çš„ ACK æ¶ˆæ¯å»¶è¿Ÿä¸èƒ½è¶…è¿‡ T ç§’ï¼Œå¦åˆ™ï¼Œä¸»èŠ‚ç‚¹å°±ä¸ä¼šå†æ¥æ”¶å®¢æˆ·ç«¯çš„å†™è¯·æ±‚äº†ã€‚ç­‰åˆ°æ–°ä¸»èŠ‚ç‚¹ä¸Šçº¿æ—¶ï¼Œå°±åªæœ‰æ–°ä¸»èŠ‚ç‚¹èƒ½æ¥æ”¶å’Œå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ­¤æ—¶ï¼Œæ–°å†™çš„æ•°æ®ä¼šè¢«ç›´æ¥å†™åˆ°æ–°ä¸»èŠ‚ç‚¹ä¸­ã€‚è€ŒåŸä¸»èŠ‚ç‚¹ä¼šè¢«å“¨å…µé™ä¸ºä»èŠ‚ç‚¹ï¼Œå³ä½¿å®ƒçš„æ•°æ®è¢«æ¸…ç©ºäº†ï¼Œä¹Ÿä¸ä¼šæœ‰æ–°æ•°æ®ä¸¢å¤±ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„Redisé¢è¯•é¢˜</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="Redis" scheme="https://outoflovenicoo.github.io/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>å®ä¹ ç»éªŒ</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-%E5%AE%9E%E4%B9%A0%E7%BB%8F%E9%AA%8C.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-%E5%AE%9E%E4%B9%A0%E7%BB%8F%E9%AA%8C.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Gitä½¿ç”¨"><a href="#1-Gitä½¿ç”¨" class="headerlink" title="1.Gitä½¿ç”¨"></a>1.Gitä½¿ç”¨</h2><ol><li><p>åˆ‡æ¢åˆ°æœ¬åœ°devåˆ†æ”¯ï¼Œå¦‚æ²¡æœ‰</p><ol><li>ä»è¿œç¨‹origin/dev check outä¸€ä¸ªdevåˆ†æ”¯(æœ¬åœ°)</li></ol></li><li><p>ä»è¿œç¨‹æ›´æ–°devåˆ†æ”¯ä»£ç ã€‚åˆå¹¶æ–¹å¼é€‰æ‹©rebase</p></li><li><p>ä»æœ¬åœ°devåˆ†æ”¯ï¼Œåˆ‡å‡ºæ–°çš„å¼€å‘åˆ†æ”¯ï¼Œå¦‚dev_1</p></li><li><p>åœ¨dev_1ä¸Šå¼€å‘ä»£ç æäº¤ã€‚</p></li><li><p>åˆ‡æ¢åˆ°æœ¬åœ°devåˆ†æ”¯ï¼Œå¦‚æ²¡æœ‰</p><ol><li>ä»è¿œç¨‹origin/dev check outä¸€ä¸ªdevåˆ†æ”¯(æœ¬åœ°)</li></ol></li><li><p>ä»è¿œç¨‹æ›´æ–°devåˆ†æ”¯ä»£ç ã€‚åˆå¹¶æ–¹å¼é€‰æ‹©rebase</p></li><li><p>idea gitåˆ†æ”¯é€‰æ‹©å¼€å‘åˆ†æ”¯ï¼Œdev_1</p></li><li><p>é€‰ä¸­å¼€å‘åˆ†æ”¯ä¸Šçš„æäº¤ï¼Œcherry pick</p></li><li><p>æ£€æŸ¥æœ¬åœ°devåˆ†æ”¯æäº¤æ˜¯å¦æ­£å¸¸</p></li><li><p>push æœ¬åœ°devåˆ†æ”¯</p><ol><li><p>pushæç¤ºå†²çªï¼Œåœæ­¢pushã€‚</p></li><li><p>ä»è¿œç¨‹æ›´æ–°devåˆ†æ”¯ä»£ç ã€‚åˆå¹¶æ–¹å¼é€‰æ‹©rebaseï¼Œè§£å†³å¯èƒ½å¾—å†²çª</p></li><li><p>é‡æ–°push</p></li></ol></li></ol><h2 id="2-gitå‡ºç°mergeæäº¤"><a href="#2-gitå‡ºç°mergeæäº¤" class="headerlink" title="2.gitå‡ºç°mergeæäº¤"></a>2.gitå‡ºç°mergeæäº¤</h2><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>åœ¨git pushä¹‹åï¼Œå¤šäº†ä¸€ä¸ªMerge remote-tracking branch XXX æäº¤</p><p>å¦‚ï¼š</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-11-3663206.png" alt=""></p><p>å’Œ</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-10-3663206.png" alt=""></p><p>è¿™å¯¼è‡´æœ‰ä¸¤ä¸ªåˆ†æ”¯æœ¬æ¥æ˜¯åœ¨ä¸»å¹²ä¸Šçš„ï¼Œç»“æœæ–°å‡ºäº†ä¸€ä¸ªåˆ†æ”¯ï¼Œä¸€æ–¹é¢ç»“æ„ç´Šä¹±ï¼Œå¦ä¸€æ–¹é¢å°†æ¥åˆå¹¶ä¹Ÿå›°éš¾ã€‚</p><h3 id="å¤ç›˜ï¼š"><a href="#å¤ç›˜ï¼š" class="headerlink" title="å¤ç›˜ï¼š"></a>å¤ç›˜ï¼š</h3><p>åœ¨ä»devåˆ†æ”¯æ‹‰ä¸‹æ¥çš„ä»£ç å¼€å‘æ—¶æ²¡æœ‰å…ˆpullï¼Œå¯¼è‡´å‡ºç°å†²çªéœ€è¦åˆå¹¶ï¼Œåœ¨åˆå¹¶çš„æ—¶å€™ä½¿ç”¨äº†git mergeå‡ºç°äº†è¿™ç§çŠ¶å†µã€‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-9.png" alt=""></p><h3 id="è§£å†³ï¼š"><a href="#è§£å†³ï¼š" class="headerlink" title="è§£å†³ï¼š"></a>è§£å†³ï¼š</h3><p>åœ¨ä»devåˆ†æ”¯ä¸Šå¼€å‘ä»£ç æ—¶ï¼Œè¦å…ˆpullä¸€ä¸‹ï¼Œåœ¨å¼€å‘å®Œæˆä¹‹åï¼Œæäº¤ä»£ç ä¹‹å‰ä¹Ÿè¦å…ˆpullä¸€ä¸‹ã€‚å³å…ˆpullå†ä¿®æ”¹ï¼Œå…ˆpullå†pushã€‚</p><p>å‡ºç°äº†è¿™ç§é—®é¢˜æ€ä¹ˆè§£å†³ï¼Œå…ˆgit reset</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-7.png" alt=""></p><p>å†git push -forceï¼Œå°†è¿œç¨‹devä»£ç æ”¹å˜ï¼Œå†ä»è¿œç¨‹devæ–°æ‹‰ä¸€ä¸ªåˆ†æ”¯dev-1ï¼Œä½¿ç”¨cherry-pickå°†è‡ªå·±è¦çš„åˆ†æ”¯åŠ åˆ°dev-1åˆ†æ”¯ä¸Šï¼Œå†pushåˆ°è¿œç¨‹devåˆ†æ”¯ã€‚</p><p>ç»“æœï¼š</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image.png" alt=""></p><h2 id="3-å¯åŠ¨ä¸äº†ï¼Œæ’æŸ¥é—®é¢˜"><a href="#3-å¯åŠ¨ä¸äº†ï¼Œæ’æŸ¥é—®é¢˜" class="headerlink" title="3.å¯åŠ¨ä¸äº†ï¼Œæ’æŸ¥é—®é¢˜"></a>3.å¯åŠ¨ä¸äº†ï¼Œæ’æŸ¥é—®é¢˜</h2><p>1.å…ˆçœ‹activeï¼Œçœ‹çœ‹è¯»çš„æ˜¯localé…ç½®è¿˜æ˜¯devé…ç½®</p><p>è¯´æ˜æ˜¯è¯»å–é…ç½®çš„åŸå› </p><p>æŸ¥çœ‹é…ç½®æ–‡ä»¶</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/CGWEbNF5porf0NxbvvKcCXftnJb.png" alt=""></p><p>æœç´¢<a href="http://nacos.dev.new.ii-ai.tech/">http://nacos.dev.new.ii-ai.tech</a></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/YewibnOWqopZpCxrYLqcsseanqf.png" alt=""></p><p>æ— å¼‚å¸¸ï¼Œç„¶åè¯´æ˜æ˜¯ä»£ç åŸå› </p><p>2.æŒ‡å®šä¸ºlocal</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/ZN1LbSaJloOSIVxeNGjc34qJn98.png" alt=""></p><h2 id="4-è¯»æ‡‚é…ç½®ã€æœåŠ¡æŒ‚æ‰é—®é¢˜æ’æŸ¥"><a href="#4-è¯»æ‡‚é…ç½®ã€æœåŠ¡æŒ‚æ‰é—®é¢˜æ’æŸ¥" class="headerlink" title="4.è¯»æ‡‚é…ç½®ã€æœåŠ¡æŒ‚æ‰é—®é¢˜æ’æŸ¥"></a>4.è¯»æ‡‚é…ç½®ã€æœåŠ¡æŒ‚æ‰é—®é¢˜æ’æŸ¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#nacosé…ç½®</span><br><span class="line">spring.cloud.nacos.config.server-addr=http://nacos.dev.new.ii-ai.tech</span><br><span class="line">spring.cloud.nacos.config.namespace=local</span><br><span class="line">#æ ‡è¯†RPA-Mall çš„æœåŠ¡åˆ†ç»„</span><br><span class="line">spring.cloud.nacos.discovery.namespace=dev</span><br><span class="line">spring.cloud.nacos.discovery.register-enabled=false</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶æ”¾åœ¨nacosé‡Œï¼Œå‘½åç©ºé—´æ˜¯æœ¬åœ°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@FeignClient(name = &quot;apis-kylin&quot;, path = &quot;/kylin/api&quot;, url = &quot;$&#123;mall.kylin.host:&#125;&quot;,</span><br><span class="line">        configuration = &#123;KylinFeignConfiguration.class&#125;)</span><br></pre></td></tr></table></figure><p>å…ˆæ‰¾urlï¼š${mall.kylin.host:}</p><p>å†æ‰¾æœåŠ¡åï¼šapis-kylinï¼ˆdevç¯å¢ƒæŒ‚æ‰ï¼‰ï¼Œå› æ­¤è¦åœ¨localçš„é…ç½®ç¯å¢ƒé‡Œé¢æ·»åŠ ${mall.kylin.host:}çš„å­—æ®µä¸ºqaçš„æœåŠ¡ã€‚</p><h2 id="5-å¼€å‘è§„èŒƒ"><a href="#5-å¼€å‘è§„èŒƒ" class="headerlink" title="5.å¼€å‘è§„èŒƒ"></a>5.å¼€å‘è§„èŒƒ</h2><ul><li><p>1ã€å…¥å‚æ ¡éªŒ</p></li><li><p>2ã€ç©ºå€¼é¢„æœŸåˆ¤æ–­ï¼Œæ¯”å¦‚æŸä¸ªä¸šåŠ¡é‡Œé¢ï¼Œè¿™é‡Œä¸åº”è¯¥ä¸ºç©ºçš„ï¼Œä½ å°±åšå¥½assertutilæ–­è¨€åˆ¤æ–­</p></li><li><p>3ã€å‡å°‘Forå¾ªç¯åµŒå¥—</p></li><li><p>4ã€å‡å°‘forå¾ªç¯è°ƒæ¥å£ã€æŸ¥æ•°æ®åº“</p></li><li><p>5ã€å…±åŒçš„ä¸šåŠ¡é€»è¾‘æŠ½è°ƒæ–¹æ³•</p></li><li><p>6ã€é¿å…å°‘çš„forå¾ªç¯ï¼Œæ¯”å¦‚mapåˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸€ä¸ªkey valueï¼Œç›´æ¥å…ˆè·å–å¯¹è±¡ç„¶åObjects.notnullåˆ¤ç©º</p></li></ul><h2 id="6-è‡ªå·±å†™ä¸€ä¸ªå¾®æœåŠ¡"><a href="#6-è‡ªå·±å†™ä¸€ä¸ªå¾®æœåŠ¡" class="headerlink" title="6.è‡ªå·±å†™ä¸€ä¸ªå¾®æœåŠ¡"></a>6.è‡ªå·±å†™ä¸€ä¸ªå¾®æœåŠ¡</h2><h3 id="ï¼ˆ1ï¼‰å…ˆå†™é…ç½®æ–‡ä»¶"><a href="#ï¼ˆ1ï¼‰å…ˆå†™é…ç½®æ–‡ä»¶" class="headerlink" title="ï¼ˆ1ï¼‰å…ˆå†™é…ç½®æ–‡ä»¶"></a>ï¼ˆ1ï¼‰å…ˆå†™é…ç½®æ–‡ä»¶</h3><p>é…ç½®æ–‡ä»¶æ”¾åœ¨nacosé‡Œï¼Œå†™è‡ªå·±çš„propertiesçš„bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ocrçš„ç›¸å…³é…ç½®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> make</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@module</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024/10/13</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@RefreshScope</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;ocr&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OcrConfigProperties</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¡¹ç›®æ¥å£ç»Ÿä¸€å‰ç¼€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2022/12/03</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;ocr.globalPrefix:/shizai/ai/ocr-aws&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String globalPrefix;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Apiè¯·æ±‚çš„Urlåœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;ocr.apiUrl:https://idp-sea.6estates.com/customer/extraction/fields/async&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String apiUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢ç»“æœçš„ç­‰å¾…æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;ocr.waitTime:30&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> waitTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‹¦æˆªå™¨ç™½åå•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;college.filterWhiteList:&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> CharSequence[] filterWhiteList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»Ÿä¸€å‰ç¼€æ·»åŠ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configurePathMatch</span><span class="params">(PathMatchConfigurer configurer)</span> &#123;</span><br><span class="line">    configurer.addPathPrefix(ocrConfigProperties.getGlobalPrefix(),</span><br><span class="line">            c -&gt; StrUtil.startWith(c.getPackage().getName(), <span class="string">&quot;ai.ii.ipa.aws.launcher&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰å†™controllerå±‚ï¼Œæ¥å…¥æ¥å£ï¼Œå°†ä»£ç é€»è¾‘å†™åœ¨bizé‡Œï¼Œå†™å…¨å±€å¼‚å¸¸å¤„ç†å™¨"><a href="#ï¼ˆ2ï¼‰å†™controllerå±‚ï¼Œæ¥å…¥æ¥å£ï¼Œå°†ä»£ç é€»è¾‘å†™åœ¨bizé‡Œï¼Œå†™å…¨å±€å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="ï¼ˆ2ï¼‰å†™controllerå±‚ï¼Œæ¥å…¥æ¥å£ï¼Œå°†ä»£ç é€»è¾‘å†™åœ¨bizé‡Œï¼Œå†™å…¨å±€å¼‚å¸¸å¤„ç†å™¨"></a>ï¼ˆ2ï¼‰å†™controllerå±‚ï¼Œæ¥å…¥æ¥å£ï¼Œå°†ä»£ç é€»è¾‘å†™åœ¨bizé‡Œï¼Œå†™å…¨å±€å¼‚å¸¸å¤„ç†å™¨</h3><p>åˆ©ç”¨@RestControllerAdviceå’Œ@ExceptionHandlerå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonControllerAdvice</span> &#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler(ApiException.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseObject&lt;String&gt; <span class="title function_">handleApiException</span><span class="params">(ApiException e)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">status</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">errorCode</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">detailMessage</span> <span class="operator">=</span> e.getMessage();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(e.getStatusCode() == <span class="literal">null</span> &amp;&amp; detailMessage != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">                <span class="type">JsonNode</span> <span class="variable">jsonNode</span> <span class="operator">=</span> objectMapper.readTree(detailMessage);</span><br><span class="line">                errorCode = jsonNode.get(<span class="string">&quot;errorCode&quot;</span>).asText();</span><br><span class="line">                message = jsonNode.get(<span class="string">&quot;message&quot;</span>).asText();</span><br><span class="line">                status = jsonNode.get(<span class="string">&quot;status&quot;</span>).asText();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (JsonProcessingException ex)&#123;</span><br><span class="line">                log.error(<span class="string">&quot;[&#123;&#125;] - &#123;&#125;&quot;</span>, ResultCodeEnum.INTERNAL_ERROR.getCode(), e.getMessage());</span><br><span class="line">                <span class="keyword">return</span> ResponseObject.fail(ResultCodeEnum.INTERNAL_ERROR.getCode(), e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseObject.fail(ResultCodeEnum.UNKNOWN_ERROR.getCode(),e.getMessage());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ3ï¼‰æ¥å£æ²¡é—®é¢˜ï¼Œè¦å¼€å§‹é‰´æƒã€‚è‡ªå·±å†™ä¸€ä¸ªæ‹¦æˆªå™¨"><a href="#ï¼ˆ3ï¼‰æ¥å£æ²¡é—®é¢˜ï¼Œè¦å¼€å§‹é‰´æƒã€‚è‡ªå·±å†™ä¸€ä¸ªæ‹¦æˆªå™¨" class="headerlink" title="ï¼ˆ3ï¼‰æ¥å£æ²¡é—®é¢˜ï¼Œè¦å¼€å§‹é‰´æƒã€‚è‡ªå·±å†™ä¸€ä¸ªæ‹¦æˆªå™¨"></a>ï¼ˆ3ï¼‰æ¥å£æ²¡é—®é¢˜ï¼Œè¦å¼€å§‹é‰´æƒã€‚è‡ªå·±å†™ä¸€ä¸ªæ‹¦æˆªå™¨</h3><p>å°†æ‹¦æˆªè·¯å¾„å†™åœ¨é…ç½®é‡Œã€‚è‡ªå·±å†™æ‹¦æˆªå™¨çš„é€»è¾‘ï¼Œæ ¹æ®ç”¨æˆ·çš„tokenè·å–ç”¨æˆ·çš„ä¿¡æ¯</p><p>å…ˆå†™é…ç½®</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-8.png" alt=""></p><p>åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯å…å¯†æ¥å£</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-2.png" alt=""></p><p>å†™ä¸€ä¸ªæ‹¦æˆªå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthInfoLoadInterceptor</span> <span class="keyword">extends</span> <span class="title class_">HandlerInterceptorAdapter</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> OcrConfigProperties ocrConfigProperties;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> LoginHeaderAuthenticationTypePlug loginHeaderAuthenticationTypePlug;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(<span class="meta">@Nonnull</span> HttpServletRequest request,</span></span><br><span class="line"><span class="params">                             <span class="meta">@Nonnull</span> HttpServletResponse response,</span></span><br><span class="line"><span class="params">                             <span class="meta">@Nonnull</span> Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯å…ç™»ã€‚ä¸å…ç™»ï¼Œåˆ™è¿›è¡Œç™»å½•æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (!isNoLogin(request, handler)) &#123;</span><br><span class="line">            <span class="comment">//è¿›è¡Œé‰´æƒ</span></span><br><span class="line">            loginHeaderAuthenticationTypePlug.checkIsLogin(request, handler);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.preHandle(request, response, handler);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è·å–tokenè¿›è¡Œç™»å½•æ ¡éªŒ</p><p>ç”¨æˆ·ç™»å½•èµ°çš„æ˜¯UICæœåŠ¡ï¼Œç”¨æˆ·ä¿¡æ¯å­˜åœ¨redisé‡Œï¼Œkeyæ˜¯ä¸€ä¸ªtoken,valueæ˜¯ä¸€ä¸ªç”¨æˆ·è¯¦ç»†ä¿¡æ¯çš„å¯¹è±¡ã€‚è·å–åˆ°äº†è¯¦ç»†ä¿¡æ¯ä¹‹åå°†ä¿¡æ¯å­˜åˆ°çº¿ç¨‹æœ¬åœ°å˜é‡é‡Œé¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">checkIsLogin</span><span class="params">(HttpServletRequest request, Object handler)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(UserAuthCenter.RPA_TOKEN_HEADER);</span><br><span class="line">    AssertUtil.isTrue(StrUtil.isNotBlank(token), ResultCodeEnum.UNAUTHORIZED.getCode(), <span class="string">&quot;ç”¨æˆ·æœªç™»å½•&quot;</span>);</span><br><span class="line">    UserAuthCenter.setRpaToken(token);</span><br><span class="line">    <span class="type">UICTokenUserInfo</span> <span class="variable">tokenInfoDTO</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//ä»redisè·å–tokenå¯¹åº”ç”¨æˆ·ä¿¡æ¯ï¼Œ æ²¡æœ‰åˆ™æ¥å£è·å–ï¼Œ3åˆ†é’Ÿåredisè¿‡æœŸ</span></span><br><span class="line">        tokenInfoDTO = manager.get(RedisCacheKeyConstant.getWebUserToken(token),</span><br><span class="line">                () -&gt; getCurrentWebUserInfo(token), <span class="number">180L</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.warn(StrUtil.format(<span class="string">&quot;get webUser by token fail, token:&#123;&#125;, message: &#123;&#125;&quot;</span>, token, e.getMessage()));</span><br><span class="line">    &#125;</span><br><span class="line">    AssertUtil.isTrue(Objects.nonNull(tokenInfoDTO), ResultCodeEnum.UNAUTHORIZED.getCode(), <span class="string">&quot;ç”¨æˆ·æœªç™»å½•&quot;</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®çº¿ç¨‹å˜é‡</span></span><br><span class="line">    UserAuthCenter.setWebUser(tokenInfoDTO);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ æ‹¦æˆªå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    registry.addInterceptor(authInfoLoadInterceptor)</span><br><span class="line">            .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ4ï¼‰æ¥å…¥UICå¾®æœåŠ¡ï¼Œå°†ç¬¬ä¸‰æ–¹APIçš„é…ç½®ä¿¡æ¯æ”¾å…¥UICçš„æ•°æ®æºä¸­ï¼Œä»æ­¤å¤„è¯»å–ã€‚"><a href="#ï¼ˆ4ï¼‰æ¥å…¥UICå¾®æœåŠ¡ï¼Œå°†ç¬¬ä¸‰æ–¹APIçš„é…ç½®ä¿¡æ¯æ”¾å…¥UICçš„æ•°æ®æºä¸­ï¼Œä»æ­¤å¤„è¯»å–ã€‚" class="headerlink" title="ï¼ˆ4ï¼‰æ¥å…¥UICå¾®æœåŠ¡ï¼Œå°†ç¬¬ä¸‰æ–¹APIçš„é…ç½®ä¿¡æ¯æ”¾å…¥UICçš„æ•°æ®æºä¸­ï¼Œä»æ­¤å¤„è¯»å–ã€‚"></a>ï¼ˆ4ï¼‰æ¥å…¥UICå¾®æœåŠ¡ï¼Œå°†ç¬¬ä¸‰æ–¹APIçš„é…ç½®ä¿¡æ¯æ”¾å…¥UICçš„æ•°æ®æºä¸­ï¼Œä»æ­¤å¤„è¯»å–ã€‚</h3><p>é‡‡ç”¨feignè°ƒç”¨ï¼Œè¦å†™ä¸€äº›DTOå’Œé…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;uic-user&quot;, path = &quot;/uic-user/v1&quot;, contextId = &quot;openUicUserFeignClient&quot;,</span></span><br><span class="line"><span class="meta">        configuration = UicV2FeignConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OpenUicUserFeignClient</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> ResponseObject&lt; List &lt; UserDTO &gt;&gt;&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/openApi/users/list&quot;)</span></span><br><span class="line">    ResponseObject&lt;List&lt;UserDTO&gt;&gt; <span class="title function_">listUserByUserUids</span><span class="params">(<span class="meta">@SpringQueryMap</span> UicOpenUserQueryRequest param)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ5ï¼‰â­ï¸è‡ªå®šä¹‰æ³¨è§£-AOPå°†ç”¨æˆ·çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ã€‚"><a href="#ï¼ˆ5ï¼‰â­ï¸è‡ªå®šä¹‰æ³¨è§£-AOPå°†ç”¨æˆ·çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ã€‚" class="headerlink" title="ï¼ˆ5ï¼‰â­ï¸è‡ªå®šä¹‰æ³¨è§£+AOPå°†ç”¨æˆ·çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ã€‚"></a>ï¼ˆ5ï¼‰â­ï¸è‡ªå®šä¹‰æ³¨è§£+AOPå°†ç”¨æˆ·çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ã€‚</h3><p>åŸºäºSpring AOP + ELè¡¨è¾¾å¼å°†ç”¨æˆ·æ“ä½œè‡ªåŠ¨å…¥åº“</p><p><strong>å®ä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€ocræ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@PARAM</span>: <span class="doctag">@param</span> param</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Make</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DATE</span>: 2024/10/25</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@RETURN</span>: <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@LogRecord(objectType = ResourceType.TENANT, objectId = &quot;#webUser.tenantId&quot;,</span></span><br><span class="line"><span class="meta">        operationContent = &quot;&#123;#webUser.userName&#125; ä½¿ç”¨ocr-awsæå– &#123;#param.fileType&#125; æ–‡ä»¶ç±»å‹æ•°æ®&quot;, operationType = OperationType.SELECT)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/AWS-OCR&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseObject&lt;ApiResponse&gt; <span class="title function_">ocrAws</span><span class="params">(<span class="meta">@Valid</span> AwsOcrControllerParam param)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ocrCommonBiz.havePermission())&#123;</span><br><span class="line">        <span class="type">SixEstateApiParam</span> <span class="variable">apiParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SixEstateApiParam</span>();</span><br><span class="line">        BeanUtils.copyProperties(param, apiParam);</span><br><span class="line">        apiParam.setFileName(UserAuthCenter.getWebUser().getAccountUUID() + <span class="string">&quot;_&quot;</span> + param.getFileContent().getOriginalFilename());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            apiParam.setFileContent(param.getFileContent().getBytes());</span><br><span class="line">            <span class="keyword">return</span> ResponseObject.success(ocrCommonBiz.Extract(apiParam));</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;æ–‡ä»¶è¯»å–å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;ocr-aws-launcher/target/classes/tmp/&quot;</span>  + apiParam.getFileName());</span><br><span class="line">            <span class="keyword">if</span> (tmp.exists()) &#123;</span><br><span class="line">                FileUtil.del(tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ResponseObject.fail(ResultCodeEnum.UNAUTHORIZED.getCode(), <span class="string">&quot;ç”¨æˆ·æ— åŠŸèƒ½æƒé™ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…ˆå®šä¹‰ä¸€ä¸ªæ—¥å¿—è®°å½•æ³¨è§£</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> LogRecord &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èµ„æºç±»å‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> ResourceType&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ResourceType <span class="title function_">objectType</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œç±»å‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> OperationType&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    OperationType <span class="title function_">operationType</span><span class="params">()</span> <span class="keyword">default</span> OperationType.UNKNOWN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èµ„æºid</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">objectId</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œæè¿°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">operationDescription</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œå†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">operationContent</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è®°å½•å‚æ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isRecordParam</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å†åˆ©ç”¨åŸºäºJDKåŠ¨æ€ä»£ç†çš„AOPå»å¢å¼ºè¿™ä¸ªè‡ªå®šä¹‰æ³¨è§£</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspect</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> OperateLogService operateLogService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®æ“ä½œæ—¥å¿—åˆ‡å…¥ç‚¹ï¼Œè®°å½•æ“ä½œæ—¥å¿—ï¼Œåœ¨æ³¨è§£ä½ç½®åˆ‡å…¥ä»£ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(value = &quot;@annotation(ai.ii.ipa.aws.util.log.annotation.LogRecord)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logPointcut</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Around(value = &quot;logPointcut() &amp;&amp; @annotation(logRecord)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint jp, LogRecord logRecord)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="type">UICTokenUserInfo</span> <span class="variable">webUser</span> <span class="operator">=</span> UserAuthCenter.getWebUser();</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p><strong>å¢å¼ºçš„å…·ä½“å®ç°ï¼šç¯ç»•é€šçŸ¥ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around(value = &quot;logPointcut() &amp;&amp; @annotation(logRecord)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint jp, LogRecord logRecord)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="type">UICTokenUserInfo</span> <span class="variable">webUser</span> <span class="operator">=</span> UserAuthCenter.getWebUser();</span><br><span class="line">    <span class="type">RequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> RequestContextHolder.getRequestAttributes();</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) requestAttributes.resolveReference(RequestAttributes.REFERENCE_REQUEST);</span><br><span class="line"></span><br><span class="line">    <span class="type">OperateLog</span> <span class="variable">logEntity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OperateLog</span>();</span><br><span class="line">    logEntity.setOperUrl(request.getRequestURI());</span><br><span class="line">    logEntity.setOperUserName(webUser.getUserName());</span><br><span class="line">    logEntity.setOperUserRealname(webUser.getRealName());</span><br><span class="line">    logEntity.setOperUserIp(IpUtils.getIp(request));</span><br><span class="line">    logEntity.setOperType(logRecord.operationType().getCode().toString());</span><br><span class="line">    logEntity.setOperDescription(logRecord.operationDescription());</span><br><span class="line">    logEntity.setOperObjectType(logRecord.objectType().getType());</span><br><span class="line">    <span class="comment">//è¯·æ±‚çš„å‚æ•°</span></span><br><span class="line">    Map&lt;String, Object&gt; data = getDataMap(jp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (logRecord.isRecordParam()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(data.get(<span class="string">&quot;param&quot;</span>) != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">AwsOcrControllerParam</span> <span class="variable">param</span> <span class="operator">=</span> (AwsOcrControllerParam) data.get(<span class="string">&quot;param&quot;</span>);</span><br><span class="line">            <span class="type">SixEstateApiParam</span> <span class="variable">newParam</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SixEstateApiParam</span>();</span><br><span class="line">            BeanUtils.copyProperties(param, newParam);</span><br><span class="line">            newParam.setFileName(param.getFileContent().getOriginalFilename());</span><br><span class="line">            data.put(<span class="string">&quot;param&quot;</span>, newParam);</span><br><span class="line">        &#125;</span><br><span class="line">        logEntity.setOperParam(JSONObject.toJSONString(data));</span><br><span class="line">    &#125;</span><br><span class="line">    logEntity.setSystemUserId(webUser.getTenantUserId());</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// @Aroundéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ.proceed()æ“ä½œ;</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> jp.proceed();</span><br><span class="line">        logEntity.setOperResult(JSONObject.toJSONString(result));</span><br><span class="line">        logEntity.setStatus(UserOperationStatusType.SUCCESS.getType());</span><br><span class="line">        data.put(<span class="string">&quot;result&quot;</span>, result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        Map&lt;String, String&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;result&quot;</span>, <span class="string">&quot;fail&quot;</span>);</span><br><span class="line">        result.put(<span class="string">&quot;exceptionMessage&quot;</span>, e.getMessage());</span><br><span class="line">        result.put(<span class="string">&quot;exceptionName&quot;</span>, e.getClass().getName());</span><br><span class="line"></span><br><span class="line">        logEntity.setOperResult(JSONObject.toJSONString(result));</span><br><span class="line">        logEntity.setStatus(UserOperationStatusType.FAIL.getType());</span><br><span class="line">        log.info(logEntity.toString(), e);</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        data.put(<span class="string">&quot;webUser&quot;</span>, webUser);</span><br><span class="line">        data.put(<span class="string">&quot;date&quot;</span>, DateUtil.formatDateTime(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        <span class="comment">//æœ‰è®¾ç½®æ“ä½œæ–‡æ¡ˆä¿¡æ¯ï¼Œä¸”æ“ä½œæˆåŠŸæ—¶ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isNotBlank(logRecord.operationContent())</span><br><span class="line">                &amp;&amp; UserOperationStatusType.SUCCESS.getType().equals(logEntity.getStatus())) &#123;</span><br><span class="line">            <span class="comment">//ç”Ÿæˆæ“ä½œå†…å®¹ï¼Œæ“ä½œæˆåŠŸæ—¶æ‰è®¾ç½®æè¿°</span></span><br><span class="line">            logEntity.setOperDescription(replaceElString(logRecord.operationContent(), data));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç”ŸæˆobjectId</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">objectId</span> <span class="operator">=</span> getElString(logRecord.objectId(), data);</span><br><span class="line">        logEntity.setOperObjectId(objectId);</span><br><span class="line">        logEntity.setOperTime(LocalDateTime.now());</span><br><span class="line">        operateLogService.save(logEntity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è·å–è¯·æ±‚å‚æ•°ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è½¬æ¢requestè¯·æ±‚å‚æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> jp</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;String, Object&gt; <span class="title function_">getDataMap</span><span class="params">(ProceedingJoinPoint jp)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; data = Maps.newHashMap();</span><br><span class="line">    Object[] paramValues = jp.getArgs();</span><br><span class="line">    String[] paramNames = ((CodeSignature) jp.getSignature()).getParameterNames();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; paramNames.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(paramValues[i])) &#123;</span><br><span class="line">            data.put(paramNames[i], paramValues[i]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            data.put(paramNames[i], <span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ELè¡¨è¾¾å¼åŠ¨æ€å‚æ•°ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String <span class="title function_">replaceElString</span><span class="params">(String elStr, Map&lt;String, Object&gt; data)</span> &#123;</span><br><span class="line">    <span class="comment">// æ“ä½œæ˜ç»†</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isNotBlank(elStr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ElUtil.replaceElString(elStr, data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.info(e.toString(), e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">getElString</span><span class="params">(String elStr, Map&lt;String, Object&gt; data)</span> &#123;</span><br><span class="line">    <span class="comment">// æ“ä½œæ˜ç»†</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isNotBlank(elStr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ElUtil.parseExpression(elStr, data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.info(e.toString(), e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PSï¼šæœ‰æ—¶å€™è‡ªå·±èµ·ä¸€ä¸ªå¾®æœåŠ¡ä¼šå¾ˆéº»çƒ¦ï¼Œæœ‰å¾ˆå¤šä»£ç ç»“æ„è¦è‡ªå·±æï¼Œè€Œä¸”åæœŸè¿˜è¦æ¥å…¥å…¬å¼ç”Ÿæ€çš„æ¥å£ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œä»£ç è¿ç§»ã€‚å°†collegeçš„ä»£ç è¿›è¡Œä¿®æ”¹åè½¬åŒ–æˆocr-awsçš„ä»£ç ã€‚</p><p>é¦–å…ˆå…ˆå®šä¹‰ä¸€ä¸ª</p><p>æŠ€å·§ï¼š</p><ol><li><p>å…ˆè¿›è¡Œmvn clean å»é™¤target</p></li><li><p>å»é™¤.ideaçš„é…ç½®æ–‡ä»¶</p></li><li><p>å»é™¤.imlæ–‡ä»¶ï¼Œè‡ªå·±è¿›è¡Œä»£ç ç»“æ„çš„ä¿®æ”¹</p></li></ol><h2 id="7-ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œå®ä¾‹"><a href="#7-ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œå®ä¾‹" class="headerlink" title="7.ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œå®ä¾‹"></a>7.ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œå®ä¾‹</h2><p>éœ€æ±‚ï¼šå°†ç¤¾åŒºçš„å®˜æ–¹å‘çš„æ–‡ç« å…¨éƒ¨å¯¼å‡ºï¼Œå¹¶é€šè¿‡é‚®ç®±å‘ç»™æŒ‡å®šç”¨æˆ·ï¼ˆæ–‡æ¡£ç§æœ‰åŒ–ï¼‰ï¼Œç”±äºæ–‡ä»¶æ¯”è¾ƒå¤šï¼Œè¿™é‡Œé‡‡ç”¨å¤šçº¿ç¨‹æ˜¯æ¯”è¾ƒåˆç†çš„ã€‚</p><p>å¼‚æ­¥æ–‡ä»¶ä¸‹è½½</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-6.png" alt=""></p><p>å…¬ç”¨çº¿ç¨‹æ± </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¬å…±çº¿ç¨‹æ± ï¼Œä¸å¤ªé‡è¦çš„çº¿ç¨‹å¯ä»¥æ”¾åœ¨æ­¤å¤„æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/04/06</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> ExecutorService</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">COMMON_EXECUTOR</span> <span class="operator">=</span> TtlExecutors.getTtlExecutorService(<span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">10</span>, <span class="number">30</span>,</span><br><span class="line">        <span class="number">5L</span>, TimeUnit.MINUTES, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AdminThreadFactory</span>(<span class="string">&quot;COMMON_EXECUTOR&quot;</span>)));</span><br></pre></td></tr></table></figure><p>ï¼ˆ1ï¼‰å…ˆåˆ†é¡µæŸ¥è¯¢æ‰€æœ‰å®˜æ–¹æ–‡ç« çš„åˆ†é¡µ</p><p>ï¼ˆ2ï¼‰æ ¹æ®æ¯ä¸ªæ–‡ç« çš„fileCodeæ‹¿åˆ°ä¸€ä¸ªå¯Œæ–‡æœ¬å¯¹è±¡</p><p>ï¼ˆ3ï¼‰æ ¹æ®å¯Œæ–‡æœ¬å¯¹è±¡ï¼Œä¸‹è½½æ‰€æœ‰ç›¸å…³èµ„æºï¼Œå°†å¯Œæ–‡æœ¬é‡Œçš„èµ„æºçš„ç»å¯¹è·¯å¾„æ”¹ä¸ºç›¸å¯¹è·¯å¾„ï¼Œå¯¼å‡ºä¸ºhtmlæ–‡ä»¶</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-4.png" alt=""></p><p>ï¼ˆ4ï¼‰å¯¼å‡ºä¸ºå‹ç¼©åŒ…å¹¶å‘é€</p><h2 id="8-è®¾è®¡æ¨¡å¼-amp-ä¼˜åŒ–"><a href="#8-è®¾è®¡æ¨¡å¼-amp-ä¼˜åŒ–" class="headerlink" title="8.è®¾è®¡æ¨¡å¼ &amp; ä¼˜åŒ–"></a>8.è®¾è®¡æ¨¡å¼ &amp; ä¼˜åŒ–</h2><p>æœ‰å…«ä¸­æ¶ˆæ¯ç±»å‹ï¼š</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-1.png" alt=""></p><p>é¦–å…ˆï¼Œä¸ºäº†è®©ç”¨æˆ·è¯„è®ºã€ç‚¹èµä¸æ¶ˆæ¯å‘é€è§£è€¦ï¼Œå¯ä»¥é‡‡ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œç”¨æˆ·è¯„è®ºè§¦å‘ä¸€ä¸ªæ¶ˆæ¯é€šçŸ¥äº‹ä»¶</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-3.png" alt=""></p><p>åœ¨å¤„ç†æ¶ˆæ¯æ—¶ï¼Œä¸åŒçš„æ¶ˆæ¯ç±»å‹æœ‰ä¸åŒçš„ç­–ç•¥ã€‚</p><p>æ¯”å¦‚ç‚¹èµæ¶ˆæ¯æ—¶å…ˆèšåˆåˆ°redisï¼Œå†è¿ç§»åˆ°æ•°æ®åº“</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-5.png" alt=""></p><p>å®˜æ–¹æ¶ˆæ¯æ˜¯ç›´æ¥å­˜æ¶ˆæ¯è¡¨ï¼Œåœ¨ç”¨æˆ·ç™»å½•çš„æ—¶å€™å°†å®˜æ–¹æ¶ˆæ¯è¿ç§»åˆ°ç”¨æˆ·æ¶ˆæ¯æ¥æ”¶è¡¨ï¼ˆè¿™æ ·å¯ä»¥é¿å…æ•°æ®åº“å‹åŠ›å¤ªå¤§ï¼‰</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-24.png" alt=""></p><p>ç”¨æˆ·çš„å›å¤æ¶ˆæ¯ï¼Œæ˜¯è¦å…ˆå­˜å…¥åˆ°æ¶ˆæ¯è¡¨ï¼Œç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯idï¼Œå†å­˜å…¥æ¶ˆæ¯æ¥å—è¡¨ã€‚ç»™æ¶ˆæ¯idå’Œç”¨æˆ·idåŠ å”¯ä¸€ç´¢å¼•ï¼Œè¿™æ ·å¯ä»¥é¿å…ç”¨æˆ·æ”¶åˆ°é‡å¤çš„æ¶ˆæ¯ã€‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-26.png" alt=""></p><p>å› ä¸ºæœ‰ä¸‰ç§ä¸åŒçš„åº”å¯¹ç­–ç•¥ï¼Œæ‰€ä»¥å¯ä»¥å†™ä¸€ä¸ªå·¥å‚æ¥ç»Ÿä¸€å¤„ç†ã€‚é¦–å…ˆå…ˆå®šä¹‰ä¸€ä¸ªå·¥å‚ï¼Œå†™ä¸€ä¸ªæ¶ˆæ¯å¤„ç†çš„æ¥å£</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-25.png" alt=""></p><p>æ¥å£</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-22.png" alt=""></p><p>é’ˆå¯¹æ¥å£å®šä¹‰ä¸‰ä¸ªå®ç°ç±»ï¼Œå¤„ç†ä¸åŒçš„æ¶ˆæ¯ç±»å‹</p><p>ç‚¹èµæ¶ˆæ¯å¤„ç†</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-21.png" alt=""></p><p>å®˜æ–¹æ¶ˆæ¯å¤„ç†</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-23.png" alt=""></p><p>å›å¤æ¶ˆæ¯å¤„ç†</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-18.png" alt=""></p><h2 id="9-ã€å¤šçº¿ç¨‹ä¼˜åŒ–ã€‘CompletableFutureä½¿ç”¨"><a href="#9-ã€å¤šçº¿ç¨‹ä¼˜åŒ–ã€‘CompletableFutureä½¿ç”¨" class="headerlink" title="9.ã€å¤šçº¿ç¨‹ä¼˜åŒ–ã€‘CompletableFutureä½¿ç”¨"></a>9.ã€å¤šçº¿ç¨‹ä¼˜åŒ–ã€‘<a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#completablefuture-%E7%B1%BB%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8">CompletableFuture</a>ä½¿ç”¨</h2><p>éœ€æ±‚ï¼šå°†æ‰¹é‡æŸ¥è¯¢åˆ°çš„ç”¨æˆ·æˆæƒä¿¡æ¯å¯¼å‡ºä¸ºæ–‡ä»¶ï¼Œå‘é€é‚®ç®±</p><p>æ ¹æ®è¯·æ±‚å‚æ•°è·å–ç§Ÿæˆ·ä»¥åŠå…³è”ç§Ÿæˆ·çš„æ‰€æœ‰æˆæƒç æ–‡ä»¶ï¼Œ</p><p>éœ€è¦è¿›è¡Œç”¨æˆ·æˆæƒç æ•°æ®çš„å¯¼å‡ºï¼Œåœ¨è¿™é‡Œä½¿ç”¨CompletableFutureï¼Œé‡‡ç”¨å¼‚æ­¥çš„æ‰§è¡Œæ€æƒ³ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå½“æ–‡ä»¶å…¨éƒ¨å¯¼å‡ºåï¼Œä¼šè‡ªåŠ¨å›è°ƒè¿›è¡Œåç»­æ“ä½œã€‚</p><p>å¯¼å‡ºå®Œéœ€è¦åšåç½®å¤„ç†ã€‚å°†æ•°æ®å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶ã€‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-16.png" alt=""></p><p>æ‰§è¡Œå®Œè‡ªåŠ¨å›è°ƒ</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-20.png" alt=""></p><p>å°†è¿”å›çš„æ•°æ®ï¼ˆç”¨æˆ·æˆæƒå¯¹è±¡ï¼‰å†™å…¥åˆ°xlsxé‡Œé¢ï¼Œç”¨é˜¿é‡Œå·´å·´çš„EasyExcelå¯¼å‡º</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-17.png" alt=""></p><p>ä¸ä½¿ç”¨completableFutureï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¦forå¾ªç¯ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œã€‚ä½¿ç”¨äº†é€Ÿåº¦æå‡äº†ã€‚</p><h2 id="10-è‡ªåŠ¨ç”ŸæˆDAOã€XMLä»£ç "><a href="#10-è‡ªåŠ¨ç”ŸæˆDAOã€XMLä»£ç " class="headerlink" title="10.è‡ªåŠ¨ç”ŸæˆDAOã€XMLä»£ç "></a>10.è‡ªåŠ¨ç”ŸæˆDAOã€XMLä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ai.ii.ipa.college.launcher.mybatis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.*;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.DateType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.ArrayUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhengfeipeng</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ç”Ÿæˆæ•°æ®åº“è¡¨å¯¹åº”çš„ å®ä½“/Dao/Service/Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGenerator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒ…å«çš„è¡¨. è‹¥ç©ºåˆ™è¡¨ç¤ºè¯¥åº“ä¸­å…¨éƒ¨çš„è¡¨.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] tables = &#123;</span><br><span class="line">            <span class="string">&quot;college_examination_user_record&quot;</span>,</span><br><span class="line">            <span class="string">&quot;college_examination_user_record_exercises_rel&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’é™¤çš„è¡¨.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] exTables = &#123;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»£ç ç”Ÿæˆå™¨</span></span><br><span class="line">        <span class="type">AutoGenerator</span> <span class="variable">mpg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AutoGenerator</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…¨å±€é…ç½®</span></span><br><span class="line">        <span class="type">GlobalConfig</span> <span class="variable">gc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GlobalConfig</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">projectPath</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;projectPath: &quot;</span> + projectPath);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆçš„æ–‡ä»¶è¾“å‡ºç›®å½•</span></span><br><span class="line">        gc.setOutputDir(projectPath + <span class="string">&quot;/temp&quot;</span>);</span><br><span class="line">        <span class="comment">// ç±»æ³¨é‡Šä¸­ @author çš„å€¼</span></span><br><span class="line">        gc.setAuthor(<span class="string">&quot;å«åº„&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆçš„Daoå‘½åæ ¼å¼: è¡¨å+Dao</span></span><br><span class="line">        gc.setMapperName(<span class="string">&quot;%sDao&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆçš„å®ä½“ç±»å‘½åæ ¼å¼: T+è¡¨å</span></span><br><span class="line">        gc.setEntityName(<span class="string">&quot;%sDO&quot;</span>);</span><br><span class="line">        <span class="comment">// æ•°æ®åº“æ—¥æœŸ/æ—¶é—´æˆ³å­—æ®µåœ¨javaä¸­æ˜ å°„çš„ç±»</span></span><br><span class="line">        gc.setDateType(DateType.TIME_PACK);</span><br><span class="line">        <span class="comment">// æ˜¯å¦è¦†ç›–ä¹‹å‰ç”Ÿæˆçš„æ–‡ä»¶</span></span><br><span class="line">        gc.setFileOverride(<span class="literal">true</span>);</span><br><span class="line">        gc.setOpen(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// æ˜¯å¦åœ¨Mapperæ–‡ä»¶ä¸­ç”Ÿæˆå®ä½“çš„æ˜ å°„</span></span><br><span class="line">        gc.setBaseResultMap(<span class="literal">true</span>);</span><br><span class="line">        gc.setBaseColumnList(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// å®ä½“å±æ€§ Swagger2 æ³¨è§£</span></span><br><span class="line">        gc.setSwagger2(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ•°æ®æºé…ç½®</span></span><br><span class="line">        <span class="type">DataSourceConfig</span> <span class="variable">dsc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>();</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://rm-bp1sluyi8846k48we.mysql.rds.aliyuncs.com:3306/rpa_college?serverTimezone=Asia/Shanghai&amp;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true&quot;</span>);</span><br><span class="line">        dsc.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŒ…é…ç½®</span></span><br><span class="line">        <span class="type">PackageConfig</span> <span class="variable">pc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PackageConfig</span>();</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        pc.setParent(<span class="string">&quot;ai.ii.ipa.college&quot;</span>);</span><br><span class="line">        pc.setEntity(<span class="string">&quot;domain.entity&quot;</span>);</span><br><span class="line">        pc.setMapper(<span class="string">&quot;dao&quot;</span>);</span><br><span class="line">        pc.setService(<span class="string">&quot;service.basic&quot;</span>);</span><br><span class="line">        pc.setServiceImpl(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç­–ç•¥é…ç½®</span></span><br><span class="line">        <span class="type">StrategyConfig</span> <span class="variable">strategy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StrategyConfig</span>();</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setEntityLombokModel(<span class="literal">true</span>);</span><br><span class="line">        strategy.setInclude(tables);</span><br><span class="line">        <span class="keyword">if</span> (ArrayUtils.isEmpty(tables)) &#123;</span><br><span class="line">            strategy.setExclude(exTables);</span><br><span class="line">        &#125;</span><br><span class="line">        strategy.setRestControllerStyle(<span class="literal">true</span>);</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="literal">true</span>);</span><br><span class="line">        strategy.setTablePrefix(<span class="string">&quot;t_&quot;</span>);</span><br><span class="line">        strategy.setEntityTableFieldAnnotationEnable(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplateConfig</span> <span class="variable">tc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplateConfig</span>();</span><br><span class="line">        mpg.setTemplate(tc);</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-IDEAæ‰§è¡Œæ’ä»¶"><a href="#11-IDEAæ‰§è¡Œæ’ä»¶" class="headerlink" title="11.IDEAæ‰§è¡Œæ’ä»¶"></a>11.IDEAæ‰§è¡Œæ’ä»¶</h2><p><strong>(1) Apifox</strong></p><p>ä¸€é”®ç”Ÿæˆæ¥å£æ–‡æ¡£</p><p><strong>(2) EasyJavaDoc</strong></p><p>æ–‡æ¡£æ³¨é‡Š</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-15.png" alt=""></p><p><strong>(3) Maven Heaper</strong></p><p><strong>(4) MybatisX</strong></p><p>DAO å’Œxmläº’è·³</p><p><strong>(5) Ptg</strong></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-19.png" alt=""></p><p><strong>(6) Rainbow Brackets</strong></p><p>æ‹¬å·é¢œè‰²</p><p><strong>(7) Redis Heaper</strong></p><p>IDEAæŸ¥çœ‹redis</p><p><strong>(8) Tong Yi Lin Ma</strong></p><p>ä»£ç è‡ªåŠ¨è¡¥å…¨</p><p><strong>(9) DataBase Tools And SQL</strong></p><p>IDEAè¿æ¥æ•°æ®åº“</p><p><strong>(10) Grep Console</strong></p><p>æ§åˆ¶å°é¢œè‰²</p><p><strong>(11) Alibaba Java Coding Guidelines</strong></p><p>é˜¿é‡Œå¼€å‘è§„çº¦</p><p><strong>(12) Restful Tool</strong></p><p>å³ä¾§æ˜¾ç¤ºcontrollerè·¯å¾„</p><h2 id="12-git-commentè§„èŒƒ"><a href="#12-git-commentè§„èŒƒ" class="headerlink" title="12.git commentè§„èŒƒ"></a>12.git commentè§„èŒƒ</h2><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-13.png" alt=""></p><h2 id="13-è®¾è®¡è¡¨çš„ç»éªŒ"><a href="#13-è®¾è®¡è¡¨çš„ç»éªŒ" class="headerlink" title="13.è®¾è®¡è¡¨çš„ç»éªŒ"></a>13.è®¾è®¡è¡¨çš„ç»éªŒ</h2><p>ï¼ˆ1ï¼‰ä¸€å¼€å§‹è®¾è®¡çš„æ˜¯æ²¡æœ‰ç”¨æˆ·ç‚¹èµè¡¨ï¼Œæ¯æ¬¡ç‚¹èµä»æ¶ˆæ¯è®°å½•æŸ¥ï¼Œè¿™æ ·å¾ˆä¸ç¬¦åˆè®¾è®¡ç†å¿µï¼Œæ¶ˆæ¯è¡¨å°±åªåº”è¯¥å­˜å’ŒæŸ¥æ¶ˆæ¯ã€‚</p><p>ï¼ˆ2ï¼‰å¯¹äºä¸èƒ½ä¸ºè´Ÿæ•°çš„å­—æ®µï¼Œä¸€å®šè¦ç”¨unsigned</p><h2 id="14-å®ä¹ ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#14-å®ä¹ ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="14.å®ä¹ ä¸­é‡åˆ°çš„é—®é¢˜"></a>14.å®ä¹ ä¸­é‡åˆ°çš„é—®é¢˜</h2><h3 id="ï¼ˆ1ï¼‰PRDé˜…è¯»"><a href="#ï¼ˆ1ï¼‰PRDé˜…è¯»" class="headerlink" title="ï¼ˆ1ï¼‰PRDé˜…è¯»"></a>ï¼ˆ1ï¼‰PRDé˜…è¯»</h3><p>æˆ‘åœ¨å®ä¹ ä¸­é‡åˆ°çš„æœ€å¤šçš„é—®é¢˜å…¶å®è¿˜æ˜¯ç»éªŒé—®é¢˜ã€‚æ¯”å¦‚åœ¨æˆ‘ä¸€å¼€å§‹åšç¤¾åŒºçš„æ—¶å€™ï¼Œæ²¡æœ‰æ·±å…¥çš„é˜…è¯»PRDï¼Œç›´æ¥å¾ˆå¿«å°±å¼€å‘äº†ï¼Œè¿™å¯¼è‡´å¼€å‘æ•ˆç‡å¾ˆä½ï¼Œä¸ºäº†å®ç°PRDçš„éœ€æ±‚ï¼Œç»å¸¸éœ€è¦ä¸€è¾¹å¼€å‘ï¼Œä¸€éè¾¹è¡¨ã€‚æ¯”å¦‚ï¼Œæˆ‘æœ€å¼€å§‹è®¾è®¡ç¤¾åŒºçš„æ—¶å€™ï¼Œå¯¹äºå‘ˆç°ç”¨æˆ·çš„ç‚¹èµè®°å½•ï¼Œé‡‡ç”¨çš„æ˜¯ä»æ¶ˆæ¯è¡¨å»æ‰¾æœ‰æ²¡æœ‰è®°å½•ï¼Œè¿™æ ·æ˜¯å¾ˆä¸åˆç†çš„ï¼Œå› ä¸ºåé¢å¦‚æœåšæ¶ˆæ¯èšåˆï¼Œå°±æ‰¾ä¸åˆ°ç”¨æˆ·çš„ç‚¹èµè®°å½•äº†ï¼Œæ‰€ä»¥åé¢åˆåŠ äº†ä¸ªç”¨æˆ·ç‚¹èµè¡¨ã€‚</p><p>æˆ‘æƒ³è¯´çš„å°±æ˜¯ï¼Œåœ¨å¼€å‘å‰ï¼Œä¸€å®šè¦å¤šå¤šé˜…è¯»PRDï¼Œå°½é‡æŠŠè¡¨è®¾è®¡å®Œå–„ï¼Œä¸è¦ä¸€è¾¹å¼€å‘ä¸€è¾¹æ”¹è¡¨ã€‚</p><p>â‘ ä¸€å¼€å§‹è®¾è®¡è¡¨çš„æ—¶å€™ï¼Œå¯¹äºå®˜æ–¹å‘é€é€šçŸ¥ï¼Œæˆ‘é‡‡å–çš„æ˜¯ç»™æ¯ä¸ªç”¨æˆ·æ’å…¥ä¸€æ¡æ¶ˆæ¯è®°å½•ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ•°æ®åº“è¡¨çš„æ•°æ®è®°å½•å¾ˆå¤šï¼Œåœ¨ç”¨æˆ·é‡å¤šçš„æ—¶å€™è¡¨ä¼šç›´æ¥ç‚¸æ‰ï¼Œåé¢ç»è¿‡å¸ˆå…„çš„æŒ‡å¯¼ï¼Œé‡‡ç”¨äº†è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆï¼šå³ç”¨æˆ·åœ¨ç™»å½•äº†æŸ¥çœ‹æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ‹‰å–åˆ°å®˜æ–¹æ¶ˆæ¯ã€‚</p><p><strong>â‘  è®¾è®¡æ¨¡å¼ä¼˜åŒ–</strong></p><p>é‡‡ç”¨å…¬å¸å†…éƒ¨æä¾›çš„äº‹ä»¶å‡½æ•°ï¼Œå°†ç”¨æˆ·è¯„è®ºå’Œå‘é€æ¶ˆæ¯è¿™ä¸¤ä¸ªäº‹ä»¶è§£è€¦ã€‚å³ç”¨æˆ·å‘é€è¯„è®ºæˆåŠŸåï¼Œè§¦å‘ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ï¼Œåœ¨ç›‘å¬åˆ°è¿™ä¸ªäº‹ä»¶ä¹‹åï¼Œä»æ¶ˆæ¯äº‹ä»¶å¤„ç†å·¥å‚æ‹¿å‡ºä¸€ä¸ªhanderå¯¹è±¡å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚</p><p>æ¯”å¦‚ï¼š</p><p><strong>ä¸ºä»€ä¹ˆä¸ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ</strong>â€”â€”-ç”¨æ¶ˆæ¯é˜Ÿåˆ—å½“ç„¶ä¹Ÿèƒ½å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘çš„ç†è§£æ˜¯å¦‚æœæ˜¯ä¸åŒçš„ç³»ç»Ÿä¹‹é—´æ‰ç”¨æ¶ˆæ¯é˜Ÿåˆ—ã€‚æ¯”å¦‚ä½ ä¸€ä¸ªæ¶ˆæ¯åœ¨æ¶ˆè´¹æ—¶éœ€è¦è°ƒç”¨å¦å¤–ä¸€ä¸ªæœåŠ¡çš„æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨MQã€‚è€Œç¤¾åŒºä¸€æ•´ä¸ªæ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œæš‚æ—¶è¿˜æ²¡æœ‰ç”¨åˆ°MQå¼‚æ­¥è°ƒç”¨åˆ«çš„æœåŠ¡æ¥å£çš„åœºæ™¯ã€‚</p><p><strong>â‘¡å¯¹äºç‚¹èµæ¶ˆæ¯èšåˆå†™</strong></p><p>ä¼šå‘ç°ï¼Œé‡‡ç”¨Mysqlä¸€æ¡ä¸€æ¡å°†æ•°æ®æ’å…¥çš„æ€§èƒ½æ˜¯å¾ˆä½çš„ï¼Œéœ€è¦å»ºç«‹é¢‘ç¹çš„è¿æ¥ã€‚æ‰€ä»¥æˆ‘é‡‡ç”¨çš„æ˜¯ä»Rediså®šæ—¶å°†ä¸€æ‰¹æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚å…¬å¸å†…éƒ¨æœ‰å®ç°é«˜é€Ÿæ‰¹é‡æ’å…¥æ•°æ®çš„æ¥å£ï¼ˆè¦å¼€mysqlçš„è®¾ç½®ï¼‰ã€‚</p><p>è™½ç„¶è¿™æ ·ä¼šæœ‰ä¸¢å¤±æ•°æ®çš„é£é™©ï¼Œä½†æ˜¯å¯¹äºç‚¹èµæ¶ˆæ¯è¿™ç§ä¸ç®—é‡è¦çš„æ¶ˆæ¯æ˜¯å€¼å¾—çš„ã€‚</p><p><strong>â‘¢æ•°æ®åº“èšåˆ</strong></p><p>æŒ‰ç…§æ¥æ”¶è€…id + é€šçŸ¥å¯¹è±¡id å¯¹åŒä¸€ä¸ªç”¨æˆ·ï¼ŒåŒä¸€å†…å®¹çš„ç‚¹èµæ¶ˆæ¯åœ¨æ•°æ®åº“é‡Œåšèšåˆï¼Œå³ä¸ä¸ºæ¯ä¸€æ¡ç‚¹èµæ¶ˆæ¯éƒ½æ’å…¥ä¸€æ¡è®°å½•ã€‚è¿™èƒ½å¤Ÿå¤§å¤§ç¼“è§£æ•°æ®åº“çš„å­˜å‚¨å‹åŠ›ï¼Œå¹¶ä¸”æœ‰åˆ©äºä»¥åæ•°æ®åº“çš„åˆ†åº“åˆ†è¡¨ã€‚</p><p><strong>â‘£å¤šçº¿ç¨‹å¼‚æ­¥ä¼˜åŒ–</strong></p><p>å®˜æ–¹æ–‡æ¡£ç§æœ‰åŒ–(asyncDownload)ï¼š</p><p>åœ¨å®åœ¨å­¦é™¢é‡Œï¼ŒAdminçš„åå°é‡Œæœ‰ä¸€ä¸ªæ¥å£çš„åŠŸèƒ½æ˜¯å°†å®˜æ–¹æ–‡æ¡£ç§æœ‰åŒ–ã€‚å…·ä½“åŠŸèƒ½å°±æ˜¯å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå‘é€é‚®ä»¶ç»™æŒ‡å®šç”¨æˆ·ã€‚åœ¨è¿™é‡Œé‡‡ç”¨äº†CompletableFutureï¼Œæ— éœ€é˜»å¡ä¸»çº¿ç¨‹ã€‚åœ¨ä¸‹è½½å®Œæ–‡æ¡£å(CompletableFuture.allOf)è‡ªåŠ¨å›è°ƒå‘é€é‚®ç®±çš„æ¥å£ã€‚æå‡æ–‡æ¡£ç§æœ‰åŒ–æ¥å£çš„æ€§èƒ½ã€‚</p><h2 id="15-ä¸ºä»€ä¹ˆåœ¨å®é™…å¼€å‘ä¸­ä¸å»ºè®®ç”¨BeanUtil-copyProperties"><a href="#15-ä¸ºä»€ä¹ˆåœ¨å®é™…å¼€å‘ä¸­ä¸å»ºè®®ç”¨BeanUtil-copyProperties" class="headerlink" title="15.ä¸ºä»€ä¹ˆåœ¨å®é™…å¼€å‘ä¸­ä¸å»ºè®®ç”¨BeanUtil.copyProperties"></a>15.ä¸ºä»€ä¹ˆåœ¨å®é™…å¼€å‘ä¸­ä¸å»ºè®®ç”¨BeanUtil.copyProperties</h2><h3 id="ï¼ˆ1ï¼‰æ€§èƒ½é—®é¢˜"><a href="#ï¼ˆ1ï¼‰æ€§èƒ½é—®é¢˜" class="headerlink" title="ï¼ˆ1ï¼‰æ€§èƒ½é—®é¢˜"></a>ï¼ˆ1ï¼‰æ€§èƒ½é—®é¢˜</h3><p><code>BeanUtils.copyProperties</code> æ˜¯ä¸€ç§é€šè¿‡åå°„æœºåˆ¶å®ç°çš„å±æ€§å¤åˆ¶ã€‚åå°„é€šå¸¸ä¼šæ¯”ç›´æ¥èµ‹å€¼æˆ–æ‰‹åŠ¨ç¼–å†™çš„èµ‹å€¼ä»£ç æ…¢ï¼Œå°¤å…¶æ˜¯åœ¨å¤§é‡æ•°æ®éœ€è¦å¤åˆ¶æ—¶ï¼Œæ€§èƒ½å¼€é”€å¯èƒ½ä¼šæ˜¾å¾—æ¯”è¾ƒå¤§ã€‚å¯¹äºé«˜æ€§èƒ½è¦æ±‚çš„åœºæ™¯ï¼Œå¦‚å¤„ç†å¤§æ•°æ®é‡æ—¶ï¼Œé¢‘ç¹ä½¿ç”¨åå°„å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„å“åº”é€Ÿåº¦ã€‚</p><h3 id="ï¼ˆ2ï¼‰ç»´æŠ¤æ€§å·®"><a href="#ï¼ˆ2ï¼‰ç»´æŠ¤æ€§å·®" class="headerlink" title="ï¼ˆ2ï¼‰ç»´æŠ¤æ€§å·®"></a>ï¼ˆ2ï¼‰ç»´æŠ¤æ€§å·®</h3><p>å¦‚æœé¡¹ç›®ä¸­å¤§é‡ä½¿ç”¨ <code>BeanUtils.copyProperties</code>ï¼Œå°¤å…¶æ˜¯åœ¨æºå¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´æ²¡æœ‰å®Œå…¨ä¸€è‡´çš„å­—æ®µæˆ–å±æ€§ç±»å‹æ—¶ï¼Œå¤åˆ¶çš„é€»è¾‘å¯èƒ½å˜å¾—ä¸æ¸…æ™°ä¸”å®¹æ˜“å‡ºé”™ã€‚ä½ è¿˜éœ€è¦ç¡®ä¿æ¯æ¬¡æºå¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶éƒ½ä¿®æ”¹ä»£ç ï¼Œä»è€Œå½±å“ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p><h3 id="ï¼ˆ3ï¼‰è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨MapStruct"><a href="#ï¼ˆ3ï¼‰è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨MapStruct" class="headerlink" title="ï¼ˆ3ï¼‰è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨MapStruct"></a>ï¼ˆ3ï¼‰è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨MapStruct</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(componentModel = &quot;spring&quot;, unmappedTargetPolicy = ReportingPolicy.IGNORE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CollegeCommunityParamConvert</span> &#123;</span><br><span class="line">    <span class="meta">@Mappings(&#123;</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;id&quot; , source = &quot;id&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;userUid&quot; , source = &quot;userUid&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;updateUserName&quot; , source = &quot;updateUserName&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;isUnban&quot; ,source = &quot;isUnban&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;banReason&quot; , source = &quot;banReason&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;startBanTime&quot; , expression=&quot;java(toLocalDateTime(param.getStartBanTime()))&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;endBanTime&quot; , expression=&quot;java(toLocalDateTime(param.getEndBanTime()))&quot;)</span></span><br><span class="line"><span class="meta">        &#125;)</span></span><br><span class="line">    CollegeCommunityBlacklistDO <span class="title function_">convert</span><span class="params">(CollegeCommunityBlackListUpdateParam param)</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤æ–¹æ³•ï¼šLocalDateTime è½¬ æ¯«ç§’</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> Long <span class="title function_">toMilliseconds</span><span class="params">(LocalDateTime time)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ai.ii.ipa.college.util.date.LocalDateTimeUtils.localDateTimeToMillisecond(time);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤æ–¹æ³•ï¼šå°†æ—¶é—´æˆ³è½¬ä¸º LocalDateTime</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> LocalDateTime <span class="title function_">toLocalDateTime</span><span class="params">(Long timestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDateTimeUtils.millisecondToLocalDateTime(timestamp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="16-æ ¹æ®æ¡ä»¶æ‰¹é‡æ’å…¥"><a href="#16-æ ¹æ®æ¡ä»¶æ‰¹é‡æ’å…¥" class="headerlink" title="16.æ ¹æ®æ¡ä»¶æ‰¹é‡æ’å…¥"></a>16.æ ¹æ®æ¡ä»¶æ‰¹é‡æ’å…¥</h2><p><strong>å¦‚æœåœ¨ä¸šåŠ¡é‡Œå†™ï¼Œä¸šåŠ¡å¤æ‚åŒ–äº†ï¼š</strong></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-14.png" alt=""></p><p><strong>æ­£ç¡®å†™æ³•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=<span class="string">&quot;addOfficialMessagesToUserMessages&quot;</span> parameterType=<span class="string">&quot;CollegeCommunityMessageReceiveDO&quot;</span>&gt;</span><br><span class="line">    INSERT INTO <span class="title function_">college_community_message_receive</span> <span class="params">(</span></span><br><span class="line"><span class="params">        notification_object_id,</span></span><br><span class="line"><span class="params">        post_title,</span></span><br><span class="line"><span class="params">        send_user_uid,</span></span><br><span class="line"><span class="params">        send_user_name,</span></span><br><span class="line"><span class="params">        accept_user_uid,</span></span><br><span class="line"><span class="params">        msg_id,</span></span><br><span class="line"><span class="params">        content,</span></span><br><span class="line"><span class="params">        notification_object_type,</span></span><br><span class="line"><span class="params">        create_time</span></span><br><span class="line"><span class="params">    )</span></span><br><span class="line">    SELECT</span><br><span class="line">        msg.notification_object_id,</span><br><span class="line">        msg.post_title,</span><br><span class="line">        msg.send_user_uid,</span><br><span class="line">        msg.send_user_name,</span><br><span class="line">        #&#123;param.acceptUserUid, jdbcType=VARCHAR&#125;,</span><br><span class="line">        msg.id,</span><br><span class="line">        msg.content,</span><br><span class="line">        #&#123;param.notificationObjectType, jdbcType=INTEGER&#125;,</span><br><span class="line">        msg.create_time</span><br><span class="line">    FROM</span><br><span class="line">        college_community_message msg</span><br><span class="line">    WHERE</span><br><span class="line">        NOT <span class="title function_">EXISTS</span> <span class="params">(</span></span><br><span class="line"><span class="params">                SELECT <span class="number">1</span></span></span><br><span class="line"><span class="params">                FROM college_community_message_receive cmr</span></span><br><span class="line"><span class="params">                WHERE cmr.accept_user_uid = #&#123;param.acceptUserUid, jdbcType=VARCHAR&#125;</span></span><br><span class="line"><span class="params">                  AND cmr.msg_id = msg.id</span></span><br><span class="line"><span class="params">            )</span></span><br><span class="line">      AND msg.notification_object_type = #&#123;param.notificationObjectType, jdbcType=INTEGER&#125;;</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure><h2 id="17-ä¸ºä»€ä¹ˆé¡¹ç›®ä¸­æ‰€æœ‰çš„å®šæ—¶éƒ½éœ€è¦å¼•å…¥XXL-JOB"><a href="#17-ä¸ºä»€ä¹ˆé¡¹ç›®ä¸­æ‰€æœ‰çš„å®šæ—¶éƒ½éœ€è¦å¼•å…¥XXL-JOB" class="headerlink" title="17.ä¸ºä»€ä¹ˆé¡¹ç›®ä¸­æ‰€æœ‰çš„å®šæ—¶éƒ½éœ€è¦å¼•å…¥XXL-JOB"></a>17.ä¸ºä»€ä¹ˆé¡¹ç›®ä¸­æ‰€æœ‰çš„å®šæ—¶éƒ½éœ€è¦å¼•å…¥XXL-JOB</h2><p>æ¯”å¦‚ESç´¢å¼•çš„è‡ªåŠ¨åˆ·æ–°ï¼Œä»¥åŠspringçš„@Scheduledéƒ½æ˜¯ä¸å»ºè®®ä½¿ç”¨çš„ï¼Œå› ä¸ºé¡¹ç›®ä¸€æ—¦ä¸Šçº¿ï¼Œæ‰€æœ‰èŠ‚ç‚¹ä¼šä¸€èµ·åˆ·æ–°ESç´¢å¼•ï¼Œè¿™æ ·ä¼šæŸè€—æ€§èƒ½ï¼Œé€ æˆä¸å¿…è¦çš„è´Ÿæ‹…ã€‚åº”è¯¥é‡‡ç”¨XXL-JOBè¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚</p><h2 id="18-Spring-ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶å·¥å…·ç±»"><a href="#18-Spring-ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶å·¥å…·ç±»" class="headerlink" title="18.Spring ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶å·¥å…·ç±»"></a>18.Spring ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶å·¥å…·ç±»</h2><p>è§‚å¯Ÿè€…æ¨¡å¼è§£è€¦ï¼š<a href="https://blog.csdn.net/crazymakercircle/article/details/128627663?fromshare=blogdetail\&amp;sharetype=blogdetail\&amp;sharerId=128627663\&amp;sharerefer=PC\&amp;sharesource=m0_51088567\&amp;sharefrom=from_link">é€šè¿‡äº‹ä»¶æ€»çº¿EventBus/AsyncEventBusè¿›è¡ŒJAVAæ¨¡å—è§£è€¦ (å²ä¸Šæœ€å…¨)_java eventbus-CSDNåšå®¢</a></p><h3 id="1-å¤–å±‚è°ƒç”¨Util"><a href="#1-å¤–å±‚è°ƒç”¨Util" class="headerlink" title="(1).å¤–å±‚è°ƒç”¨Util"></a>(1).å¤–å±‚è°ƒç”¨Util</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-12.png" alt=""></p><h3 id="2-Utilè·å–äº‹ä»¶çš„Bean"><a href="#2-Utilè·å–äº‹ä»¶çš„Bean" class="headerlink" title="(2)Utilè·å–äº‹ä»¶çš„Bean"></a>(2)Utilè·å–äº‹ä»¶çš„Bean</h3><p>åœ¨è¿™é‡Œä¸èƒ½ä½¿ç”¨@Resourceè¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå› ä¸ºåœ¨è¿™ä¸ªBeanè¿›è¡Œåˆå§‹åŒ–ä¸­ä½¿ç”¨åˆ°äº†ApplicationContextï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡ç±»å‹æˆ–åç§°è·å–æŒ‡å®šçš„ Beanã€‚</p><p>@Resource:é™æ€ä¾èµ–æ³¨å…¥ï¼Œæ³¨å…¥çš„æ˜¯å•ä¸€ã€ç¡®å®šçš„ Beanã€‚</p><p><code>ApplicationContext</code>ï¼Œå¯ä»¥åŠ¨æ€æŒ‰åç§°æˆ–ç±»å‹è·å–å¤šä¸ªä¸åŒçš„ Beanã€‚è¿™åœ¨éœ€è¦æ ¹æ®è¿è¡Œæ—¶æ¡ä»¶å†³å®šä½¿ç”¨å“ªä¸ª Bean æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-40.png" alt=""></p><h3 id="3-è°ƒç”¨Beançš„æ–¹æ³•ï¼š"><a href="#3-è°ƒç”¨Beançš„æ–¹æ³•ï¼š" class="headerlink" title="(3)è°ƒç”¨Beançš„æ–¹æ³•ï¼š"></a>(3)è°ƒç”¨Beançš„æ–¹æ³•ï¼š</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-41.png" alt=""></p><h3 id="4-åœ¨Beané‡Œé¢å®šä¹‰åŒæ­¥äº‹ä»¶æ€»çº¿å’Œå¼‚æ­¥äº‹ä»¶æ€»çº¿"><a href="#4-åœ¨Beané‡Œé¢å®šä¹‰åŒæ­¥äº‹ä»¶æ€»çº¿å’Œå¼‚æ­¥äº‹ä»¶æ€»çº¿" class="headerlink" title="(4)åœ¨Beané‡Œé¢å®šä¹‰åŒæ­¥äº‹ä»¶æ€»çº¿å’Œå¼‚æ­¥äº‹ä»¶æ€»çº¿"></a>(4)åœ¨Beané‡Œé¢å®šä¹‰åŒæ­¥äº‹ä»¶æ€»çº¿å’Œå¼‚æ­¥äº‹ä»¶æ€»çº¿</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-39.png" alt=""></p><h3 id="5-è‡ªå®šä¹‰æ³¨è§£å¹¶ç›‘å¬"><a href="#5-è‡ªå®šä¹‰æ³¨è§£å¹¶ç›‘å¬" class="headerlink" title="(5) è‡ªå®šä¹‰æ³¨è§£å¹¶ç›‘å¬"></a>(5) è‡ªå®šä¹‰æ³¨è§£å¹¶ç›‘å¬</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-38.png" alt=""></p><h3 id="6-ä½¿ç”¨-PostConstructåœ¨Beanè¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ­¤å¤„æ‰§è¡Œè·å–æ‰€æœ‰å¸¦æœ‰-EventBusListener-çš„-beanï¼Œå°†ä»–ä»¬æ³¨å†Œä¸ºç›‘å¬è€…"><a href="#6-ä½¿ç”¨-PostConstructåœ¨Beanè¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ­¤å¤„æ‰§è¡Œè·å–æ‰€æœ‰å¸¦æœ‰-EventBusListener-çš„-beanï¼Œå°†ä»–ä»¬æ³¨å†Œä¸ºç›‘å¬è€…" class="headerlink" title="(6)ä½¿ç”¨@PostConstructåœ¨Beanè¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ­¤å¤„æ‰§è¡Œè·å–æ‰€æœ‰å¸¦æœ‰ @EventBusListener çš„ beanï¼Œå°†ä»–ä»¬æ³¨å†Œä¸ºç›‘å¬è€…"></a>(6)ä½¿ç”¨@PostConstructåœ¨Beanè¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ­¤å¤„æ‰§è¡Œè·å–æ‰€æœ‰å¸¦æœ‰ @EventBusListener çš„ beanï¼Œå°†ä»–ä»¬æ³¨å†Œä¸ºç›‘å¬è€…</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-36.png" alt=""></p><h2 id="19-ã€è§„çº¦ã€‘æ’å…¥å’Œæ›´æ–°çš„ä»£ç ä¸è¦æ”¾Bizé‡Œï¼Œå°è£…åœ¨Serviceé‡Œ"><a href="#19-ã€è§„çº¦ã€‘æ’å…¥å’Œæ›´æ–°çš„ä»£ç ä¸è¦æ”¾Bizé‡Œï¼Œå°è£…åœ¨Serviceé‡Œ" class="headerlink" title="19.ã€è§„çº¦ã€‘æ’å…¥å’Œæ›´æ–°çš„ä»£ç ä¸è¦æ”¾Bizé‡Œï¼Œå°è£…åœ¨Serviceé‡Œ"></a>19.ã€è§„çº¦ã€‘æ’å…¥å’Œæ›´æ–°çš„ä»£ç ä¸è¦æ”¾Bizé‡Œï¼Œå°è£…åœ¨Serviceé‡Œ</h2><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-37.png" alt=""></p><p><strong>MPçš„æ˜¾å¼æ³›å‹è°ƒç”¨å†™æ³•ï¼Œå€¼å¾—å­¦ä¹ ï¼š</strong></p><p>Wrappers.\<CollegeCommunityPostTagRelDO> <em>lambdaQuery</em>()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Wrappers.&lt;CollegeCommunityPostTagRelDO&gt; lambdaQuery()</span><br><span class="line">       .eq(CollegeCommunityPostTagRelDO::getTagId,tagId)</span><br></pre></td></tr></table></figure><h2 id="20-SQLè¯­å¥"><a href="#20-SQLè¯­å¥" class="headerlink" title="20.SQLè¯­å¥"></a>20.SQLè¯­å¥</h2><h3 id="1-åŠ¨æ€SQLâ€”-inçš„ä½¿ç”¨"><a href="#1-åŠ¨æ€SQLâ€”-inçš„ä½¿ç”¨" class="headerlink" title="(1) åŠ¨æ€SQLâ€”- inçš„ä½¿ç”¨"></a>(1) åŠ¨æ€SQLâ€”- inçš„ä½¿ç”¨</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-27.png" alt=""></p><h3 id="2-åŠ¨æ€æ’å…¥"><a href="#2-åŠ¨æ€æ’å…¥" class="headerlink" title="(2) åŠ¨æ€æ’å…¥"></a>(2) åŠ¨æ€æ’å…¥</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-28.png" alt=""></p><h3 id="3-å¤šæ¡ä»¶åˆ†é¡µæŸ¥è¯¢"><a href="#3-å¤šæ¡ä»¶åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="(3) å¤šæ¡ä»¶åˆ†é¡µæŸ¥è¯¢"></a>(3) å¤šæ¡ä»¶åˆ†é¡µæŸ¥è¯¢</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-29.png" alt=""></p><h3 id="4-GROUP-CONCAT"><a href="#4-GROUP-CONCAT" class="headerlink" title="(4) GROUP_CONCAT"></a>(4) GROUP_CONCAT</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-30.png" alt=""></p><p><strong>æ•ˆæœï¼š</strong></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-31.png" alt=""></p><h3 id="5-choose"><a href="#5-choose" class="headerlink" title="(5) choose"></a>(5) choose</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-32.png" alt=""></p><h3 id="6-ONLY-FULL-GROUP-BY-é—®é¢˜"><a href="#6-ONLY-FULL-GROUP-BY-é—®é¢˜" class="headerlink" title="(6) ONLY_FULL_GROUP_BY é—®é¢˜"></a>(6) ONLY_FULL_GROUP_BY é—®é¢˜</h3><p><strong>ONLY_FULL_GROUP_BY</strong>æ˜¯MySQLçš„ä¸€ä¸ªSQLæ¨¡å¼ï¼ˆSQL_MODEï¼‰ä¹‹ä¸€ï¼Œå®ƒè¦æ±‚åœ¨ä½¿ç”¨GROUP BYè¯­å¥æ—¶ï¼ŒSELECTåˆ—è¡¨ã€HAVINGæ¡ä»¶æˆ–ORDER BYåˆ—è¡¨ä¸­çš„æ¯ä¸ªåˆ—ï¼Œè¦ä¹ˆæ˜¯èšåˆå‡½æ•°çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚COUNT(), SUM(), AVG()ç­‰ï¼‰ï¼Œè¦ä¹ˆå¿…é¡»åœ¨GROUP BYå­å¥ä¸­æ˜ç¡®æŒ‡å®šã€‚</p><p>è™½ç„¶ONLY_FULL_GROUP_BYæ¨¡å¼ä¸‹selectä¸­çš„åˆ—å¿…é¡»åœ¨group byä¸­å‡ºç°ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•åå‘ç° <strong>è‹¥group by åé¢åˆ†ç»„å­—æ®µæ˜¯å”¯ä¸€ç´¢å¼•æˆ–è€…æ˜¯ä¸»é”®ï¼Œé‚£ä¹ˆselectåé¢å¯ä»¥è·Ÿå…¶ä»–çš„åˆ—</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ONLY_FULL_GROUP_BYï¼šå¯¹äºGROUP BYèšåˆæ“ä½œï¼Œå¦‚æœåœ¨SELECTä¸­çš„åˆ—ï¼Œæ²¡æœ‰åœ¨GROUP BYä¸­å‡ºç°ï¼Œé‚£ä¹ˆè¿™ä¸ªSQLæ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºåˆ—ä¸åœ¨GROUP BYä»å¥ä¸­</span><br><span class="line">NO_AUTO_VALUE_ON_ZEROï¼šè¯¥å€¼å½±å“è‡ªå¢é•¿åˆ—çš„æ’å…¥ã€‚é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ’å…¥0æˆ–NULLä»£è¡¨ç”Ÿæˆä¸‹ä¸€ä¸ªè‡ªå¢é•¿å€¼ã€‚å¦‚æœç”¨æˆ·å¸Œæœ›æ’å…¥çš„å€¼ä¸º0ï¼Œè€Œè¯¥åˆ—åˆæ˜¯è‡ªå¢é•¿çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé€‰é¡¹å°±æœ‰ç”¨äº†ã€‚</span><br><span class="line">STRICT_TRANS_TABLESï¼šåœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸èƒ½æ’å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡è¡¨ä¸­ï¼Œåˆ™ä¸­æ–­å½“å‰çš„æ“ä½œï¼Œå¯¹éäº‹åŠ¡è¡¨ä¸åšé™åˆ¶</span><br><span class="line">NO_ZERO_IN_DATEï¼šåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¸å…è®¸æ—¥æœŸå’Œæœˆä»½ä¸ºé›¶</span><br><span class="line">NO_ZERO_DATEï¼šè®¾ç½®è¯¥å€¼ï¼Œmysqlæ•°æ®åº“ä¸å…è®¸æ’å…¥é›¶æ—¥æœŸï¼Œæ’å…¥é›¶æ—¥æœŸä¼šæŠ›å‡ºé”™è¯¯è€Œä¸æ˜¯è­¦å‘Šã€‚</span><br><span class="line">ERROR_FOR_DIVISION_BY_ZEROï¼šåœ¨INSERTæˆ–UPDATEè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®è¢«é›¶é™¤ï¼Œåˆ™äº§ç”Ÿé”™è¯¯è€Œéè­¦å‘Šã€‚å¦‚æœæœªç»™å‡ºè¯¥æ¨¡å¼ï¼Œé‚£ä¹ˆæ•°æ®è¢«é›¶é™¤æ—¶MySQLè¿”å›NULL</span><br><span class="line">NO_AUTO_CREATE_USERï¼šç¦æ­¢GRANTåˆ›å»ºå¯†ç ä¸ºç©ºçš„ç”¨æˆ·</span><br><span class="line">NO_ENGINE_SUBSTITUTIONï¼šå¦‚æœéœ€è¦çš„å­˜å‚¨å¼•æ“è¢«ç¦ç”¨æˆ–æœªç¼–è¯‘ï¼Œé‚£ä¹ˆæŠ›å‡ºé”™è¯¯ã€‚ä¸è®¾ç½®æ­¤å€¼æ—¶ï¼Œç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“æ›¿ä»£ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br><span class="line">PIPES_AS_CONCATï¼šå°†â€||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼</span><br><span class="line">ANSI_QUOTESï¼šå¯ç”¨ANSI_QUOTESåï¼Œä¸èƒ½ç”¨åŒå¼•å·æ¥å¼•ç”¨å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒè¢«è§£é‡Šä¸ºè¯†åˆ«ç¬¦</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-33.png" alt=""></p><h2 id="21-è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œè¯·æ±‚é™æµ"><a href="#21-è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œè¯·æ±‚é™æµ" class="headerlink" title="21.è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œè¯·æ±‚é™æµ"></a>21.è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œè¯·æ±‚é™æµ</h2><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-34.png" alt=""></p><h3 id="ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£"><a href="#ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£"></a>ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-35.png" alt=""></p><h3 id="ï¼ˆ2ï¼‰æ³¨è§£åˆ‡é¢ç±»"><a href="#ï¼ˆ2ï¼‰æ³¨è§£åˆ‡é¢ç±»" class="headerlink" title="ï¼ˆ2ï¼‰æ³¨è§£åˆ‡é¢ç±»"></a>ï¼ˆ2ï¼‰æ³¨è§£åˆ‡é¢ç±»</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-56.png" alt=""></p><p>ï¼ˆ3ï¼‰æ„å»ºKey</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-42.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-43.png" alt=""></p><p>ä»æ³¨è§£å‚æ•°ä¸­è·å–Keyç”Ÿæˆç±»æ¥ç”ŸæˆKey</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-44.png" alt=""></p><h3 id="ï¼ˆ3ï¼‰è‡ªå®šä¹‰è·å–Keyçš„å‡½æ•°"><a href="#ï¼ˆ3ï¼‰è‡ªå®šä¹‰è·å–Keyçš„å‡½æ•°" class="headerlink" title="ï¼ˆ3ï¼‰è‡ªå®šä¹‰è·å–Keyçš„å‡½æ•°"></a>ï¼ˆ3ï¼‰è‡ªå®šä¹‰è·å–Keyçš„å‡½æ•°</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-45.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-46.png" alt=""></p><p>è¯»å–å‡½æ•°çš„å…¥å‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-47.png" alt=""></p><h3 id="ï¼ˆ4ï¼‰æ„å»ºValue"><a href="#ï¼ˆ4ï¼‰æ„å»ºValue" class="headerlink" title="ï¼ˆ4ï¼‰æ„å»ºValue"></a>ï¼ˆ4ï¼‰æ„å»ºValue</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-48.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-49.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-50.png" alt=""></p><p>æ„å»ºå‚æ•°çš„Md5</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-51.png" alt=""></p><h3 id="ï¼ˆ5ï¼‰ä»redisé‡Œåˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªkeyï¼Œæ²¡æœ‰å°±æ–°å¢"><a href="#ï¼ˆ5ï¼‰ä»redisé‡Œåˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªkeyï¼Œæ²¡æœ‰å°±æ–°å¢" class="headerlink" title="ï¼ˆ5ï¼‰ä»redisé‡Œåˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªkeyï¼Œæ²¡æœ‰å°±æ–°å¢"></a>ï¼ˆ5ï¼‰ä»redisé‡Œåˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªkeyï¼Œæ²¡æœ‰å°±æ–°å¢</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-52.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-53.png" alt=""></p><h2 id="22-æ³›å‹ä½¿ç”¨"><a href="#22-æ³›å‹ä½¿ç”¨" class="headerlink" title="22.æ³›å‹ä½¿ç”¨"></a>22.æ³›å‹ä½¿ç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰¹é‡åˆ é™¤å¸–å­åŠå…¶ç›¸å…³æ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@PARAM</span>: <span class="doctag">@param</span> postIds</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@RETURN</span>:</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deletePostRelatedRecords</span><span class="params">(List&lt;Long&gt; postIds)</span> &#123;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢å…³è”å…³ç³»</span></span><br><span class="line">    List&lt;AdminCollegeCommunityPostRelDTO&gt; postRelDtos = collegeCommunityPostService.listPostRel(postIds);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å…³è”IDé›†åˆ</span></span><br><span class="line">    Map&lt;String, Set&lt;?&gt;&gt; relatedIdsMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    relatedIdsMap.put(<span class="string">&quot;postUuids&quot;</span>, <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;String&gt;());</span><br><span class="line">    relatedIdsMap.put(<span class="string">&quot;replyIds&quot;</span>, <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Long&gt;());</span><br><span class="line">    relatedIdsMap.put(<span class="string">&quot;topicRelIds&quot;</span>, <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Long&gt;());</span><br><span class="line">    relatedIdsMap.put(<span class="string">&quot;tagRelIds&quot;</span>, <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Long&gt;());</span><br><span class="line">    relatedIdsMap.put(<span class="string">&quot;attachmentIds&quot;</span>, <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Long&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ”¶é›†å…³è”å…³ç³»</span></span><br><span class="line">    postRelDtos.forEach(dto -&gt; &#123;</span><br><span class="line">        Optional.ofNullable(dto.getPostUuid()).ifPresent(uuid -&gt; ((Set&lt;String&gt;) relatedIdsMap.get(<span class="string">&quot;postUuids&quot;</span>)).add(uuid));</span><br><span class="line">        Optional.ofNullable(dto.getReplyId()).ifPresent(id -&gt; ((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;replyIds&quot;</span>)).add(id));</span><br><span class="line">        Optional.ofNullable(dto.getTopicRelId()).ifPresent(id -&gt; ((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;topicRelIds&quot;</span>)).add(id));</span><br><span class="line">        Optional.ofNullable(dto.getTagRelId()).ifPresent(id -&gt; ((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;tagRelIds&quot;</span>)).add(id));</span><br><span class="line">        Optional.ofNullable(dto.getAttachmentRelId()).ifPresent(id -&gt; ((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;attachmentIds&quot;</span>)).add(id));</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰¹é‡åˆ é™¤å…³è”è®°å½•</span></span><br><span class="line">    batchRemoveIfNotEmpty((Set&lt;String&gt;) relatedIdsMap.get(<span class="string">&quot;postUuids&quot;</span>), collegeCommunityPostAttachmentService::removeByPostUuid);</span><br><span class="line">    batchRemoveIfNotEmpty((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;replyIds&quot;</span>), collegeCommunityReplyService::removeByIds);</span><br><span class="line">    batchRemoveIfNotEmpty((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;topicRelIds&quot;</span>), collegeCommunityTopicPostRelService::removeByIds);</span><br><span class="line">    batchRemoveIfNotEmpty((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;tagRelIds&quot;</span>), collegeCommunityPostTagRelService::removeByIds);</span><br><span class="line">    batchRemoveIfNotEmpty((Set&lt;Long&gt;) relatedIdsMap.get(<span class="string">&quot;attachmentIds&quot;</span>), collegeCommunityPostAttachmentService::removeByIds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ é™¤ç›¸å…³è®°å½•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> removeFunction</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@PARAM</span>: <span class="doctag">@param</span> set</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@RETURN</span>:</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">batchRemoveIfNotEmpty</span><span class="params">(Set&lt;T&gt; set, Consumer&lt;List&lt;T&gt;&gt; removeFunction)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (CollUtil.isNotEmpty(set)) &#123;</span><br><span class="line">        removeFunction.accept(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(set));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="23-æ›´è‡ªç”±çš„ç™½åå•"><a href="#23-æ›´è‡ªç”±çš„ç™½åå•" class="headerlink" title="23.æ›´è‡ªç”±çš„ç™½åå•"></a>23.æ›´è‡ªç”±çš„ç™½åå•</h2><h3 id="ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£-1"><a href="#ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£-1" class="headerlink" title="ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£"></a>ï¼ˆ1ï¼‰è‡ªå®šä¹‰æ³¨è§£</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-54.png" alt=""></p><h3 id="ï¼ˆ2ï¼‰åœ¨å¯¹åº”çš„Controllerä¸ŠåŠ ä¸Šå¯¹åº”çš„ç±»"><a href="#ï¼ˆ2ï¼‰åœ¨å¯¹åº”çš„Controllerä¸ŠåŠ ä¸Šå¯¹åº”çš„ç±»" class="headerlink" title="ï¼ˆ2ï¼‰åœ¨å¯¹åº”çš„Controllerä¸ŠåŠ ä¸Šå¯¹åº”çš„ç±»"></a>ï¼ˆ2ï¼‰åœ¨å¯¹åº”çš„Controllerä¸ŠåŠ ä¸Šå¯¹åº”çš„ç±»</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-55.png" alt=""></p><h3 id="ï¼ˆ3ï¼‰å†™æ‹¦æˆªå™¨"><a href="#ï¼ˆ3ï¼‰å†™æ‹¦æˆªå™¨" class="headerlink" title="ï¼ˆ3ï¼‰å†™æ‹¦æˆªå™¨"></a>ï¼ˆ3ï¼‰å†™æ‹¦æˆªå™¨</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-67.png" alt=""></p><h3 id="ï¼ˆ4ï¼‰å…ç™»åˆ¤æ–­"><a href="#ï¼ˆ4ï¼‰å…ç™»åˆ¤æ–­" class="headerlink" title="ï¼ˆ4ï¼‰å…ç™»åˆ¤æ–­"></a>ï¼ˆ4ï¼‰å…ç™»åˆ¤æ–­</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-57.png" alt=""></p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-58.png" alt=""></p><p>æˆ–è€…æ ¹æ®é…ç½®è¿›è¡Œå…ç™»åˆ¤æ–­</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-59.png" alt=""></p><h2 id="24-Dockeréƒ¨ç½²é¡¹ç›®"><a href="#24-Dockeréƒ¨ç½²é¡¹ç›®" class="headerlink" title="24.Dockeréƒ¨ç½²é¡¹ç›®"></a>24.Dockeréƒ¨ç½²é¡¹ç›®</h2><h3 id="ï¼ˆ1ï¼‰Mavenæ‰“åŒ…"><a href="#ï¼ˆ1ï¼‰Mavenæ‰“åŒ…" class="headerlink" title="ï¼ˆ1ï¼‰Mavenæ‰“åŒ…"></a>ï¼ˆ1ï¼‰Mavenæ‰“åŒ…</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-60.png" alt=""></p><h3 id="ï¼ˆ2ï¼‰å†™Dockerfileæ–‡ä»¶"><a href="#ï¼ˆ2ï¼‰å†™Dockerfileæ–‡ä»¶" class="headerlink" title="ï¼ˆ2ï¼‰å†™Dockerfileæ–‡ä»¶"></a>ï¼ˆ2ï¼‰å†™Dockerfileæ–‡ä»¶</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-61.png" alt=""></p><h3 id="ï¼ˆ3ï¼‰jaråŒ…å’ŒDockerfileæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•é‡Œ"><a href="#ï¼ˆ3ï¼‰jaråŒ…å’ŒDockerfileæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•é‡Œ" class="headerlink" title="ï¼ˆ3ï¼‰jaråŒ…å’ŒDockerfileæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•é‡Œ"></a>ï¼ˆ3ï¼‰jaråŒ…å’ŒDockerfileæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•é‡Œ</h3><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-62.png" alt=""></p><h3 id="ï¼ˆ4ï¼‰æ„å»ºé•œåƒ"><a href="#ï¼ˆ4ï¼‰æ„å»ºé•œåƒ" class="headerlink" title="ï¼ˆ4ï¼‰æ„å»ºé•œåƒ"></a>ï¼ˆ4ï¼‰æ„å»ºé•œåƒ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t college .     </span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ5ï¼‰è¿è¡Œ"><a href="#ï¼ˆ5ï¼‰è¿è¡Œ" class="headerlink" title="ï¼ˆ5ï¼‰è¿è¡Œ"></a>ï¼ˆ5ï¼‰è¿è¡Œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --build-arg BASE_IMAGE=openjdk:<span class="number">8</span>-jdk-alpine -t college .</span><br></pre></td></tr></table></figure><h2 id="25-åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµçš„ä¸¤ç§æ–¹æ¡ˆ"><a href="#25-åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµçš„ä¸¤ç§æ–¹æ¡ˆ" class="headerlink" title="25.åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµçš„ä¸¤ç§æ–¹æ¡ˆ"></a>25.åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµçš„ä¸¤ç§æ–¹æ¡ˆ</h2><h3 id="ï¼ˆ1ï¼‰æ–°å¢ä¸€ä¸ªç”¨æˆ·ç‚¹èµè¡¨"><a href="#ï¼ˆ1ï¼‰æ–°å¢ä¸€ä¸ªç”¨æˆ·ç‚¹èµè¡¨" class="headerlink" title="ï¼ˆ1ï¼‰æ–°å¢ä¸€ä¸ªç”¨æˆ·ç‚¹èµè¡¨"></a>ï¼ˆ1ï¼‰æ–°å¢ä¸€ä¸ªç”¨æˆ·ç‚¹èµè¡¨</h3><p>å½“ç”¨æˆ·ç‚¹èµæ—¶ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦ä¿®æ”¹ç‚¹èµè¡¨æˆåŠŸï¼Œåªæœ‰æˆåŠŸæ‰ä¼šç»™å¯¹è±¡çš„ç‚¹èµæ•°ç›®å¢åŠ æˆ–è€…å‡å°‘</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-63.png" alt=""></p><h3 id="ï¼ˆ2ï¼‰ä½¿ç”¨redisçš„bitmapæ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµè¿‡"><a href="#ï¼ˆ2ï¼‰ä½¿ç”¨redisçš„bitmapæ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµè¿‡" class="headerlink" title="ï¼ˆ2ï¼‰ä½¿ç”¨redisçš„bitmapæ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµè¿‡"></a>ï¼ˆ2ï¼‰ä½¿ç”¨redisçš„bitmapæ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹èµè¿‡</h3><h2 id="26-ã€â­ï¸ä¼˜åŒ–ã€‘ä¼˜åŒ–æ…¢æŸ¥è¯¢æ¥å£"><a href="#26-ã€â­ï¸ä¼˜åŒ–ã€‘ä¼˜åŒ–æ…¢æŸ¥è¯¢æ¥å£" class="headerlink" title="26.ã€â­ï¸ä¼˜åŒ–ã€‘ä¼˜åŒ–æ…¢æŸ¥è¯¢æ¥å£"></a>26.ã€â­ï¸ä¼˜åŒ–ã€‘ä¼˜åŒ–æ…¢æŸ¥è¯¢æ¥å£</h2><p><strong>ç®€æ´ç‰ˆï¼š</strong>&#x6DFB;åŠ å†—ä½™å­—æ®µæ¥ä¼˜åŒ–æ…¢æŸ¥è¯¢æ¥å£ï¼Œæ¥å£åŠŸèƒ½æ˜¯æ ¹æ®ä¸€ä¸ªidå»æŸ¥æ‰¾è¿™ä¸ªidä¸‹çš„æ‰€æœ‰å­éƒ¨é—¨ã€‚</p><p><strong>é—®é¢˜æè¿°ï¼š</strong>&#x6570;æ®ç»“æ„æ˜¯æ ‘å‹ï¼Œä¸€ä¸ªéƒ¨é—¨å¯ä»¥å¯¹åº”å¤šä¸ªå­éƒ¨é—¨ï¼Œä¸€ä¸ªå­éƒ¨é—¨åˆå¯¹åº”å¾ˆå¤šä¸ªå­éƒ¨é—¨ã€‚åœ¨æ§åˆ¶å™¨é¡¹ç›®ä¸­ï¼Œå‘ç°æœ‰ä¸€äº›å…¬å¸æœ‰ä¸€ä¸‡å¤šä¸ªéƒ¨é—¨ï¼Œè¿™æ ·æ•°æ®å¾ˆå¤šè€Œä¸”æ ‘å¾ˆæ·±ã€‚</p><p>ä»¥å¾€çš„æŸ¥è¯¢ç­–ç•¥æ˜¯æ ¹æ®idå»æŸ¥è¯¢è¿™ä¸ªidçš„æ‰€æœ‰å­éƒ¨é—¨ï¼Œå†æ ¹æ®å­éƒ¨é—¨å†å»é€’å½’æŸ¥è¯¢ã€‚è¿™æ ·è¦æŸ¥è¯¢å¾ˆå¤šæ¬¡æ•°æ®åº“ï¼Œå¯¼è‡´åœ¨æœ‰äº›éƒ¨é—¨å¾ˆå¤šçš„å…¬å¸è°ƒç”¨è¿™ä¸ªæ¥å£çš„æ—¶é—´é•¿è¾¾20sï¼Œä¼˜åŒ–åä»20så˜æˆäº†40msã€‚</p><p>æ‰€ä»¥è¦é‡‡å–ä¼˜åŒ–æªæ–½ï¼Œé™¤äº†å¯¹è¡¨çš„å­—æ®µå¢åŠ ç´¢å¼•å¤–ï¼Œæ­¤æ¬¡ä¼˜åŒ–çš„ä¸»è¦ç›®çš„æ˜¯èƒ½å¤Ÿé€šè¿‡idä¸€æ¬¡æ€§æŸ¥è¯¢è¿™ä¸ªéƒ¨é—¨çš„æ‰€æœ‰å­éƒ¨é—¨ã€‚</p><p><strong>ä¼˜åŒ–æ–¹æ³•ï¼š</strong>&#x5BF9;æ•°æ®åº“æ·»åŠ ä¸¤ä¸ªå†—ä½™å­—æ®µï¼ŒleftValueå’ŒrightValueã€‚é€šè¿‡idå¯ä»¥æ ¹æ®è¿™ä¸ªidçš„leftValueå’ŒrightValueå»æŸ¥æ‰¾æ‰€æœ‰å¯¹åº”èŒƒ&#x56F4;<strong>[leftValue,rightValue]</strong>&#x7684;å€¼ã€‚</p><p>æ„å»ºæ ‘ï¼šä¼ è¿›æ¥ä¸€ä¸ªæ ‘ï¼Œé‡‡ç”¨dfsæ„å»ºè¿™é¢—æ ‘ã€‚ç¡®ä¿å­èŠ‚ç‚¹çš„leftValueå’ŒrightValueè¢«çˆ¶èŠ‚ç‚¹çš„leftValueå’ŒrightValueæ‰€åŒ…å«ã€‚</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-64.png" alt=""></p><p>å¢åŠ å•ä¸ªéƒ¨é—¨ï¼šå¯¹è¿™é¢—æ ‘çš„ç´¢å¼•èŠ‚ç‚¹éå†ï¼Œæ‰€æœ‰å¤§äºè¿™ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼çš„leftValueå’ŒrightValueåŠ ä¸Š nodeNum * 2</p><p>åˆ é™¤å•ä¸ªéƒ¨é—¨ï¼šä¸Šè¿°æ“ä½œå–å</p><p>ç§»åŠ¨éƒ¨é—¨ï¼šå…ˆåˆ é™¤å†æ·»åŠ </p><p><a href="https://mcnfxurl5vzo.feishu.cn/wiki/Nk0nwR3W4iP9FLk9Pm7cXvRWnZc"> æ ‘å‹æŸ¥è¯¢ä¼˜åŒ–</a></p><h2 id="27-feignè°ƒç”¨çš„é—®é¢˜"><a href="#27-feignè°ƒç”¨çš„é—®é¢˜" class="headerlink" title="27.feignè°ƒç”¨çš„é—®é¢˜"></a>27.feignè°ƒç”¨çš„é—®é¢˜</h2><h3 id="ï¼ˆ1ï¼‰è°ƒç”¨è¿”å›NULL"><a href="#ï¼ˆ1ï¼‰è°ƒç”¨è¿”å›NULL" class="headerlink" title="ï¼ˆ1ï¼‰è°ƒç”¨è¿”å›NULL"></a>ï¼ˆ1ï¼‰è°ƒç”¨è¿”å›NULL</h3><p>åœ¨adminæœåŠ¡å†™äº†ï¼Œæ¥å£åœ¨collegeé‡Œè°ƒç”¨ã€‚ç»“æœåœ¨adminé‚£è¾¹èƒ½æ‹¿åˆ°æ•°æ®ï¼Œåœ¨collegeé‡Œé¢å´æ‹¿ä¸åˆ°ã€‚è¿™æ˜¯å› ä¸ºåœ¨feigné‡Œé¢é…ç½®äº†è§£ç å™¨ï¼Œå®ƒå»æ‰äº†å¤–å±‚çš„åŒ…è£…ResponseObject</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-65.png" alt=""></p><p>è§£æå®Œæ˜¯è¿”å›UserExaminationCertVOï¼Œå¦‚æœç”¨Responseobject\<UserExaminationCertVO>ä¼šç›´æ¥è¿”å›NULL</p><p><img src="2025-01-09-å®ä¹ ç»éªŒ/image-66.png" alt=""></p><h3 id="ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆä¸€èˆ¬VOé‡Œé¢ä¼ é€’æ—¶é—´éƒ½è¦ç”¨Longå‹"><a href="#ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆä¸€èˆ¬VOé‡Œé¢ä¼ é€’æ—¶é—´éƒ½è¦ç”¨Longå‹" class="headerlink" title="ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆä¸€èˆ¬VOé‡Œé¢ä¼ é€’æ—¶é—´éƒ½è¦ç”¨Longå‹"></a>ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆä¸€èˆ¬VOé‡Œé¢ä¼ é€’æ—¶é—´éƒ½è¦ç”¨Longå‹</h3><p>å› ä¸ºåœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå¦‚æœæ—¶é—´å­—æ®µæ˜¯LocalDateTimeç±»å‹ï¼Œå¯èƒ½ä¼šåºåˆ—åŒ–é”™è¯¯ï¼Œå¯¼è‡´ä¸åŒfeignä¹‹é—´çš„è°ƒç”¨å‡ºç°å¼‚å¸¸ï¼Œæ‰€ä»¥VOä¸­çš„æ—¶é—´ä¸€èˆ¬ä¸ºLongå‹ã€‚</p><h2 id="28-ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°MQ"><a href="#28-ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°MQ" class="headerlink" title="28.ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°MQ"></a>28.ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°MQ</h2><p>å­¦é™¢è€ƒè¯•æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå½“ç”¨æˆ·æäº¤æ“ä½œé¢˜ä¹‹åï¼Œç”¨é€šè¿‡webSocketé€šçŸ¥å‰ç«¯ï¼Œè¿™æ˜¯ä¸ºäº†ç”¨æˆ·åœ¨å®¢æˆ·ç«¯æäº¤äº†ï¼Œåœ¨webç«¯ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p><p>å¦‚æœæ˜¯å•èŠ‚ç‚¹ï¼Œå®Œå…¨ä¸ç”¨MQã€‚ä½†æ˜¯æ¯”å¦‚æœ‰10ä¸ªèŠ‚ç‚¹ï¼Œwebç«¯åªä¸èŠ‚ç‚¹1è¿æ¥äº†webSocketï¼Œé‚£ä¹ˆå…¶å®ƒ9ä¸ªèŠ‚ç‚¹ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹åœ¨æäº¤æ“ä½œé¢˜æ—¶ï¼Œwebç«¯å°±ä¸èƒ½åŒæ­¥æ˜¾ç¤ºäº†ã€‚å› æ­¤è¦é‡‡ç”¨MQè¿›è¡Œå¹¿æ’­ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹é‡Œè¿›è¡Œæ“ä½œé¢˜æäº¤æ—¶ï¼Œå‘é€ä¸€æ¡æ¶ˆæ¯ã€‚é€šè¿‡å¹¿æ’­ï¼Œ10ä¸ªèŠ‚ç‚¹éƒ½èƒ½æ”¶åˆ°è¿™ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åè¿æ¥äº†webSocketçš„é‚£ä¸ªèŠ‚ç‚¹å°±èƒ½é€šè¿‡WebSocketé€šçŸ¥å‰ç«¯ã€‚</p><p>è¿™æ ·ï¼Œå³ä½¿æ˜¯å¤šèŠ‚ç‚¹ï¼Œwebç«¯ä¹Ÿä¸€ç›´èƒ½æ˜¾ç¤ºå®æ—¶çš„é¡µé¢ã€‚</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„å®ä¹ ç»éªŒæ€»ç»“</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="å®ä¹ ç»éªŒ" scheme="https://outoflovenicoo.github.io/tags/%E5%AE%9E%E4%B9%A0%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>åœºæ™¯é¢˜</title>
    <link href="https://outoflovenicoo.github.io/posts/2025-01-09-%E5%9C%BA%E6%99%AF%E9%A2%98.html"/>
    <id>https://outoflovenicoo.github.io/posts/2025-01-09-%E5%9C%BA%E6%99%AF%E9%A2%98.html</id>
    <published>2025-01-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åœºæ™¯é¢˜"><a href="#åœºæ™¯é¢˜" class="headerlink" title="åœºæ™¯é¢˜"></a>åœºæ™¯é¢˜</h1><h2 id="1-å¦‚ä½•åŸºäº-Redis-å®ç°å»¶æ—¶ä»»åŠ¡ï¼Ÿ"><a href="#1-å¦‚ä½•åŸºäº-Redis-å®ç°å»¶æ—¶ä»»åŠ¡ï¼Ÿ" class="headerlink" title="1.å¦‚ä½•åŸºäº Redis å®ç°å»¶æ—¶ä»»åŠ¡ï¼Ÿ"></a>1.å¦‚ä½•åŸºäº Redis å®ç°å»¶æ—¶ä»»åŠ¡ï¼Ÿ</h2><p>â‘  åˆ©ç”¨Redisçš„è¿‡æœŸç›‘å¬æœºåˆ¶</p><p>åœ¨ pub/sub æ¨¡å¼ä¸‹ï¼Œç”Ÿäº§è€…éœ€è¦æŒ‡å®šæ¶ˆæ¯å‘é€åˆ°å“ªä¸ª channel ä¸­ï¼Œè€Œæ¶ˆè´¹è€…åˆ™è®¢é˜…å¯¹åº”çš„ channel ä»¥è·å–æ¶ˆæ¯ã€‚<br> Redis ä¸­æœ‰å¾ˆå¤šé»˜è®¤çš„ channelï¼Œè¿™äº› channel æ˜¯ç”± Redis æœ¬èº«å‘å®ƒä»¬å‘é€æ¶ˆæ¯çš„ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç ã€‚å…¶ä¸­ï¼Œ<strong>keyevent@0</strong>:expired å°±æ˜¯ä¸€ä¸ªé»˜è®¤çš„ channelï¼Œè´Ÿè´£ç›‘å¬ key çš„è¿‡æœŸäº‹ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ª key è¿‡æœŸä¹‹åï¼ŒRedis ä¼šå‘å¸ƒä¸€ä¸ª key è¿‡æœŸçš„äº‹ä»¶åˆ°<strong>keyevent@<db></strong>:expiredè¿™ä¸ª channel ä¸­ã€‚</p><p>ï¿®    å¤±æ•ˆæ€§å·®</p><p>ï¿®    ä¸¢æ¶ˆæ¯</p><p>ï¿®    é‡å¤æ¶ˆè´¹æ¶ˆæ¯</p><p>â‘¡Redissionå»¶æ—¶é˜Ÿåˆ—</p><p>Redisson çš„å»¶è¿Ÿé˜Ÿåˆ— RDelayedQueue æ˜¯åŸºäº Redis çš„ SortedSet æ¥å®ç°çš„ã€‚SortedSet æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥è®¾ç½®ä¸€ä¸ªåˆ†æ•°ï¼Œä»£è¡¨è¯¥å…ƒç´ çš„æƒé‡ã€‚Redisson åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œå°†éœ€è¦å»¶è¿Ÿæ‰§è¡Œçš„ä»»åŠ¡æ’å…¥åˆ° SortedSet ä¸­ï¼Œå¹¶ç»™å®ƒä»¬è®¾ç½®ç›¸åº”çš„è¿‡æœŸæ—¶é—´ä½œä¸ºåˆ†æ•°ã€‚<br> Redisson åœ¨å®¢æˆ·ç«¯ï¼ˆå³åº”ç”¨ç¨‹åºè¿›ç¨‹ï¼‰ä¸­å¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œåˆ°æ—¶é—´åä½¿ç”¨ zrangebyscore å‘½ä»¤æ‰«æ SortedSet ä¸­è¿‡æœŸçš„å…ƒç´ ï¼ˆå³åˆ†æ•°å°äºæˆ–ç­‰äºå½“å‰æ—¶é—´çš„å…ƒç´ ï¼‰ï¼Œç„¶åå°†è¿™äº›è¿‡æœŸå…ƒç´ ä» SortedSet ä¸­ç§»é™¤ï¼Œå¹¶å°†å®ƒä»¬åŠ å…¥åˆ°å°±ç»ªæ¶ˆæ¯åˆ—è¡¨ï¼ˆ List ç»“æ„ï¼‰ä¸­ã€‚<br> å½“ä»»åŠ¡è¢«ç§»åˆ°å®é™…çš„å°±ç»ªæ¶ˆæ¯åˆ—è¡¨ä¸­æ—¶ï¼ŒRedisson é€šå¸¸è¿˜ä¼šé€šè¿‡å‘å¸ƒ/è®¢é˜…æœºåˆ¶ï¼ˆRedis çš„ Pub/Sub æ¨¡å‹ï¼‰æ¥é€šçŸ¥æ¶ˆè´¹è€…æœ‰æ–°ä»»åŠ¡åˆ°è¾¾ã€‚<br> å°±ç»ªæ¶ˆæ¯åˆ—è¡¨æ˜¯ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œæ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨é˜»å¡æ“ä½œï¼ˆå¦‚ BLPOP key 0ï¼Œ0 è¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œç›´åˆ°æœ‰æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—ï¼‰ç›‘å¬ã€‚ç”±äº Redis çš„ Pub/Sub æœºåˆ¶æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œå®ƒé¿å…äº†è½®è¯¢å¼€é”€ï¼Œåªæœ‰åœ¨æœ‰æ–°æ¶ˆæ¯æ—¶æ‰ä¼šè§¦å‘å¤„ç†é€»è¾‘ã€‚</p><p>RedissonDelayQueue ä¸­çš„ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼š<br> â— startConsumerï¼ˆï¼‰ï¼šå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œä»é˜»å¡é˜Ÿåˆ— blockingQueue ä¸­è·å–ä»»åŠ¡å¹¶å¤„ç†ã€‚<br> â— addTask(String task, long delay)ï¼šå°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°å»¶è¿Ÿé˜Ÿåˆ—ä¸­ï¼Œå¹¶æŒ‡å®šå»¶è¿Ÿæ—¶é—´ã€‚</p><p><img src="2025-01-09-åœºæ™¯é¢˜/clip_image002.jpg" alt="img"></p><h2 id="2-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ"><a href="#2-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ" class="headerlink" title="2.è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ"></a>2.è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ</h2><p>  <a href="https://ls8sck0zrg.feishu.cn/wiki/KfZ1wUS3niXbM4ky37qcMSG2nPd">åç«¯è®­ç»ƒè¥</a>  <a href="https://ls8sck0zrg.feishu.cn/wiki/L1WKwK29ti7Z7dkIS2EcgSdnnoh">åç«¯è®­ç»ƒè¥ ç§’æ€ä¸“æ </a>  </p><p><img src="2025-01-09-åœºæ™¯é¢˜/clip_image003.jpg" alt="img"></p><!--è¯´ç‚¹æ·±åˆ»ä¸€ç‚¹çš„ç»“è®º--><p>ä¸åŒé‡çº§å’Œè¦æ±‚ä¸‹çš„æ¶æ„ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘è¿™é‡Œä¸»è¦è¿˜æ˜¯æŒ‰æ¯”è¾ƒå¸¸è§çš„åœºæ™¯ï¼ˆå‡ åä¸‡qpsï¼‰æ¥åšçš„åˆ†æã€‚</p><p>åœ¨å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰éœ€è®¾è®¡ï¼ŒåŸåˆ™ä¸Šä¸èƒ½ä½ä¼°ç§’æ€è¯·æ±‚é‡ï¼Œä½†ä¹Ÿä¸è¦ç”¨å¤§ç‚®æ‰“èšŠå­</p><!--è¦ç‚¹ä½œä¸ºçº¿ç´¢ç‰µå¼•--><p>åœ¨ç§’æ€ç³»ç»Ÿä¸­ï¼Œæˆ‘è®¤ä¸ºæœ€å¤§çš„æŒ‘æˆ˜æ˜¯é«˜å¹¶å‘å’Œé«˜ç²¾å‡†ã€‚</p><p>è§£å†³é«˜å¹¶å‘æ€è·¯ï¼š</p><p>1.é™æµï¼š</p><p>ï¿®    æ¥å£é™æµï¼šé™æµç»„ä»¶Hystrixã€Sentinelæˆ–è€…redis+Luaè„šæœ¬</p><p>ï¿®    æå‰é¢„çº¦æœºåˆ¶</p><p>ï¿®    é—®é¢˜éªŒè¯ç æœºåˆ¶</p><p>2.é™çº§ï¼šæ ¸å¿ƒæ€æƒ³å°±æ˜¯ä¸¢è½¦ä¿å¸…ï¼Œä¼˜å…ˆä¿è¯æ ¸å¿ƒä¸šåŠ¡ï¼Œé™çº§çš„ç›®çš„åœ¨äºåº”å¯¹ç³»ç»Ÿè‡ªèº«çš„æ•…éšœ</p><p>3.ç†”æ–­ï¼šå¯ä»¥é˜²æ­¢å› ä¸ºç§’æ€äº¤æ˜“å½±å“åˆ°å…¶ä»–æ­£å¸¸æœåŠ¡çš„æä¾›</p><p>4.æµé‡å‰Šå³°ï¼šé‡‡ç”¨MQ</p><p>è§£å†³é«˜ç²¾å‡†çš„æ€è·¯ï¼š</p><p>1.é‡‡ç”¨Redis+Luaè„šæœ¬åˆ¤æ–­å½“å‰åº“å­˜æ˜¯å¦å¤Ÿï¼Œå¦‚æœå¤Ÿå°±æ‰£å‡ï¼Œå…ˆå¯¹ Redis çš„åº“å­˜è¿›è¡Œæ›´æ–°ï¼Œç„¶åå†å¼‚æ­¥åŒæ­¥åˆ° MySQL çš„åº“å­˜ã€‚è¿™é‡Œçš„å¼‚æ­¥å®ç°æ–¹å¼å»ºè®®ä½¿ç”¨ MQï¼Œç”± MQ ä¿è¯æ¶ˆæ¯è¢«æ¶ˆè´¹ï¼Œå®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ¯•ç«Ÿç§’æ€åœºæ™¯æœ¬èº«å°±è¦å¼•å…¥ MQ è¿›è¡Œæµé‡å‰Šå³°ã€‚</p><p>ä»»åŠ¡å¯¹æ¯”åº“å­˜å’Œåé¢ï¼Œè§£å†³å°‘å–ï¼›é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿè¦è€ƒè™‘åˆ°äº†é»„ç‰›æ‰“å‡»ã€é™é¢‘å…œåº•ï¼Œç”¨æˆ·ä½“éªŒç­‰é—®é¢˜</p><!--æ”¶å°¾--><p>ä»¥ä¸Šå°±æ˜¯æˆ‘å¯¹ç§’æ€ç³»ç»Ÿçš„è®¾è®¡ï¼Œæœ‰ä¸æˆç†Ÿçš„åœ°æ–¹è¿˜è¯·æŒ‡æ•™ </p><h2 id="3-çŸ­é“¾ç³»ç»Ÿ"><a href="#3-çŸ­é“¾ç³»ç»Ÿ" class="headerlink" title="3.çŸ­é“¾ç³»ç»Ÿ"></a>3.çŸ­é“¾ç³»ç»Ÿ</h2><p><img src="2025-01-09-åœºæ™¯é¢˜/clip_image004.jpg" alt="img"></p><h2 id="4-æ’è¡Œæ¦œ"><a href="#4-æ’è¡Œæ¦œ" class="headerlink" title="4.æ’è¡Œæ¦œ"></a>4.æ’è¡Œæ¦œ</h2><p><img src="2025-01-09-åœºæ™¯é¢˜/clip_image005.jpg" alt="img"></p><h2 id="5-ç¼“å­˜ä¸€è‡´ä¿è¯"><a href="#5-ç¼“å­˜ä¸€è‡´ä¿è¯" class="headerlink" title="5.ç¼“å­˜ä¸€è‡´ä¿è¯"></a>5.ç¼“å­˜ä¸€è‡´ä¿è¯</h2><p>  <a href="https://mp.weixin.qq.com/s/_VyHzICG_qZENjjnHGC0UA">https://mp.weixin.qq.com/s/_VyHzICG_qZENjjnHGC0UA</a>  </p><p><img src="2025-01-09-åœºæ™¯é¢˜/clip_image006.jpg" alt="img"></p><h2 id="6-å¦‚æœè¦ä½ è®¾è®¡ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½ è§‰å¾—è¿™ä¸ªçº¿ç¨‹æ± è¦æä¾›å“ªäº›åŠŸèƒ½ï¼Œä»¥åŠå®ƒå†…éƒ¨åº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªå®ç°çš„é€»è¾‘ï¼Œä½ èƒ½æè¿°ä¸€ä¸‹å—ï¼Ÿ"><a href="#6-å¦‚æœè¦ä½ è®¾è®¡ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½ è§‰å¾—è¿™ä¸ªçº¿ç¨‹æ± è¦æä¾›å“ªäº›åŠŸèƒ½ï¼Œä»¥åŠå®ƒå†…éƒ¨åº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªå®ç°çš„é€»è¾‘ï¼Œä½ èƒ½æè¿°ä¸€ä¸‹å—ï¼Ÿ" class="headerlink" title="6.å¦‚æœè¦ä½ è®¾è®¡ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½ è§‰å¾—è¿™ä¸ªçº¿ç¨‹æ± è¦æä¾›å“ªäº›åŠŸèƒ½ï¼Œä»¥åŠå®ƒå†…éƒ¨åº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªå®ç°çš„é€»è¾‘ï¼Œä½ èƒ½æè¿°ä¸€ä¸‹å—ï¼Ÿ"></a>6.å¦‚æœè¦ä½ è®¾è®¡ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½ è§‰å¾—è¿™ä¸ªçº¿ç¨‹æ± è¦æä¾›å“ªäº›åŠŸèƒ½ï¼Œä»¥åŠå®ƒå†…éƒ¨åº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªå®ç°çš„é€»è¾‘ï¼Œä½ èƒ½æè¿°ä¸€ä¸‹å—ï¼Ÿ</h2><p>  å¦‚æœè¦æˆ‘æ¥å®ç°ä¸€ä¸ªçº¿ç¨‹æ± çš„è¯ï¼Œæˆ‘é¦–å…ˆä¼šè€ƒè™‘å®ƒå®é™…çš„åº”ç”¨åœºæ™¯å¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œç„¶åæä¾›ä»€ä¹ˆåŠŸèƒ½ã€‚ä¸€èˆ¬çº¿ç¨‹æ± çš„åœºæ™¯çš„è¯å°±æ˜¯ï¼ŒåŠ å¿«æ•°æ®çš„è¯»å–é€Ÿåº¦ä¹‹ç±»çš„ï¼Œæ€ä¹ˆåˆ›å»ºçº¿ç¨‹è¿™äº›å°±æ˜¯æœ€åŸºç¡€çš„åŠŸèƒ½çš„è€ƒè™‘ã€‚ç„¶åä¹Ÿä¼šå¯¹ä¸€äº›å¼‚å¸¸åœºæ™¯æˆ–è€…æ˜¯åšä¸€äº›å®Œæ•´æ€§çš„è€ƒè™‘ï¼Œæ¯”å¦‚è¯´çº¿ç¨‹è¿™ä¸ªåˆ›å»ºä¹‹åè¯¥æ€ä¹ˆè¿›è¡Œå›æ”¶å¤„ç†ï¼Œå› ä¸ºä¸èƒ½è®©è¿™ä¸ªçº¿ç¨‹æ— é™åˆ¶çš„å¢åŠ ä¸‹å»å ç”¨èµ„æºã€‚  åŒæ—¶çš„è¯å¦‚æœçº¿ç¨‹å’Œçº¿ç¨‹ä¹‹é—´ä¼šå­˜åœ¨ä¼˜å…ˆçº§ä¹‹ç±»çš„é—®é¢˜ï¼Œé‚£ä¹ˆå°±è¦åœ¨è®¾è®¡çš„æ—¶å€™è€ƒè™‘åˆ°æŠ¢å ç›¸å…³çš„æœºåˆ¶è®¾è®¡ï¼Œé‚£æŠ¢å è¿™æ ·çš„è¯å°±ä¼šæœ‰å¾ˆå¤šä¸åŒçš„ç­–ç•¥ï¼Œå¯èƒ½æ˜¯æ ¹æ®æ‰§è¡Œçš„æ—¶é—´æˆ–è€…æ˜¯ç»™å›ºå®šçš„æ—¶é—´ï¼Œç„¶åè¿›è¡Œåˆ†åˆ«çš„è°ƒåº¦ã€‚å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡è®¾è®¡ä¸åŒçš„è°ƒåº¦çš„ç­–ç•¥ã€‚è®¾è®¡å®Œæˆä¹‹åçš„è¯ï¼Œä¸€èˆ¬è¿˜è¦å†è¿›è¡ŒåŠŸèƒ½æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ï¼Œè¿›è¡Œä¼˜åŒ–çš„è¿­ä»£ã€‚  å¦‚ä½•è®¾ç½®ä¸€ä¸ªæœ€ä¼˜çš„çº¿ç¨‹æ•°ï¼Ÿ  å¦‚æœæˆ‘ä»¬çš„ä»»åŠ¡ä¸»è¦æ˜¯è¿›è¡Œè®¡ç®—ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€CPUçš„å¤„ç†èƒ½åŠ›æ˜¯ç¨€ç¼ºçš„èµ„æºï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡å¤§é‡å¢åŠ çº¿ç¨‹æ•°æé«˜è®¡ç®—èƒ½åŠ›å—ï¼Ÿå¾€å¾€æ˜¯ä¸èƒ½çš„ï¼Œå¦‚æœçº¿ç¨‹å¤ªå¤šï¼Œåå€’å¯èƒ½å¯¼è‡´å¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚æ‰€ä»¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸å»ºè®®æŒ‰ç…§CPUæ ¸çš„æ•°ç›®Næˆ–è€…N+1ã€‚  å¦‚æœæ˜¯éœ€è¦è¾ƒå¤šç­‰å¾…çš„ä»»åŠ¡ï¼Œä¾‹å¦‚I/Oæ“ä½œæ¯”è¾ƒå¤šï¼Œå¯ä»¥å‚è€ƒBrain Goetzæ¨èçš„è®¡ç®—æ–¹æ³•ï¼šçº¿ç¨‹æ•° = CPUæ ¸æ•° Ã— ç›®æ ‡CPUåˆ©ç”¨ç‡ Ã—ï¼ˆ1 + å¹³å‡ç­‰å¾…æ—¶é—´/å¹³å‡å·¥ä½œæ—¶é—´ï¼‰     </p><p>ä»¥ä¸‹æ˜¯å…³äºLRU cacheçš„è®¾è®¡ç›¸å…³å†…å®¹ï¼š</p><h2 id="7-è®¾è®¡ä¸€ä¸ª-LRU-çš„è¿™æ ·çš„-cacheï¼Œå†…éƒ¨çš„å…³é”®çš„æ•°æ®ç»“æ„ï¼Œæ•°æ®çš„è¯»å†™çš„æµç¨‹"><a href="#7-è®¾è®¡ä¸€ä¸ª-LRU-çš„è¿™æ ·çš„-cacheï¼Œå†…éƒ¨çš„å…³é”®çš„æ•°æ®ç»“æ„ï¼Œæ•°æ®çš„è¯»å†™çš„æµç¨‹" class="headerlink" title="7.è®¾è®¡ä¸€ä¸ª LRU çš„è¿™æ ·çš„ cacheï¼Œå†…éƒ¨çš„å…³é”®çš„æ•°æ®ç»“æ„ï¼Œæ•°æ®çš„è¯»å†™çš„æµç¨‹"></a>7.è®¾è®¡ä¸€ä¸ª LRU çš„è¿™æ ·çš„ cacheï¼Œå†…éƒ¨çš„å…³é”®çš„æ•°æ®ç»“æ„ï¼Œæ•°æ®çš„è¯»å†™çš„æµç¨‹</h2><p>å…³é”®æ•°æ®ç»“æ„</p><p>é€šå¸¸ä½¿ç”¨å“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨æ¥å®ç°LRU cacheã€‚</p><p>â€¢     åŒå‘é“¾è¡¨ï¼šç”¨äºç»´æŠ¤æ•°æ®çš„ä½¿ç”¨é¡ºåºã€‚é“¾è¡¨å¤´éƒ¨æ˜¯æœ€è¿‘ä½¿ç”¨çš„æ•°æ®ï¼Œå°¾éƒ¨æ˜¯æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ã€‚è¿™æ ·å¯ä»¥åœ¨O(1)æ—¶é—´å¤æ‚åº¦å†…å®ç°æ•°æ®èŠ‚ç‚¹çš„æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p><p>â€¢     å“ˆå¸Œè¡¨ï¼šç”¨äºå¿«é€Ÿè®¿é—®ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œé€šè¿‡é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ï¼Œèƒ½åœ¨O(1)æ—¶é—´å¤æ‚åº¦å†…åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œå¹¶è·å–å¯¹åº”çš„æ•°æ®èŠ‚ç‚¹ã€‚å“ˆå¸Œè¡¨çš„é”®ä¸ºç¼“å­˜æ•°æ®çš„é”®ï¼Œå€¼ä¸ºåŒå‘é“¾è¡¨ä¸­å¯¹åº”èŠ‚ç‚¹çš„å¼•ç”¨ã€‚</p><p>æ•°æ®è¯»å†™æµç¨‹</p><p>â€¢     è¯»æ“ä½œï¼š</p><p>ï¿®    é¦–å…ˆé€šè¿‡å“ˆå¸Œè¡¨æŸ¥æ‰¾ç»™å®šé”®å¯¹åº”çš„èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨äºç¼“å­˜ä¸­ã€‚</p><p>ï¿®    å¦‚æœå­˜åœ¨ï¼Œå°†è¯¥èŠ‚ç‚¹ä»å½“å‰ä½ç½®ç§»åŠ¨åˆ°åŒå‘é“¾è¡¨çš„å¤´éƒ¨ï¼Œè¡¨ç¤ºè¯¥æ•°æ®æœ€è¿‘è¢«ä½¿ç”¨è¿‡ï¼Œå¹¶è¿”å›å¯¹åº”çš„å€¼ã€‚</p><p>ï¿®    å¦‚æœä¸å­˜åœ¨ï¼Œè¯´æ˜ç¼“å­˜æœªå‘½ä¸­ï¼Œè¿”å›ç›¸åº”çš„æœªå‘½ä¸­æ ‡è¯†ã€‚</p><p>â€¢     å†™æ“ä½œï¼š</p><p>ï¿®    å…ˆåœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾è¦å†™å…¥çš„é”®æ˜¯å¦å·²å­˜åœ¨ã€‚</p><p>ï¿®    å¦‚æœå­˜åœ¨ï¼Œæ›´æ–°å¯¹åº”èŠ‚ç‚¹çš„å€¼ï¼Œå¹¶å°†è¯¥èŠ‚ç‚¹ç§»åŠ¨åˆ°åŒå‘é“¾è¡¨çš„å¤´éƒ¨ã€‚</p><p>ï¿®    å¦‚æœä¸å­˜åœ¨ï¼Œåˆ¤æ–­ç¼“å­˜æ˜¯å¦å·²æ»¡ã€‚è‹¥ç¼“å­˜æœªæ»¡ï¼Œåœ¨åŒå‘é“¾è¡¨å¤´éƒ¨æ’å…¥æ–°èŠ‚ç‚¹ï¼Œå¹¶åœ¨å“ˆå¸Œè¡¨ä¸­æ·»åŠ å¯¹åº”çš„é”®å€¼å¯¹ï¼›è‹¥ç¼“å­˜å·²æ»¡ï¼Œå…ˆç§»é™¤åŒå‘é“¾è¡¨å°¾éƒ¨çš„èŠ‚ç‚¹ï¼ˆå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®ï¼‰ï¼Œå¹¶ä»å“ˆå¸Œè¡¨ä¸­åˆ é™¤å¯¹åº”çš„é”®å€¼å¯¹ï¼Œç„¶åå†åœ¨åŒå‘é“¾è¡¨å¤´éƒ¨æ’å…¥æ–°èŠ‚ç‚¹ï¼Œå¹¶åœ¨å“ˆå¸Œè¡¨ä¸­æ·»åŠ æ–°çš„é”®å€¼å¯¹ã€‚</p><p>å¹¶å‘æ§åˆ¶è®¾è®¡</p><p>â€¢     è¯»å†™é”ï¼šå¯ä»¥ä½¿ç”¨è¯»å†™é”æ¥æ§åˆ¶å¹¶å‘è®¿é—®ã€‚è¯»æ“ä½œæ—¶è·å–è¯»é”ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œï¼›å†™æ“ä½œæ—¶è·å–å†™é”ï¼Œå†™é”ä¸è¯»é”ã€å†™é”ä¸å†™é”ä¹‹é—´äº’æ–¥ï¼Œç¡®ä¿åœ¨å†™æ“ä½œæ—¶æ²¡æœ‰å…¶ä»–è¯»æˆ–å†™æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p>â€¢     åˆ†æ®µé”ï¼šå°†æ•´ä¸ªç¼“å­˜æŒ‰ key çš„ hash å€¼åˆ’åˆ†ä¸ºå¤šä¸ª Segmentï¼Œæ¯ä¸ª Segment å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå°å‹ LRU ç¼“å­˜ï¼ˆHashMap + åŒå‘é“¾è¡¨ï¼‰ï¼Œå¹¶æŒæœ‰è‡ªå·±çš„é”ã€‚æ“ä½œå„è‡ªåŒºåŸŸçš„æ•°æ®æ—¶åªé”å®šå½“å‰ Segmentï¼Œä¸åŒ Segment çš„æ“ä½œå¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œé™ä½äº†é”çš„ç«äº‰èŒƒå›´ï¼Œæé«˜å¹¶å‘æ€§èƒ½ã€‚</p><p>â€¢     ç»†ç²’åº¦æ§åˆ¶ï¼šå¢åŠ çŠ¶æ€é‡å’Œå˜åŠ¨ä¿¡æ¯æ¥è¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ¤æ–­ã€‚ä¾‹å¦‚ï¼Œè®°å½•æ¯ä¸ªæ“ä½œæ¶‰åŠçš„æ•°æ®èŒƒå›´ï¼Œæ¯æ¬¡æ“ä½œè¿›æ¥æ—¶ï¼Œæ ¹æ®å½“å‰çŠ¶æ€å’Œè¦æ“ä½œçš„æ•°æ®èŒƒå›´åˆ¤æ–­æ˜¯å¦å­˜åœ¨å†²çªï¼Œä»¥æ­¤æ¥å†³å®šæ˜¯å¦å…è®¸å¹¶å‘æ‰§è¡Œã€‚</p><h2 id="8-å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ‰«ç ç™»å½•ç³»ç»Ÿï¼Ÿ"><a href="#8-å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ‰«ç ç™»å½•ç³»ç»Ÿï¼Ÿ" class="headerlink" title="8.å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ‰«ç ç™»å½•ç³»ç»Ÿï¼Ÿ"></a>8.å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ‰«ç ç™»å½•ç³»ç»Ÿï¼Ÿ</h2><h2 id="9-æ—¶é’Ÿå›æ‹¨æ€ä¹ˆè§£å†³ï¼Ÿ"><a href="#9-æ—¶é’Ÿå›æ‹¨æ€ä¹ˆè§£å†³ï¼Ÿ" class="headerlink" title="9.æ—¶é’Ÿå›æ‹¨æ€ä¹ˆè§£å†³ï¼Ÿ"></a>9.æ—¶é’Ÿå›æ‹¨æ€ä¹ˆè§£å†³ï¼Ÿ</h2><p>ç¾å›¢leafçš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”è¯´äº†å¯ä»¥å°†æœºå™¨å·æ‹†å‡ºå‡ ä½ä½œä¸ºæ—¶é’Ÿåºå·ï¼Œæ¯æ¬¡å›æ‹¨å°±è‡ªå¢ã€‚ä¸ªäººæ›´å–œæ¬¢åè€…ï¼Œæ›´è½»é‡çº§</p>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„åœºæ™¯é¢˜é¢è¯•æ€»ç»“</summary>
    
    
    
    <category term="é¢è¯•é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
    
    <category term="åœºæ™¯é¢˜" scheme="https://outoflovenicoo.github.io/tags/%E5%9C%BA%E6%99%AF%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢</title>
    <link href="https://outoflovenicoo.github.io/posts/2024-12-28-%E5%B7%A7%E5%A6%99%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96%E6%A0%91%E5%9E%8B%E6%9F%A5%E8%AF%A2.html"/>
    <id>https://outoflovenicoo.github.io/posts/2024-12-28-%E5%B7%A7%E5%A6%99%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96%E6%A0%91%E5%9E%8B%E6%9F%A5%E8%AF%A2.html</id>
    <published>2024-12-28T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–éƒ¨é—¨æŸ¥è¯¢"><a href="#å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–éƒ¨é—¨æŸ¥è¯¢" class="headerlink" title="å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–éƒ¨é—¨æŸ¥è¯¢"></a><strong>å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–éƒ¨é—¨æŸ¥è¯¢</strong></h1><h1 id="ä¸€ã€å‡ºç°çš„é—®é¢˜"><a href="#ä¸€ã€å‡ºç°çš„é—®é¢˜" class="headerlink" title="ä¸€ã€å‡ºç°çš„é—®é¢˜"></a><strong>ä¸€ã€å‡ºç°çš„é—®é¢˜</strong></h1><h2 id="éƒ¨é—¨æ ‘æ¥å£è¶…æ—¶"><a href="#éƒ¨é—¨æ ‘æ¥å£è¶…æ—¶" class="headerlink" title="éƒ¨é—¨æ ‘æ¥å£è¶…æ—¶"></a><strong>éƒ¨é—¨æ ‘æ¥å£è¶…æ—¶</strong></h2><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image1.png" alt=""></p><p>æ— è®ºæ˜¯åœ¨æ§åˆ¶å™¨è¿˜æ˜¯åœ¨è¿è¥å¹³å°ä¸­ï¼Œéƒ½å­˜åœ¨ç±»ä¼¼çš„é¡µé¢ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªéƒ¨é—¨åˆ—è¡¨æˆ–è€…å«ç»„ç»‡åˆ—è¡¨ã€‚</p><p>ä»é¡µé¢çš„å±•ç¤ºå½¢å¼ä¸Šæ¥çœ‹å®ƒæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚å› æ­¤åœ¨æœ€æ—©çš„æ¥å£è®¾è®¡ä¸Šä¹Ÿæ˜¯é€šè¿‡ä¸€ä¸ªæ¥å£è¿”å›è¯¥ç§Ÿæˆ·çš„éƒ¨é—¨é¡µé¢è¿›è¡Œæ˜¾ç¤ºã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image2.png" alt=""></p><p>æ¥å£çš„è¿”å›å½¢å¼å¦‚ä¸Šã€‚å…¶å®ä¹Ÿå¾ˆç®€å•ã€‚å°±æ˜¯ä¸€ä¸ªé€šè¿‡ä¸€ä¸ªåµŒå¥—çš„å¯¹è±¡å®ç°äº†æ ‘ã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image3.png" alt=""></p><p>ä½†æ˜¯åœ¨æˆ‘ä»¬ç§æœ‰åŒ–çš„è¿‡ç¨‹ä¸­æœ‰ä¸€äº›å¤§å‹çš„é›†å›¢å®¢æˆ·ï¼Œæ¯”å¦‚äº¤æŠ•ã€å†œå‘è¡Œç­‰ï¼Œä»–ä»¬æ•´ä¸ªé›†å›¢çš„éƒ¨é—¨æ•°é‡ä¸Šä¸‡ä¸ªç”šè‡³å¯èƒ½å‡ºç° 10w å¤šä¸ªéƒ¨é—¨ã€‚å› æ­¤å‡ºç°äº†æ¥å£è¶…æ—¶20s éƒ½æ²¡æœ‰ç»“æœçš„æƒ…å†µå‡ºç°äº†ã€‚</p><h2 id="æ•°æ®æƒé™æŸ¥è¯¢å­éƒ¨é—¨è¶…æ—¶"><a href="#æ•°æ®æƒé™æŸ¥è¯¢å­éƒ¨é—¨è¶…æ—¶" class="headerlink" title="æ•°æ®æƒé™æŸ¥è¯¢å­éƒ¨é—¨è¶…æ—¶"></a><strong>æ•°æ®æƒé™æŸ¥è¯¢å­éƒ¨é—¨è¶…æ—¶</strong></h2><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image4.png" alt=""></p><p>å…¶å®ï¼Œä¸å…‰æœ‰è¿™ä¸ªåœºæ™¯ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®æƒé™è®¾è®¡ä¸Šæœ‰ä¸€ä¸ªï¼Œè¿™ä¸ªæ„æ€å‘¢å°±æ˜¯ã€‚å¦‚æœç”¨æˆ·çš„æ•°æ®æƒé™ä¸ºæœ¬çº§åŠå­çº§çš„ï¼Œé‚£è¿™ä¸ªç”¨æˆ·å°±èƒ½æŸ¥çœ‹ç”¨æˆ·æ‰€å±éƒ¨é—¨å’Œè¯¥éƒ¨é—¨å­éƒ¨é—¨ä¸‹äº§ç”Ÿçš„æ•°æ®ã€‚æŒ‰ç…§ç›®å‰çš„å®ç°æ–¹å¼ï¼Œé‚£æˆ‘ä»¬å°±è¦çŸ¥é“è¿™ä¸ªç”¨æˆ·çš„éƒ¨é—¨å’Œå­éƒ¨é—¨ã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image5.png" alt=""></p><p>é‚£è¿™ä¸ªæŸ¥è¯¢å­éƒ¨é—¨çš„è¿‡ç¨‹ä¹Ÿä¼šåŒæ ·å‡ºç°è¶…æ—¶çš„æƒ…å†µã€‚</p><h1 id="äºŒã€é—®é¢˜åˆ†æ"><a href="#äºŒã€é—®é¢˜åˆ†æ" class="headerlink" title="äºŒã€é—®é¢˜åˆ†æ"></a><strong>äºŒã€é—®é¢˜åˆ†æ</strong></h1><h2 id="æºä»£ç åˆ†æ"><a href="#æºä»£ç åˆ†æ" class="headerlink" title="æºä»£ç åˆ†æ"></a><strong>æºä»£ç åˆ†æ</strong></h2><p>èµ°è¯»åŸå…ˆçš„éƒ¨é—¨æ ‘æ¥å£é€»è¾‘å‘ç°ï¼Œ</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image6.png" alt=""></p><p>æ˜¯é€šè¿‡é€’å½’æŸ¥è¯¢çš„æ–¹å¼å®ç°ã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image7.png" alt=""></p><p>åœ¨æ•°æ®è¡¨çš„è®¾è®¡ä¸Šï¼Œæ˜¯é€šè¿‡ä¸€ä¸ª parent_id å­—æ®µå…³è”çš„æ˜¯çˆ¶éƒ¨é—¨çš„ idã€‚å› æ­¤å¯ä»¥é€šè¿‡è¯¥å­—æ®µæŸ¥è¯¢åˆ°è¿™ä¸ªéƒ¨é—¨çš„å­éƒ¨é—¨çš„åˆ—è¡¨ã€‚ç„¶åé€šè¿‡é€’å½’ä¸æ–­åœ°éå†å°±èƒ½æŸ¥è¯¢å‡ºæ‰€æœ‰çš„éƒ¨é—¨å¹¶ä¸”ç»„è£…æˆæ ‘ã€‚</p><p>ä¼ªä»£ç é€»è¾‘å…¶å®å°±æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€’å½’æŸ¥è¯¢å‡½æ•°ï¼Œå‚æ•°ä¸ºè¦æŸ¥æ‰¾çš„çˆ¶éƒ¨é—¨id</span></span><br><span class="line">List&lt;Department&gt; <span class="title function_">findDepartmentsByParentId</span><span class="params">(<span class="type">int</span> parentId)</span> &#123;</span><br><span class="line">    List&lt;Department&gt; departmentList = queryFromMysql(parentId);</span><br><span class="line">  <span class="comment">// ç”¨äºå­˜æ”¾æŸ¥è¯¢ç»“æœçš„åˆ—è¡¨</span></span><br><span class="line">    List&lt;Department&gt; result = <span class="keyword">new</span> <span class="title class_">List</span>&lt;Department&gt;();  </span><br><span class="line">    <span class="keyword">for</span> (Department department : departmentList) &#123;</span><br><span class="line">        <span class="keyword">if</span> (department.parentId == parentId) &#123;</span><br><span class="line">            result.add(department);</span><br><span class="line">            <span class="comment">// é€’å½’è°ƒç”¨ï¼ŒæŸ¥æ‰¾å½“å‰éƒ¨é—¨ä¸‹çš„å­éƒ¨é—¨ï¼Œå¹¶å°†ç»“æœåˆå¹¶</span></span><br><span class="line">            List&lt;Department&gt; subDepartments = findDepartmentsByParentId(department.id);</span><br><span class="line">            result.addAll(subDepartments);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="x20-å¯èƒ½å‡ºç°é—®é¢˜çš„åŸå› "><a href="#x20-å¯èƒ½å‡ºç°é—®é¢˜çš„åŸå› " class="headerlink" title="&#x20;å¯èƒ½å‡ºç°é—®é¢˜çš„åŸå› "></a><strong>&#x20;å¯èƒ½å‡ºç°é—®é¢˜çš„åŸå› </strong></h2><ol><li><p>å­éƒ¨é—¨æ•°é‡å¤ªå¤šã€‚å¯¼è‡´queryFromMysql è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„æ¬¡æ•°å¤š</p></li><li><p>éƒ¨é—¨å±‚çº§æ·±ã€‚å¯¼è‡´queryFromMysql è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„æ¬¡æ•°å¤š</p></li></ol><p>æ ¸å¿ƒåŸå› å…¶å®è¿˜æ˜¯æ¯ä¸€æ¬¡æŸ¥è¯¢å­éƒ¨é—¨éƒ½éœ€è¦é€šè¿‡queryFromMysqlè¿™ä¸ªæ–¹æ³•æ‰§è¡Œä¸€æ¬¡ï¼Œç±»ä¼¼å¦‚ä¸‹çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from department where tenant_id=xxx and parent_id=xxx;</span><br></pre></td></tr></table></figure><p>ä¸éš¾å‘ç°ï¼Œé—®é¢˜çš„æ ¹æœ¬åŸå› å°±æ˜¯ sql æŸ¥è¯¢æ‰§è¡Œæ¬¡æ•°å¤ªå¤šäº†ã€‚é‚£ä¹ˆç°åœ¨é—®é¢˜çš„æ ¸å¿ƒå°±æ˜¯å‡å°‘ sql æŸ¥è¯¢çš„æ¬¡æ•°ã€‚å°±èƒ½è§£å†³é—®é¢˜ã€‚</p><p>å½“ç„¶è¿™é‡Œæ²¡æœ‰è€ƒè™‘æ”¹äº¤äº’çš„æ–¹å¼ï¼Œæ¯”å¦‚ä¸€æ¬¡åªæŸ¥è¯¢ä¸€çº§ï¼Œæ…¢æ…¢å±•å¼€å‘¢ï¼Œå…¶å®ä¸€æ ·ï¼Œæ•°æ®æƒé™çš„å­éƒ¨é—¨é‚£é‡Œä¿æŒåŸæ ·è¿˜æ˜¯ä¼šè¶…æ—¶ã€‚</p><p>å¦å¤–ï¼Œç»†å¿ƒçš„åŒå­¦å¯èƒ½å‘ç°è¿™ä¸ªä»£ç æœ‰é—®é¢˜å‘€ï¼Œä¸ºä»€ä¹ˆè¦ä» root ä¸€å±‚ä¸€å±‚åœ°æŸ¥ä¸‹å»ï¼Œç›´æ¥ç”¨ç§Ÿæˆ· id æŸ¥è¯¢å‡ºæ‰€æœ‰çš„éƒ¨é—¨æ•°æ®ç„¶åå†ç»„è£…æˆæ ‘ä¸æ˜¯ä¼šè§£å†³å—ã€‚ç¡®å®å¯ä»¥è§£å†³éƒ¨é—¨æ ‘çš„æŸ¥è¯¢ï¼Œä½†æ˜¯æ•°æ®æƒé™çš„å­éƒ¨é—¨é‚£é‡Œä¿æŒåŸæ ·è¿˜æ˜¯ä¼šè¶…æ—¶ã€‚</p><p>å› æ­¤è¦è§£å†³çš„é—®é¢˜æ ¸å¿ƒè¿˜æ˜¯<strong>ä¼ å…¥ä»»ä½•ä¸€ä¸ªéƒ¨é—¨ id èƒ½å¤Ÿå¿«é€ŸæŸ¥è¯¢å‡ºå­éƒ¨é—¨åˆ—è¡¨</strong>ã€‚</p><h1 id="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"></a><strong>ä¸‰ã€è§£å†³æ–¹æ¡ˆ</strong></h1><ol><li><p>åŠ ç¼“å­˜ï¼Œå¯èƒ½å­˜çš„æ•°æ®æ¯”è¾ƒå¤šå§ï¼Œæ¯ä¸€ä¸ªéƒ¨é—¨ id éƒ½éœ€è¦å­˜ä¸€ä»½å­éƒ¨é—¨çš„æ•°æ®ã€‚åˆå§‹åŒ–æ„å»ºç¼“å­˜çš„æ—¶å€™æŸ¥è¯¢ä¾æ—§æ…¢ï¼Œè¿™é‡Œä¸è®¨è®ºäº†ã€‚å› ä¸ºæ ¸å¿ƒé—®é¢˜æ˜¯è§£å†³æŸ¥è¯¢æ•°æ®åº“æ…¢çš„é—®é¢˜</p></li><li><p>å‡å°‘æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ï¼Œä»è€Œå‡å°‘å“åº”æ—¶é—´</p></li></ol><h2 id="å…·ä½“å®ç°æ€è·¯"><a href="#å…·ä½“å®ç°æ€è·¯" class="headerlink" title="å…·ä½“å®ç°æ€è·¯"></a><strong>å…·ä½“å®ç°æ€è·¯</strong></h2><p>å›é¡¾æ ‡é¢˜ï¼Œè¦ç”¨æ•°æ®ç»“æ„å»ä¼˜åŒ–æŸ¥è¯¢ï¼Œé‚£å¯èƒ½å°±æ˜¯åœ¨åŸå…ˆè¡¨çš„åŸºç¡€å¢åŠ ä¸€äº›è¾…åŠ©å­—æ®µæ¥æé«˜æŸ¥è¯¢çš„æ•ˆç‡ã€‚åŠ ç´¢å¼•è‚¯å®šæ²¡å•¥å¤§ä½œç”¨äº†ï¼Œå› ä¸ºè¿™é‡Œçš„æŸ¥è¯¢æ…¢æ˜¯å› ä¸ºæ¬¡æ•°å¤šè€Œä¸æ˜¯å› ä¸ºå•è¯æŸ¥è¯¢æ•°æ®é‡å¤§å¯¼è‡´ã€‚å½“ç„¶ç´¢å¼•è¯¥åŠ è¿˜æ˜¯å¾—åŠ ã€‚</p><h3 id="ä¼˜åŒ–æŸ¥è¯¢è®¾è®¡"><a href="#ä¼˜åŒ–æŸ¥è¯¢è®¾è®¡" class="headerlink" title="ä¼˜åŒ–æŸ¥è¯¢è®¾è®¡"></a><strong>ä¼˜åŒ–æŸ¥è¯¢è®¾è®¡</strong></h3><p>è§‚å¯Ÿä¸‹éƒ¨é—¨æ ‘çš„æ•°æ®ç»“æ„ã€‚</p><p>ä»¥ä¸‹é¢ä¸ºä¾‹ï¼›</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image8.png" alt=""></p><p>æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸ºæ¯ä¸ªèŠ‚ç‚¹æ·»åŠ ä¸¤ä¸ªå€¼ï¼Œä»£è¡¨æ•°æ®çš„èŒƒå›´ï¼ˆleftValut, rightValueï¼‰</p><p>éœ€è¦æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p><p>æ¯ä¸ªèŠ‚ç‚¹çš„ leftValut &lt; rightValue</p><p>å­èŠ‚ç‚¹çš„ leftValut &gt; çˆ¶èŠ‚ç‚¹çš„ leftValue</p><p>å­èŠ‚ç‚¹çš„ rightValue &lt; çˆ¶èŠ‚ç‚¹çš„ rightValue</p><p>æˆ‘ä»¬æŒ‰ç…§ï¼Œè¿™ä¸ªè§„åˆ™ç»™ä¸Šé¢çš„ç»“æ„èµ‹å€¼ä¸‹ï¼š</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image9.png" alt=""></p><p>å†è§‚å¯Ÿä¸‹ï¼Œæ€ä¹ˆå»æŸ¥å­éƒ¨é—¨å‘¢ï¼Ÿ</p><p>æ¯”å¦‚  2-1ï¼ˆ2,9ï¼‰ çš„ å­éƒ¨é—¨ä¸º  3-1ï¼ˆ3,6ï¼‰ å’Œ  3-2ï¼ˆ7,8ï¼‰ä»¥åŠ 3-1 çš„å­éƒ¨é—¨ 4-1ï¼ˆ4,5ï¼‰ã€‚ å¯ä»¥çœ‹å‡º 3,4,5,6,7,8 éƒ½åœ¨ 2,9 ä¹‹é—´ã€‚</p><p>å› æ­¤å¯ä»¥ç”¨ï¼Œ2&lt; leftValue/rightValue &lt;9  æŸ¥è¯¢åˆ° 3-1,3-2,4-1 .è€Œè¿™å‡ ä¸ªæ­£å¥½æ˜¯ 2-1 çš„å­éƒ¨é—¨ã€‚</p><p>æ ¹æ®æˆ‘ä»¬èµ‹å€¼çš„é™åˆ¶æ¡ä»¶ä¸éš¾çœ‹å‡ºä¸€ä¸ªéƒ¨é—¨çš„æ‰€æœ‰å­éƒ¨é—¨çš„ leftValue å’Œ rightValue æ˜¯åœ¨çˆ¶éƒ¨é—¨çš„èŒƒå›´å†…çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥è¯¢ä¸€ä¸ªéƒ¨é—¨çš„æ‰€æœ‰å­éƒ¨é—¨æ—¶ï¼Œå°±å¯ä»¥ç”¨å¦‚ä¸‹çš„ä¼ªä»£ç å»æŸ¥è¯¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//1. æŸ¥è¯¢è¯¥éƒ¨é—¨çš„ leftValue å’Œ rightValue</span><br><span class="line">Dept dept = queryDeptFromMysql(parentId);</span><br><span class="line">int leftValue = dept.getLeftValue();</span><br><span class="line">int rightValue = dept.getRightValue();</span><br><span class="line">//2. é€šè¿‡leftValue å’Œ rightValue æŸ¥è¯¢å­éƒ¨é—¨</span><br><span class="line">List&lt;Dept&gt; childDepts = queryChildDeptsFromMysql(leftValue,rightValue)</span><br><span class="line">//sql çš„è¯å°±æ˜¯è¿™æ ·</span><br><span class="line">// select * from dept where tenant_id=xxx and left_value &gt; #&#123;leftValue&#125; and left_value &lt; #&#123;rightValue&#125;</span><br><span class="line">  </span><br><span class="line">//3. æ ¹æ®å®é™…æƒ…å†µè¿”å›åˆ—è¡¨ï¼Œæˆ–è€…ç»„è£…æˆæ ‘</span><br></pre></td></tr></table></figure><p>//3. æ ¹æ®å®é™…æƒ…å†µè¿”å›åˆ—è¡¨ï¼Œæˆ–è€…ç»„è£…æˆæ ‘</p><p>å®é™…çš„ä»£ç ä¹Ÿç¡®å®å¦‚æ­¤ï¼š</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image10.png" alt=""></p><p>åœ¨æˆ‘ä»¬æœ‰è¿™ä¸¤ä¸ªå·¦å³å€¼çš„æƒ…å†µä¸‹ï¼Œä¸€æ¡ sql å°±èƒ½æŸ¥è¯¢å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»“æœã€‚é‚£ä¹ˆç°åœ¨çš„é—®é¢˜æ¥åˆ°äº†å¦‚ä½•å»ä¸ºæ¯ä¸ªéƒ¨é—¨èŠ‚ç‚¹è¿›è¡Œèµ‹å€¼ã€‚</p><h3 id="å¦‚ä½•å¯¹éƒ¨é—¨è¿›è¡Œèµ‹å€¼"><a href="#å¦‚ä½•å¯¹éƒ¨é—¨è¿›è¡Œèµ‹å€¼" class="headerlink" title="å¦‚ä½•å¯¹éƒ¨é—¨è¿›è¡Œèµ‹å€¼"></a><strong>å¦‚ä½•å¯¹éƒ¨é—¨è¿›è¡Œèµ‹å€¼</strong></h3><p>å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µè®¨è®ºï¼šï¼ˆè¿™é‡Œåªè€ƒè™‘å¢åŠ ä¿®æ”¹çš„æƒ…å†µéƒ½æ˜¯å•éƒ¨é—¨ï¼‰</p><h4 id="åˆå§‹åŒ–-x20"><a href="#åˆå§‹åŒ–-x20" class="headerlink" title="åˆå§‹åŒ–  &#x20;"></a><strong>åˆå§‹åŒ–  &#x20;</strong></h4><p>åˆå§‹åŒ–æ˜¯æœ€ç®€å•çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ä»¥æ ¹èŠ‚ç‚¹ï¼ˆleftValue å€¼ä¸º 1ï¼‰ä¸ºå¼€å§‹æ·±åº¦ä¼˜å…ˆéå†ï¼Œ æ¯æ¬¡+1 å³å¯ã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image11.png" alt=""></p><p>è¿™é‡Œçš„åˆå§‹å€¼è®¾ç½®ä¸º 1 å³å¯ã€‚å¾ˆç®€å•</p><h4 id="æ–°å¢éƒ¨é—¨"><a href="#æ–°å¢éƒ¨é—¨" class="headerlink" title="æ–°å¢éƒ¨é—¨"></a><strong>æ–°å¢éƒ¨é—¨</strong></h4><p>è¿˜æ˜¯ä»¥ä¸Šè¿°ä¸ºä¾‹ï¼šæˆ‘ä»¬ç»™ 3-1 å¢åŠ ä¸€ä¸ªå­éƒ¨é—¨ 4-2 ã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image12.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºå˜åŒ–çš„éƒ¨åˆ†æ˜¯</p><p>æ–°å¢äº†ä¸€ä¸ªéƒ¨é—¨ 4-2 ä»–çš„å€¼åˆ†åˆ«æ˜¯ 4-1 çš„ ï¼ˆrightValue +1,rightValue+2) å³ 6,7&#x20;</p><p>å› ä¸º 3-1 å¢åŠ äº†å­éƒ¨é—¨æ‰€ä»¥ä»–çš„å€¼èŒƒå›´å¿…å®šå‘ç”Ÿå˜åŒ–ï¼Œå˜åŒ–çš„å¢é•¿å€¼å°±æ˜¯ 2 ï¼ˆ ä¹Ÿæ˜¯å¢åŠ çš„èŠ‚ç‚¹ä¸ªæ•°*2ï¼‰å› ä¸ºéƒ¨é—¨ 4-2 å·²ç»æ˜¯ 6,7 äº† æ‰€ä»¥ 3-1 éƒ¨é—¨ä¼šå‘ç”Ÿå˜åŒ–ä¸º 3,8&#x20;</p><p>åŒç†åç»­å³è¾¹ï¼ˆæ¯”å‘ç”Ÿå˜åŒ–çš„å€¼å¤§çš„ï¼‰èŠ‚ç‚¹çš„å€¼éƒ½ä¼šå‘ç”Ÿå¯¹åº”çš„å˜åŒ–</p><p>å…¶å®ä¸éš¾çœ‹å‡ºï¼Œæ¯ä¸ªå€¼å¤§äºç­‰äº 4-1 çš„rightValue +1ï¼Œï¼ˆå³æ–°å¢åŠ çš„4-2çš„ leftValueï¼‰ çš„å€¼éƒ½å¢åŠ äº† 2 ï¼Œæ— è®ºä»–æ˜¯leftValueè¿˜æ˜¯rightValueã€‚</p><p>é‚£ä¹ˆæ–°å¢åŠ ä¸€ä¸ªå­èŠ‚ç‚¹å¯ä»¥è¿™æ ·å»æ›´æ–°ã€‚å½“ç„¶ä½ è¿˜è¦æŠŠæ–°åŠ çš„éƒ¨é—¨åŠ è¿›å»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE dept</span><br><span class="line">SET left_value = IF(left_value &gt; #&#123;leftValue&#125;, left_value + #&#123;changeValue&#125;, left_value),</span><br><span class="line">    right_value = IF(right_value &gt; #&#123;leftValue&#125;, right_value +  #&#123;changeValue&#125;, right_value)</span><br><span class="line">where tenant_id= #&#123;tenantId&#125;;</span><br></pre></td></tr></table></figure><p>changeValue æ˜¯ä»€ä¹ˆå‘¢ã€‚å…¶å®å°±æ˜¯å˜åŒ–çš„èŠ‚ç‚¹çš„ä¸ªæ•°*2ï¼Œè€Œè¿™é‡Œå°±æ˜¯ 2ï¼Œå› ä¸ºåªæ–°å¢äº†ä¸€ä¸ªå­èŠ‚ç‚¹ 4-2</p><p>é‚£å¦‚æœï¼Œæ–°å¢åŠ çš„éƒ¨é—¨ä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªå‘¢ï¼Ÿ</p><p>å…¶å®è¿™ç§æƒ…å†µåœ¨æˆ‘ä»¬è¿™ç§é¡µé¢ä¸Šä¸ä¼šå‡ºç°ã€‚å› ä¸ºæ·»åŠ éƒ¨é—¨çš„æ—¶å€™åªä¼šæ·»åŠ ä¸€ä¸ªã€‚</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image13.png" alt=""></p><p>æ·»åŠ çš„å­éƒ¨é—¨å¹¶ä¸ä¼šå­˜åœ¨å®ƒæ˜¯æ ‘çš„æƒ…å†µã€‚</p><h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a><strong>åˆ é™¤</strong></h4><p>è¿˜æ˜¯ä»¥ä¸Šè¿°ä¸ºä¾‹ï¼šæˆ‘ä»¬æŠŠ 4-1 åˆ é™¤äº†ï¼›</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image14.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºå˜åŒ–çš„éƒ¨åˆ†æ˜¯:</p><p>å› ä¸º 4-1 è¢«åˆ é™¤ï¼Œæ‰€ä»¥ä»–çš„çˆ¶éƒ¨é—¨å€¼èŒƒå›´å¿…å®šå‘ç”Ÿå˜åŒ–ï¼Œå˜åŒ–çš„å‡å°‘å€¼å°±æ˜¯ 2 ï¼ˆ ä¹Ÿæ˜¯åˆ é™¤çš„èŠ‚ç‚¹ä¸ªæ•°*2ï¼‰ 3-1 éƒ¨é—¨å·²ç»æ²¡æœ‰å˜åŒ–ä¸º 3,4</p><p>åŒç†åç»­å³è¾¹ï¼ˆæ¯”å‘ç”Ÿå˜åŒ–çš„å€¼å¤§çš„ï¼‰èŠ‚ç‚¹çš„å€¼éƒ½ä¼šå‘ç”Ÿå¯¹åº”çš„å˜åŒ–</p><p>å…¶å® ä¹Ÿä¸éš¾çœ‹å‡ºï¼Œæ¯ä¸ªå€¼å¤§äº 4-1 çš„leftValueï¼Œ çš„å€¼éƒ½å‡å°‘äº† 2 ï¼Œæ— è®ºä»–æ˜¯leftValueè¿˜æ˜¯rightValueã€‚</p><p>é‚£ä¹ˆæ–°å¢åŠ ä¸€ä¸ªå­èŠ‚ç‚¹å¯ä»¥è¿™æ ·å»æ›´æ–°ï¼Œå½“ç„¶ä½ è¿˜è¦æŠŠåˆ é™¤çš„éƒ¨é—¨åˆ é™¤æ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE dept</span><br><span class="line"> SET left_value = IF(left_value &gt; #&#123;leftValue&#125;, left_value - #&#123;changeValue&#125;, left_value),</span><br><span class="line">     right_value = IF(right_value &gt; #&#123;leftValue&#125;, right_value - #&#123;changeValue&#125;, right_value)</span><br><span class="line"> where tenant_id= #&#123;tenantId&#125;;</span><br></pre></td></tr></table></figure><p>å¦‚æœåˆ é™¤çš„æ˜¯ä¸€ä¸ªå¸¦æœ‰å­éƒ¨é—¨çš„éƒ¨é—¨å‘¢ï¼Ÿé‚£ä¼šå¦‚ä½•å˜åŒ–å‘¢ï¼Œå…¶å®è‡ªå·±æ¨æ¼”ä¸‹ä¹Ÿä¸éš¾å‘ç°ä¸Šè¿°è§„å¾‹åŒæ ·æˆç«‹ã€‚å¦‚åˆ é™¤çš„æ˜¯ 3-1 é‚£ä¹ˆï¼Œå˜åŒ–å¦‚ä¸‹ï¼š</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image15.png" alt=""></p><p>ä¸€æ ·åœ°ï¼Œå› ä¸ºåˆ é™¤äº†ä¸¤ä¸ªéƒ¨é—¨ ï¼ˆ3-1 å’Œä»–çš„å­éƒ¨é—¨ 4-1ï¼‰æ‰€ä»¥ changeValue = 4ã€‚æ‰€æœ‰æ¯”åˆ é™¤çš„ 3-1 çš„ leftValue ï¼ˆ4ï¼‰å¤§å€¼éƒ½å‡å» 4 å³å¯ã€‚</p><h4 id="ä¿®æ”¹ï¼ˆç§»åŠ¨éƒ¨é—¨ï¼‰"><a href="#ä¿®æ”¹ï¼ˆç§»åŠ¨éƒ¨é—¨ï¼‰" class="headerlink" title="ä¿®æ”¹ï¼ˆç§»åŠ¨éƒ¨é—¨ï¼‰"></a><strong>ä¿®æ”¹ï¼ˆç§»åŠ¨éƒ¨é—¨ï¼‰</strong></h4><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image16.png" alt=""></p><p>å¦‚æœä¸æ˜¯ä¿®æ”¹äº†è¿™ä¸ªéƒ¨é—¨çš„çˆ¶éƒ¨é—¨ï¼ˆparentId å­—æ®µï¼‰ï¼Œé‚£å…¶å®ä¸ç”¨å»æ›´æ–°èŒƒå›´å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬åªè®¨è®ºæ›´æ–°äº† parentId çš„æƒ…å†µã€‚</p><p>ç§»åŠ¨éƒ¨é—¨æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å…ˆåˆ é™¤å†ä¿å­˜çš„æ–¹å¼å»æ“ä½œã€‚å°±æ˜¯ç»“åˆ æ­¥éª¤ 3 å’Œæ­¥éª¤ 2&#x20;</p><p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ä¼šé‡åˆ°ï¼Œå¦‚æœç§»åŠ¨çš„éƒ¨é—¨ä»–æœ‰å­éƒ¨é—¨ï¼Œé‚£å°±ç›¸å½“äºè¦ä¿å­˜ä¸€ä¸ªå¸¦æœ‰å­éƒ¨é—¨çš„éƒ¨é—¨äº†ã€‚</p><p>è¿˜æ˜¯ä»¥ä¸Šè¿°ä¸ºä¾‹ï¼šæˆ‘ä»¬ç§»åŠ¨ 3-1ï¼ŒæŠŠä»–çš„çˆ¶éƒ¨é—¨å˜æˆ 3-2&#x20;</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆå°† 3-1 æ•´ä½“åˆ é™¤ ç„¶åå¯¹ 3-1 åŠå­éƒ¨é—¨ 4-1 åšä¸€ä¸ªæ•´ä½“çš„å­æ ‘çš„åˆå§‹åŒ–(èµ·å§‹å€¼æ˜¯éƒ¨é—¨ 3-2 çš„ leftValue+1)</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image17.png" alt=""></p><p>ç„¶åæˆ‘ä»¬å°† 3-1 çš„å­æ ‘æ’å…¥åˆ° 3-2 ä¸‹é¢ã€‚å°±å®Œæˆäº†ç§»åŠ¨</p><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image18.png" alt=""></p><p>æ‰€ä»¥æ’å…¥å¸¦æœ‰æ ‘ç»“æ„çš„å­éƒ¨é—¨å’Œä¸€ä¸ªéƒ¨é—¨çš„é€»è¾‘æ˜¯ä¸€è‡´,åªæ˜¯å¤šäº†åˆå§‹åŒ–æ’å…¥çš„å­æ ‘ç»“æ„çš„æ­¥éª¤ã€‚å› ä¸ºå­æ ‘æ‰€æœ‰çš„å€¼éƒ½å¤§äºçˆ¶èŠ‚ç‚¹çš„ leftValue å› æ­¤ä»è¯¥å€¼+1åˆå§‹åŒ–å­æ ‘å†æ’å…¥å°±è¡Œï¼Œè¿™æ—¶å€™å…¶ä»–èŠ‚ç‚¹å˜åŒ–çš„ changeValue å°±æ˜¯å­æ ‘çš„èŠ‚ç‚¹æ•°é‡*2&#x20;</p><h1 id="å››ã€ä¼˜åŒ–çš„æ•ˆæœ"><a href="#å››ã€ä¼˜åŒ–çš„æ•ˆæœ" class="headerlink" title="å››ã€ä¼˜åŒ–çš„æ•ˆæœ"></a><strong>å››ã€ä¼˜åŒ–çš„æ•ˆæœ</strong></h1><p><img src="2024-12-28-å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢/image19.png" alt=""></p><p>éƒ¨é—¨æ ‘ï¼ˆçº¦æœ‰ 1.8w ä¸ªéƒ¨é—¨ï¼‰çš„æ¥å£è¿”å›äº†å¦‚æ­¤å·¨å¤§æ•°æ®çš„æƒ…å†µçš„ä¸‹åªç”¨äº† 400msã€‚å…¶ä¸­è¿˜å¯¹éƒ¨é—¨é‡æ–°è¿›è¡Œäº†æ’åºï¼Œå¹¶ä¸”å¸¦æœ‰å…¶ä»–é€»è¾‘ã€‚æ•ˆæœå ªç§°æ˜¾è‘—ã€‚</p><p>psï¼šä¿®æ”¹ä¹‹ååœ¨æ•°æ®æƒé™æ‹¦æˆªå™¨ä¸Šï¼Œå¯ä»¥é€šè¿‡å­æŸ¥è¯¢å…³è”ä¸Šå­éƒ¨é—¨ idï¼Œè€Œä¸ç”¨å†å»æŸ¥è¯¢å­éƒ¨é—¨æ”¾åˆ° in æ¡ä»¶é‡Œäº†ã€‚å…¶å®å·®ä¸å¤šã€‚å¯ä»¥åšå¦‚ä¸‹ä¿®æ”¹ï¼Œæ›¿æ¢åŸå…ˆ SELF_AND_CHILD çº§åˆ«æ•°æ®æƒé™çš„å¤„ç†é€»è¾‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">else if (dataPermissionType.equals(DataPermissionLevel.SELF_AND_CHILD.getCode())) &#123;</span><br><span class="line">            // 1æœ¬çº§åŠå­é›†</span><br><span class="line">            // åˆ›å»ºå­æŸ¥è¯¢çš„å†…éƒ¨ SELECT</span><br><span class="line">            PlainSelect plainSelect = new PlainSelect();</span><br><span class="line">            Table departmentsTable = new Table(&quot;dep_department&quot;);</span><br><span class="line">            SelectExpressionItem department_id =new SelectExpressionItem();</span><br><span class="line">            department_id.withExpression(new Column (&quot;id&quot;));</span><br><span class="line">            plainSelect.setFromItem(departmentsTable);</span><br><span class="line">            plainSelect.addSelectItems(department_id);</span><br><span class="line">            // è®¾ç½®å­æŸ¥è¯¢æ¡ä»¶ï¼šleft_value BETWEEN (SELECT left_value FROM departments WHERE department_id = 2) AND (SELECT right_value FROM departments WHERE department_id = 2)</span><br><span class="line">            SubSelect subSelectForLeftValue = new SubSelect();</span><br><span class="line">            PlainSelect subPlainSelectForLeftValue = new PlainSelect();</span><br><span class="line">            subPlainSelectForLeftValue.setFromItem(departmentsTable);</span><br><span class="line">            SelectExpressionItem left_value =new SelectExpressionItem();</span><br><span class="line">            left_value.withExpression(new Column (&quot;left_value&quot;));</span><br><span class="line">            subPlainSelectForLeftValue.addSelectItems(left_value);</span><br><span class="line">            subPlainSelectForLeftValue.setWhere(new EqualsTo(new Column(&quot;id&quot;), new LongValue(dataPermissionParams.getDepartmentId())));</span><br><span class="line">            subSelectForLeftValue.setSelectBody(subPlainSelectForLeftValue);</span><br><span class="line">            SubSelect subSelectForRightValue = new SubSelect();</span><br><span class="line">            PlainSelect subPlainSelectForRightValue = new PlainSelect();</span><br><span class="line">            subPlainSelectForRightValue.setFromItem(departmentsTable);</span><br><span class="line">            SelectExpressionItem right_value =new SelectExpressionItem();</span><br><span class="line">            right_value.withExpression(new Column (&quot;right_value&quot;));</span><br><span class="line">            subPlainSelectForRightValue.addSelectItems(right_value);</span><br><span class="line">            subPlainSelectForRightValue.setWhere(new EqualsTo(new Column(&quot;id&quot;), new LongValue(dataPermissionParams.getDepartmentId())));</span><br><span class="line">            subSelectForRightValue.setSelectBody(subPlainSelectForRightValue);</span><br><span class="line">            Column leftValueColumn = new Column(&quot;left_value&quot;);</span><br><span class="line">            Between betweenExpression = new Between();</span><br><span class="line">            betweenExpression.setLeftExpression(leftValueColumn);</span><br><span class="line">            betweenExpression.setBetweenExpressionStart(subSelectForLeftValue);</span><br><span class="line">            betweenExpression.setBetweenExpressionEnd(subSelectForRightValue);</span><br><span class="line">            plainSelect.setWhere(betweenExpression);</span><br><span class="line">            // è®¾ç½®æ¡ä»¶ï¼šdepartment_id IN (å­æŸ¥è¯¢)</span><br><span class="line">            SubSelect subSelect = new SubSelect();</span><br><span class="line">            subSelect.setSelectBody(plainSelect);</span><br><span class="line">            expression = new InExpression(new Column(dataPermissionInfo.getDepartmentColumnName()), subSelect);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ğŸ¥§å·§å¦™åˆ©ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–æ ‘å‹æŸ¥è¯¢</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="å®ä¹ ç»éªŒ" scheme="https://outoflovenicoo.github.io/tags/%E5%AE%9E%E4%B9%A0%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>å¥½çš„åšå®¢åˆ†äº«</title>
    <link href="https://outoflovenicoo.github.io/posts/2024-08-09-%E5%A5%BD%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%88%86%E4%BA%AB.html"/>
    <id>https://outoflovenicoo.github.io/posts/2024-08-09-%E5%A5%BD%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%88%86%E4%BA%AB.html</id>
    <published>2024-08-09T10:19:03.000Z</published>
    <updated>2025-01-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>åšå®¢</p><p>  â­ï¸<a href="https://xiaolincoding.com/mysql/buffer_pool/buffer_pool.html#ä¸ºä»€ä¹ˆè¦æœ‰-buffer-pool">æ­å¼€ Buffer Pool çš„é¢çº±</a>  </p><p>è¯´å®è¯ï¼Œyoung LRUå’Œ old LRUé‚£å—æ²¡çœ‹æ‡‚</p><p>  <a href="https://xiaolincoding.com/os/3_memory/cache_lru.html">4.5 å¦‚ä½•é¿å…é¢„è¯»å¤±æ•ˆå’Œç¼“å­˜æ±¡æŸ“çš„é—®é¢˜ï¼Ÿ</a> </p><p> <a href="https://xiaolincoding.com/os/3_memory/linux_mem.html">4.6 æ·±å…¥ç†è§£ Linux è™šæ‹Ÿå†…å­˜ç®¡ç†</a>  </p><p><a href="https://xiaolincoding.com/os/3_memory/linux_mem2.html">4.7 æ·±å…¥ç†è§£ Linux ç‰©ç†å†…å­˜ç®¡ç†</a> </p><p> <a href="https://xiaolincoding.com/network/1_base/how_os_deal_network_package.html">2.3 Linux ç³»ç»Ÿæ˜¯å¦‚ä½•æ”¶å‘ç½‘ç»œåŒ…çš„ï¼Ÿ</a> </p><p> â­ï¸<a href="https://xiaolincoding.com/network/2_http/http_websocket.html">3.9 æ—¢ç„¶æœ‰ HTTP åè®®ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æœ‰ WebSocketï¼Ÿ</a> </p><p> TCPå…¨éƒ¨  </p><p><a href="https://xiaolincoding.com/network/3_tcp/tcp_queue.html">4.4 TCP åŠè¿æ¥é˜Ÿåˆ—å’Œå…¨è¿æ¥é˜Ÿåˆ—</a> </p><p> <a href="https://xiaolincoding.com/network/3_tcp/tcp_optimize.html">4.5 å¦‚ä½•ä¼˜åŒ– TCP?</a> </p><p> <a href="https://xiaolincoding.com/network/3_tcp/tcp_stream.html">4.6 å¦‚ä½•ç†è§£æ˜¯ TCP é¢å‘å­—èŠ‚æµåè®®ï¼Ÿ</a>  </p><p><a href="https://xiaolincoding.com/network/3_tcp/isn_deff.html">4.7 ä¸ºä»€ä¹ˆ TCP æ¯æ¬¡å»ºç«‹è¿æ¥æ—¶ï¼Œåˆå§‹åŒ–åºåˆ—å·éƒ½è¦ä¸ä¸€æ ·å‘¢ï¼Ÿ</a></p><p>  <a href="https://xiaolincoding.com/network/3_tcp/challenge_ack.html">4.9 å·²å»ºç«‹è¿æ¥çš„TCPï¼Œæ”¶åˆ°SYNä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</a>  </p><p>â€¦  </p><p><a href="https://xiaolincoding.com/network/4_ip/ip_base.html#å‰èœ-ip-åŸºæœ¬è®¤è¯†">5.1 IP åŸºç¡€çŸ¥è¯†å…¨å®¶æ¡¶</a>  </p><p>1.CPU ç¼“å­˜ä¸€è‡´æ€§</p><p>  <a href="https://xiaolincoding.com/os/1_hardware/cpu_mesi.html#cpu-cache-çš„æ•°æ®å†™å…¥">2.4 CPU ç¼“å­˜ä¸€è‡´æ€§</a>  <a href="https://mp.weixin.qq.com/s/PDUqwAIaUxNkbjvRfovaCg">åå¼ å›¾ä»‹ç»MESI</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image001.jpg" alt="img"></p><p>2.CPUæ˜¯å¦‚ä½•æ‰§è¡Œä»»åŠ¡çš„</p><p>  <a href="https://xiaolincoding.com/os/1_hardware/how_cpu_deal_task.html#cpu-å¦‚ä½•è¯»å†™æ•°æ®çš„">2.5 CPU æ˜¯å¦‚ä½•æ‰§è¡Œä»»åŠ¡çš„ï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image002.jpg" alt="img"></p><p>3.å†…å­˜æ»¡äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>  <a href="https://xiaolincoding.com/os/3_memory/mem_reclaim.html#å†…å­˜åˆ†é…çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„">4.3 å†…å­˜æ»¡äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image003.jpg" alt="img"></p><p>4.åƒåœ¾å›æ”¶æœºåˆ¶ä¸åƒåœ¾å›æ”¶å™¨</p><p>  <a href="https://javaguide.cn/java/jvm/jvm-garbage-collection.html">JVMåƒåœ¾å›æ”¶è¯¦è§£ï¼ˆé‡ç‚¹ï¼‰</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image004.jpg" alt="img"></p><p>ï¼ˆ1ï¼‰å¯¹CMSåƒåœ¾å›æ”¶å™¨çš„ç†è§£</p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image006.jpg" alt="img"></p><p>  CMSæ˜¯ä¸€ä¸ªè€å¹´ä»£çš„åƒåœ¾å›æ”¶å™¨  CMSåƒåœ¾å›æ”¶å™¨çš„æ­¥éª¤ï¼š  ï¿®    åˆå§‹æ ‡è®°ï¼š çŸ­æš‚åœé¡¿STWï¼Œæ ‡è®°ç›´æ¥ä¸ root ç›¸è¿çš„å¯¹è±¡ï¼ˆæ ¹å¯¹è±¡ï¼‰ï¼›  ï¿®    å¹¶å‘æ ‡è®°ï¼š åŒæ—¶å¼€å¯ GC å’Œç”¨æˆ·çº¿ç¨‹ï¼Œç”¨ä¸€ä¸ªé—­åŒ…ç»“æ„å»è®°å½•å¯è¾¾å¯¹è±¡ã€‚ä½†åœ¨è¿™ä¸ªé˜¶æ®µç»“æŸï¼Œè¿™ä¸ªé—­åŒ…ç»“æ„å¹¶ä¸èƒ½ä¿è¯åŒ…å«å½“å‰æ‰€æœ‰çš„å¯è¾¾å¯¹è±¡ã€‚å› ä¸ºç”¨æˆ·çº¿ç¨‹å¯èƒ½ä¼šä¸æ–­çš„æ›´æ–°å¼•ç”¨åŸŸï¼Œæ‰€ä»¥ GC çº¿ç¨‹æ— æ³•ä¿è¯å¯è¾¾æ€§åˆ†æçš„å®æ—¶æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•é‡Œä¼šè·Ÿè¸ªè®°å½•è¿™äº›å‘ç”Ÿå¼•ç”¨æ›´æ–°çš„åœ°æ–¹ã€‚  ï¿®    é‡æ–°æ ‡è®°ï¼š é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­  ï¿®    å¹¶å‘æ¸…é™¤ï¼š å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶ GC çº¿ç¨‹å¼€å§‹å¯¹æœªæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚     CMSä¼˜ç‚¹ï¼šå¹¶å‘ã€ä½åœé¡¿  CMSç¼ºç‚¹ï¼šå¯¹CPUçš„ä½¿ç”¨ç‡é«˜ï¼Œä¼šæŠ¢å ç”¨æˆ·çº¿ç¨‹çš„CPUæ‰§è¡Œæ—¶æœºè¿›è¡ŒGCï¼Œå¯¼è‡´ç”¨æˆ·ç¨‹åºæ‰§è¡Œå¡é¡¿ã€‚å› ä¸ºä½¿ç”¨æ ‡è®°æ¸…æ¥šç®—æ³•ä¼šå¯¼è‡´å¤§é‡ç©ºé—´ç¢ç‰‡     </p><p>ï¼ˆ2ï¼‰å¯¹G1åƒåœ¾å›æ”¶å™¨çš„ç†è§£</p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image008.jpg" alt="img"></p><p>  G1æŠŠå †ç©ºé—´åˆ†å‰²æˆè‹¥å¹²ä¸ªregionï¼Œæ¯ä¸ªreginæ—¢å¯ä»¥æ˜¯EdenåŒºï¼Œä¹Ÿå¯ä»¥æ˜¯å¹¸å­˜åŒºï¼Œä¹Ÿå¯ä»¥æ˜¯è€å¹´ä»£ï¼Œè¿™ç§ç»†ç²’åº¦çš„åˆ†å‰²æ–¹å¼æ˜¯å¾—G1åƒåœ¾å›æ”¶å™¨èƒ½å¤Ÿæ›´ç²¾ç»†çš„æ§åˆ¶å†…å­˜ï¼Œå¹¶ä¸”ç”±äºæ¯ä¸ªregionæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿé¢„æµ‹åœé¡¿æ—¶é—´ã€‚  åœ¨æ¯ä¸ªregionå†…éƒ¨é€šè¿‡æŒ‡é’ˆç¢°æ’åˆ†é…å†…å­˜ï¼Œè¿™æ ·å¯ä»¥ä½¿å†…å­˜åˆ†é…æ›´è§„æ•´ã€‚è¿™æ ·å°±é¿å…äº†æ”¶é›†æ•´ä¸ªå †ï¼Œè€Œæ˜¯æŒ‰ç…§è‹¥å¹²ä¸ªRegioné›†è¿›è¡Œæ”¶é›†ï¼ŒåŒæ—¶ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆçº§åˆ—è¡¨ï¼Œè·Ÿè¸ªå„ä¸ªRegionå›æ”¶çš„â€œä»·å€¼ï¼Œä¼˜å…ˆæ”¶é›†ä»·å€¼é«˜çš„Regionã€‚  G1æ”¶é›†å™¨çš„è¿è¡Œè¿‡ç¨‹å¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š  ï¿®    åˆå§‹æ ‡è®°ï¼ˆinitial markï¼‰ï¼Œæ ‡è®°äº†ä»GC Rootå¼€å§‹ç›´æ¥å…³è”å¯è¾¾çš„å¯¹è±¡ã€‚STWï¼ˆStop  the Worldï¼‰æ‰§è¡Œã€‚  ï¿®    å¹¶å‘æ ‡è®°ï¼ˆconcurrent markingï¼‰ï¼Œå’Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œä»GC Rootå¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§  åˆ†æï¼Œé€’å½’æ‰«ææ•´ä¸ªå †é‡Œçš„å¯¹è±¡å›¾ï¼Œæ‰¾å‡ºè¦å›æ”¶çš„å¯¹è±¡ã€  ï¿®    æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼‰ï¼ŒSTWï¼Œæ ‡è®°å†å¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­äº§ç”Ÿçš„åƒåœ¾ã€‚ = é‡æ–°æ ‡è®°ï¼ˆæ ‡è®°çš„èŒƒå›´æ›´å°ï¼‰  ï¿®    ç­›é€‰å›æ”¶ï¼ˆLive Data Counting And Evacuationï¼‰ï¼Œåˆ¶å®šå›æ”¶è®¡åˆ’ï¼Œé€‰æ‹©å¤šä¸ªRegion æ„æˆå›æ”¶  é›†ï¼ŒæŠŠå›æ”¶é›†ä¸­Regionçš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ç©ºçš„Regionä¸­ï¼Œå†æ¸…ç†æ‰æ•´ä¸ªæ—§Regionçš„å…¨éƒ¨ç©ºé—´ã€‚éœ€  è¦STWã€‚   </p><p>ï¼ˆ3ï¼‰å¯¹ZGCçš„äº†è§£</p><p>ç›¸å…³åšå®¢</p><p><a href="https://mp.weixin.qq.com/s/Ywj3XMws0IIK-kiUllN87Q">æè‡´å…«è‚¡æ–‡ä¹‹JVMåƒåœ¾å›æ”¶å™¨G1&amp;ZGCè¯¦è§£</a></p><p><a href="https://mp.weixin.qq.com/s/ExkB40cq1_Z0ooDzXn7CVw">ä»å†ä»£GCç®—æ³•è§’åº¦å‰–æZGC</a></p><p><a href="https://tech.meituan.com/2020/08/06/new-zgc-practice-in-meituan.html">æ–°ä¸€ä»£åƒåœ¾å›æ”¶å™¨ ZGC çš„æ¢ç´¢ä¸å®è·µ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ</a></p><p>5.åˆ†å¸ƒå¼äº‹åŠ¡</p><p>  <a href="https://learn.lianglianglee.com/ä¸“æ /æ¶æ„è®¾è®¡é¢è¯•ç²¾è®²/05  æµ·é‡å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¦‚ä½•å›ç­”åˆ†å¸ƒå¼äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ.md">05 æµ·é‡å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¦‚ä½•å›ç­”åˆ†å¸ƒå¼äº‹åŠ¡ä¸€è‡´æ€§é—®é¢˜?</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image009.jpg" alt="img"></p><p>6.è¿›ç¨‹ä¹‹é—´é€šä¿¡æ–¹å¼</p><p>  <a href="https://xiaolincoding.com/os/4_process/process_commu.html">5.2 è¿›ç¨‹é—´æœ‰å“ªäº›é€šä¿¡æ–¹å¼ï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image010.jpg" alt="img"></p><p>7.çº¿ç¨‹å´©æºƒäº†è¿›ç¨‹ä¹Ÿä¼šç›´æ¥å´©æºƒå—</p><p>  <a href="https://xiaolincoding.com/os/4_process/thread_crash.html#çº¿ç¨‹å´©æºƒ-è¿›ç¨‹ä¸€å®šä¼šå´©æºƒå—">5.7 çº¿ç¨‹å´©æºƒäº†ï¼Œè¿›ç¨‹ä¹Ÿä¼šå´©æºƒå—ï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image011.jpg" alt="img"></p><p>8.æ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿå…¨å®¶æ¡¶ï¼ˆ70%ï¼‰</p><p>  <a href="https://xiaolincoding.com/os/6_file_system/file_system.html#æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆ">7.1 æ–‡ä»¶ç³»ç»Ÿå…¨å®¶æ¡¶</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image012.jpg" alt="img"></p><p>9.è¿›ç¨‹å†™æ–‡ä»¶æ—¶ï¼Œè¿›ç¨‹å‘ç”Ÿäº†å´©æºƒï¼Œå·²å†™å…¥çš„æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ</p><p>  <a href="https://xiaolincoding.com/os/6_file_system/pagecache.html#page-cache">7.2 è¿›ç¨‹å†™æ–‡ä»¶æ—¶ï¼Œè¿›ç¨‹å‘ç”Ÿäº†å´©æºƒï¼Œå·²å†™å…¥çš„æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image013.jpg" alt="img"></p><p>10.ä»€ä¹ˆæ˜¯ä¸€è‡´æ€§å“ˆå¸Œï¼Ÿ</p><p>  <a href="https://xiaolincoding.com/os/8_network_system/hash.html">9.4 ä»€ä¹ˆæ˜¯ä¸€è‡´æ€§å“ˆå¸Œï¼Ÿ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image014.jpg" alt="img"></p><p>11.CompletableFutureåŸç†</p><p>  <a href="https://tech.meituan.com/2022/05/12/principles-and-practices-of-completablefuture.html">CompletableFutureåŸç†ä¸å®è·µ-å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ–</a>  <a href="https://blog.csdn.net/u013905744/article/details/109134516">java8ä¸­CompletableFutureå¼‚æ­¥å¤„ç†è¶…æ—¶çš„æ–¹æ³•_completablefuture è¶…æ—¶-CSDNåšå®¢</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image015.jpg" alt="img"></p><p>12.Guavaçš„eventBusçš„åŸç†</p><p><a href="https://cloud.tencent.com/developer/article/1377032">GuavaåŸç†æ·±åº¦è§£æ</a></p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image016.jpg" alt="img"></p><p>13.ç¾å›¢çº¿ç¨‹æ± æœ€ä½³å®è·µ</p><p>  <a href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">Javaçº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image017.jpg" alt="img"></p><p>14.åˆ†å¸ƒå¼IDè®¾è®¡</p><p>  <a href="https://javaguide.cn/distributed-system/distributed-id.html">åˆ†å¸ƒå¼IDä»‹ç»&amp;å®ç°æ–¹æ¡ˆæ€»ç»“</a>  <a href="https://tech.meituan.com/2017/04/21/mt-leaf.html">Leafâ€”â€”ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼IDç”Ÿæˆç³»ç»Ÿ</a>  <a href="https://www.cnblogs.com/shoshana-kong/p/17319231.html">é›ªèŠ±ç®—æ³•çš„è¯¦è§£åŠæ—¶é—´å›æ‹¨è§£å†³æ–¹æ¡ˆ - ç™½éœ²~ - åšå®¢å›­</a>  </p><p><img src="2024-08-09-å¥½çš„åšå®¢åˆ†äº«/clip_image018.jpg" alt="img"></p><p>15.æ”¹è¿›å‹LRUï¼šå¦‚ä½•é¿å…é¢„è¯»å¤±æ•ˆå’Œç¼“å­˜æ±¡æŸ“çš„é—®é¢˜ï¼Ÿ</p><p><a href="https://xiaolincoding.com/os/3_memory/cache_lru.html#linux-å’Œ-mysql-çš„ç¼“å­˜">4.5 å¦‚ä½•é¿å…é¢„è¯»å¤±æ•ˆå’Œç¼“å­˜æ±¡æŸ“çš„é—®é¢˜ï¼Ÿ</a></p><p>13JUCçš„åšå®¢</p><p>ä¸Š</p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html">Javaå¹¶å‘å¸¸è§é¢è¯•é¢˜æ€»ç»“ï¼ˆä¸Šï¼‰</a></p><p>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html#â­ï¸è¯´è¯´çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€">â­ï¸è¯´è¯´çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€?</a>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html#â­ï¸æ­»é”">â­ï¸æ­»é”</a>  </p><p>ä¸­</p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html">Javaå¹¶å‘å¸¸è§é¢è¯•é¢˜æ€»ç»“ï¼ˆä¸­ï¼‰</a></p><p>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#â­ï¸jmm-java-å†…å­˜æ¨¡å‹">JMM(Java å†…å­˜æ¨¡å‹)</a>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#â­ï¸volatile-å…³é”®å­—">â­ï¸volatile å…³é”®å­—</a>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#â­ï¸ä¹è§‚é”å’Œæ‚²è§‚é”">â­ï¸ä¹è§‚é”å’Œæ‚²è§‚é”</a>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#â­ï¸synchronized-åº•å±‚åŸç†äº†è§£å—">â­ï¸synchronized åº•å±‚åŸç†äº†è§£å—ï¼Ÿ</a>  <a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#â­ï¸synchronized-å’Œ-volatile-æœ‰ä»€ä¹ˆåŒºåˆ«">â­ï¸synchronized å’Œ volatile æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a>  å¸¸ç”¨å·¥å…·ï¼š<a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#reentrantlock">ReentrantLock</a>ã€<a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#stampedlock">StampedLock</a>ã€<a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#atomic-åŸå­ç±»">Atomic åŸå­ç±»</a>        </p><p>ä¸‹</p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html">Javaå¹¶å‘å¸¸è§é¢è¯•é¢˜æ€»ç»“ï¼ˆä¸‹ï¼‰</a></p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#threadlocal">ThreadLocal</a></p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#çº¿ç¨‹æ± ">çº¿ç¨‹æ± </a></p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#future">Future</a></p><p><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#aqs">AQS</a></p>]]></content>
    
    
    <summary type="html">ğŸ¥§å¥½çš„åšå®¢å­¦ä¹ åˆ†äº«</summary>
    
    
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="å¤–æŒ‚æ ‡ç­¾" scheme="https://outoflovenicoo.github.io/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/"/>
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>å­¦ä¹ æ–¹æ³•ä¼˜åŒ–ä¸åæ€</title>
    <link href="https://outoflovenicoo.github.io/posts/2023454z.html"/>
    <id>https://outoflovenicoo.github.io/posts/2023454z.html</id>
    <published>2024-08-09T10:19:03.000Z</published>
    <updated>2025-03-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­¦ä¹ æ–¹æ³•ä¼˜åŒ–"><a href="#å­¦ä¹ æ–¹æ³•ä¼˜åŒ–" class="headerlink" title="å­¦ä¹ æ–¹æ³•ä¼˜åŒ–"></a>å­¦ä¹ æ–¹æ³•ä¼˜åŒ–</h1><h2 id="1-å­¦ä¹ æ–¹æ³•"><a href="#1-å­¦ä¹ æ–¹æ³•" class="headerlink" title="1.å­¦ä¹ æ–¹æ³•"></a>1.å­¦ä¹ æ–¹æ³•</h2><p>â€‹    å­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯ï¼Œè¦å…ˆçœ‹å®˜ç½‘è‡ªå·±åšæ€»ç»“ï¼ŒæŠŠè‡ªå·±å¯¹åº”çš„ç†è§£è¾“å‡ºæˆä¸ºä¸€ç¯‡æ–‡æ¡£ï¼Œç„¶åå†çœ‹åˆ«äººçš„åšå®¢è¿›è¡Œå¯¹æ¯”ã€‚å› ä¸ºçŸ¥è¯†å†ä¼ æ’­çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«å¼‚åŒ–æ‰ï¼Œåˆ«äººçš„ç†è§£ä¸ä¸€å®šå¯¹ï¼Œè¦å¸¦ç€æ€è€ƒå»çœ‹åˆ«äººçš„åšå®¢ã€‚</p><h2 id="2-å¥½çš„åšå®¢ä»‹ç»"><a href="#2-å¥½çš„åšå®¢ä»‹ç»" class="headerlink" title="2.å¥½çš„åšå®¢ä»‹ç»"></a>2.å¥½çš„åšå®¢ä»‹ç»</h2>]]></content>
    
    
    <summary type="html">ğŸ¥§å­¦ä¹ æ–¹æ³•ä¼˜åŒ–ä¸åæ€</summary>
    
    
    
    <category term="å­¦ä¹ æ–¹æ³•ä¼˜åŒ–" scheme="https://outoflovenicoo.github.io/categories/%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="å¤–æŒ‚æ ‡ç­¾" scheme="https://outoflovenicoo.github.io/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/"/>
    
    <category term="å­¦ä¹ " scheme="https://outoflovenicoo.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ’åºç®—æ³•æ€»ç»“</title>
    <link href="https://outoflovenicoo.github.io/posts/2024-06-09-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93.html"/>
    <id>https://outoflovenicoo.github.io/posts/2024-06-09-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93.html</id>
    <published>2023-10-09T10:19:03.000Z</published>
    <updated>2024-10-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="2024-06-09-æ’åºç®—æ³•æ€»ç»“/1.png" alt="1"></p><p><a href="https://leetcode.cn/problems/sort-an-array/solutions/179489/fu-xi-ji-chu-pai-xu-suan-fa-java-by-liweiwei1419">912. æ’åºæ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h1 id="1-å¿«é€Ÿæ’åº"><a href="#1-å¿«é€Ÿæ’åº" class="headerlink" title="1.å¿«é€Ÿæ’åº"></a>1.å¿«é€Ÿæ’åº</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Random</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortArray(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        quickSort(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(left&lt;right)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> partition(nums, left, right);</span><br><span class="line">            quickSort(nums, left, pivot - <span class="number">1</span>);</span><br><span class="line">            quickSort(nums, pivot + <span class="number">1</span>, right);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="comment">// éšæœºé€‰æ‹©pivotå¹¶äº¤æ¢åˆ°leftä½ç½®</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">randomIndex</span> <span class="operator">=</span> rand.nextInt(right - left + <span class="number">1</span>) + left;</span><br><span class="line">        swap(nums, left, randomIndex);</span><br><span class="line">        <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[left];</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left;</span><br><span class="line">        <span class="comment">// å¾ªç¯ä¸å˜é‡ï¼šæ¯æ¬¡çš„iç›¸å½“äºæ˜¯æŒ‡å‘&lt;pivotçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚æœ€åä¸€å®šæ˜¯pivotå·¦è¾¹éƒ½æ˜¯å°äºï¼Œå³è¾¹éƒ½æ˜¯å¤§äº</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            (left,i]å°äºpivot</span></span><br><span class="line"><span class="comment">            [j , right] å¤§äºç­‰äºpivot</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> left + <span class="number">1</span>; j &lt;= right; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &lt; pivot) &#123;</span><br><span class="line">                i++;</span><br><span class="line">                swap(nums, j, i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(nums, left, i);</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[i];</span><br><span class="line">        nums[i] = nums[j];</span><br><span class="line">        nums[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-å½’å¹¶æ’åº"><a href="#2-å½’å¹¶æ’åº" class="headerlink" title="2.å½’å¹¶æ’åº"></a>2.å½’å¹¶æ’åº</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> leetcode.com.base.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergeSort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½’å¹¶æ’åºçš„å…¥å£æ–¹æ³•ï¼Œå¯¹å¤–æä¾›æ’åºåŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortArray(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="keyword">return</span> mergeSort(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] mergeSort(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right) &#123;</span><br><span class="line">        <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">            <span class="keyword">return</span> nums;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (right + left) / <span class="number">2</span>;</span><br><span class="line">        <span class="comment">// å¯¹å·¦åŠéƒ¨åˆ†æ•°ç»„è¿›è¡Œå½’å¹¶æ’åº</span></span><br><span class="line">        mergeSort(nums, left, mid);</span><br><span class="line">        <span class="comment">// å¯¹å³åŠéƒ¨åˆ†æ•°ç»„è¿›è¡Œå½’å¹¶æ’åº</span></span><br><span class="line">        mergeSort(nums, mid + <span class="number">1</span>, right);</span><br><span class="line">        <span class="comment">// åˆå¹¶å·¦å³ä¸¤éƒ¨åˆ†å·²æ’åºå¥½çš„å­æ•°ç»„</span></span><br><span class="line">        <span class="keyword">return</span> merge(nums, left, mid, right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] merge(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> mid, <span class="type">int</span> right) &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸´æ—¶æ•°ç»„ç”¨äºå­˜æ”¾åˆå¹¶åçš„å…ƒç´ </span></span><br><span class="line">        <span class="type">int</span>[] temp = <span class="keyword">new</span> <span class="title class_">int</span>[right - left + <span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left;  <span class="comment">// å·¦å­æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> mid + <span class="number">1</span>;  <span class="comment">// å³å­æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;  <span class="comment">// ä¸´æ—¶æ•°ç»„æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] &lt;= nums[j]) &#123;</span><br><span class="line">                temp[t++] = nums[i++];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                temp[t++] = nums[j++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¤„ç†å·¦å­æ•°ç»„å‰©ä½™å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid) &#123;</span><br><span class="line">            temp[t++] = nums[i++];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¤„ç†å³å­æ•°ç»„å‰©ä½™å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (j &lt;= right) &#123;</span><br><span class="line">            temp[t++] = nums[j++];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ä¸´æ—¶æ•°ç»„ä¸­çš„å…ƒç´ å¤åˆ¶å›åŸæ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; temp.length; k++) &#123;</span><br><span class="line">            nums[left + k] = temp[k];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MergeSort</span> <span class="variable">mergeSort</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MergeSort</span>();</span><br><span class="line">        <span class="type">int</span>[] nums = &#123; <span class="number">9</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span> &#125;;</span><br><span class="line">        <span class="type">int</span>[] sortedArray = mergeSort.sortArray(nums);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : sortedArray) &#123;</span><br><span class="line">            System.out.print(num + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-å†’æ³¡æ’åºï¼š"><a href="#3-å†’æ³¡æ’åºï¼š" class="headerlink" title="3.å†’æ³¡æ’åºï¼š"></a>3.å†’æ³¡æ’åºï¼š</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> leetcode.com.base.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BubbleSort</span> &#123;</span><br><span class="line">    <span class="comment">// å†’æ³¡æ’åºï¼šè¶…æ—¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortArray(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">// å…ˆé»˜è®¤æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œåªè¦å‘ç”Ÿä¸€æ¬¡äº¤æ¢ï¼Œå°±å¿…é¡»è¿›è¡Œä¸‹ä¸€è½®æ¯”è¾ƒï¼Œ</span></span><br><span class="line">            <span class="comment">// å¦‚æœåœ¨å†…å±‚å¾ªç¯ä¸­ï¼Œéƒ½æ²¡æœ‰æ‰§è¡Œä¸€æ¬¡äº¤æ¢æ“ä½œï¼Œè¯´æ˜æ­¤æ—¶æ•°ç»„å·²ç»æ˜¯å‡åºæ•°ç»„</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">sorted</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[j] &gt; nums[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                    swap(nums, j, j + <span class="number">1</span>);</span><br><span class="line">                    sorted = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (sorted) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> index1, <span class="type">int</span> index2)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[index1];</span><br><span class="line">        nums[index1] = nums[index2];</span><br><span class="line">        nums[index2] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">BubbleSort</span> <span class="variable">bubbleSort</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BubbleSort</span>();</span><br><span class="line">        <span class="type">int</span>[] nums = &#123;<span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">2</span>&#125;;</span><br><span class="line">        <span class="type">int</span>[] sortedNums = bubbleSort.sortArray(nums);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : sortedNums) &#123;</span><br><span class="line">            System.out.print(num + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-å †æ’åº"><a href="#4-å †æ’åº" class="headerlink" title="4.å †æ’åº"></a>4.å †æ’åº</h1><h2 id="æ•°ç»„ï¼š"><a href="#æ•°ç»„ï¼š" class="headerlink" title="æ•°ç»„ï¼š"></a>æ•°ç»„ï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> leetcode.com.base.sort;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å †æ’åº</span></span><br><span class="line"><span class="comment"> * å…³é”®ï¼šä¸‹æ²‰å‡½æ•°ï¼šnum,0,len</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Make</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DATE</span>: 2024/12/18</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeapSort</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¹å¤–æš´éœ²çš„å †æ’åºæ–¹æ³•ï¼Œç”¨äºå¯¹ç»™å®šçš„æ•´æ•°æ•°ç»„è¿›è¡Œæ’åºå¹¶è¿”å›æ’åºåçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nums å¾…æ’åºçš„æ•´æ•°æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ’åºåçš„æ•´æ•°æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortArray(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="comment">// å°†æ•°ç»„æ•´ç†æˆå †</span></span><br><span class="line">        heapify(nums);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾ªç¯ä¸å˜é‡ï¼šåŒºé—´ [0, i] å †æœ‰åº</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> len - <span class="number">1</span>; i &gt;= <span class="number">1</span>; ) &#123;</span><br><span class="line">            <span class="comment">// æŠŠå †é¡¶å…ƒç´ ï¼ˆå½“å‰æœ€å¤§ï¼‰äº¤æ¢åˆ°æ•°ç»„æœ«å°¾</span></span><br><span class="line">            swap(nums, <span class="number">0</span>, i);</span><br><span class="line">            <span class="comment">// é€æ­¥å‡å°‘å †æœ‰åºçš„éƒ¨åˆ†</span></span><br><span class="line">            i--;</span><br><span class="line">            <span class="comment">// ä¸‹æ ‡ 0 ä½ç½®ä¸‹æ²‰æ“ä½œï¼Œä½¿å¾—åŒºé—´ [0, i] å †æœ‰åº</span></span><br><span class="line">            siftDown(nums, <span class="number">0</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ•°ç»„æ•´ç†æˆå †ï¼ˆå †æœ‰åºï¼‰</span></span><br><span class="line"><span class="comment">     * æ€è·¯æ˜¯ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œä»¥æ„å»ºå¤§é¡¶å †</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nums å¾…æ•´ç†æˆå †çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">heapify</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="comment">// åªéœ€è¦ä» i = (len - 1) / 2 è¿™ä¸ªä½ç½®å¼€å§‹é€å±‚ä¸‹ç§»</span></span><br><span class="line">        <span class="comment">// å› ä¸ºå®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œä» (len - 1) / 2 ä½ç½®å¾€åçš„èŠ‚ç‚¹éƒ½æ˜¯å¶å­èŠ‚ç‚¹ï¼Œæ— éœ€ä¸‹æ²‰æ“ä½œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> (len - <span class="number">1</span>) / <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">// len - 1 è¦è®°ä½</span></span><br><span class="line">            siftDown(nums, i, len - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹æ²‰æ“ä½œï¼Œç”¨äºç»´æŠ¤å †çš„æ€§è´¨ï¼ˆå¤§é¡¶å †æƒ…å†µä¸‹ï¼Œçˆ¶èŠ‚ç‚¹å¤§äºå­èŠ‚ç‚¹ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nums æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> k    å½“å‰ä¸‹æ²‰å…ƒç´ çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end  [0, end] æ˜¯ nums çš„æœ‰æ•ˆéƒ¨åˆ†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftDown</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k, <span class="type">int</span> end)</span> &#123;</span><br><span class="line">        <span class="comment">// å½“å‰èŠ‚ç‚¹ï¼ˆä¸‹æ ‡ä¸ºkï¼‰è‡³å°‘æœ‰å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">2</span> * k + <span class="number">1</span> &lt;= end) &#123;</span><br><span class="line">            <span class="comment">// å·¦å­èŠ‚ç‚¹ä¸‹æ ‡j = 2 * k + 1</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">2</span> * k + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å³å­èŠ‚ç‚¹ï¼ˆä¸‹æ ‡ä¸ºj + 1ï¼‰æ˜¯å¦å­˜åœ¨ä¸”æ¯”å·¦å­èŠ‚ç‚¹å¤§</span></span><br><span class="line">            <span class="keyword">if</span> (j + <span class="number">1</span> &lt;= end &amp;&amp; nums[j + <span class="number">1</span>] &gt; nums[j]) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ˜¯ï¼Œåˆ™è®©jæŒ‡å‘å³å­èŠ‚ç‚¹ï¼ˆå› ä¸ºè¦æ‰¾å­èŠ‚ç‚¹ä¸­çš„è¾ƒå¤§å€¼ä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼‰</span></span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœå­èŠ‚ç‚¹å€¼å¤§äºå½“å‰èŠ‚ç‚¹å€¼ï¼Œå°±è°ƒç”¨swapæ–¹æ³•äº¤æ¢å®ƒä»¬çš„ä½ç½®</span></span><br><span class="line">            <span class="keyword">if</span> (nums[j] &gt; nums[k]) &#123;</span><br><span class="line">                swap(nums, j, k);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// äº¤æ¢å®Œä¸‹æ²‰</span></span><br><span class="line">            k = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº¤æ¢æ•°ç»„ä¸­ä¸¤ä¸ªæŒ‡å®šä¸‹æ ‡çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nums   æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index1 è¦äº¤æ¢çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index2 è¦äº¤æ¢çš„ç¬¬äºŒä¸ªå…ƒç´ ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> index1, <span class="type">int</span> index2)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[index1];</span><br><span class="line">        nums[index1] = nums[index2];</span><br><span class="line">        nums[index2] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HeapSort</span> <span class="variable">heapSort</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HeapSort</span>();</span><br><span class="line">        <span class="type">int</span>[] nums = &#123; <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span> &#125;;</span><br><span class="line">        <span class="type">int</span>[] sortedNums = heapSort.sortArray(nums);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : sortedNums) &#123;</span><br><span class="line">            System.out.print(num + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼˜å…ˆé˜Ÿåˆ—ï¼š"><a href="#ä¼˜å…ˆé˜Ÿåˆ—ï¼š" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—ï¼š"></a>ä¼˜å…ˆé˜Ÿåˆ—ï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> leetcode.com.base.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeapSortWithPriorityQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—å®ç°å †æ’åºçš„æ–¹æ³•ï¼Œå¯¹ç»™å®šæ•´æ•°æ•°ç»„è¿›è¡Œæ’åºå¹¶è¿”å›æ’åºåçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nums å¾…æ’åºçš„æ•´æ•°æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ’åºåçš„æ•´æ•°æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] sortArray(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        PriorityQueue&lt;Integer&gt; priorityQueue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// å°†æ•°ç»„å…ƒç´ ä¾æ¬¡æ·»åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            priorityQueue.add(num);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span>[] sortedNums = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// ä¾æ¬¡ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºå…ƒç´ ï¼Œæ”¾å…¥æ–°æ•°ç»„ä¸­ï¼Œæ­¤æ—¶å–å‡ºçš„å…ƒç´ å°±æ˜¯æŒ‰ç…§ä»å°åˆ°å¤§é¡ºåºçš„</span></span><br><span class="line">        <span class="keyword">while</span> (!priorityQueue.isEmpty()) &#123;</span><br><span class="line">            sortedNums[index++] = priorityQueue.poll();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sortedNums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] nums = &#123;<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>&#125;;</span><br><span class="line">        <span class="type">int</span>[] sortedNums = sortArray(nums);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : sortedNums) &#123;</span><br><span class="line">            System.out.print(num + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬äººçš„æ’åºç®—æ³•æ€»ç»“</summary>
    
    
    
    <category term="åˆ·é¢˜" scheme="https://outoflovenicoo.github.io/categories/%E5%88%B7%E9%A2%98/"/>
    
    
    <category term="æ’åºç®—æ³•" scheme="https://outoflovenicoo.github.io/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
</feed>
