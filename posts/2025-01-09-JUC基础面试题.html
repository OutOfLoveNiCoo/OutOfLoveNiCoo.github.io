<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JUCåŸºç¡€é¢è¯•é¢˜ | OutOfLoveğŸ¥</title><meta name="keywords" content="JUC"><meta name="author" content="OutOfLoveğŸ¥"><meta name="copyright" content="OutOfLoveğŸ¥"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="ğŸ¥§æœ¬äººçš„JUCåŸºç¡€é¢è¯•æ€»ç»“">
<meta property="og:type" content="article">
<meta property="og:title" content="JUCåŸºç¡€é¢è¯•é¢˜">
<meta property="og:url" content="https://outoflovenicoo.github.io/posts/2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html">
<meta property="og:site_name" content="OutOfLoveğŸ¥">
<meta property="og:description" content="ğŸ¥§æœ¬äººçš„JUCåŸºç¡€é¢è¯•æ€»ç»“">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://source.fomal.cc/img/default_cover_15.webp">
<meta property="article:published_time" content="2025-01-09T10:19:03.000Z">
<meta property="article:modified_time" content="2025-03-23T14:00:00.000Z">
<meta property="article:author" content="OutOfLoveğŸ¥">
<meta property="article:tag" content="JUC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://source.fomal.cc/img/default_cover_15.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://outoflovenicoo.github.io/posts/2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JUCåŸºç¡€é¢è¯•é¢˜',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-23 22:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="OutOfLoveğŸ¥" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/02/avatar.webp" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">OutOfLoveğŸ¥</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">JUCåŸºç¡€é¢è¯•é¢˜</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº </span><time class="post-meta-date-created" datetime="2025-01-09T10:19:03.000Z" title="å‘è¡¨äº 2025-01-09 18:19:03">2025-01-09</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-03-23T14:00:00.000Z" title="æ›´æ–°äº 2025-03-23 22:00:00">2025-03-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/">é¢è¯•é¢˜</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">2.2w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>68åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JUCåŸºç¡€é¢è¯•é¢˜"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>å­¦ä¹ </h1>
<h2 id="1-Future">1.Future</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://javaguide.cn/java/concurrent/java-concurrent-questions-03.html#future-%E7%B1%BB%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8">Future ç±»æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904199625375757">Javaæ˜¯å¦‚ä½•å®ç°Futureæ¨¡å¼çš„?ä¸‡å­—è¯¦è§£!</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/diagram.png" alt=""></p>
<h2 id="ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•">ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DaHuoGuo.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DaHuoGuo</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Callable</span>&lt;String&gt;() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span> + <span class="string">&quot;å¼€å§‹çƒ§å¼€æ°´...&quot;</span>);</span><br><span class="line">                                <span class="comment">// æ¨¡æ‹Ÿçƒ§å¼€æ°´è€—æ—¶</span></span><br><span class="line">                                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot;å¼€æ°´å·²ç»çƒ§å¥½äº†...&quot;</span>);</span><br><span class="line">                                <span class="keyword">return</span> <span class="string">&quot;å¼€æ°´&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask);</span><br><span class="line">                thread.start();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// do other thing</span></span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot; æ­¤æ—¶å¼€å¯äº†ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œfutureçš„é€»è¾‘ï¼ˆçƒ§å¼€æ°´ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¹²ç‚¹åˆ«çš„äº‹æƒ…ï¼ˆæ¯”å¦‚å‡†å¤‡ç«é”…é£Ÿæï¼‰...&quot;</span>);</span><br><span class="line">                <span class="comment">// æ¨¡æ‹Ÿå‡†å¤‡ç«é”…é£Ÿæè€—æ—¶</span></span><br><span class="line">                Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + <span class="string">&quot;ç«é”…é£Ÿæå‡†å¤‡å¥½äº†&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">shicai</span> <span class="operator">=</span> <span class="string">&quot;ç«é”…é£Ÿæ&quot;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¼€æ°´å·²ç»ç¨å¥½ï¼Œæˆ‘ä»¬å–å¾—çƒ§å¥½çš„å¼€æ°´</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">boilWater</span> <span class="operator">=</span> futureTask.get();</span><br><span class="line"></span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;:&quot;</span>  + boilWater + <span class="string">&quot;å’Œ&quot;</span> + shicai + <span class="string">&quot;å·²ç»å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ‰“ç«é”…å•¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•">ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•</h2>
<p>è§ä»£ç CFUser</p>
<p>åŸç†ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://mcnfxurl5vzo.feishu.cn/wiki/Lp6uws3rFiEDjXkkyGGchQWQnVH#share-YTvbd2a9qoU8qRx7RU4cl8kencd"> åšå®¢</a></p>
<hr>
<h1>é¢è¯•é¢˜ç›®</h1>
<h2 id="å¹¶å‘åŸºç¡€">å¹¶å‘åŸºç¡€</h2>
<h3 id="1-çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬">1.çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-6.png" alt=""></p>
<h3 id="2-Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼">2.Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image.png" alt=""></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/longshengguoji/article/details/41126119">javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼åŠå…¶å¯¹æ¯”_åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼-CSDNåšå®¢</a></p>
<h3 id="3-â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•">3. â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•</h3>
<p><strong>è°ƒç”¨start()æ–¹æ³•ä¼šå‘Šè¯‰jvmåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹</strong>ï¼Œå¹¶åœ¨è¿™ä¸ªæ–°çº¿ç¨‹ä¸­æ‰§è¡Œä¸run()æ–¹æ³•ç›¸å…³è”çš„ä»£ç å—ã€‚è¿™ä¸ªè¿‡ç¨‹å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥åœ¨äº’ä¸ç›¸å¹²çš„æƒ…å†µä¸‹æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>ä¸æ­¤ä¸åŒï¼Œ<strong>å¦‚æœç›´æ¥è°ƒç”¨run()æ–¹æ³•</strong>ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è°ƒç”¨ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ç›¸åï¼Œå®ƒä¼šåœ¨å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œrun()æ–¹æ³•ä¸­çš„ä»£ç ã€‚è¿™å°†å¯¼è‡´ä»£ç çš„é¡ºåºæ‰§è¡Œï¼Œæ²¡æœ‰å¹¶è¡Œæ€§å¯è¨€ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…æ‰§è¡Œã€‚</p>
<p>è¿™ç§åŒºåˆ«éå¸¸é‡è¦ï¼Œå› ä¸ºå¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¸€ä¸ªä¸»è¦ç›®æ ‡æ˜¯å®ç°å¹¶è¡Œæ€§ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ€§èƒ½å’Œå“åº”èƒ½åŠ›ã€‚é€šè¿‡è°ƒç”¨start()æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œä»¥æ›´æœ‰æ•ˆåœ°å®Œæˆä»»åŠ¡ã€‚è€Œç›´æ¥è°ƒç”¨run()æ–¹æ³•åªæ˜¯æŒ‰ç…§ä¸€èˆ¬çš„æ–¹æ³•é¡ºåºæ‰§è¡Œä»£ç ï¼Œæ— æ³•å‘æŒ¥å¤šçº¿ç¨‹çš„æ½œåŠ›ã€‚å› æ­¤ï¼Œä½¿ç”¨start()æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹æ˜¯å®ç°å¹¶è¡Œæ€§çš„å…³é”®ã€‚ </p>
<h3 id="4-wait-ã€notify-å’Œ-notifyAll-ã€sleep-ã€yield">4. wait()ã€notify()å’Œ notifyAll()ã€sleep()ã€yield()</h3>
<ul>
<li>
<p>sleepæ˜¯è®©çº¿ç¨‹è‡ªå·±æ‹¿ç€é”ä¼‘çœ ï¼Œä½†æ˜¯ä¸é‡Šæ”¾é”ï¼Œæš‚åœçº¿ç¨‹çš„æ‰§è¡Œ</p>
</li>
<li>
<p>waitæ˜¯Açº¿ç¨‹é€šè¿‡å¯¹è±¡çš„æ–¹æ³•æ¥é‡Šæ”¾è‡ªå·±æŒæœ‰çš„è¯¥å¯¹è±¡çš„é”,å¹¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚Javaä¸­æ¯ä¸€ä¸ªå¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªç›‘è§†å™¨é”ï¼Œwaitæ–¹æ³•æ˜¯å½“å‰æŒæœ‰é”çš„çº¿ç¨‹ ã€ä¸»åŠ¨ã€‘ æ”¾å¼ƒé”å¹¶ç­‰å¾…ï¼›wait ä¸æ˜¯ç­‰é”ï¼Œè€Œæ˜¯ç­‰ä¸€ä¸ªæ¡ä»¶ï¼Œè¿™ä¸ªæ¡ä»¶è¦å˜›æ˜¯å®šæ—¶æ—¶é—´åˆ°äº†ï¼Œè¦å˜›æ˜¯åˆ«äººnotifyã€‚ç­‰åˆ°æ¡ä»¶æ»¡è¶³ä¹‹åï¼Œæ‰æœ‰èµ„æ ¼å»ç«äº‰é”ï¼Œåç»­å°±èµ°æ­£å¸¸é”ç«äº‰æµç¨‹äº†ã€‚  ä¾‹å¦‚Bæ²¡æœ‰é‡Šæ”¾ï¼Œé‚£ç¡®å®å¾—ç­‰Bç”¨å®Œé‡Šæ”¾äº†æ‰èƒ½è·å–åˆ°é”ã€‚</p>
</li>
<li>
<p><code>notifyAll()</code>ï¼šä¼šå”¤é†’æ‰€æœ‰åœ¨è¯¥å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p><code>notify()</code>ï¼šåªä¼šéšæœºå”¤é†’ä¸€ä¸ªåœ¨è¯¥å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>yield()æ–¹æ³•åªä¼šç»™ç›¸åŒä¼˜å…ˆçº§æˆ–æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼›sleep()æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼› çº¿ç¨‹æ‰§è¡Œ sleep()æ–¹æ³•åè½¬å…¥é˜»å¡ï¼ˆè¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼‰ï¼Œè€Œæ‰§è¡Œ yield()æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼›æ‰©å±•ï¼š</p>
</li>
</ul>
<p>ä¸ºä»€ä¹ˆwait()ã€notify()å’Œ notifyAll()è¦å®šä¹‰åœ¨ç±»é‡Œ</p>
<p>å¯¹è±¡æ‰æ˜¯å…±äº«èµ„æºçš„å•ä½ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯èƒ½æˆä¸ºå…±äº«èµ„æºï¼Œwaitæ–¹æ³•å®šä¹‰åœ¨Objectä¸­æ˜¯ä¸ºäº†è®©æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥æ–¹ä¾¿çš„å…±äº«ã€‚</p>
<p>ä¸ºä»€ä¹ˆ wait(), notify()å’Œ notifyAll()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</p>
<p>å…±äº«èµ„æºæ—¶ä¸éœ€è¦å…³æ³¨çº¿ç¨‹ï¼Œå¯¹è±¡æ‰æ˜¯éœ€è¦äº’æ–¥è®¿é—®çš„èµ„æºï¼Œå› æ­¤å¯¹è±¡çš„wait()æ–¹æ³•å¿…é¡»åœ¨æŒæœ‰é”ä¹‹åè°ƒç”¨ï¼›</p>
<p>åŒç†ï¼Œnotify()æ–¹æ³•ä¹Ÿå¿…é¡»åœ¨æŒæœ‰é”ä¹‹åè°ƒç”¨ï¼Œç±»ä¼¼äºå‘Šè¯‰åˆ«äººæˆ‘é©¬ä¸Šç”¨å®Œäº†ï¼Œä½ å¯ä»¥è¿‡æ¥æ’é˜Ÿç­‰ç€</p>
<p>å¾ˆå°‘éœ€è¦ç›´æ¥æ§åˆ¶ä¸€ä¸ªçº¿ç¨‹çš„ç­‰å¾…çŠ¶æ€ï¼Œä¸»è¦è¿˜æ˜¯ç­‰å¾…å…±äº«èµ„æºçš„è®¿é—®æƒï¼Œç›¸æ¯”æ§åˆ¶çº¿ç¨‹æœ¬èº«ï¼Œæ§åˆ¶èµ„æºè®¿é—®æƒé™æ›´ç¬¦åˆç›´è§‰ã€‚</p>
<h3 id="5-Java-ä¸­-interrupted-å’Œ-isInterrupted-æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ">5.Java ä¸­ interrupted å’Œ isInterrupted æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h3>
<blockquote>
<p>interruptï¼šç”¨äºä¸­æ–­çº¿ç¨‹ã€‚è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹çš„çŠ¶æ€ä¸ºå°†è¢«ç½®ä¸ºâ€ä¸­æ–­â€çŠ¶æ€ã€‚</p>
<p> æ³¨æ„ï¼šçº¿ç¨‹ä¸­æ–­ä»…ä»…æ˜¯ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä½ï¼Œä¸ä¼šåœæ­¢çº¿ç¨‹ã€‚éœ€è¦ç”¨æˆ·è‡ªå·±å»ç›‘è§†çº¿ç¨‹çš„çŠ¶æ€ä¸ºå¹¶åšå¤„ç†ã€‚æ”¯æŒçº¿ç¨‹ä¸­æ–­çš„æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­æ–­åä¼šæŠ›å‡ºinterruptedException çš„æ–¹æ³•ï¼‰å°±æ˜¯åœ¨ç›‘è§†çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œä¸€æ—¦çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«ç½®ä¸ºâ€œä¸­æ–­çŠ¶æ€â€ï¼Œå°±ä¼šæŠ›å‡ºä¸­æ–­å¼‚å¸¸ã€‚</p>
<p> interruptedï¼šæ˜¯é™æ€æ–¹æ³•ï¼ŒæŸ¥çœ‹å½“å‰ä¸­æ–­ä¿¡å·æ˜¯trueè¿˜æ˜¯falseå¹¶ä¸”æ¸…é™¤ä¸­æ–­ä¿¡å·ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹è¢«ä¸­æ–­äº†ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ interrupted åˆ™è¿”å› trueï¼Œç¬¬äºŒæ¬¡å’Œåé¢çš„å°±è¿”å› false äº†ã€‚</p>
<p>isInterruptedï¼šæ˜¯å¯ä»¥è¿”å›å½“å‰ä¸­æ–­ä¿¡å·æ˜¯trueè¿˜æ˜¯falseï¼Œä¸interruptedæœ€å¤§çš„å·®åˆ«æ˜¯ï¼ŒisInterruputedä¸ä¼šæ¸…é™¤ä¸­æ–­ä¿¡å·ï¼Œè€Œinterruptedä¼šæ¸…é™¤ä¸­æ–­ä¿¡å·â€œã€‚</p>
</blockquote>
<h3 id="6-åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©">6. åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>åŒæ­¥å—æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥è®©å®ƒé”ä½æ•´ä¸ªå¯¹è±¡ï¼‰ã€‚åŒæ­¥æ–¹æ³•ä¼šé”ä½æ•´ä¸ªå¯¹è±¡ï¼Œå“ªæ€•è¿™ä¸ªç±»ä¸­æœ‰å¤šä¸ªä¸ç›¸å…³è”çš„åŒæ­¥å—ï¼Œé€šå¸¸ä¼šå¯¼è‡´å®ƒä»¬åœæ­¢æ‰§è¡Œå¹¶éœ€è¦ç­‰å¾…è·å¾—è¿™ä¸ªå¯¹è±¡ä¸Šçš„é”ã€‚</p>
</li>
<li>
<p>åŒæ­¥å—æ›´ç¬¦åˆå¼€æ”¾è°ƒç”¨çš„åŸåˆ™ï¼Œåªåœ¨éœ€è¦é”ä½çš„ä»£ç å—é”ä½ç›¸åº”çš„å¯¹è±¡ï¼Œè¿™æ ·ä»ä¾§é¢æ¥è¯´ä¹Ÿå¯ä»¥é¿å…æ­»é”ã€‚</p>
</li>
</ul>
<p>è¯·çŸ¥é“ä¸€æ¡åŸåˆ™ï¼šåŒæ­¥çš„èŒƒå›´è¶Šå°è¶Šå¥½ã€‚ </p>
<h3 id="7-ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ">7.ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ</h3>
<p><strong>å®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•</strong></p>
<ul>
<li>
<p>åŒæ­¥ä»£ç æ–¹æ³•ï¼šsynchronizedå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•</p>
</li>
<li>
<p>åŒæ­¥ä»£ç å—ï¼šsynchronizedå…³é”®å­—ä¿®é¥°çš„ä»£ç å—</p>
</li>
<li>
<p>ä½¿ç”¨ç‰¹æ®Šå˜é‡åŸŸvolatileå®ç°çº¿ç¨‹åŒæ­¥ï¼švolatileå…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶</p>
</li>
<li>
<p>ä½¿ç”¨é‡å…¥é”å®ç°çº¿ç¨‹åŒæ­¥ï¼šreentrantlockç±»æ˜¯å¯é‡å…¥ã€äº’æ–¥ã€å®ç°äº†lockæ¥å£çš„é”ï¼Œå®ƒä¸synchronizedæ–¹æ³•å…·æœ‰ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰ </p>
</li>
</ul>
<h3 id="8-åœ¨ç›‘è§†å™¨-Monitor-å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ">8.åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ</h3>
<blockquote>
<p>åœ¨ java è™šæ‹Ÿæœºä¸­ï¼Œç›‘è§†å™¨å’Œé”åœ¨Javaè™šæ‹Ÿæœºä¸­æ˜¯ä¸€å—ä½¿ç”¨çš„ã€‚ç›‘è§†å™¨ç›‘è§†ä¸€å—åŒæ­¥ä»£ç å—ï¼Œç¡®ä¿ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ã€‚æ¯ä¸€ä¸ªç›‘è§†å™¨éƒ½å’Œä¸€ä¸ªå¯¹è±¡å¼•ç”¨ç›¸å…³è”ã€‚çº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡ŒåŒæ­¥ä»£ç ã€‚ </p>
<p>ä¸€æ—¦æ–¹æ³•æˆ–è€…ä»£ç å—è¢« synchronized ä¿®é¥°ï¼Œé‚£ä¹ˆè¿™ä¸ªéƒ¨åˆ†å°±æ”¾å…¥äº†ç›‘è§†å™¨çš„ç›‘è§†åŒºåŸŸï¼Œç¡®ä¿ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç ï¼Œçº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡Œè¯¥éƒ¨åˆ†çš„ä»£ç </p>
<p>å¦å¤– java è¿˜æä¾›äº†æ˜¾å¼ç›‘è§†å™¨( Lock )å’Œéšå¼ç›‘è§†å™¨( synchronized )ä¸¤ç§é”æ–¹æ¡ˆ</p>
</blockquote>
<h3 id="9-å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ">9.å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</h3>
<blockquote>
<p>æœ‰ä¿©ç§å¯èƒ½ï¼š</p>
<ul>
<li>(1) å¦‚æœä½¿ç”¨çš„æ˜¯æ— ç•Œé˜Ÿåˆ—</li>
</ul>
<p>LinkedBlockingQueueï¼Œä¹Ÿå°±æ˜¯æ— ç•Œé˜Ÿåˆ—çš„è¯ï¼Œæ²¡å…³ç³»ï¼Œç»§ç»­æ·»åŠ ä»»åŠ¡åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼Œå› ä¸ºLinkedBlockingQueueå¯ä»¥è¿‘ä¹è®¤ä¸ºæ˜¯ä¸€ä¸ªæ— ç©·å¤§çš„é˜Ÿåˆ—ï¼Œå¯ä»¥æ— é™å­˜æ”¾ä»»åŠ¡ã€‚</p>
<ul>
<li>(2) å¦‚æœä½¿ç”¨çš„æ˜¯æœ‰ç•Œé˜Ÿåˆ—æ¯”å¦‚</li>
</ul>
<p>ArrayBlockingQueueï¼Œä»»åŠ¡é¦–å…ˆä¼šè¢«æ·»åŠ åˆ°ArrayBlockingQueueä¸­ï¼ŒArrayBlockingQueueæ»¡äº†ï¼Œä¼šæ ¹æ®maximumPoolSizeçš„å€¼å¢åŠ çº¿ç¨‹æ•°é‡ï¼Œå¦‚æœå¢åŠ äº†çº¿ç¨‹æ•°é‡è¿˜æ˜¯å¤„ç†ä¸è¿‡æ¥ï¼ŒArrayBlockingQueueç»§ç»­æ»¡ï¼Œé‚£ä¹ˆåˆ™ä¼šä½¿ç”¨æ‹’ç»ç­–ç•¥RejectedExecutionHandlerå¤„ç†æ»¡äº†çš„ä»»åŠ¡ï¼Œé»˜è®¤æ˜¯AbortPolicy </p>
</blockquote>
<h3 id="10-åœ¨-Java-ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ">10.åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ</h3>
<blockquote>
<p><strong>æ–¹æ³•ä¸€</strong>ï¼šä½¿ç”¨å®‰å…¨ç±»ï¼Œæ¯”å¦‚java.util.concurrentä¸‹çš„ç±»ï¼Œä½¿ç”¨åŸå­ç±»AtomicInteger</p>
<p><strong>æ–¹æ³•äºŒ</strong>ï¼šä½¿ç”¨è‡ªåŠ¨é”synchronizedã€‚</p>
<p><strong>æ–¹æ³•ä¸‰</strong>ï¼šä½¿ç”¨æ‰‹åŠ¨é”Lockã€‚æ‰‹åŠ¨é”Javaç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  Lock lock = new ReentrantLock();</span><br><span class="line">  lock.lock();</span><br><span class="line">  try &#123;</span><br><span class="line">      System.out.println(&quot;è·å¾—é”&quot;);</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">      // TODO: handle exception</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">     System.out.println(&quot;é‡Šæ”¾é”&quot;);</span><br><span class="line">      lock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="11-çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„">11.çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„</h3>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸åˆé’»å’Œç‹¡çŒ¾çš„é—®é¢˜ã€‚è¯·è®°ä½ï¼šçº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«newè¿™ä¸ªçº¿ç¨‹ç±»æ‰€åœ¨çš„çº¿ç¨‹æ‰€è°ƒç”¨çš„ï¼Œè€Œrunæ–¹æ³•é‡Œé¢çš„ä»£ç æ‰æ˜¯è¢«çº¿ç¨‹è‡ªèº«æ‰€è°ƒç”¨çš„ã€‚</p>
<p>å¦‚æœè¯´ä¸Šé¢çš„è¯´æ³•è®©ä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œé‚£ä¹ˆæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾Thread2ä¸­newäº†Thread1ï¼Œmainå‡½æ•°ä¸­newäº†Thread2ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>
<p>(1) Thread2çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯mainçº¿ç¨‹è°ƒç”¨çš„ï¼ŒThread2çš„run()æ–¹æ³•æ˜¯Thread2è‡ªå·±è°ƒç”¨çš„</p>
</li>
<li>
<p>(2) Thread1çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯Thread2è°ƒç”¨çš„ï¼ŒThread1çš„run()æ–¹æ³•æ˜¯Thread1è‡ªå·±è°ƒç”¨çš„ </p>
</li>
</ul>
</blockquote>
<h3 id="12-Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ">12. Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>Dumpæ–‡ä»¶æ˜¯è¿›ç¨‹çš„å†…å­˜é•œåƒã€‚å¯ä»¥æŠŠç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€é€šè¿‡è°ƒè¯•å™¨ä¿å­˜åˆ°dumpæ–‡ä»¶ä¸­ã€‚</p>
<p>åœ¨Linuxä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤jstack -l PIDï¼ˆJavaè¿›ç¨‹çš„è¿›ç¨‹IDï¼‰æ¥è·å–Javaåº”ç”¨çš„dumpæ–‡ä»¶ã€‚</p>
<p>åœ¨Windowsä¸‹ï¼Œä½ å¯ä»¥æŒ‰ä¸‹Ctrl + Breakæ¥è·å–ï¼Œè¿™æ ·JVMå°±ä¼šå°†çº¿ç¨‹çš„dumpæ–‡ä»¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºæˆ–é”™è¯¯æ–‡ä»¶ä¸­ï¼Œå®ƒå¯èƒ½æ‰“å°åœ¨æ§åˆ¶å°æˆ–è€…æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå…·ä½“ä½ç½®ä¾èµ–åº”ç”¨çš„é…ç½®ã€‚</p>
</blockquote>
<h3 id="13-ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ">13. ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<p>å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«æ•è·è¯¥çº¿ç¨‹å°†ä¼šåœæ­¢æ‰§è¡Œã€‚</p>
<p>Thread.UncaughtExceptionHandleræ˜¯ç”¨äºå¤„ç†æœªæ•è·å¼‚å¸¸é€ æˆçº¿ç¨‹çªç„¶ä¸­æ–­æƒ…å†µçš„ä¸€ä¸ªå†…åµŒæ¥å£ã€‚å½“ä¸€ä¸ªæœªæ•è·å¼‚å¸¸å°†é€ æˆçº¿ç¨‹ä¸­æ–­çš„æ—¶å€™ï¼ŒJVMä¼šä½¿ç”¨Thread.getUncaughtExceptionHandler()æ¥æŸ¥è¯¢çº¿ç¨‹çš„UncaughtExceptionHandlerï¼Œå¹¶å°†çº¿ç¨‹å’Œå¼‚å¸¸ä½œä¸ºå‚æ•°ä¼ é€’ç»™handlerçš„uncaughtException()æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚ </p>
</blockquote>
<h3 id="14-å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•">14.å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</h3>
<table>
<thead>
<tr>
<th>æ–¹æ³•å</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>sleep()isAlive()join()activeCount()enumerate()currentThread()isDaemon()setDaemon()setName()wait()notify()setPriority()</td>
<td>å¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç¡çœ Næ¯«ç§’åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å­˜æ´»ã€‚ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ã€‚ç¨‹åºä¸­æ´»è·ƒçš„çº¿ç¨‹æ•°ã€‚æšä¸¾ç¨‹åºä¸­çš„çº¿ç¨‹ã€‚å¾—åˆ°å½“å‰çº¿ç¨‹ã€‚ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚ä¸ºçº¿ç¨‹è®¾ç½®ä¸€ä¸ªåç§°ã€‚å¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ã€‚é€šçŸ¥ä¸€ä¸ªçº¿ç¨‹ç»§ç»­è¿è¡Œã€‚è®¾ç½®ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="15-â“ä»‹ç»ä¸€ä¸‹-ThreadLocal">15.â“ä»‹ç»ä¸€ä¸‹ ThreadLocal</h3>
<blockquote>
<p>Threadç±»æœ‰ä¸¤ä¸ªå˜é‡ï¼šthreadLocalså’ŒinheritableThreadLocalsã€‚</p>
<p>è¿™ä¸¤ä¸ªå˜é‡é»˜è®¤ä¸ºnullï¼Œåªæœ‰å½“è¯¥çº¿ç¨‹è°ƒç”¨äº†ThreadLocalç±»çš„get/setæ–¹æ³•æ—¶æ‰ä¼šåˆ›å»ºä»–ä»¬ï¼Œè€Œè°ƒç”¨ThreadLocalçš„get/setå®é™…ä¸Šæ˜¯è°ƒç”¨ThreadLocalMapçš„get/setã€‚</p>
<p>ThreadLocalMapå¯ç†è§£æˆç»™ThreadLocalå®šåˆ¶åŒ–çš„HashMapã€‚</p>
<p>æœ€ç»ˆçš„å˜é‡æ”¾åœ¨äº†çº¿ç¨‹çš„ThreadLocalMapä¸­ï¼Œè€Œä¸æ˜¯ThreadLocalä¸­ï¼ŒThreadLocalåªæ˜¯å¯¹å…¶è¿›è¡Œå°è£…ï¼Œå‘å…¶ä¼ é€’å˜é‡å€¼ã€‚</p>
<p>ç”¨ä¸€ä¸ªåœºæ™¯åˆ†æThreadLocalçš„get/setæµç¨‹ï¼š</p>
<p>é¦–å…ˆåœ¨æ‰€æœ‰çº¿ç¨‹å¤–éƒ¨åˆ›å»ºä¸€ä¸ªå…±äº«çš„ThreadLocalå¯¹è±¡ï¼Œè®°ä¸ºTL1ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨TL1.get()æ—¶ï¼Œé¦–å…ˆè·å–åˆ°å½“å‰çº¿ç¨‹å¯¹è±¡ï¼Œè®°ä¸ºtï¼Œç„¶ååˆ¤æ–­t.threadLocalsæ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œå°±åœ¨tä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadLocalMapå¯¹è±¡èµ‹å€¼ç»™t.threadLocalsï¼Œå¹¶å°†&lt;TL1,null&gt;æ’å…¥å…¶ä¸­ï¼Œæœ€ågetæ–¹æ³•è¿”å›nullï¼›å¦‚æœä¸ä¸ºnullï¼Œåˆ™å°è¯•è·å–threadLocalsä¸­TL1æ‰€åœ¨çš„é”®å€¼å¯¹ï¼Œå¦‚æœè¯¥é”®å€¼å¯¹ä¸ºnullï¼Œåˆ™å‘threadLocalsä¸­é€šè¿‡setæ–¹æ³•æ’å…¥&lt;TL1,null&gt;ï¼Œæœ€åè¿”å›nullï¼Œå¦‚æœé”®å€¼å¯¹ä¸ä¸ºnullï¼Œåˆ™è¿”å›é”®å€¼å¯¹ä¸­çš„å€¼ã€‚</p>
<p>è°ƒç”¨setæ–¹æ³•æ—¶ï¼Œæµç¨‹å’ŒgetåŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ä»è¯»å˜æˆäº†å†™ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥å®ç°ä¸åŒçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªThreadLocalï¼ˆTL1ï¼‰èƒ½æ‹¿åˆ°å„è‡ªå‘å…¶ä¸­å­˜æ”¾çš„å€¼ã€‚ </p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-5.png" alt=""></p>
<h3 id="16-ThreadLocal-å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—">16.ThreadLocal å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-3.png" alt=""></p>
<p><strong>åˆ†æ</strong></p>
<p>ThreadLocal å†…å­˜æ³„éœ²ä¹Ÿæ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜äº†ï¼Œç½‘ä¸Šéƒ¨åˆ†èµ„æ–™ï¼ŒåŒ…æ‹¬å¥½å¤šé¢è¯•å®˜éƒ½æŠŠè¿™ä¸ªé—®é¢˜å‡ºç°çš„ä¸»è¦åŸå› å½’ç»“ä¸º ThreadLocalMaps é‡Œ Entry Keyï¼ˆThreadLocal å¯¹è±¡æœ¬èº«ï¼‰ä½¿ç”¨äº†å¼±å¼•ç”¨å¯¼è‡´çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä»”ç»†çœ‹çœ‹å¼•ç”¨ç»“æ„ï¼Œè„‘è¡¥ä¸€ä¸‹å†…å­˜æ³„éœ²çš„åœºæ™¯å°±ä¸éš¾å‘ç°ï¼ŒçœŸæ­£å¯¼è‡´å†…å­˜æ³„éœ²çš„ä¸»è¦åŸå› ï¼Œå…¶å®æ˜¯ Thread å¼ºå¼•ç”¨ ThreadLocalMapsï¼Œå¦‚æœ Thread ä¸€ç›´å­˜åœ¨ï¼ŒThreadLocalMaps Entry ä¸­çš„ value è¿™ä¸ªå¼ºå¼•ç”¨ä¸€ç›´å­˜åœ¨ï¼Œä¸è¢«å›æ”¶æ‰æ˜¯å¯¼è‡´å‘ç”Ÿå†…å­˜æ³„éœ²çš„çœŸæ­£åŸå› </p>
<blockquote>
<p>å› ä¸º ThreadLocal æœ¬èº«ä¸å­˜å‚¨å¯¹è±¡ï¼Œæ˜¯è°ƒç”¨ Thread ä¸­çš„ ThreadLocalMaps æ¥ä¿å­˜ï¼Œè€Œ Thread å¼ºå¼•ç”¨ ThreadLocalMaps å¯¹è±¡ï¼Œå¦‚æœ Thread å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿ï¼Œä¸èƒ½åŠæ—¶è¢«å›æ”¶ï¼Œå°±ä¼šå¯¼è‡´ ThreadLocalMaps å¯¹è±¡é‡Œ Entry çš„ value å­˜åœ¨å†…å­˜æ³„éœ²çš„å¯èƒ½ã€‚</p>
<p>å½“ç„¶ ThreadLocalMaps åœ¨è®¾è®¡çš„æ—¶å€™ä¹Ÿè€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ ThreadLocalMaps Key é‡‡ç”¨äº†å¼±å¼•ç”¨çš„æ–¹å¼ï¼Œå¹¶ä¸”åœ¨ setã€removeã€rehash çš„æ—¶å€™ä¼šä¸»åŠ¨æ¸…ç† ThreadLocalMaps ä¸­ Key ä¸º Null çš„ valueï¼Œä½†æ˜¯å¦‚æœ ThreadLocal å·²ç»ä¸è¢«ä½¿ç”¨äº† setã€removeã€rehash æ–¹æ³•ä¹Ÿä¸ä¼šè¢«è°ƒç”¨ï¼Œä¸æ­¤åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªçº¿ç¨‹åˆä¸€ç›´å­˜æ´»ã€ä¸ç»ˆæ­¢çš„è¯ï¼Œé‚£ä¹ˆä¸€ThreadLocalMaps ä¸­çš„ Value å¼ºå¼•ç”¨å°±ä¼šä¸€ç›´å­˜åœ¨ï¼Œä¹Ÿå°±é¿å…ä¸äº† Value çš„å†…å­˜æ³„æ¼</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%2078%20%E8%AE%B2-%E5%AE%8C/47%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E2%80%94%E2%80%94%E4%B8%BA%E4%BD%95%E6%AF%8F%E6%AC%A1%E7%94%A8%E5%AE%8C%20ThreadLocal%20%E9%83%BD%E8%A6%81%E8%B0%83%E7%94%A8%20remove()%EF%BC%9F.md">47 å†…å­˜æ³„æ¼â€”â€”ä¸ºä½•æ¯æ¬¡ç”¨å®Œ ThreadLocal éƒ½è¦è°ƒç”¨ remove()?</a></p>
<h3 id="17-ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡">17.ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>å¦‚æœç”¨æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆæˆå‘˜å˜é‡å¿…é¡»åœ¨Threadé‡Œï¼Œä¸èƒ½åœ¨Runnableé‡Œï¼Œå› ä¸ºä¸€ä¸ªRunnableå¯¹è±¡å¯ä»¥è¢«å¤šä¸ªThreadæ‰§è¡Œã€‚</p>
<p>è€Œå¦‚æœåœ¨Threadä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼Œå°±è¦åŠ å¼ºThreadå’ŒRunnableçš„è€¦åˆï¼Œå°†Threadä½œä¸ºRunnableçš„æˆå‘˜å˜é‡ï¼Œå¹¶åœ¨Runnableä¸­è°ƒç”¨å…·ä½“çš„Threadå˜é‡ï¼Œå¦‚æœæ‰§è¡ŒRunnableçš„Threadå¯èƒ½æœ‰å¾ˆå¤šå­ç±»ï¼Œä¸åŒå­ç±»æœ‰ä¸åŒçš„æˆå‘˜å˜é‡ï¼Œåˆ™è¦åœ¨runæ–¹æ³•ä¸­è¿›è¡Œå¤æ‚å¤„ç†ï¼Œæ‰©å±•æ€§è¾ƒä½ï¼Œä¸åˆ©äºç»´æŠ¤ã€‚è€ŒThreadLocalå°±æ˜¯å°†æˆå‘˜å˜é‡ç»Ÿä¸€ä¸ºä¸€ä¸ªMapæ”¾åˆ°çº¿ç¨‹é‡Œã€‚ </p>
</blockquote>
<h2 id="â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile-Synchronized-CASï¼‰">â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile/Synchronized/CASï¼‰</h2>
<h3 id="1-çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥">1. çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>- åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼šçº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥ã€‚é€šä¿¡æ˜¯æŒ‡çº¿ç¨‹ä¹‹é—´ä»¥å¦‚ä½•æ¥äº¤æ¢ä¿¡æ¯ã€‚ä¸€èˆ¬çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æœºåˆ¶æœ‰ä¸¤ç§ï¼šå…±äº«å†…å­˜å’Œæ¶ˆæ¯ä¼ é€’ã€‚åŒæ­¥æ˜¯æŒ‡ç¨‹åºä¸­ç”¨äºæ§åˆ¶ä¸åŒçº¿ç¨‹é—´æ“ä½œå‘ç”Ÿç›¸å¯¹é¡ºåºçš„æœºåˆ¶ã€‚</p>
<p>- Javaçš„å¹¶å‘é‡‡ç”¨çš„æ˜¯å…±äº«å†…å­˜æ¨¡å‹ï¼ŒJavaçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ€»æ˜¯éšå¼è¿›è¡Œï¼Œæ•´ä¸ªé€šä¿¡è¿‡ç¨‹å¯¹ç¨‹åºå‘˜å®Œå…¨é€æ˜ã€‚å¦‚æœç¼–å†™å¤šçº¿ç¨‹ç¨‹åºçš„Javaç¨‹åºå‘˜ä¸ç†è§£éšå¼è¿›è¡Œçš„çº¿ç¨‹ä¹‹é—´é€šä¿¡çš„å·¥ä½œæœºåˆ¶ï¼Œå¾ˆå¯èƒ½ä¼šé‡åˆ°å„ç§å¥‡æ€ªçš„å†…å­˜å¯è§æ€§é—®é¢˜ã€‚</p>
<p>- åœ¨å…±äº«å†…å­˜å¹¶å‘æ¨¡å‹é‡Œï¼ŒåŒæ­¥æ˜¯æ˜¾å¼è¿›è¡Œçš„ã€‚ç¨‹åºå‘˜å¿…é¡»æ˜¾å¼æŒ‡å®šæŸä¸ªæ–¹æ³•æˆ–è€…æŸæ®µä»£ç éœ€è¦åœ¨çº¿ç¨‹ä¹‹é—´äº’æ–¥æ‰§è¡Œã€‚ </p>
</blockquote>
<h3 id="2-Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰">2.Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-4.png" alt=""></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Your_heart_private/article/details/105566207">Jvmå†…å­˜æ¨¡å‹å’ŒJMMæ¨¡å‹ç»“æ„å›¾_java jmmæ¨¡å‹å›¾-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://pdai.tech/md/java/jvm/java-jvm-x-introduce.html">JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/29881777">https://zhuanlan.zhihu.com/p/29881777</a></p>
<h3 id="3-Happens-Before-åŸåˆ™">3.Happens-Before åŸåˆ™</h3>
<p><strong>åˆ†æ</strong></p>
<p>ç†è§£JMMæ¨¡å‹å¦‚ä½•ä¿è¯å¹¶å‘å®‰å…¨æ€§ï¼ŒçŸ¥é“æŒ‡ä»¤é‡æ’ï¼Œç†è§£happens-beforeåŸåˆ™</p>
<p><strong>å›ç­”</strong></p>
<blockquote>
<p>happens-before å­—é¢æ„æ€å°±æ˜¯å…ˆè¡Œå‘ç”Ÿï¼Œä½ å¯ä»¥ç†è§£ä¸ºA happens before Bï¼Œå°±æ˜¯Aå‘ç”Ÿåœ¨Bä¹‹å‰ã€‚</p>
<p>happens-beforeï¼ˆHBï¼‰æ˜¯åœ¨JMMä¸­çš„ä¸€ä¸ªå¾ˆé‡è¦çš„è§„åˆ™ï¼Œå³ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯¹äºå¦ä¸€ä¸ªæ“ä½œæ˜¯å¯è§çš„ï¼Œç”¨æ¥æŒ‡å®šä¸¤ä¸ªæ“ä½œä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_11812862/3002287">é˜¿é‡Œé¢è¯•é¢˜:Java å¹¶å‘ç¼–ç¨‹ä¹‹ happens-before è§„åˆ™_51CTOåšå®¢_java happens-beforeåŸåˆ™</a></p>
<h3 id="4-Java-æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ">4.Java æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ</h3>
<blockquote>
<p>å¹¶å‘æ§åˆ¶ä¸­çš„é”ä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œæ‚²è§‚é”å’Œä¹è§‚é”ï¼Œä¸€èˆ¬æ¥è¯´æ‚²è§‚é”æ˜¯åŸºäºMonitorå®ç°çš„ï¼Œè¿™åœ¨Javaä¸­åˆ†åˆ«å¯¹åº”synchronizedå…³é”®å­—å’ŒAQSã€‚ä¹è§‚é”æ˜¯åŸºäºCAS+è‡ªæ—‹æ¥å®ç°çš„ï¼ŒJavaä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯å¹¶å‘åŸå­ç±»ã€‚</p>
<p><strong>synchronized</strong></p>
<p>synchronizedä¿®é¥°çš„æ–¹æ³•æˆ–ä»£ç å—åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>ä¸€èˆ¬æœ‰ä¸‰ç§ä½¿ç”¨æ–¹æ³•ï¼š</p>
<ol>
<li>
<p>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼šè°ƒç”¨æŸå¯¹è±¡çš„è¯¥æ–¹æ³•å‰è·å–è¯¥å¯¹è±¡å®ä¾‹çš„é”ã€‚</p>
</li>
<li>
<p>ä¿®é¥°é™æ€æ–¹æ³•ï¼šè°ƒç”¨æŸå¯¹è±¡çš„è¯¥æ–¹æ³•å‰è·å–è¯¥ç±»çš„é”ã€‚</p>
</li>
<li>
<p>ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰§è¡ŒåŒä¸€ä¸ªå¯¹è±¡synchronizedä¿®é¥°çš„å®ä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•æ—¶ä¸ä¼šå‘ç”Ÿäº’æ–¥ï¼Œå› ä¸ºé”çš„èµ„æºä¸åŒï¼Œä¸€ä¸ªé”äº†å¯¹è±¡å®ä¾‹ï¼Œä¸€ä¸ªé”äº†ç±»ã€‚</p>
</li>
<li>
<p>é”å¯¹è±¡ï¼Œä¿®é¥°ä»£ç å—ï¼šsynchronized(å¯¹è±¡çš„å¼•ç”¨)é”çš„æ˜¯å¯¹è±¡å®ä¾‹ï¼Œsynchronized(ç±».class)é”çš„æ˜¯ç±»ã€‚</p>
</li>
</ol>
<p>å°½é‡ä¸è¦ä½¿ç”¨synchronized(String a)å› ä¸ºJVMä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å…·æœ‰ç¼“å­˜åŠŸèƒ½ï¼</p>
<p>synchronizedä¸èƒ½ä¿®é¥°æ„é€ æ–¹æ³•ï¼Œä¹Ÿæ²¡å¿…è¦ä¿®é¥°ï¼Œæ„é€ æ–¹æ³•æœ¬èº«å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<p>åº•å±‚åŸç†ï¼šå°è¯•è·å–å¯¹è±¡çš„monitorï¼Œmonitorå·²è¢«å…¶ä»–çº¿ç¨‹å ç”¨æ—¶ï¼Œè·å–å¤±è´¥ï¼Œè¯¥çº¿ç¨‹è¿›å…¥EntrySetã€‚å æœ‰monitoræ—¶è°ƒç”¨wait()è¿›å…¥WaitSetã€‚è°ƒç”¨notify()æ—¶ä»WaitSeté‡Œéšæœºé€‰ä¸€ä¸ªçº¿ç¨‹å”¤é†’ï¼Œè°ƒç”¨notifyAllæ—¶å”¤é†’WaitSeté‡Œæ‰€æœ‰çº¿ç¨‹ã€‚</p>
<p><strong> AQS</strong></p>
<p>AQSå…¨ç§°æ˜¯AbstractQueuedSynchronizerï¼Œå®ƒæ˜¯Javaä¸­ç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„åŸºç¡€æ¡†æ¶ï¼Œå¯ä»¥ç”¨äºå®ç°è¯¸å¦‚ReentrantLockã€Semaphoreã€CountDownLatchç­‰å¤šç§åŒæ­¥å·¥å…·ã€‚</p>
<p>AQSä¸»è¦ä¾èµ–äºä¸€ä¸ªåŒå‘é“¾è¡¨å’Œä¸€ä¸ªvolatileç±»å‹çš„æ•´æ•°stateæ¥å®ç°åŒæ­¥æ§åˆ¶ã€‚è¯¥æ•´æ•°stateç”¨æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œstate=0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;0è¡¨ç¤ºæœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockå¯ä»¥å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—é”ï¼Œæ¯æ¬¡stateå€¼åŠ ä¸€ã€‚</p>
<p>AQSçš„ä¸»è¦æ–¹æ³•æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p>
<ul>
<li>
<p>acquire()ï¼šè¯¥æ–¹æ³•ç”¨æ¥è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœåŒæ­¥çŠ¶æ€è¢«å ç”¨ï¼Œåˆ™çº¿ç¨‹å°†è¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p>
</li>
<li>
<p>acquireInterruptibly()ï¼šä¸acquire()ç±»ä¼¼ï¼Œä½†æ˜¯è¯¥æ–¹æ³•å…è®¸ä¸­æ–­æ“ä½œã€‚</p>
</li>
<li>
<p>tryAcquire()ï¼šè¯¥æ–¹æ³•ç”¨æ¥å°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p>
</li>
<li>
<p>release()ï¼šè¯¥æ–¹æ³•ç”¨æ¥é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>acquireShared()ï¼šè¯¥æ–¹æ³•ç”¨æ¥è·å–å…±äº«å¼åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœåŒæ­¥çŠ¶æ€è¢«å ç”¨ï¼Œåˆ™çº¿ç¨‹å°†è¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p>
</li>
<li>
<p>releaseShared()ï¼šè¯¥æ–¹æ³•ç”¨æ¥é‡Šæ”¾å…±äº«å¼åŒæ­¥çŠ¶æ€ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚</p>
</li>
</ul>
<p>AQSå®ç°åŒæ­¥çš„å…³é”®åœ¨äºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåŸºäºFIFOé˜Ÿåˆ—çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œé€šè¿‡å°†ç­‰å¾…çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ—¶å€™ï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å”¤é†’ç­‰å¾…çº¿ç¨‹ï¼Œä»è€Œå®ç°äº†åŒæ­¥æœºåˆ¶ã€‚ </p>
<p>AQSçš„å®ç°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç‹¬å å¼ï¼ˆExclusiveï¼‰å’Œå…±äº«å¼ï¼ˆSharedï¼‰ã€‚ç‹¬å å¼æ˜¯æŒ‡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockï¼Œè€Œå…±äº«å¼æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚CountDownLatchã€‚åœ¨AQSä¸­ï¼Œè¿™ä¸¤ç§æ–¹å¼çš„å®ç°æ˜¯åŸºæœ¬ç›¸åŒçš„ï¼ŒåŒºåˆ«åœ¨äºè·å–å’Œé‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ–¹å¼ä¸åŒã€‚</p>
<p>ä»¥ä¸Šæ˜¯AQSçš„åŸºæœ¬å®ç°æ–¹å¼ï¼Œå®ƒæ˜¯Javaä¸­æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ ¸å¿ƒæ¡†æ¶ï¼Œä¸ºå„ç§åŒæ­¥å·¥å…·çš„å®ç°æä¾›äº†å¼ºå¤§çš„åŸºç¡€æ”¯æŒã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ls8sck0zrg.feishu.cn/wiki/Y6jkwwaHPiJw6skxQsfctlVVnMb#share-WZDZdVZqWobjF0xwtjocNSOqnQd">https://ls8sck0zrg.feishu.cn/wiki/Y6jkwwaHPiJw6skxQsfctlVVnMb#share-WZDZdVZqWobjF0xwtjocNSOqnQd</a></p>
<h3 id="5-synchronizedå…³é”®å­—">5. synchronizedå…³é”®å­—</h3>
<p><strong>åˆ†æ</strong></p>
<p>å›ç­”synchronizedä½œç”¨ã€ç‰¹æ€§ã€å®ç°æ–¹å¼ï¼Œå¯ä»¥é€‚å½“ç”»å›¾æˆ–è€…ä¸¾ä¾‹ã€‚</p>
<p><strong>å›ç­”</strong></p>
<blockquote>
<p>synchronizedå…³é”®å­—æ˜¯Javaç”¨æ¥è§£å†³å¤šä¸ªçº¿ç¨‹å…±äº«èµ„æºç«äº‰é—®é¢˜ï¼ŒsynchronizedåŒæ­¥è¯­å¥å—å®ç°æ˜¯å…ˆæ‰§è¡ŒmonitorenteræŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šå°è¯•è·å–å¯¹è±¡çš„monitorï¼ŒæŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼ŒmonitorexitæŒ‡ä»¤åˆ™åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®ï¼Œsynchronizedå…³é”®å­—å¯ä»¥ä¿è¯è¢«å®ƒä¿®é¥°çš„æ–¹æ³•æˆ–è€…ä»£ç å—åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>æ—©æœŸçš„synchronizedä¾èµ–æ“ä½œç³»ç»Ÿå®ç°ï¼Œå±äºé‡é‡é”ï¼ŒJDK 1.6ä»¥åå¯¹å…¶è¿›è¡Œäº†å¤§é‡çš„ä¼˜åŒ–ã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://pdai.tech/md/java/thread/java-thread-x-key-synchronized.html">å…³é”®å­—: synchronizedè¯¦è§£</a></p>
<h3 id="6-è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—">6. è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>synchronizedå…³é”®å­—æœ€ä¸»è¦çš„ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š</p>
<ul>
<li>
<p>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼šä½œç”¨äºå½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å¯¹è±¡å®ä¾‹çš„é”ã€‚</p>
</li>
<li>
<p>ä¿®é¥°é™æ€æ–¹æ³•ï¼šä¹Ÿå°±æ˜¯ç»™å½“å‰ç±»åŠ é”ï¼Œä¼šä½œç”¨äºç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œå› ä¸ºé™æ€æˆå‘˜ä¸å±äºä»»ä½•ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œæ˜¯ç±»æˆå‘˜ï¼ˆstaticè¡¨æ˜è¿™æ˜¯è¯¥ç±»çš„ä¸€ä¸ªé™æ€èµ„æºï¼Œä¸ç®¡newäº†å¤šå°‘ä¸ªå¯¹è±¡ï¼Œåªæœ‰ä¸€ä»½ï¼‰ã€‚æ‰€ä»¥å¦‚æœä¸€ä¸ªçº¿ç¨‹Aè°ƒç”¨ä¸€ä¸ªå®ä¾‹å¯¹è±¡çš„éé™æ€synchronizedæ–¹æ³•ï¼Œè€Œçº¿ç¨‹Béœ€è¦è°ƒç”¨è¿™ä¸ªå®ä¾‹å¯¹è±¡æ‰€å±ç±»çš„é™æ€synchronizedæ–¹æ³•ï¼Œæ˜¯å…è®¸çš„ï¼Œä¸ä¼šå‘ç”Ÿäº’æ–¥ç°è±¡ï¼Œå› ä¸ºè®¿é—®é™æ€synchronizedæ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰ç±»çš„é”ï¼Œè€Œè®¿é—®éé™æ€synchronizedæ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰å®ä¾‹å¯¹è±¡é”ã€‚ </p>
</li>
<li>
<p>ä¿®é¥°ä»£ç å—ï¼šæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚</p>
</li>
</ul>
<p>æ€»ç»“ï¼šsynchronizedå…³é”®å­—åŠ åˆ°staticé™æ€æ–¹æ³•å’Œsynchronized(class)ä»£ç å—ä¸Šéƒ½æ˜¯ç»™Classç±»ä¸Šé”ã€‚synchronizedå…³é”®å­—åŠ åˆ°å®ä¾‹æ–¹æ³•ä¸Šæ˜¯ç»™å¯¹è±¡å®ä¾‹ä¸Šé”ã€‚å°½é‡ä¸è¦ä½¿ç”¨synchronized(String a)å› ä¸ºJVMä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å…·æœ‰ç¼“å­˜åŠŸèƒ½ï¼ </p>
</blockquote>
<h3 id="7-è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†">7. è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>Synchronizedçš„è¯­ä¹‰åº•å±‚æ˜¯é€šè¿‡ä¸€ä¸ªmonitorï¼ˆç›‘è§†å™¨é”ï¼‰çš„å¯¹è±¡æ¥å®Œæˆï¼Œæ¯ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç›‘è§†å™¨é”(monitor)ã€‚æ¯ä¸ªSynchronizedä¿®é¥°è¿‡çš„ä»£ç å½“å®ƒçš„monitorè¢«å ç”¨æ—¶å°±ä¼šå¤„äºé”å®šçŠ¶æ€å¹¶ä¸”å°è¯•è·å–monitorçš„æ‰€æœ‰æƒ ï¼Œè¿‡ç¨‹ï¼š</p>
<p>1ã€å¦‚æœmonitorçš„è¿›å…¥æ•°ä¸º0ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥monitorï¼Œç„¶åå°†è¿›å…¥æ•°è®¾ç½®ä¸º1ï¼Œè¯¥çº¿ç¨‹å³ä¸ºmonitorçš„æ‰€æœ‰è€…ã€‚</p>
<p>2ã€å¦‚æœçº¿ç¨‹å·²ç»å æœ‰è¯¥monitorï¼Œåªæ˜¯é‡æ–°è¿›å…¥ï¼Œåˆ™è¿›å…¥monitorçš„è¿›å…¥æ•°åŠ 1.</p>
<p>3ã€å¦‚æœå…¶ä»–çº¿ç¨‹å·²ç»å ç”¨äº†monitorï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°monitorçš„è¿›å…¥æ•°ä¸º0ï¼Œå†é‡æ–°å°è¯•è·å–monitorçš„æ‰€æœ‰æƒã€‚</p>
<p><code>synchronizedæ˜¯å¯ä»¥é€šè¿‡ åæ±‡ç¼–æŒ‡ä»¤javapå‘½ä»¤ï¼ŒæŸ¥çœ‹ç›¸åº”çš„å­—èŠ‚ç æ–‡ä»¶ã€‚ </code></p>
</blockquote>
<h3 id="8-synchronizedå¯é‡å…¥çš„åŸç†">8. synchronizedå¯é‡å…¥çš„åŸç†</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>é‡å…¥é”æ˜¯æŒ‡ä¸€çº¿ç¨‹è·å–åˆ°è¯¥é”ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å¾—è¯¥é”ã€‚åº•å±‚åŸç†ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå†æ¬¡è·å¾—è¯¥é”æ—¶ç»§ç»­åŠ ä¸€ï¼Œé‡Šæ”¾é”æ—¶ï¼Œè®¡æ•°å™¨å‡ä¸€ï¼Œå½“è®¡æ•°å™¨å€¼ä¸º0æ—¶ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹æ‰€æŒæœ‰ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥ç«äº‰è·å–é”ã€‚</p>
</blockquote>
<h3 id="9-ä»€ä¹ˆæ˜¯è‡ªæ—‹">9. ä»€ä¹ˆæ˜¯è‡ªæ—‹</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>å¾ˆå¤šsynchronizedé‡Œé¢çš„ä»£ç åªæ˜¯ä¸€äº›å¾ˆç®€å•çš„ä»£ç ï¼Œæ‰§è¡Œæ—¶é—´éå¸¸å¿«ï¼Œæ­¤æ—¶ç­‰å¾…çš„çº¿ç¨‹éƒ½é˜»å¡å¯èƒ½æ˜¯ä¸€ç§ä¸å¤ªå€¼å¾—çš„æ“ä½œï¼Œå› ä¸ºçº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜ã€‚æ—¢ç„¶synchronizedé‡Œé¢çš„ä»£ç æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œä¸å¦¨è®©ç­‰å¾…é”çš„çº¿ç¨‹ä¸è¦è¢«é˜»å¡ï¼Œè€Œæ˜¯åœ¨ çº¿ç¨‹çš„è¾¹ç•Œå¿™å¾ªç¯ï¼Œè¿™å°±æ˜¯è‡ªæ—‹ã€‚å¦‚æœåšäº†å¤šæ¬¡å¾ªç¯å‘ç°è¿˜æ²¡æœ‰è·å¾—é”ï¼Œå†é˜»å¡ï¼Œè¿™æ ·å¯èƒ½æ˜¯ä¸€ç§æ›´å¥½çš„ç­–ç•¥ã€‚</p>
</li>
<li>
<p>å¿™å¾ªç¯ï¼šå°±æ˜¯ç¨‹åºå‘˜ç”¨å¾ªç¯è®©ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œä¸åƒä¼ ç»Ÿæ–¹æ³•wait(),sleep() æˆ–yield() å®ƒä»¬éƒ½æ”¾å¼ƒäº†CPUæ§åˆ¶ï¼Œè€Œå¿™å¾ªç¯ä¸ä¼šæ”¾å¼ƒCPUï¼Œå®ƒå°±æ˜¯åœ¨è¿è¡Œä¸€ä¸ªç©ºå¾ªç¯ã€‚è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä¸ºäº†ä¿ç•™CPUç¼“å­˜ï¼Œåœ¨å¤šæ ¸ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªç­‰å¾…çº¿ç¨‹é†’æ¥çš„æ—¶å€™å¯èƒ½ä¼šåœ¨å¦ä¸€ä¸ªå†…æ ¸è¿è¡Œï¼Œè¿™æ ·ä¼šé‡å»ºç¼“å­˜ã€‚ä¸ºäº†é¿å…é‡å»ºç¼“å­˜å’Œå‡å°‘ç­‰å¾…é‡å»ºçš„æ—¶é—´å°±å¯ä»¥ä½¿ç”¨å®ƒäº†ã€‚ </p>
</li>
</ul>
<p>åœ¨Javaä¸­ï¼Œè‡ªæ—‹ï¼ˆSpinningï¼‰æ˜¯ä¸€ç§çº¿ç¨‹åŒæ­¥æŠ€æœ¯ï¼Œç”¨äºåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å®ç°é”æœºåˆ¶ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªå·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰çš„é”æ—¶ï¼Œè¯¥çº¿ç¨‹ä¸ä¼šæ”¾å¼ƒCPUæ—¶é—´ç‰‡ï¼Œè€Œæ˜¯è¿›è¡Œå¾ªç¯ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¿™ç­‰å¾…å¾ªç¯ï¼‰ï¼Œä¸æ–­æ£€æŸ¥é”æ˜¯å¦å¯ç”¨ã€‚è¿™ç§æœºåˆ¶æ—¨åœ¨å‡å°‘çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œæé«˜å“åº”é€Ÿåº¦ï¼Œä½†ä¹Ÿå¯èƒ½æµªè´¹å¤§é‡çš„CPUæ—¶é—´ã€‚</p>
<p>è‡ªæ—‹é”æ˜¯Javaå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œé€šè¿‡å…è®¸çº¿ç¨‹åœ¨é”ä¸å¯ç”¨æ—¶æŒç»­å°è¯•è·å–é”ï¼Œå®ƒå¯ä»¥é¿å…çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚ç„¶è€Œï¼Œå¦‚æœé”æŒæœ‰æ—¶é—´è¿‡é•¿ï¼Œè‡ªæ—‹çº¿ç¨‹ä¼šæµªè´¹å¤§é‡CPUæ—¶é—´ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚å› æ­¤ï¼Œè‡ªæ—‹é”éœ€è¦è°¨æ…ä½¿ç”¨ï¼Œä¾æ®å…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚è¿›è¡Œé€‰æ‹©å’Œä¼˜åŒ–ã€‚</p>
</blockquote>
<h3 id="10-å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ">10. å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>synchronizedé”å‡çº§åŸç†ï¼šåœ¨é”å¯¹è±¡çš„å¯¹è±¡å¤´é‡Œé¢æœ‰ä¸€ä¸ªthreadidå­—æ®µï¼Œåœ¨ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™threadidä¸ºç©ºï¼Œjvmè®©å…¶æŒæœ‰åå‘é”ï¼Œå¹¶å°†threadidè®¾ç½®ä¸ºå…¶çº¿ç¨‹idï¼Œå†æ¬¡è¿›å…¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­threadidæ˜¯å¦ä¸å…¶çº¿ç¨‹idä¸€è‡´ï¼Œå¦‚æœä¸€è‡´åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤å¯¹è±¡ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™å‡çº§åå‘é”ä¸ºè½»é‡çº§é”ï¼Œé€šè¿‡è‡ªæ—‹å¾ªç¯ä¸€å®šæ¬¡æ•°æ¥è·å–é”ï¼Œæ‰§è¡Œä¸€å®šæ¬¡æ•°ä¹‹åï¼Œå¦‚æœè¿˜æ²¡æœ‰æ­£å¸¸è·å–åˆ°è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œæ­¤æ—¶å°±ä¼šæŠŠé”ä»è½»é‡çº§å‡çº§ä¸ºé‡é‡çº§é”ï¼Œæ­¤è¿‡ç¨‹å°±æ„æˆäº†synchronizedé”çš„å‡çº§ã€‚ </p>
<p><code>é”çš„å‡çº§çš„ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚åœ¨Java 6ä¹‹åä¼˜åŒ–synchronizedçš„å®ç°æ–¹å¼ï¼Œä½¿ç”¨äº†åå‘é”å‡çº§ä¸ºè½»é‡çº§é”å†å‡çº§åˆ°é‡é‡çº§é”çš„æ–¹å¼ï¼Œä»è€Œå‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚</code></p>
<ul>
<li>
<p>åå‘é”ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒä¼šåå‘äºç¬¬ä¸€ä¸ªè®¿é—®é”çš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŒæ­¥é”åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹äº‰ç”¨çš„æƒ…å†µï¼Œåˆ™çº¿ç¨‹æ˜¯ä¸éœ€è¦è§¦å‘åŒæ­¥çš„ï¼Œå‡å°‘åŠ é” / è§£é”çš„ä¸€äº›CASæ“ä½œï¼ˆæ¯”å¦‚ç­‰å¾…é˜Ÿåˆ—çš„ä¸€äº›CASæ“ä½œï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä¼šç»™çº¿ç¨‹åŠ ä¸€ä¸ªåå‘é”ã€‚å¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†å…¶ä»–çº¿ç¨‹æŠ¢å é”ï¼Œåˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ŒJVMä¼šæ¶ˆé™¤å®ƒèº«ä¸Šçš„åå‘é”ï¼Œå°†é”æ¢å¤åˆ°æ ‡å‡†çš„è½»é‡çº§é”ã€‚</p>
</li>
<li>
<p>è½»é‡çº§é”æ˜¯ç”±åå‘æ‰€å‡çº§æ¥çš„ï¼Œåå‘é”è¿è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå½“ç¬¬äºŒä¸ªçº¿ç¨‹åŠ å…¥é”äº‰ç”¨çš„æ—¶å€™ï¼Œåå‘é”å°±ä¼šå‡çº§ä¸ºè½»é‡çº§é”ï¼› </p>
</li>
<li>
<p>é‡é‡çº§é”æ˜¯synchronizedï¼Œæ˜¯Javaè™šæ‹Ÿæœºä¸­æœ€ä¸ºåŸºç¡€çš„é”å®ç°ã€‚åœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼ŒJavaè™šæ‹Ÿæœºä¼šé˜»å¡åŠ é”å¤±è´¥çš„çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨ç›®æ ‡é”è¢«é‡Šæ”¾çš„æ—¶å€™ï¼Œå”¤é†’è¿™äº›çº¿ç¨‹ã€‚ </p>
</li>
</ul>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E9%9D%A2%E8%AF%95%E7%B2%BE%E8%AE%B2/16%20%20synchronized%E5%BA%95%E5%B1%82%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F%E4%BB%80%E4%B9%88%E6%98%AF%E9%94%81%E7%9A%84%E5%8D%87%E7%BA%A7%E3%80%81%E9%99%8D%E7%BA%A7%EF%BC%9F-%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4.md">16 synchronizedåº•å±‚å¦‚ä½•å®ç°?ä»€ä¹ˆæ˜¯é”çš„å‡çº§ã€é™çº§?-æå®¢æ—¶é—´</a></p>
<blockquote>
<h3 id="11-çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡">11. çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<p>(1) volatileä¿®é¥°å˜é‡</p>
<p>(2) synchronizedä¿®é¥°ä¿®æ”¹å˜é‡çš„æ–¹æ³•</p>
<p>(3) wait/notify</p>
</blockquote>
<h3 id="12-å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B">12. å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<p>ä¸èƒ½ã€‚å…¶å®ƒçº¿ç¨‹åªèƒ½è®¿é—®è¯¥å¯¹è±¡çš„éåŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥æ–¹æ³•åˆ™ä¸èƒ½è¿›å…¥ã€‚å› ä¸ºéé™æ€æ–¹æ³•ä¸Šçš„synchronizedä¿®é¥°ç¬¦è¦æ±‚æ‰§è¡Œæ–¹æ³•æ—¶è¦è·å¾—å¯¹è±¡çš„é”ï¼Œå¦‚æœå·²ç»è¿›å…¥Aæ–¹æ³•è¯´æ˜å¯¹è±¡é”å·²ç»è¢«å–èµ°ï¼Œé‚£ä¹ˆè¯•å›¾è¿›å…¥Bæ–¹æ³•çš„çº¿ç¨‹å°±åªèƒ½åœ¨ç­‰é”æ± ï¼ˆæ³¨æ„ä¸æ˜¯ç­‰å¾…æ± å“¦ï¼‰ä¸­ç­‰å¾…å¯¹è±¡çš„é”ã€‚</p>
</blockquote>
<h3 id="13-synchronizedã€volatileã€CASæ¯”è¾ƒ">13. synchronizedã€volatileã€CASæ¯”è¾ƒ</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<p>(1) synchronizedæ˜¯æ‚²è§‚é”ï¼Œå±äºæŠ¢å å¼ï¼Œä¼šå¼•èµ·å…¶ä»–çº¿ç¨‹é˜»å¡ã€‚</p>
<p>(2) volatileæä¾›å¤šçº¿ç¨‹å…±äº«å˜é‡å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚ </p>
<p>(3) CASæ˜¯åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚é”ï¼ˆéé˜»å¡ï¼‰ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://refblogs.com/article/582">å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronizedã€volatileå’ŒCASæ“ä½œè¯¦è§£ - æ¬ç –çš„ç å†œ</a></p>
<h3 id="14-synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«">14. synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>é¦–å…ˆsynchronizedæ˜¯Javaå†…ç½®å…³é”®å­—ï¼Œåœ¨JVMå±‚é¢ï¼ŒLockæ˜¯ä¸ªæ¥å£ï¼›</p>
</li>
<li>
<p>åŸç†åŒºåˆ«ï¼šsynchronizedæ˜¯å†…ç½®é”ï¼Œç”±JVMå®ç°è·å–é”å’Œé‡Šæ”¾é”çš„åŸç†ï¼Œè¿˜åˆ†ä¸ºåå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ã€‚Lockæ ¹æ®å®ç°ä¸åŒï¼Œæœ‰ä¸åŒçš„åŸç†ï¼Œä¾‹å¦‚ReentrantLockå†…éƒ¨æ˜¯é€šè¿‡AQSæ¥è·å–å’Œé‡Šæ”¾é”çš„ã€‚</p>
</li>
<li>
<p>ç”¨æ³•åŒºåˆ«ï¼šsynchronizedå¯ä»¥ç»™ç±»ã€æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼›è€Œlockåªèƒ½ç»™ä»£ç å—åŠ é”ã€‚synchronizedä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œä½¿ç”¨ç®€å•ï¼Œå‘ç”Ÿå¼‚å¸¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä¸å®¹æ˜“é€ æˆæ­»é”ï¼›è€Œlockéœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼Œå¦‚æœä½¿ç”¨ä¸å½“æ²¡æœ‰unLock()å»é‡Šæ”¾é”å°±ä¼šé€ æˆæ­»é”ã€‚</p>
</li>
<li>
<p>synchronizedé”åªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œä½†æ˜¯Locké”æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œä¾‹å¦‚åœ¨è¯»å†™é”ä¸­çš„è¯»é”ï¼Œæ˜¯å¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æŒæœ‰çš„ï¼Œå¯æ˜¯synchronizedåšä¸åˆ°ã€‚</p>
</li>
<li>
<p>synchronizedé”ä¸å¤Ÿçµæ´»ï¼Œä¸€æ—¦synchronizedé”å·²ç»è¢«æŸä¸ªçº¿ç¨‹è·å¾—äº†ï¼Œæ­¤æ—¶å…¶ä»–çº¿ç¨‹å¦‚æœè¿˜æƒ³è·å¾—ï¼Œé‚£å®ƒåªèƒ½è¢«é˜»å¡ï¼Œç›´åˆ°æŒæœ‰é”çš„çº¿ç¨‹è¿è¡Œå®Œæ¯•æˆ–è€…å‘ç”Ÿå¼‚å¸¸ä»è€Œé‡Šæ”¾è¿™ä¸ªé”ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æŒæœ‰å¾ˆé•¿æ—¶é—´æ‰é‡Šæ”¾ï¼Œé‚£ä¹ˆæ•´ä¸ªç¨‹åºçš„è¿è¡Œæ•ˆç‡å°±ä¼šé™ä½ï¼Œè€Œä¸”å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æ°¸è¿œä¸é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå°è¯•è·å–é”çš„çº¿ç¨‹åªèƒ½æ°¸è¿œç­‰ä¸‹å»ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒLockç±»åœ¨ç­‰é”çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯lockInterruptiblyæ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœè§‰å¾—ç­‰å¾…çš„æ—¶é—´å¤ªé•¿äº†ä¸æƒ³å†ç»§ç»­ç­‰å¾…ï¼Œå¯ä»¥ä¸­æ–­é€€å‡ºï¼Œä¹Ÿå¯ä»¥ç”¨tryLock()ç­‰æ–¹æ³•å°è¯•è·å–é”ï¼Œå¦‚æœè·å–ä¸åˆ°é”ä¹Ÿå¯ä»¥åšåˆ«çš„äº‹ï¼Œæ›´åŠ çµæ´»ã€‚ </p>
</li>
<li>
<p>æ€§èƒ½åŒºåˆ«ï¼šåœ¨Java 5ä»¥åŠä¹‹å‰ï¼Œsynchronizedçš„æ€§èƒ½æ¯”è¾ƒä½ï¼Œä½†æ˜¯åˆ°äº†Java 6ä»¥åå‘ç”Ÿäº†å˜åŒ–ï¼Œå› ä¸ºJDKå¯¹synchronizedè¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚è‡ªé€‚åº”è‡ªæ—‹ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ã€è½»é‡çº§é”ã€åå‘é”ç­‰ï¼Œæ‰€ä»¥åæœŸçš„Javaç‰ˆæœ¬é‡Œçš„synchronizedçš„æ€§èƒ½å¹¶ä¸æ¯”Lockå·®ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="15-synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©">15. synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ol>
<li>
<p>å¦‚æœèƒ½ä¸ç”¨æœ€å¥½æ—¢ä¸ä½¿ç”¨Lockä¹Ÿä¸ä½¿ç”¨synchronizedã€‚å› ä¸ºåœ¨è®¸å¤šæƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨java.util.concurrentåŒ…ä¸­çš„æœºåˆ¶ï¼Œå®ƒä¼šä¸ºä½ å¤„ç†æ‰€æœ‰çš„åŠ é”å’Œè§£é”æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ¨èä¼˜å…ˆä½¿ç”¨å·¥å…·ç±»æ¥åŠ è§£é”ã€‚</p>
</li>
<li>
<p>å¦‚æœsynchronizedå…³é”®å­—é€‚åˆä½ çš„ç¨‹åºï¼Œé‚£ä¹ˆè¯·å°½é‡ä½¿ç”¨å®ƒï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç¼–å†™ä»£ç çš„æ•°é‡ï¼Œå‡å°‘å‡ºé”™çš„æ¦‚ç‡ã€‚å› ä¸ºä¸€æ—¦å¿˜è®°åœ¨finallyé‡Œunlockï¼Œä»£ç å¯èƒ½ä¼šå‡ºå¾ˆå¤§çš„é—®é¢˜ï¼Œè€Œä½¿ç”¨synchronizedæ›´å®‰å…¨ã€‚</p>
</li>
<li>
<p>å¦‚æœç‰¹åˆ«éœ€è¦Lockçš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œæ¯”å¦‚å°è¯•è·å–é”ã€å¯ä¸­æ–­ã€è¶…æ—¶åŠŸèƒ½ç­‰ï¼Œæ‰ä½¿ç”¨Lockã€‚</p>
</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Java%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%2078%20%E8%AE%B2-%E5%AE%8C/22%20synchronized%20%E5%92%8C%20Lock%20%E5%AD%B0%E4%BC%98%E5%AD%B0%E5%8A%A3%EF%BC%8C%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%EF%BC%9F.md">22 synchronized å’Œ Lock å­°ä¼˜å­°åŠ£ï¼Œå¦‚ä½•é€‰æ‹©?</a></p>
<h3 id="16-synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ">16. synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>synchronizedå’ŒReentrantLockéƒ½æ˜¯Javaä¸­æä¾›çš„å¯é‡å…¥é”ï¼ŒäºŒè€…çš„ä¸»è¦åŒºåˆ«æœ‰ä»¥ä¸‹5ä¸ªï¼š</p>
<ul>
<li>
<p>ç”¨æ³•ä¸åŒï¼šsynchronizedå¯ä»¥ç”¨æ¥ä¿®é¥°æ™®é€šæ–¹æ³•ã€é™æ€æ–¹æ³•å’Œä»£ç å—ï¼Œè€ŒReentrantLockåªèƒ½ç”¨äºä»£ç å—ã€‚</p>
</li>
<li>
<p>è·å–é”å’Œé‡Šæ”¾é”çš„æœºåˆ¶ä¸åŒï¼šsynchronizedæ˜¯è‡ªåŠ¨åŠ é”å’Œé‡Šæ”¾é”çš„ï¼Œè€ŒReentrantLockéœ€è¦æ‰‹åŠ¨åŠ é”å’Œé‡Šæ”¾é”ã€‚</p>
</li>
<li>
<p>é”ç±»å‹ä¸åŒï¼šsynchronizedæ˜¯éå…¬å¹³é”ï¼Œè€ŒReentrantLocké»˜è®¤ä¸ºéå…¬å¹³é”ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸ºå…¬å¹³é”ã€‚ </p>
</li>
<li>
<p>å“åº”ä¸­æ–­ä¸åŒï¼šReentrantLockå¯ä»¥å“åº”ä¸­æ–­ï¼Œè§£å†³æ­»é”çš„é—®é¢˜ï¼Œè€Œsynchronizedä¸èƒ½å“åº”ä¸­æ–­ã€‚</p>
</li>
<li>
<p>åº•å±‚å®ç°ä¸åŒï¼šsynchronizedæ˜¯JVMå±‚é¢é€šè¿‡ç›‘è§†å™¨å®ç°çš„ï¼Œè€ŒReentrantLockæ˜¯åŸºäºAQS</p>
</li>
</ul>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.51cto.com/article/707239.html">https://www.51cto.com/article/707239.html</a></p>
<h3 id="17-volatileå…³é”®å­—çš„ä½œç”¨">17. volatileå…³é”®å­—çš„ä½œç”¨</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>å¯¹äºå¯è§æ€§ï¼ŒJavaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚volatileç¡®ä¿ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹èƒ½å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢«volatileä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å†…å­˜ä¸­ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚</p>
</li>
<li>
<p>ä»å®è·µè§’åº¦è€Œè¨€ï¼Œvolatileçš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯å’ŒCASç»“åˆï¼Œä¿è¯äº†åŸå­æ€§ï¼Œè¯¦ç»†çš„å¯ä»¥å‚è§java.util.concurrent.atomicåŒ…ä¸‹çš„ç±»ï¼Œæ¯”å¦‚AtomicIntegerã€‚</p>
</li>
</ul>
</blockquote>
<h3 id="18-Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—">18. Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>èƒ½ï¼ŒJavaä¸­å¯ä»¥åˆ›å»ºvolatileç±»å‹æ•°ç»„ï¼Œä¸è¿‡åªæ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ã€‚æ„æ€æ˜¯ï¼Œå¦‚æœæ”¹å˜å¼•ç”¨æŒ‡å‘çš„æ•°ç»„ï¼Œå°†ä¼šå—åˆ°volatileçš„ä¿æŠ¤ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ”¹å˜æ•°ç»„çš„å…ƒç´ ï¼Œvolatileæ ‡ç¤ºç¬¦å°±ä¸èƒ½èµ·åˆ°ä¹‹å‰çš„ä¿æŠ¤ä½œç”¨äº†ã€‚ </p>
</blockquote>
<h3 id="19-volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—">19. volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>å…³é”®å­—volatileçš„ä¸»è¦ä½œç”¨æ˜¯ä½¿å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹é—´å¯è§ï¼Œä½†æ— æ³•ä¿è¯åŸå­æ€§ï¼Œå¯¹äºå¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå®ä¾‹å˜é‡éœ€è¦åŠ é”è¿›è¡ŒåŒæ­¥ã€‚</p>
</li>
<li>
<p>è™½ç„¶volatileåªèƒ½ä¿è¯å¯è§æ€§ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä½†ç”¨volatileä¿®é¥°longå’Œdoubleå¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://blog.csdn.net/tian2342/article/details/122665957%EF%BC%89">https://blog.csdn.net/tian2342/article/details/122665957ï¼‰</a></p>
</li>
</ul>
</blockquote>
<h3 id="20-synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ">20. synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>
<p>synchronizedè¡¨ç¤ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–ä½œç”¨å¯¹è±¡çš„é”ï¼Œæ‰§è¡Œä»£ç ï¼Œé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>volatileè¡¨ç¤ºå˜é‡åœ¨CPUçš„å¯„å­˜å™¨ä¸­æ˜¯ä¸ç¡®å®šçš„ï¼Œå¿…é¡»ä»ä¸»å­˜ä¸­è¯»å–ã€‚ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å˜é‡çš„å¯è§æ€§ï¼›ç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚</p>
</li>
</ul>
<p><strong>åŒºåˆ«</strong></p>
<ul>
<li>
<p>volatileæ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronizedå¯ä»¥ä¿®é¥°æ–¹æ³•ï¼Œä»£ç å—ã€‚</p>
</li>
<li>
<p>volatileä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼›è€Œsynchronizedåˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’ŒåŸå­æ€§ã€‚ </p>
</li>
<li>
<p>volatileä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronizedå¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ã€‚</p>
</li>
<li>
<p>volatileæ ‡è®°çš„å˜é‡ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼›synchronizedæ ‡è®°çš„å˜é‡å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</p>
</li>
<li>
<p>volatileå…³é”®å­—æ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œæ‰€ä»¥volatileæ€§èƒ½è‚¯å®šæ¯”synchronizedå…³é”®å­—è¦å¥½ã€‚ä½†æ˜¯volatileå…³é”®å­—åªèƒ½ç”¨äºå˜é‡è€Œsynchronizedå…³é”®å­—å¯ä»¥ä¿®é¥°æ–¹æ³•ä»¥åŠä»£ç å—ã€‚synchronizedå…³é”®å­—åœ¨JavaSE1.6ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œæ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œå®é™…å¼€å‘ä¸­ä½¿ç”¨synchronizedå…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="21-è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£">21. è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£</h3>
<blockquote>
<p>volatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li>
<p>ä¿è¯å¯è§æ€§ï¼švolatileä¿è¯äº†å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œæ˜¯å¯è§çš„ã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ä¼šç«‹å³çœ‹åˆ°è¿™ä¸ªæ”¹å˜ã€‚</p>
</li>
<li>
<p>ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼švolatileé€šè¿‡ç¦æ­¢æŒ‡ä»¤é‡æ’æ¥ä¿è¯é¡ºåºæ€§ã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸ºäº†æé«˜ç¨‹åºæ‰§è¡Œæ•ˆç‡ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå˜é‡è¢«volatileä¿®é¥°ï¼Œå°±ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ï¼Œç¡®ä¿æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°æ­£ç¡®çš„æ“ä½œé¡ºåºã€‚</p>
</li>
</ol>
<p>æ€»çš„æ¥è¯´ï¼Œvolatileå¯ä»¥ç¡®ä¿å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œä¸€è‡´ï¼Œé¿å…äº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚<strong>ä½†æ˜¯å®ƒä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œå› æ­¤å¯¹äºéœ€è¦ä¿è¯åŸå­æ€§çš„æ“ä½œè¿˜éœ€è¦ä½¿ç”¨å…¶ä»–åŒæ­¥æœºåˆ¶ï¼Œå¦‚synchronizedå…³é”®å­—æˆ–java.util.concurrent.atomicåŒ…ä¸­çš„åŸå­ç±»ã€‚ </strong></p>
<p><strong>volatileå…³é”®å­—</strong>é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼š</p>
<ol>
<li>
<p>å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰ï¼šå½“ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨çœ‹åˆ°volatileä¿®é¥°çš„å˜é‡æ—¶ï¼Œå®ƒä¼šåœ¨è¯¥å˜é‡å‰åæ’å…¥å†…å­˜å±éšœã€‚å†…å­˜å±éšœå¯ä»¥ä¿è¯åœ¨è¯¥å±éšœä¹‹å‰çš„æ‰€æœ‰è¯»å†™æ“ä½œéƒ½å¿…é¡»åœ¨å±éšœä¹‹åçš„è¯»å†™æ“ä½œä¹‹å‰å®Œæˆã€‚è¿™å®é™…ä¸Šå°±ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ã€‚</p>
</li>
<li>
<p>å¼ºåˆ¶ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼šå½“ä¸€ä¸ªçº¿ç¨‹å‘è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡å†™å…¥æ•°æ®æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå¼ºåˆ¶è¿™ä¸ªå€¼è¢«ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ã€‚è¿™ç¡®ä¿äº†å…¶ä»–çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°è¿™ä¸ªä¿®æ”¹ã€‚</p>
</li>
<li>
<p>å¼ºåˆ¶ä»ä¸»å†…å­˜è¯»å–ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è¯»å–è¢«volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå¼ºåˆ¶è¦æ±‚å®ƒä»ä¸»å†…å­˜ä¸­è¯»å–è¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯ä»è¯¥çº¿ç¨‹çš„æœ¬åœ°ç¼“å­˜ä¸­è¯»å–ã€‚è¿™ç¡®ä¿äº†è¯¥çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°å…¶ä»–çº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡çš„ä¿®æ”¹ã€‚ </p>
</li>
</ol>
</blockquote>
<h2 id="çº¿ç¨‹æ± ">çº¿ç¨‹æ± </h2>
<h3 id="1-ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ">1. ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šJavaä¸­çš„çº¿ç¨‹æ± æ˜¯è¿ç”¨åœºæ™¯æœ€å¤šçš„å¹¶å‘æ¡†æ¶ï¼Œå‡ ä¹æ‰€æœ‰éœ€è¦å¼‚æ­¥æˆ–å¹¶å‘æ‰§è¡Œä»»åŠ¡çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆç†åœ°ä½¿ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥è®¸å¤šå¥½å¤„ã€‚</p>
<ul>
<li>
<p>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œé™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</p>
</li>
<li>
<p>æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</p>
</li>
<li>
<p>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯ï¼Œè¦åšåˆ°åˆç†åˆ©ç”¨ ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="2-æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›">2. æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›?</h3>
<p><strong>åˆ†æ</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">int</span> maximumPoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">long</span> keepAliveTime,</span></span><br><span class="line"><span class="params">                          TimeUnit unit,</span></span><br><span class="line"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class="line"><span class="params">                          ThreadFactory threadFactory,</span></span><br><span class="line"><span class="params">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<p>çº¿ç¨‹æ± çš„æ„é€ å‡½æ•°æœ‰7ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>
<p>corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°</p>
</li>
<li>
<p>maximumPoolSizeï¼šçº¿ç¨‹æ± èƒ½åˆ›å»ºçº¿ç¨‹çš„æœ€å¤§ä¸ªæ•°</p>
</li>
<li>
<p>keepAliveTimeï¼šç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</p>
</li>
<li>
<p>unitï¼šæ—¶é—´å•ä½ï¼Œä¸ºkeepAliveTimeæŒ‡å®šæ—¶é—´å•ä½</p>
</li>
<li>
<p>workQueueï¼šé˜»å¡é˜Ÿåˆ—ï¼Œç”¨äºä¿å­˜ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—</p>
</li>
<li>
<p>threadFactoryï¼šåˆ›å»ºçº¿ç¨‹çš„å·¥ç¨‹ç±»</p>
</li>
<li>
<p>handlerï¼šé¥±å’Œç­–ç•¥ï¼ˆæ‹’ç»ç­–ç•¥ï¼‰ </p>
</li>
</ul>
</blockquote>
<h3 id="3-çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯">3. çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</h3>
<p><strong>åˆ†æ</strong></p>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ol>
<li>newCachedThreadPool</li>
</ol>
<p>newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ± çš„é•¿åº¦è¶…è¿‡äº†å¤„ç†çš„éœ€è¦æ—¶ï¼Œå®ƒå¯ä»¥çµæ´»çš„å›æ”¶ç©ºé—²çš„çº¿ç¨‹ï¼Œå½“éœ€è¦å¢åŠ æ—¶ï¼Œå®ƒå¯ä»¥çµæ´»çš„æ·»åŠ æ–°çš„çº¿ç¨‹ï¼Œè€Œä¸ä¼šå¯¹æ± çš„é•¿åº¦ä½œä»»ä½•é™åˆ¶ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ‰§è¡Œå¾ˆå¤šçŸ­æœŸå¼‚æ­¥çš„å°ç¨‹åºã€‚</p>
<ul>
<li>newFixedThreadPool</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å®šé•¿çº¿ç¨‹æ± çš„å¤§å°æœ€å¥½æ ¹æ®ç³»ç»Ÿèµ„æºè¿›è¡Œè®¾ç½®ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ‰§è¡Œé•¿æœŸçš„ä»»åŠ¡ï¼Œæ€§èƒ½å¥½å¾ˆå¤šã€‚</p>
<ul>
<li>newScheduledThreadPool</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± ï¼Œè€Œä¸”æ”¯æŒå®šæ—¶çš„ä»¥åŠå‘¨æœŸæ€§çš„ä»»åŠ¡æ‰§è¡Œã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ã€‚</p>
<ul>
<li>newSingleThreadExecutor</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒï¼Œå¿…é¡»ä¿è¯å‰ä¸€é¡¹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰èƒ½æ‰§è¡Œåä¸€é¡¹ã€‚ä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šé€‚åˆå¤šä¸ªä»»åŠ¡é¡ºåºæ‰§è¡Œçš„åœºæ™¯ï¼Œä¸éœ€è¦è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sachen/p/7401959.html">åšå®¢å›­</a></p>
<h3 id="4-çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›">4. çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›</h3>
<p><strong>åˆ†æ</strong></p>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>AbortPolicy, é»˜è®¤</li>
</ul>
<p>è¯¥ç­–ç•¥æ˜¯çº¿ç¨‹æ± çš„é»˜è®¤ç­–ç•¥ã€‚ä½¿ç”¨è¯¥ç­–ç•¥æ—¶ï¼Œå¦‚æœçº¿ç¨‹æ± é˜Ÿåˆ—æ»¡äº†ä¸¢æ‰è¿™ä¸ªä»»åŠ¡å¹¶ä¸”æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚</p>
<ul>
<li>DiscardPolicy</li>
</ul>
<p>è¿™ä¸ªç­–ç•¥å’ŒAbortPolicyçš„silentç‰ˆæœ¬ï¼Œå¦‚æœçº¿ç¨‹æ± é˜Ÿåˆ—æ»¡äº†ï¼Œä¼šç›´æ¥ä¸¢æ‰è¿™ä¸ªä»»åŠ¡å¹¶ä¸”ä¸ä¼šæœ‰ä»»ä½•å¼‚å¸¸ã€‚</p>
<ul>
<li>DiscardOldestPolicy</li>
</ul>
<p>è¿™ä¸ªç­–ç•¥ä»å­—é¢ä¸Šä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä¸¢å¼ƒæœ€è€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œä¼šå°†æœ€æ—©è¿›å…¥é˜Ÿåˆ—çš„ä»»åŠ¡åˆ æ‰è…¾å‡ºç©ºé—´ï¼Œå†å°è¯•åŠ å…¥é˜Ÿåˆ—ã€‚å› ä¸ºé˜Ÿåˆ—æ˜¯é˜Ÿå°¾è¿›ï¼Œé˜Ÿå¤´å‡ºï¼Œæ‰€ä»¥é˜Ÿå¤´å…ƒç´ æ˜¯æœ€è€çš„ï¼Œå› æ­¤æ¯æ¬¡éƒ½æ˜¯ç§»é™¤é˜Ÿå¤´å…ƒç´ åå†å°è¯•å…¥é˜Ÿã€‚</p>
<ul>
<li>CallerRunsPolicy</li>
</ul>
<p>ä½¿ç”¨æ­¤ç­–ç•¥ï¼Œå¦‚æœæ·»åŠ åˆ°çº¿ç¨‹æ± å¤±è´¥ï¼Œé‚£ä¹ˆè°ƒç”¨çº¿ç¨‹ä¼šè‡ªå·±å»æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œä¸ä¼šç­‰å¾…çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å»æ‰§è¡Œã€‚å°±åƒæ˜¯ä¸ªæ€¥è„¾æ°”çš„äººï¼Œæˆ‘ç­‰ä¸åˆ°åˆ«äººæ¥åšè¿™ä»¶äº‹å°±å¹²è„†è‡ªå·±å¹²ã€‚ </p>
</blockquote>
<h3 id="5-åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«">5. åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>Executorså·¥å…·ç±»çš„ä¸åŒæ–¹æ³•æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚åˆ›å»ºäº†ä¸åŒçš„çº¿ç¨‹æ± ï¼Œæ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ã€‚</p>
<p>Executoræ¥å£å¯¹è±¡èƒ½æ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡ã€‚</p>
<p>ExecutorServiceæ¥å£ç»§æ‰¿äº†Executoræ¥å£å¹¶è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•æˆ‘ä»¬èƒ½è·å¾—ä»»åŠ¡æ‰§è¡Œçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥è·å–ä»»åŠ¡çš„è¿”å›å€¼ã€‚ </p>
</blockquote>
<h3 id="6-çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€">6.çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-1.png" alt=""></p>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>
<p>RUNNINGï¼šè¿™æ˜¯æœ€æ­£å¸¸çš„çŠ¶æ€ï¼Œæ¥å—æ–°çš„ä»»åŠ¡ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>TIDYINGï¼šæ‰€æœ‰çš„çº¿ç¨‹éƒ½é”€æ¯äº†ï¼ŒworkerCountä¸º0ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€è½¬æ¢ä¸ºTIDYINGçŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³•terminated()ã€‚</p>
</li>
<li>
<p>TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚</p>
</li>
</ul>
</blockquote>
<h3 id="7-çº¿ç¨‹æ± ä¸­submit-å’Œexecute-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«">7. çº¿ç¨‹æ± ä¸­submit()å’Œexecute()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>ç›¸åŒç‚¹ï¼š</p>
<ul>
<li>ç›¸åŒç‚¹å°±æ˜¯éƒ½å¯ä»¥å¼€å¯çº¿ç¨‹æ‰§è¡Œæ± ä¸­çš„ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p>ä¸åŒç‚¹ï¼š</p>
<ul>
<li>
<p>æ¥æ”¶å‚æ•°ï¼šexecute()åªèƒ½æ‰§è¡ŒRunnableç±»å‹çš„ä»»åŠ¡ã€‚submit()å¯ä»¥æ‰§è¡ŒRunnableå’ŒCallableç±»å‹çš„ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>è¿”å›å€¼ï¼šsubmit()æ–¹æ³•å¯ä»¥è¿”å›æŒæœ‰è®¡ç®—ç»“æœçš„Futureå¯¹è±¡ï¼Œè€Œexecute()æ²¡æœ‰ã€‚</p>
</li>
<li>
<p>å¼‚å¸¸å¤„ç†ï¼šsubmit()æ–¹ä¾¿Exceptionå¤„ç†ã€‚ </p>
</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="8-åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹">8. åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹</h3>
<p><strong>åˆ†æ</strong></p>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± ä¸­ï¼Œçº¿ç¨‹æ± çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå°±ä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
</li>
<li>
<p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äºæˆ–å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¹¶ä¸”ä»»åŠ¡é˜Ÿåˆ—æ²¡æ»¡ï¼Œé‚£ä¹ˆå°±æŠŠè¯¥ä»»åŠ¡æ”¾å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—é‡Œç­‰å¾…æ‰§è¡Œã€‚</p>
</li>
<li>
<p>å¦‚æœä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ï¼Œä½†æ˜¯å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°çš„ï¼Œå°±æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
</li>
<li>
<p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å·²ç»ç­‰åŒäºæœ€å¤§çº¿ç¨‹æ•°äº†ï¼Œæ–°å»ºçº¿ç¨‹å°†ä¼šä½¿å½“å‰è¿è¡Œçš„çº¿ç¨‹è¶…å‡ºæœ€å¤§çº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå½“å‰ä»»åŠ¡ä¼šè¢«æ‹’ç»ï¼Œè°ƒç”¨æ‹’ç»ç­–ç•¥æ–¹æ³•ã€‚</p>
</li>
</ol>
</blockquote>
<h3 id="9-çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š">9. çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š</h3>
<p><strong>åˆ†æ</strong></p>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>çº¿ç¨‹æ± ç”¨æ¥æ‰§è¡ŒCPUå¯†é›†å‹ä»»åŠ¡æ—¶ï¼Œè®¾ç½®çº¿ç¨‹æ•°ä¸ºcpuæ ¸å¿ƒæ•°+1ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡ã€‚ç”¨æ¥æ‰§è¡ŒIOå¯†é›†å‹ä»»åŠ¡æ—¶ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹éƒ½é˜»å¡ï¼Œæ‰€ä»¥è®¾ç½®çº¿ç¨‹æ•°ä¸º2*cpuæ ¸æ•°ã€‚ </p>
</blockquote>
<h3 id="10-çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜">10. çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜</h3>
<p><strong>åˆ†æ</strong></p>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ol>
<li>
<p>CPUå¯†é›†å‹ä»»åŠ¡é…ç½®å°½å¯èƒ½å°çš„çº¿ç¨‹ï¼Œcpuæ ¸æ•°+1ã€‚</p>
</li>
<li>
<p>IOå¯†é›†å‹ä»»åŠ¡åˆ™ç”±äºçº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹ï¼Œå¦‚2*cpuæ ¸æ•°ã€‚</p>
</li>
<li>
<p>æ··åˆå‹ä»»åŠ¡ï¼Œå¦‚æœå¯ä»¥æ‹†åˆ†ï¼Œåˆ™å°†å…¶æ‹†åˆ†æˆä¸€ä¸ªCPUå¯†é›†å‹ä»»åŠ¡å’Œä¸€ä¸ªIOå¯†é›†å‹ä»»åŠ¡ã€‚åªè¦è¿™ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´ç›¸å·®ä¸æ˜¯å¤ªå¤§ï¼Œé‚£ä¹ˆåˆ†è§£åå¹¶å‘æ‰§è¡Œçš„ååç‡é«˜äºä¸²è¡Œæ‰§è¡Œçš„ååç‡ï¼›å¦‚æœè¿™ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›¸å·®å¤ªå¤§ï¼Œåˆ™æ²¡å¿…è¦è¿›è¡Œåˆ†è§£ã€‚</p>
</li>
<li>
<p>ä¼˜å…ˆçº§ä¸åŒçš„ä»»åŠ¡å¯ä»¥ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—PriorityBlockingQueueæ¥å¤„ç†ï¼Œå®ƒå¯ä»¥è®©ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡å…ˆå¾—åˆ°æ‰§è¡Œã€‚</p>
</li>
<li>
<p>æ‰§è¡Œæ—¶é—´ä¸åŒçš„ä»»åŠ¡å¯ä»¥äº¤ç»™ä¸åŒçº¿ç¨‹æ± æ¥å¤„ç†ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè®©æ‰§è¡Œæ—¶é—´çŸ­çš„ä»»åŠ¡å…ˆæ‰§è¡Œã€‚</p>
</li>
<li>
<p>ä¾èµ–æ•°æ®åº“è¿æ¥æ± çš„ä»»åŠ¡ï¼Œå› ä¸ºçº¿ç¨‹æäº¤SQLåéœ€è¦ç­‰å¾…æ•°æ®åº“è¿”å›ç»“æœï¼Œçº¿ç¨‹æ•°åº”è¯¥è®¾ç½®å¾—è¾ƒå¤§ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„åˆ©ç”¨CPUã€‚</p>
</li>
<li>
<p>å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œæœ‰ç•Œé˜Ÿåˆ—èƒ½å¢åŠ ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œé¢„è­¦èƒ½åŠ›ã€‚å¯ä»¥æ ¹æ®éœ€è¦è®¾å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚å‡ åƒã€‚ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ± çš„é˜Ÿåˆ—å°±ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæœ‰å¯èƒ½ä¼šæ’‘æ»¡å†…å­˜ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚ </p>
</li>
</ol>
</blockquote>
<h3 id="11-çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹">11. çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ol>
<li>é¦–å…ˆçº¿ç¨‹æ± æä¾›äº†éƒ¨åˆ†setteræ–¹æ³•å¯ä»¥è®¾ç½®çº¿ç¨‹æ± çš„å‚æ•°ï¼›</li>
</ol>
<p> a. ä¿®æ”¹æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œæœ€å¤§çº¿ç¨‹æ•°ï¼Œç©ºé—²çº¿ç¨‹åœç•™æ—¶é—´ï¼Œæ‹’ç»ç­–ç•¥ç­‰ã€‚</p>
<p> b. å¯ä»¥å°†çº¿ç¨‹æ± çš„é…ç½®å‚æ•°æ”¾å…¥é…ç½®ä¸­å¿ƒï¼Œå½“éœ€è¦è°ƒæ•´çš„æ—¶å€™ï¼Œå»é…ç½®ä¸­å¿ƒä¿®æ”¹å°±è¡Œã€‚</p>
<ul>
<li>ä»€ä¹ˆæ—¶å€™ä¿®æ”¹å‘¢?</li>
</ul>
<p> a. è¿™é‡Œéœ€è¦ç›‘æ§æŠ¥è­¦ç­–ç•¥ï¼Œè·å–çº¿ç¨‹æ± çŠ¶æ€æŒ‡æ ‡ï¼Œå½“æŒ‡æ ‡åˆ¤å®šä¸ºå¼‚å¸¸ä¹‹åè¿›è¡ŒæŠ¥è­¦ã€‚</p>
<p> b. åˆ†ææŒ‡æ ‡å¼‚å¸¸åŸå› ï¼Œè¯„ä¼°å¤„ç†ç­–ç•¥ï¼Œæœ€åé€šè¿‡ä¸Šè¿°çº¿ç¨‹æ± æä¾›çš„æ¥å£è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€‚(å¯ä»¥å°†åŠ¨æ€é…ç½®)</p>
</blockquote>
<p><strong>æ¨èå­¦ä¹ </strong>ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">Javaçº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ</a></p>
<h3 id="12-ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜">12. ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ä¾‹å¦‚newFixedThreadPoolä½¿ç”¨äº†æ— ç•Œçš„é˜»å¡é˜Ÿåˆ—LinkedBlockingQueueï¼Œå¦‚æœçº¿ç¨‹è·å–ä¸€ä¸ªä»»åŠ¡åï¼Œä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä¼šå¯¼è‡´é˜Ÿåˆ—çš„ä»»åŠ¡è¶Šç§¯è¶Šå¤šï¼Œå¯¼è‡´æœºå™¨å†…å­˜ä½¿ç”¨ä¸åœé£™å‡ï¼Œæœ€ç»ˆå¯¼è‡´OOMã€‚ </p>
</blockquote>
<h3 id="13-çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€">13. çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€?</h3>
<p><strong>åˆ†æ</strong></p>
<p>è¿™é‡Œé¢é¢è¯•å®˜å…¶å®æƒ³é—®ä½ çº¿ç¨‹å¤ç”¨çš„é€»è¾‘ï¼Œä»¥åŠå¯¹çº¿ç¨‹çŠ¶æ€æœºçš„ç†è§£ï¼ŒçŸ¥ä¸çŸ¥é“éƒ½è¦æœ‰ä¸€ä¸ªåˆ†ææ€è€ƒçš„è¿‡ç¨‹ï¼Œä¸è¦ä¸€ä¸Šæ¥å°±å›ç­”ç­”æ¡ˆæˆ–è€…è¯´ä¸çŸ¥é“ï¼ŒççŒœã€‚</p>
<p><strong>å‚è€ƒå›ç­”</strong></p>
<blockquote>
<p>é¦–å…ˆçº¿ç¨‹æœ¬èº«åˆ›å»ºå’Œé”€æ¯éƒ½æ˜¯æˆæœ¬æ¯”è¾ƒé«˜çš„ï¼Œé‚£å°±æ’é™¤newå’ŒterminatedçŠ¶æ€ï¼Œæ²¡æœ‰ä»»åŠ¡è¿è¡Œæ’é™¤runnableçŠ¶æ€ï¼Œå‰©ä¸‹é˜»å¡å’Œç­‰å¾…ï¼Œå› ä¸ºçº¿ç¨‹ä¸ä¼šé”€æ¯éœ€è¦ä¸€ç›´ç­‰å¾…æ‰§è¡Œä»»åŠ¡ï¼Œè¶…æ—¶ç­‰å¾…ä¹Ÿä¸å¤ªå¯èƒ½ï¼Œæœ€ååŒæ­¥é”æ‰ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘çŒœæ˜¯ä¸€ç›´ç­‰å¾…ã€‚ </p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image-2.png" alt=""></p>
<h3 id="14-å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ">14. å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ</h3>
<p>å¤§å®¶åº”è¯¥éƒ½çŸ¥é“ï¼Œçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ»¡äº†ï¼Œå°±ä¼šæ”¾åœ¨é˜»å¡é˜Ÿåˆ—ï¼Œé˜»å¡é˜Ÿåˆ—æ»¡äº†ä¼šåˆ›å»ºä¸´æ—¶çº¿ç¨‹ï¼Œå¦‚æœè¶…è¿‡æœ€å¤§çº¿ç¨‹æ•°ï¼Œå°±ä¼šè§¦å‘æ‹’ç»ç­–ç•¥ã€‚é‚£å¾ˆå¤šäººéƒ½æ˜¯ç”¨ç›´æ¥æ‹’ç»çš„ç­–ç•¥ï¼Œè¿™æ ·ä»»åŠ¡å°±ç›´æ¥ä¸¢äº†ã€‚ </p>
<p>ä½†æ˜¯å¦‚æœä»»åŠ¡å¾ˆé‡è¦ï¼Œä¸å…è®¸ä¸¢å¼ƒä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿé‚£å¤§å®¶å¯ä»¥æŠŠå·¥ä½œä¸­ç”¨åˆ°çš„æ–¹æ¡ˆå‘åœ¨è¯„è®ºåŒºï¼Œæˆ‘ç»™ä½ æä¾›å‡ ç§ï¼š</p>
<ol>
<li>
<p>ç”¨CallerRunsPolicyï¼Œå®ƒä¼šé‡‡ç”¨ä¸»çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä½†æ˜¯å¦‚æœä»»åŠ¡éå¸¸è€—æ—¶ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯æ…ç”¨ï¼</p>
</li>
<li>
<p>å°†ä»»åŠ¡è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¯ä»¥é‡‡ç”¨mysqlã€redisã€æˆ–è€…mqå¼‚æ­¥ç­‰æ–¹æ¡ˆæŒä¹…åŒ–ï¼Œåç»­å†å¯¹ä»»åŠ¡è¿›è¡Œè¡¥å¿æ‰§è¡Œã€‚</p>
</li>
<li>
<p>  ä¹Ÿå¯ä»¥å‚è€ƒnettyï¼šå®ƒä¼šå†åˆ›å»ºæ–°çš„ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚ </p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/image76.png" alt=""></p>
<h3 id="15-Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">15. Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<blockquote>
<p>Callableå’ŒRunnableæ¥å£éƒ½æ˜¯ç”¨äºåœ¨Javaä¸­å®ç°å¤šçº¿ç¨‹çš„æ¥å£ï¼Œä½†å®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›åŒºåˆ«ï¼š</p>
<ol>
<li>
<p><strong>è¿”å›å€¼</strong>ï¼š</p>
<ul>
<li>
<p>Runnableæ¥å£çš„run()æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œå®ƒé€šå¸¸ç”¨äºæ‰§è¡Œä¸€äº›ä¸éœ€è¦è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>Callableæ¥å£çš„call()æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªç»“æœï¼Œå®ƒå…è®¸çº¿ç¨‹æ‰§è¡Œä»»åŠ¡å¹¶è¿”å›ç»“æœï¼Œå¯ä»¥é€šè¿‡Futureå¯¹è±¡è·å–ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æŠ›å‡ºå¼‚å¸¸</strong>ï¼š</p>
<ul>
<li>
<p>Runnableæ¥å£çš„run()æ–¹æ³•ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œåªèƒ½æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ã€‚</p>
</li>
<li>
<p>Callableæ¥å£çš„call()æ–¹æ³•å¯ä»¥æŠ›å‡ºå—æ£€å¼‚å¸¸ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ³›å‹</strong>ï¼š</p>
<ul>
<li>
<p>Callableæ¥å£ä½¿ç”¨äº†æ³›å‹ï¼Œå¯ä»¥æŒ‡å®šcall()æ–¹æ³•çš„è¿”å›ç±»å‹ã€‚</p>
</li>
<li>
<p>Runnableæ¥å£æ²¡æœ‰ä½¿ç”¨æ³›å‹ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>çº¿ç¨‹æ± æ”¯æŒ</strong>ï¼š</p>
<ul>
<li>
<p>Callableæ¥å£é€šå¸¸ä¸Executoræ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥æäº¤ç»™ExecutorServiceçš„çº¿ç¨‹æ± æ‰§è¡Œã€‚</p>
</li>
<li>
<p>Runnableæ¥å£åŒæ ·å¯ä»¥ä¸Executoræ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯Callableæ¥å£æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¦‚å–æ¶ˆä»»åŠ¡ã€è·å–æ‰§è¡Œç»“æœç­‰ã€‚ </p>
</li>
</ul>
</li>
</ol>
</blockquote>
<h3 id="16-çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ">16. çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ</h3>
<blockquote>
<p>ç¬¬ä¸€ä¸ªçº¿ç¨‹æ± æ‹’ç»ç­–ç•¥æ˜¯ï¼š</p>
<p><strong>æ‰§è¡Œç­–ç•¥ä¸ºAbortPolicy</strong>ï¼šæ‰§è¡Œä»»åŠ¡å‡ºç°å¼‚å¸¸ï¼Œå‘æäº¤ä»»åŠ¡çº¿ç¨‹ï¼Œå³è°ƒç”¨çº¿ç¨‹ä¼šæŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ï¼Œå¹¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡ã€‚</p>
<p><strong>æ‰§è¡Œç­–ç•¥ä¸ºDiscardPolicy</strong>ï¼šå†…éƒ¨ä¼šæŠŠå¼‚å¸¸ä¿¡æ¯åæ‰ï¼Œæ—¢ä¸ä¼šæŠŠå¼‚å¸¸æŠ›ç»™è¿™ä¸ªçº¿ç¨‹æ± çº¿ç¨‹ï¼Œä¹Ÿä¸ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ã€‚</p>
<p>è¿™ä¸¤ç§æ‰§è¡Œæ–¹å¼ï¼Œéƒ½ä¸ä¼šå½±å“çº¿ç¨‹æ± é‡Œé¢å…¶ä»–çº¿ç¨‹çš„æ­£å¸¸æ‰§è¡Œï¼Œæ›´ä¾¿äºçº¿ç¨‹æ± çš„èµ„æºç®¡ç†ï¼Œå¯ä»¥é˜²æ­¢èµ„æºè¢«æ»¥ç”¨ï¼Œå¦‚æœç¨‹åºæœ‰é»˜è®¤å¤„ </p>
</blockquote>
<h3 id="17-çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹">17.çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹</h3>
<blockquote>
<p>çº¿ç¨‹æ± å¸¸ç”¨çš„é˜»å¡é˜Ÿåˆ—ç±»å‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ol>
<li>
<p><code>ArrayBlockingQueue</code>ï¼šåŸºäºæ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚å…¶å®¹é‡åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼Œä¸€æ—¦è¾¾åˆ°å®¹é‡ä¸Šé™ï¼Œæ–°çš„å…¥é˜Ÿæ“ä½œä¼šé˜»å¡ç­‰å¾…ã€‚</p>
</li>
<li>
<p><code>LinkedBlockingQueue</code>ï¼šåŸºäºé“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶å®¹é‡æ²¡æœ‰ä¸Šé™ï¼Œå¯ä»¥çœ‹ä½œæ˜¯æ— ç•Œçš„ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºæ—¶æŒ‡å®šå®¹é‡ã€‚</p>
</li>
<li>
<p><code>PriorityBlockingQueue</code>ï¼šæ— ç•Œçš„ä¼˜å…ˆçº§é˜»å¡é˜Ÿåˆ—ï¼Œå…ƒç´ æŒ‰ç…§è‡ªå®šä¹‰çš„ä¼˜å…ˆçº§è§„åˆ™è¿›è¡Œæ’åºã€‚</p>
</li>
<li>
<p><code>SynchronousQueue</code>ï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œå…¥é˜Ÿæ“ä½œå¿…é¡»ç­‰å¾…å‡ºé˜Ÿæ“ä½œï¼Œåä¹‹äº¦ç„¶ï¼Œå¸¸ç”¨äºå®ç°çº¿ç¨‹ä¹‹é—´çš„ç›´æ¥ä¼ é€’ã€‚</p>
</li>
<li>
<p><code>DelayQueue</code>ï¼šæ— ç•Œçš„å»¶è¿Ÿé˜»å¡é˜Ÿåˆ—ï¼Œå…ƒç´ åªæœ‰åœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åˆ°æœŸåæ‰èƒ½è¢«å–å‡ºã€‚</p>
</li>
<li>
<p><code>LinkedTransferQueue</code>ï¼šæ— ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰é«˜æ•ˆçš„å…ƒç´ ä¼ é€’ç‰¹æ€§ã€‚</p>
</li>
<li>
<p><code>LinkedBlockingDeque</code>ï¼šåŸºäºé“¾è¡¨å®ç°çš„åŒå‘é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥ä»é˜Ÿåˆ—çš„å¤´éƒ¨å’Œå°¾éƒ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p>
</li>
</ol>
</blockquote>
<h2 id="Javaä¸­çš„é”">Javaä¸­çš„é”</h2>
<h3 id="1-Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿">1. Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>Lockæ¥å£æ¯”åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—æä¾›äº†æ›´å…·æ‰©å±•æ€§çš„é”æ“ä½œã€‚å®ƒä»¬å…è®¸æ›´çµæ´»çš„ç»“æ„ï¼Œå¯ä»¥å…·æœ‰å®Œå…¨ä¸åŒçš„æ€§è´¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒå¤šä¸ªç›¸å…³ç±»çš„æ¡ä»¶å¯¹è±¡ã€‚</p>
<p>å®ƒçš„ä¼˜åŠ¿æœ‰ï¼š</p>
<ul>
<li>
<p><strong>(1) å¯ä»¥ä½¿é”æ›´å…¬å¹³ã€‚</strong></p>
</li>
<li>
<p><strong>(2) å¯ä»¥ä½¿çº¿ç¨‹åœ¨ç­‰å¾…é”çš„æ—¶å€™å“åº”ä¸­æ–­ã€‚</strong></p>
</li>
<li>
<p><strong>(3) å¯ä»¥è®©çº¿ç¨‹å°è¯•è·å–é”ï¼Œå¹¶åœ¨æ— æ³•è·å–é”çš„æ—¶å€™ç«‹å³è¿”å›æˆ–è€…ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</strong></p>
</li>
<li>
<p><strong>(4) å¯ä»¥åœ¨ä¸åŒçš„èŒƒå›´ï¼Œä»¥ä¸åŒçš„é¡ºåºè·å–å’Œé‡Šæ”¾é”ã€‚</strong></p>
</li>
</ul>
<p>æ•´ä½“ä¸Šæ¥è¯´Lockæ˜¯synchronizedçš„æ‰©å±•ç‰ˆï¼ŒLockæä¾›äº†æ— æ¡ä»¶çš„ã€å¯è½®è¯¢çš„(tryLockæ–¹æ³•)ã€å®šæ—¶çš„(tryLockå¸¦å‚æ–¹æ³•)ã€å¯ä¸­æ–­çš„(lockInterruptibly)ã€å¯å¤šæ¡ä»¶é˜Ÿåˆ—çš„(newConditionæ–¹æ³•)é”æ“ä½œã€‚å¦å¤–Lockçš„å®ç°ç±»åŸºæœ¬éƒ½æ”¯æŒéå…¬å¹³é”(é»˜è®¤)å’Œå…¬å¹³é”ï¼Œsynchronizedåªæ”¯æŒéå…¬å¹³é”ï¼Œå½“ç„¶ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œéå…¬å¹³é”æ˜¯é«˜æ•ˆçš„é€‰æ‹©ã€‚ </p>
</blockquote>
<h3 id="2-ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼">2. ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>
<p><strong>æ‚²è§‚é”ï¼š</strong>æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚å†æ¯”å¦‚Javaé‡Œé¢çš„åŒæ­¥åŸè¯­synchronizedå…³é”®å­—çš„å®ç°ä¹Ÿæ˜¯æ‚²è§‚é”ã€‚</p>
</li>
<li>
<p><strong>ä¹è§‚é”ï¼š</strong>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·ç­‰æœºåˆ¶ã€‚ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œåƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äºwrite_conditionæœºåˆ¶ï¼Œå…¶å®éƒ½æ˜¯æä¾›çš„ä¹è§‚é”ã€‚åœ¨Javaä¸­java.util.concurrent.atomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼CASå®ç°çš„ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="3-ä»€ä¹ˆæ˜¯CAS">3. ä»€ä¹ˆæ˜¯CAS</h3>
<p><strong>åˆ†æ</strong></p>
<p>å›ç­”å‡ºCASæ“ä½œçš„åŸå­æ€§ï¼Œç³»ç»Ÿç¡¬ä»¶çº§åˆ«æä¾›æ”¯æŒ</p>
<p><strong>å›ç­”</strong></p>
<blockquote>
<p>CASå³CompareAndSwapï¼ŒJavaä¸­å¯ä»¥é€šè¿‡CASæ“ä½œæ¥ä¿è¯åŸå­æ€§ï¼ŒåŸå­æ€§å°±æ˜¯ä¸å¯è¢«ä¸­æ–­çš„ä¸€ç³»åˆ—æ“ä½œæˆ–è€…ä¸€ä¸ªæ“ä½œï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ç³»åˆ—æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå¤±è´¥ï¼Œä¸èƒ½è¢«ä¸­æ–­ã€‚</p>
<p>CASä¸»è¦åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼ˆVï¼Œexpectï¼Œupdateï¼‰ï¼ŒVè¡¨ç¤ºè¦æ›´æ–°çš„å˜é‡ï¼ˆå†…å­˜å€¼ï¼‰ã€expectè¡¨ç¤ºé¢„æœŸå€¼ï¼ˆæ—§å€¼ï¼‰ã€updateè¡¨ç¤ºæ–°å€¼ã€‚ç®—æ³•æµç¨‹æ˜¯é¦–å…ˆæ¯”è¾ƒVå’Œexpectçš„å€¼ï¼Œå¦‚æœç›¸ç­‰ï¼Œå°†updateå€¼èµ‹å€¼ç»™Vï¼Œå¦‚æœä¸ç›¸ç­‰è¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å¯¹è¯¥å˜é‡åšäº†æ›´æ–°ã€‚è¿™ä¸ªå‚æ•°æœ‰çš„åœ°æ–¹ä¹Ÿä¼šç”¨ï¼ˆVï¼ŒAï¼ŒBï¼‰è¡¨ç¤ºï¼Œå…¶ä¸­Aè¡¨ç¤ºé¢„æœŸå€¼ï¼ŒBè¡¨ç¤ºæ–°å€¼ã€‚</p>
<p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹å˜é‡è¿›è¡ŒæˆåŠŸæ›´æ–°ï¼Œå…¶ä»–çº¿ç¨‹å‡ä¼šå¤±è´¥ï¼Œä½†æ˜¯å¤±è´¥å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè¿›è¡Œå†æ¬¡å°è¯•ï¼Œä¹Ÿå°±æ˜¯è‡ªæ—‹ã€‚Javaä¸­çš„è‡ªæ—‹é”å°±æ˜¯åˆ©ç”¨CASæ¥å®ç°çš„ã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huansky/p/15746624.html">Java CAS åŸç†è¯¦è§£ - huansky - åšå®¢å›­</a></p>
<h3 id="4-CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜">4. CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p><strong>1ã€ABAé—®é¢˜ï¼š</strong></p>
<p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹oneä»å†…å­˜ä½ç½®Vä¸­å–å‡ºAï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹twoä¹Ÿä»å†…å­˜ä¸­å–å‡ºAï¼Œå¹¶ä¸”twoè¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº†Bï¼Œç„¶åtwoåˆå°†Vä½ç½®çš„æ•°æ®å˜æˆAï¼Œè¿™æ—¶å€™çº¿ç¨‹oneè¿›è¡ŒCASæ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯Aï¼Œç„¶åoneæ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹oneçš„CASæ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œè—çš„é—®é¢˜ã€‚ä»Java1.5å¼€å§‹JDKçš„atomicåŒ…é‡Œæä¾›äº†ä¸€ä¸ªç±»AtomicStampedReferenceæ¥è§£å†³ABAé—®é¢˜ã€‚</p>
<p><strong>2ã€å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ï¼š</strong></p>
<p>å¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCASè‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„CPUèµ„æºï¼Œæ•ˆç‡ä½äºsynchronizedã€‚</p>
<p><strong>3ã€åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼š</strong></p>
<p>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯CASçš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯CASå°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”ã€‚ </p>
</blockquote>
<h3 id="5-ä»€ä¹ˆæ˜¯åŸå­ç±»">5. ä»€ä¹ˆæ˜¯åŸå­ç±»</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>java.util.concurrent.atomicåŒ…ï¼šæ˜¯åŸå­ç±»çš„å°å·¥å…·åŒ…ï¼Œæ”¯æŒåœ¨å•ä¸ªå˜é‡ä¸Šè§£è§£é”çš„çº¿ç¨‹å®‰å…¨ç¼–ç¨‹ã€‚åŸå­å˜é‡ç±»ç›¸å½“äºä¸€ç§æ³›åŒ–çš„volatileå˜é‡ï¼Œèƒ½å¤Ÿæ”¯æŒåŸå­çš„å’Œæœ‰æ¡ä»¶çš„è¯»-æ”¹-å†™æ“ä½œã€‚</p>
</li>
<li>
<p>æ¯”å¦‚ï¼šAtomicIntegerè¡¨ç¤ºä¸€ä¸ªintç±»å‹çš„å€¼ï¼Œå¹¶æä¾›äº†getå’Œsetæ–¹æ³•ï¼Œè¿™äº›Volatileç±»å‹çš„intå˜é‡åœ¨è¯»å–å’Œå†™å…¥ä¸Šæœ‰ç€ç›¸åŒçš„å†…å­˜è¯­ä¹‰ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ªåŸå­çš„compareAndSetæ–¹æ³•ï¼ˆå¦‚æœè¯¥æ–¹æ³•æˆåŠŸæ‰§è¡Œï¼Œé‚£ä¹ˆå°†å®ç°ä¸è¯»å–/å†™å…¥ä¸€ä¸ªvolatileå˜é‡ç›¸åŒçš„å†…å­˜æ•ˆæœï¼‰ï¼Œä»¥åŠåŸå­çš„æ·»åŠ ã€é€’å¢å’Œé€’å‡ç­‰æ–¹æ³•ã€‚AtomicIntegerè¡¨é¢ä¸Šéå¸¸åƒä¸€ä¸ªæ‰©å±•çš„Counterç±»ï¼Œä½†åœ¨å‘ç”Ÿç«äº‰çš„æƒ…å†µä¸‹èƒ½æä¾›æ›´é«˜çš„å¯ä¼¸ç¼©æ€§ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†ç¡¬ä»¶å¯¹å¹¶å‘çš„æ”¯æŒã€‚</p>
</li>
</ul>
<p>ç®€å•æ¥è¯´å°±æ˜¯åŸå­ç±»æ¥å®ç°CASæ— é”æ¨¡å¼çš„ç®—æ³•ã€‚</p>
</blockquote>
<h3 id="6-åŸå­ç±»çš„å¸¸ç”¨ç±»">6. åŸå­ç±»çš„å¸¸ç”¨ç±»</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>
<p>AtomicBoolean</p>
</li>
<li>
<p>AtomicInteger</p>
</li>
<li>
<p>AtomicLong</p>
</li>
<li>
<p>AtomicReference </p>
</li>
</ul>
</blockquote>
<h3 id="7-è¯´ä¸€ä¸‹Atomicçš„åŸç†">7. è¯´ä¸€ä¸‹Atomicçš„åŸç†?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>AtomicåŒ…ä¸­çš„ç±»åŸºæœ¬çš„ç‰¹æ€§å°±æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹å•ä¸ªï¼ˆåŒ…æ‹¬åŸºæœ¬ç±»å‹åŠå¼•ç”¨ç±»å‹ï¼‰å˜é‡è¿›è¡Œæ“ä½œæ—¶ï¼Œå…·æœ‰æ’ä»–æ€§ï¼Œå³å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹è¯¥å˜é‡çš„å€¼è¿›è¡Œæ›´æ–°æ—¶ï¼Œä»…æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸï¼Œè€ŒæœªæˆåŠŸçš„çº¿ç¨‹å¯ä»¥è‡ªæ—‹é”ä¸€æ ·ï¼Œç»§ç»­å°è¯•ï¼Œä¸€ç›´ç­‰åˆ°æ‰§è¡ŒæˆåŠŸã€‚</li>
</ul>
</blockquote>
<h3 id="8-æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«">8. æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p><strong>æ­»é”ï¼š</strong>æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>
<p><strong>æ´»é”ï¼š</strong>ä»»åŠ¡æˆ–è€…æ‰§è¡Œè€…æ²¡æœ‰è¢«é˜»å¡ï¼Œç”±äºæŸäº›æ¡ä»¶æ²¡æœ‰æ»¡è¶³ï¼Œå¯¼è‡´ä¸€ç›´é‡å¤å°è¯•ï¼Œå¤±è´¥ï¼Œå°è¯•ï¼Œå¤±è´¥ã€‚</p>
<p>æ´»é”å’Œæ­»é”çš„åŒºåˆ«åœ¨äºï¼Œå¤„äºæ´»é”çš„å®ä½“æ˜¯åœ¨ä¸æ–­çš„æ”¹å˜çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ´»â€ï¼Œè€Œå¤„äºæ­»é”çš„å®ä½“è¡¨ç°ä¸ºç­‰å¾…ï¼›æ´»é”æœ‰å¯èƒ½è‡ªè¡Œè§£å¼€ï¼Œæ­»é”åˆ™ä¸èƒ½ã€‚</p>
<p><strong>é¥¥é¥¿ï¼š</strong>ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œçš„çŠ¶æ€ã€‚ </p>
<p>Javaä¸­å¯¼è‡´é¥¥é¥¿çš„åŸå› :</p>
<p>1ã€é«˜ä¼˜å…ˆçº§çº¿ç¨‹åå™¬æ‰€æœ‰çš„ä½ä¼˜å…ˆçº§çº¿ç¨‹çš„CPUæ—¶é—´ã€‚</p>
<p>2ã€çº¿ç¨‹è¢«æ°¸ä¹…å µå¡åœ¨ä¸€ä¸ªç­‰å¾…è¿›å…¥åŒæ­¥å—çš„çŠ¶æ€ï¼Œå› ä¸ºå…¶ä»–çº¿ç¨‹æ€»æ˜¯èƒ½åœ¨å®ƒä¹‹å‰æŒç»­åœ°å¯¹è¯¥åŒæ­¥å—è¿›è¡Œè®¿é—®ã€‚</p>
<p>3ã€çº¿ç¨‹åœ¨ç­‰å¾…ä¸€ä¸ªæœ¬èº«ä¹Ÿå¤„äºæ°¸ä¹…ç­‰å¾…å®Œæˆçš„å¯¹è±¡(æ¯”å¦‚è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„waitæ–¹æ³•)ï¼Œå› ä¸ºå…¶ä»–çº¿ç¨‹æ€»æ˜¯è¢«æŒç»­åœ°è·å¾—å”¤é†’ã€‚ </p>
</blockquote>
<h3 id="9-å¦‚ä½•é¿å…æ­»é”">9. å¦‚ä½•é¿å…æ­»é”</h3>
<blockquote>
<p>æ­»é”æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ç§å¸¸è§é—®é¢˜ï¼Œå®ƒå‘ç”Ÿåœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºçš„æƒ…å†µä¸‹ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•ç»§ç»­æ‰§è¡Œã€‚ä¸ºäº†é¿å…æ­»é”ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ol>
<li>
<p><strong>é”é¡ºåº</strong>ï¼šå®šä¹‰ä¸€ä¸ªå›ºå®šçš„é”è·å–é¡ºåºï¼Œå¹¶è¦æ±‚æ‰€æœ‰çº¿ç¨‹éƒ½æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–é”ã€‚è¿™å¯ä»¥å‡å°‘ä¸åŒçº¿ç¨‹ä¹‹é—´èµ„æºäº‰å¤ºçš„å¯èƒ½æ€§ã€‚</p>
</li>
<li>
<p><strong>è¶…æ—¶æœºåˆ¶</strong>ï¼šåœ¨è·å–é”æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å¦‚æœè¶…è¿‡æŒ‡å®šæ—¶é—´ä»ç„¶æ— æ³•è·å–é”ï¼Œçº¿ç¨‹åº”è¯¥é‡Šæ”¾å·²ç»æŒæœ‰çš„é”å¹¶é‡è¯•ï¼Œæˆ–è€…é‡‡å–å…¶ä»–é€‚å½“çš„æªæ–½ã€‚è¿™æœ‰åŠ©äºé¿å…çº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…é”ã€‚</p>
</li>
<li>
<p><strong>é¿å…åµŒå¥—é”</strong>ï¼šå°½é‡é¿å…åœ¨ä¸€ä¸ªé”çš„æŒæœ‰æœŸé—´å†æ¬¡å°è¯•è·å–å…¶ä»–é”ã€‚å¦‚æœç¡®å®éœ€è¦è·å–å¤šä¸ªé”ï¼Œè¯·ç¡®ä¿è·å–çš„é¡ºåºæ˜¯å›ºå®šçš„ï¼Œä»¥å‡å°‘æ­»é”é£é™©ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨é”æœºåˆ¶</strong>ï¼šæ¯”å¦‚Javaä¸­çš„ReentrantLockï¼Œå®ƒæ”¯æŒå¯ä¸­æ–­çš„é”è·å–å’Œæ¡ä»¶ç­‰å¾…ï¼Œæœ‰åŠ©äºé¿å…æ­»é”ã€‚ </p>
</li>
</ol>
</blockquote>
<h3 id="10-ä¸ºä»€ä¹ˆ-wait-å’Œ-notify-æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨">10. ä¸ºä»€ä¹ˆ wait å’Œ notify æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨</h3>
<blockquote>
<p>è°ƒç”¨wait()å°±æ˜¯é‡Šæ”¾é”ï¼Œé‡Šæ”¾é”çš„å‰ææ˜¯å¿…é¡»è¦å…ˆè·å¾—é”ï¼Œå…ˆè·å¾—é”æ‰èƒ½é‡Šæ”¾é”ã€‚</p>
<p>notify(),notifyAll()æ˜¯å°†é”äº¤ç»™å«æœ‰wait()æ–¹æ³•çš„çº¿ç¨‹ï¼Œè®©å…¶ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå¦‚æœè‡ªèº«æ²¡æœ‰é”ï¼Œæ€ä¹ˆå«æŠŠé”äº¤ç»™å…¶ä»–çº¿ç¨‹ ã€‚</p>
</blockquote>
<h3 id="11-è¯´ä¸‹å¯¹AQSçš„ç†è§£">11. è¯´ä¸‹å¯¹AQSçš„ç†è§£</h3>
<p>AQSï¼ˆAbstractQueuedSynchronizerï¼‰æ˜¯Javaå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæä¾›äº†çº¿ç¨‹åŒæ­¥çš„åº•å±‚å®ç°æœºåˆ¶ã€‚AQSçš„ä½œç”¨æ˜¯å®ç°çº¿ç¨‹çš„åŒæ­¥å’Œäº’æ–¥æ“ä½œï¼Œå®ƒæä¾›äº†ä¸¤ç§ä¸»è¦çš„é”æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯æ’ä»–é”å’Œå…±äº«é”ã€‚</p>
<p><strong>æ’ä»–é”ä¹Ÿç§°ä¸ºç‹¬å é”</strong>ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€å…±äº«èµ„æºæ—¶ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥å…±äº«èµ„æºï¼Œå³å¤šä¸ªçº¿ç¨‹ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”èµ„æºã€‚åœ¨AQSä¸­ï¼Œæ’ä»–é”æ˜¯é€šè¿‡å†…ç½®çš„åŒæ­¥çŠ¶æ€æ¥å®ç°çš„ã€‚å½“åŒæ­¥çŠ¶æ€ä¸º0æ—¶ï¼Œè¡¨ç¤ºé”æ˜¯æœªè¢«è·å–çš„ï¼›å½“åŒæ­¥çŠ¶æ€å¤§äº0æ—¶ï¼Œè¡¨ç¤ºé”å·²ç»è¢«è·å–ä¸”è¢«å ç”¨ï¼›å½“åŒæ­¥çŠ¶æ€å°äº0æ—¶ï¼Œè¡¨ç¤ºé”å·²ç»è¢«è·å–ä½†æ˜¯å¤„äºç­‰å¾…çŠ¶æ€ã€‚</p>
<p><strong>å…±äº«é”</strong>å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—é”èµ„æºï¼Œä½†æ˜¯åœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–åˆ°é”çš„æ‹¥æœ‰æƒï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾é”ã€‚åœ¨AQSä¸­ï¼Œå…±äº«é”çš„å®ç°ä¸æ’ä»–é”ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡å…ˆè¿›å†…ç½®çš„åŒæ­¥çŠ¶æ€æ¥å®ç°çš„ã€‚</p>
<p>AQSé€šè¿‡ä¸€ä¸ªå†…ç½®çš„<strong>FIFO</strong>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ç­‰å¾…é˜Ÿåˆ—æ¥å®ç°çº¿ç¨‹çš„æ’é˜Ÿå’Œè°ƒåº¦ã€‚å½“çº¿ç¨‹éœ€è¦è·å–é”èµ„æºæ—¶ï¼Œå¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¼šè·å¾—é”èµ„æºå¹¶ç»§ç»­æ‰§è¡Œã€‚</p>
<p>åœ¨å®ç°AQSæ—¶ï¼Œéœ€è¦ç»§æ‰¿è‡ªAQSç±»å¹¶å®ç°å…¶æŠ½è±¡æ–¹æ³•ã€‚å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ–¹æ³•åŒ…æ‹¬ï¼štryAcquire()å’ŒtryRelease()æ–¹æ³•ï¼Œç”¨äºå®ç°é”çš„è·å–å’Œé‡Šæ”¾ï¼›acquire()å’Œrelease()æ–¹æ³•ï¼Œç”¨äºå®ç°é˜»å¡å’Œå”¤é†’æ“ä½œï¼›isHeldExclusively()æ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æ˜¯æ’ä»–é”ã€‚ </p>
<p>ç­”æ¡ˆï¼š</p>
<blockquote>
<p>AQSæ˜¯å¤šçº¿ç¨‹åŒæ­¥å™¨ï¼Œå®ƒæ˜¯J.U.CåŒ…ä¸­å¤šä¸ªç»„ä»¶çš„åº•å±‚å®ç°ï¼Œå¦‚Lockã€CountDownLatchã€Semaphoreç­‰éƒ½ç”¨åˆ°äº†AQSã€‚<strong>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒAQSæä¾›äº†ä¸¤ç§é”æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯æ’ä»–é”ï¼Œå’Œå…±äº«é”ã€‚</strong>æ’ä»–é”ï¼Œå°±æ˜¯å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰åŒä¸€å…±äº«èµ„æºæ—¶ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¯¥å…±äº«èµ„æºï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªçº¿ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”èµ„æºï¼Œæ¯”å¦‚Lockä¸­çš„ReentrantLocké‡å…¥é”å®ç°å°±æ˜¯ç”¨åˆ°äº†AQSä¸­çš„æ’ä»–é”åŠŸèƒ½ã€‚<strong>å…±äº«é”ä¹Ÿç§°ä¸ºè¯»é”</strong>ï¼Œå°±æ˜¯åœ¨åŒä¸€æ—¶åˆ»å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—é”èµ„æºï¼Œæ¯”å¦‚CountDownLatchå’ŒSemaphoreéƒ½æ˜¯ç”¨åˆ°äº†AQSä¸­çš„å…±äº«é”åŠŸèƒ½ã€‚</p>
<p>AQSæœ‰ä¸‰ä¸ªæ ¸å¿ƒçš„é—®é¢˜ï¼š</p>
<p>AQSç»´æŒç€ä¸€ä¸ªintç±»å‹çš„äº’æ–¥å˜é‡stateæ¥è®°å½•é”ç«äº‰çš„ä¸€ä¸ªçŠ¶æ€ï¼Œ0è¡¨ç¤ºå½“å‰æ²¡æœ‰ä»»ä½•çº¿ç¨‹ç«äº‰é”èµ„æºï¼Œè€Œå¤§äºç­‰äº1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹æ­£åœ¨æŒæœ‰é”èµ„æºã€‚ä¸€ä¸ªçº¿ç¨‹æ¥è·å–é”èµ„æºçš„æ—¶å€™ï¼Œé¦–å…ˆåˆ¤æ–­stateæ˜¯å¦ç­‰äº0ï¼Œå¦‚æœæ˜¯(æ— é”çŠ¶æ€)ï¼Œåˆ™æŠŠè¿™ä¸ªstateæ›´æ–°æˆ1ï¼Œè¡¨ç¤ºå ç”¨åˆ°é”ã€‚æ­¤æ—¶å¦‚æœå¤šä¸ªçº¿ç¨‹è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œä¼šé€ æˆçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚AQSé‡‡ç”¨äº†CASæœºåˆ¶æ¥ä¿è¯äº’æ–¥å˜é‡stateçš„åŸå­æ€§ã€‚</p>
<p>æœªè·å–åˆ°é”èµ„æºçš„çº¿ç¨‹é€šè¿‡Unsafeç±»ä¸­çš„parkæ–¹æ³•å¯¹çº¿ç¨‹è¿›è¡Œé˜»å¡ï¼ŒæŠŠé˜»å¡çš„çº¿ç¨‹æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„åŸåˆ™åŠ å…¥åˆ°ä¸€ä¸ªåŒå‘é“¾è¡¨çš„ç»“æ„<strong>CLH</strong>ä¸­ï¼Œå½“è·å¾—é”èµ„æºçš„çº¿ç¨‹é‡Šæ”¾é”ä¹‹åï¼Œä¼šä»åŒå‘é“¾è¡¨çš„å¤´éƒ¨å»å”¤é†’ä¸‹ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹å†å»ç«äº‰é”ã€‚</p>
<p><strong>CLH é˜Ÿåˆ—</strong>æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—,ç”¨äºå­˜å‚¨ç­‰å¾…é”çš„çº¿ç¨‹ã€‚å½“çº¿ç¨‹å°è¯•è·å–åŒæ­¥çŠ¶æ€å¤±è´¥æ—¶ï¼Œä¼šå°†å…¶å°è£…æˆä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå¹¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚çº¿ç¨‹é€šè¿‡è‡ªæ—‹çš„æ–¹å¼ä¸æ–­æ£€æŸ¥å…¶å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€æ¥åˆ¤æ–­è‡ªå·±æ˜¯å¦èƒ½å¤Ÿè·å–åˆ°é”ã€‚å½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼Œä¼šå”¤é†’å…¶åç»§èŠ‚ç‚¹çš„çº¿ç¨‹è¿›è¡Œç«äº‰è·å–ã€‚</p>
<p>å¦å¤–å…³äºå…¬å¹³æ€§å’Œéå…¬å¹³æ€§é—®é¢˜ï¼ŒAQSçš„å¤„ç†æ–¹å¼æ˜¯ï¼Œåœ¨ç«äº‰é”èµ„æºçš„æ—¶å€™ï¼Œå…¬å¹³é”éœ€è¦åˆ¤æ–­åŒå‘é“¾è¡¨ä¸­æ˜¯å¦æœ‰é˜»å¡çš„çº¿ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™éœ€è¦å»æ’é˜Ÿç­‰å¾…ï¼›è€Œéå…¬å¹³é”çš„å¤„ç†æ–¹å¼æ˜¯ï¼Œä¸ç®¡åŒå‘é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨ç­‰å¾…é”çš„çº¿ç¨‹ï¼Œéƒ½ä¼šç›´æ¥å°è¯•æ›´æ”¹äº’æ–¥å˜é‡stateå»ç«äº‰é”ã€‚ </p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://pdai.tech/md/java/thread/java-thread-x-lock-AbstractQueuedSynchronizer.html">JUCé”: é”æ ¸å¿ƒç±»AQSè¯¦è§£</a></p>
<p><a target="_blank" rel="noopener" href="https://javaguide.cn/java/concurrent/aqs.html">AQS è¯¦è§£</a></p>
<h3 id="12-è¯´ä¸‹CASçš„åŸç†">12. è¯´ä¸‹CASçš„åŸç†</h3>
<blockquote>
<p>CASï¼ˆCompare And Swapï¼‰æ˜¯ä¸€ç§<strong>ä¹è§‚çš„å¹¶å‘æ§åˆ¶æœºåˆ¶</strong>ï¼Œå®ƒçš„æ ¸å¿ƒåŸç†æ˜¯åŸºäºç¡¬ä»¶å±‚é¢çš„åŸå­æ€§ä¿è¯ã€‚CASæ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼ï¼ˆBï¼‰ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼š</p>
<ol>
<li>
<p>åœ¨å°†æ–°å€¼å†™å…¥å†…å­˜ä¹‹å‰ï¼ŒCASæ“ä½œä¼šå…ˆæ¯”è¾ƒå†…å­˜ä½ç½®çš„å€¼æ˜¯å¦ä¸é¢„æœŸåŸå€¼ç›¸åŒ¹é…ã€‚</p>
</li>
<li>
<p>å¦‚æœå†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ã€‚</p>
</li>
<li>
<p>å¦‚æœå†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼ä¸åŒ¹é…ï¼Œåˆ™CASæ“ä½œå¤±è´¥ï¼Œä¸ä¼šä¿®æ”¹å†…å­˜å€¼ã€‚</p>
</li>
</ol>
<p>CASçš„ä¼˜åŠ¿åœ¨äºå®ƒæ²¡æœ‰é˜»å¡çŠ¶æ€ï¼Œä¸ä¼šå¼•èµ·çº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢å’Œè°ƒåº¦é—®é¢˜ã€‚ç„¶è€Œï¼ŒCASä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚ABAé—®é¢˜å’Œå¼€é”€é—®é¢˜ã€‚ABAé—®é¢˜æ˜¯æŒ‡ä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œåˆå˜æˆäº†Aï¼Œé‚£ä¹ˆä½¿ç”¨CASè¿›è¡Œæ£€æŸ¥æ—¶ä¼šå‘ç°å®ƒçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å®é™…ä¸Šå´å˜åŒ–äº†ã€‚å¼€é”€é—®é¢˜åˆ™æ˜¯å› ä¸ºCASè‡ªæ—‹æ“ä½œéœ€è¦ä¸æ–­è½®è¯¢å†…å­˜ä½ç½®ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼Œè¿™ä¼šæ¶ˆè€—å¤§é‡çš„CPUèµ„æºã€‚ </p>
</blockquote>
<h3 id="13-ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°">13. ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°</h3>
<blockquote>
<p>ReentrantLockæ˜¯Javaä¸­æä¾›çš„ä¸€ç§å¯é‡å…¥é”ï¼Œå®ƒæ”¯æŒä¸¤ç§é”çš„æ¨¡å¼ï¼šå…¬å¹³é”å’Œéå…¬å¹³é”ã€‚è¿™ä¸¤ç§é”æ¨¡å¼çš„åº•å±‚å®ç°ç•¥æœ‰ä¸åŒï¼š</p>
<ol>
<li>
<p><strong>å…¬å¹³é”ï¼ˆFair Lockï¼‰</strong>ï¼šå…¬å¹³é”çš„ç‰¹ç‚¹æ˜¯æŒ‰ç…§è¯·æ±‚é”çš„é¡ºåºæ¥åˆ†é…ï¼Œå³å…ˆåˆ°å…ˆå¾—ã€‚åœ¨ReentrantLockä¸­ï¼Œé€šè¿‡æ„é€ å‡½æ•°å¯ä»¥é€‰æ‹©åˆ›å»ºä¸€ä¸ªå…¬å¹³é”ã€‚å…¬å¹³é”çš„åº•å±‚å®ç°ä½¿ç”¨äº†ä¸€ä¸ªFIFOé˜Ÿåˆ—ï¼ˆFirst - In - First - Outï¼‰ï¼Œå³ç­‰å¾…é˜Ÿåˆ—ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚é”æ—¶ï¼Œå¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œè¯·æ±‚çº¿ç¨‹ä¼šè¢«æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—çš„æœ«å°¾ï¼ŒæŒ‰ç…§è¯·æ±‚çš„é¡ºåºç­‰å¾…é”çš„é‡Šæ”¾ã€‚å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¼šè¢«å”¤é†’å¹¶è·å¾—é”ã€‚</p>
</li>
<li>
<p><strong>éå…¬å¹³é”ï¼ˆNon - Fair Lockï¼‰</strong>ï¼šéå…¬å¹³é”ä¸è€ƒè™‘è¯·æ±‚é”çš„é¡ºåºï¼Œå®ƒå…è®¸æ–°çš„è¯·æ±‚çº¿ç¨‹æ’é˜Ÿå¹¶å°è¯•ç«‹å³è·å–é”ï¼Œè€Œä¸ç®¡å…¶ä»–çº¿ç¨‹æ˜¯å¦åœ¨ç­‰å¾…ã€‚åœ¨ReentrantLockä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹åˆ›å»ºçš„æ˜¯éå…¬å¹³é”ã€‚éå…¬å¹³é”çš„åº•å±‚å®ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œä½†å®ƒä¸ä¼šä¸¥æ ¼æŒ‰ç…§è¯·æ±‚çš„é¡ºåºæ¥åˆ†é…é”ï¼Œè€Œæ˜¯æ ¹æ®çº¿ç¨‹ç«äº‰çš„æƒ…å†µæ¥åˆ¤æ–­æ˜¯å¦ç«‹å³åˆ†é…ç»™è¯·æ±‚çº¿ç¨‹ã€‚</p>
</li>
</ol>
<p>åº•å±‚å®ç°ä¸­ï¼Œæ— è®ºæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ï¼Œéƒ½ä½¿ç”¨äº†ç±»ä¼¼çš„åŒæ­¥å™¨ï¼ˆSyncï¼‰æ¥ç®¡ç†é”çš„çŠ¶æ€å’Œçº¿ç¨‹çš„ç«äº‰ã€‚ä¸åŒä¹‹å¤„åœ¨äºå¦‚ä½•å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œä»¥åŠæ˜¯å¦æŒ‰ç…§è¯·æ±‚çš„é¡ºåºæ¥åˆ†é…é”ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¬å¹³é”è™½ç„¶éµå¾ªå…¬å¹³æ€§åŸåˆ™ï¼Œä½†åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹å¯èƒ½ä¼šå¼•å…¥è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ï¼Œå› ä¸ºæ¯æ¬¡éƒ½è¦ç»´æŠ¤ä¸€ä¸ªæœ‰åºçš„ç­‰å¾…é˜Ÿåˆ—ã€‚è€Œéå…¬å¹³é”åˆ™æ›´åŠ çµæ´»ï¼Œä½†å¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹ä¸€ç›´è·å–ä¸åˆ°é”ã€‚ </p>
</blockquote>
<h3 id="14-AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„-åº•å±‚æ•°æ®ç»“æ„">14. AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„? åº•å±‚æ•°æ®ç»“æ„?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>AQSä¸»è¦ä¾èµ–äº<strong>ä¸€ä¸ªåŒå‘é“¾è¡¨</strong>å’Œä¸€ä¸ª<strong>volatileç±»å‹çš„æ•´æ•°state</strong>æ¥å®ç°åŒæ­¥æ§åˆ¶ã€‚è¯¥æ•´æ•°stateç”¨æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œstate=0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;0è¡¨ç¤ºæœ‰çº¿ç¨‹å ç”¨åŒæ­¥èµ„æºï¼Œstate&gt;1è¡¨ç¤ºåŒæ­¥èµ„æºå·²ç»è¢«äº‰ç”¨äº†å¤šæ¬¡ï¼Œæ¯”å¦‚ReentrantLockå¯ä»¥å…è®¸ä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—é”ï¼Œæ¯æ¬¡stateå€¼åŠ 1ã€‚</p>
<p>AQSå®ç°åŒæ­¥çš„å…³é”®åœ¨äºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåŸºäºFIFOé˜Ÿåˆ—çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œé€šè¿‡å°†ç­‰å¾…çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç„¶ååœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ—¶å€™ï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å”¤é†’ç­‰å¾…çº¿ç¨‹ï¼Œä»è€Œå®ç°äº†åŒæ­¥æœºåˆ¶ã€‚</p>
<p>AQSçš„å®ç°ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šç‹¬å å¼ï¼ˆExclusiveï¼‰å’Œå…±äº«å¼ï¼ˆSharedï¼‰ã€‚ç‹¬å å¼æ˜¯æŒ‡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚ReentrantLockï¼Œè€Œå…±äº«å¼æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å ç”¨åŒæ­¥èµ„æºï¼Œæ¯”å¦‚CountDownLatchã€‚åœ¨AQSä¸­ï¼Œè¿™ä¸¤ç§æ–¹å¼çš„å®ç°æ˜¯åŸºæœ¬ç›¸åŒçš„ï¼ŒåŒºåˆ«åœ¨äºè·å–å’Œé‡Šæ”¾åŒæ­¥çŠ¶æ€çš„æ–¹å¼ä¸åŒã€‚ </p>
</blockquote>
<h3 id="15-ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”">15. ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>â€œå¯é‡å…¥é”â€æ¦‚å¿µæ˜¯ï¼šè‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œå¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p>
</blockquote>
<h3 id="16-å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«">16. å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ul>
<li>
<p>å…¬å¹³é”ï¼šé”è¢«é‡Šæ”¾ä¹‹åï¼Œå…ˆç”³è¯·çš„çº¿ç¨‹å…ˆå¾—åˆ°é”ã€‚æ€§èƒ½è¾ƒå·®ä¸€äº›ï¼Œå› ä¸ºå…¬å¹³é”ä¸ºäº†ä¿è¯æ—¶é—´ä¸Šçš„ç»å¯¹é¡ºåºï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ›´é¢‘ç¹ã€‚</p>
</li>
<li>
<p>éå…¬å¹³é”ï¼šé”è¢«é‡Šæ”¾ä¹‹åï¼Œåç”³è¯·çš„çº¿ç¨‹å¯èƒ½ä¼šå…ˆè·å–åˆ°é”ï¼Œæ˜¯éšæœºæˆ–è€…æŒ‰ç…§å…¶ä»–ä¼˜å…ˆçº§æ’åºçš„ã€‚æ€§èƒ½æ›´å¥½ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æŸäº›çº¿ç¨‹æ°¸è¿œæ— æ³•è·å–åˆ°é”ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="17-ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½">17. ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>å…¬å¹³é”æ‰§è¡Œæµç¨‹ï¼šè·å–é”æ—¶ï¼Œå…ˆå°†çº¿ç¨‹è‡ªå·±æ·»åŠ åˆ°åŒæ­¥é˜Ÿåˆ—çš„é˜Ÿå°¾å¹¶ä¼‘çœ ï¼Œå½“æŸçº¿ç¨‹ç”¨å®Œé”ä¹‹åï¼Œä¼šå»å”¤é†’åŒæ­¥é˜Ÿåˆ—é˜Ÿé¦–çš„çº¿ç¨‹å°è¯•å»è·å–é”ï¼Œé”çš„ä½¿ç”¨åŒæ­¥ä¹Ÿå°±æ˜¯é˜Ÿåˆ—ä¸­çš„å…ˆåé¡ºåºï¼Œåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¼šä»è¿è¡ŒçŠ¶æ€åˆ‡æ¢åˆ°ä¼‘çœ çŠ¶æ€ï¼Œå†ä»ä¼‘çœ çŠ¶æ€æ¢å¤æˆè¿è¡ŒçŠ¶æ€ï¼Œä½†çº¿ç¨‹æ¯æ¬¡ä¼‘çœ å’Œæ¢å¤éƒ½éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢æˆå†…æ ¸æ€ï¼Œè€Œè¿™ä¸ªçŠ¶æ€çš„è½¬æ¢æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œæ‰€ä»¥å…¬å¹³é”çš„æ‰§è¡Œé€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ã€‚</p>
</li>
<li>
<p>éå…¬å¹³é”æ‰§è¡Œæµç¨‹ï¼šå½“çº¿ç¨‹è·å–é”æ—¶ï¼Œä¼šå…ˆé€šè¿‡CASå°è¯•è·å–é”ï¼Œå¦‚æœè·å–æˆåŠŸå°±ç›´æ¥æ‹¥æœ‰é”ï¼Œå¦‚æœè·å–é”å¤±è´¥æ‰ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸‹æ¬¡å°è¯•è·å–é”ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œè·å–é”ä¸éµå¾ªå…ˆåˆ°å…ˆå¾—çš„è§„åˆ™ï¼Œä»è€Œé¿å…äº†ä¸€æ¬¡çº¿ç¨‹ä¼‘çœ å’Œæ¢å¤çš„æ“ä½œï¼Œè¿™æ ·å°±åŠ é€Ÿäº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="18-ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„-éå…¬å¹³é”çš„">18. ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„? éå…¬å¹³é”çš„?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ReentrantLockç±»å†…éƒ¨æ€»å…±å­˜åœ¨Syncã€NonfairSyncã€FairSyncä¸‰ä¸ªç±»ï¼ŒNonfairSyncä¸FairSyncç±»ç»§æ‰¿è‡ªSyncç±»ï¼ŒSyncç±»ç»§æ‰¿è‡ªAbstractQueueuedSynchronizeræŠ½è±¡ç±»ã€‚</p>
<p>éå…¬å¹³é”æ˜¯ReentrantLockçš„é»˜è®¤å®ç°ã€‚å…¬å¹³é”å¯¹æ¯”éå…¬å¹³é”çš„å®ç°å·®å¼‚ä¸»è¦ä½“ç°åœ¨tryAcquireæ–¹æ³•ï¼ˆè·å–é”ï¼‰è¿™é‡Œã€‚éå…¬å¹³é”ï¼ˆNonfairSyncï¼‰çš„tryAcquireå®ç°ç›´æ¥è°ƒç”¨äº†çˆ¶ç±»Syncä¸­çš„nonfairTryAcquireã€‚</p>
<p>è€Œå…¬å¹³é”tryAcquireçš„å”¯ä¸€ä¸åŒçš„ç‚¹ä¸ºåˆ¤æ–­æ¡ä»¶å¤šäº†hasQueuedPredecessors()æ–¹æ³•ï¼Œå³åŠ å…¥äº†åŒæ­¥é˜Ÿåˆ—ä¸­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹çš„åˆ¤æ–­ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›trueï¼Œåˆ™è¡¨ç¤ºæœ‰çº¿ç¨‹æ¯”å½“å‰çº¿ç¨‹æ›´æ—©åœ°è¯·æ±‚è·å–é”ï¼Œå› æ­¤éœ€è¦ç­‰å¾…å‰é©±çº¿ç¨‹è·å–å¹¶é‡Šæ”¾é”ä¹‹åæ‰èƒ½ç»§ç»­è·å–é”ï¼ˆè¿™å°±å«å…¬å¹³ï¼‰ã€‚</p>
</blockquote>
<h3 id="19-ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ">19. ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼š<code>ReentrantReadWriteLock</code>å®ç°äº†<code>ReadWriteLock</code>ï¼Œæ˜¯ä¸€ä¸ªå¯é‡å…¥çš„è¯»å†™é”ï¼Œæ—¢å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»çš„æ•ˆç‡ï¼ŒåŒæ—¶åˆå¯ä»¥ä¿è¯æœ‰å†™å…¥æ“ä½œæ—¶çš„çº¿ç¨‹å®‰å…¨ã€‚</p>
<p><code>ReentrantReadWriteLock</code>å…¶å®æ˜¯ä¸¤æŠŠé”ï¼Œä¸€æŠŠæ˜¯WriteLockï¼ˆå†™é”ï¼‰ï¼Œä¸€æŠŠæ˜¯ReadLockï¼ˆè¯»é”ï¼‰ã€‚è¯»é”æ˜¯å…±äº«é”ï¼Œå†™é”æ˜¯ç‹¬å é”ã€‚è¯»é”å¯ä»¥è¢«åŒæ—¶è¯»ï¼Œå¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æŒæœ‰ï¼Œè€Œå†™é”æœ€å¤šåªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ã€‚ </p>
</blockquote>
<h3 id="20-å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«">20. å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>å…±äº«é”ï¼šä¸€æŠŠé”å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å¾—ã€‚</p>
</li>
<li>
<p>ç‹¬å é”ï¼šä¸€æŠŠé”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å¾—ã€‚</p>
</li>
</ul>
</blockquote>
<h3 id="21-çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—">21. çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>åœ¨çº¿ç¨‹æŒæœ‰è¯»é”çš„æƒ…å†µä¸‹ï¼šè¯¥çº¿ç¨‹ä¸èƒ½å–å¾—å†™é”(å› ä¸ºè·å–å†™é”çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å½“å‰çš„è¯»é”è¢«å ç”¨ï¼Œå°±é©¬ä¸Šè·å–å¤±è´¥ï¼Œä¸ç®¡è¯»é”æ˜¯ä¸æ˜¯è¢«å½“å‰çº¿ç¨‹æŒæœ‰)ã€‚</p>
<p>åœ¨çº¿ç¨‹æŒæœ‰å†™é”çš„æƒ…å†µä¸‹ï¼šè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­è·å–è¯»é”ï¼ˆè·å–è¯»é”æ—¶å¦‚æœå‘ç°å†™é”è¢«å ç”¨ï¼Œåªæœ‰å†™é”æ²¡æœ‰è¢«å½“å‰çº¿ç¨‹å ç”¨çš„æƒ…å†µæ‰ä¼šè·å–å¤±è´¥ï¼‰ã€‚</p>
</blockquote>
<h3 id="22-ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§-RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§">22. ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§? RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>å†™é”å¯ä»¥é™çº§ä¸ºè¯»é”ï¼Œä½†æ˜¯è¯»é”å´ä¸èƒ½å‡çº§ä¸ºå†™é”ã€‚è¿™æ˜¯å› ä¸ºè¯»é”å‡çº§ä¸ºå†™é”ä¼šå¼•èµ·çº¿ç¨‹çš„äº‰å¤ºï¼Œæ¯•ç«Ÿå†™é”å±äºæ˜¯ç‹¬å é”ï¼Œè¿™æ ·çš„è¯ï¼Œä¼šå½±å“æ€§èƒ½ã€‚å¦å¤–ï¼Œè¿˜å¯èƒ½ä¼šæœ‰æ­»é”é—®é¢˜å‘ç”Ÿã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ä¸¤ä¸ªçº¿ç¨‹çš„è¯»é”éƒ½æƒ³å‡çº§å†™é”ï¼Œåˆ™éœ€è¦å¯¹æ–¹éƒ½é‡Šæ”¾è‡ªå·±é”ï¼Œè€ŒåŒæ–¹éƒ½ä¸é‡Šæ”¾ï¼Œå°±ä¼šäº§ç”Ÿæ­»é”ã€‚ </p>
</blockquote>
<h3 id="23-ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„">23. ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šé«˜16ä½ä¸ºè¯»é”ï¼Œä½16ä½ä¸ºå†™é”ã€‚ </p>
</blockquote>
<h2 id="å¹¶å‘å®‰å…¨å®¹å™¨-å¹¶å‘å·¥å…·ç±»">å¹¶å‘å®‰å…¨å®¹å™¨/å¹¶å‘å·¥å…·ç±»</h2>
<h3 id="1-JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ">1. JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ</h3>
<blockquote>
<ol>
<li>
<p>JDK8ä¸­æ–°å¢äº†çº¢é»‘æ ‘ï¼ŒJDK8æ˜¯é€šè¿‡æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘æ¥å®ç°çš„ï¼›</p>
</li>
<li>
<p>JDK7ä¸­é“¾è¡¨çš„æ’å…¥æ˜¯ç”¨çš„å¤´æ’æ³•ï¼Œè€ŒJDK8ä¸­åˆ™æ”¹ä¸ºäº†å°¾æ’æ³•ï¼›</p>
</li>
<li>
<p>JDK8ä¸­å› ä¸ºä½¿ç”¨äº†çº¢é»‘æ ‘ä¿è¯äº†æ’å…¥å’ŒæŸ¥è¯¢çš„æ•ˆç‡ï¼Œæ‰€ä»¥å®é™…ä¸ŠJDK8ä¸­çš„Hashç®—æ³•å®ç°çš„å¤æ‚åº¦é™ä½äº†ï¼›</p>
</li>
<li>
<p>JDK8ä¸­æ•°ç»„æ‰©å®¹çš„æ¡ä»¶ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œåªä¼šåˆ¤æ–­æ˜¯å¦å½“å‰å…ƒç´ ä¸ªæ•°æ˜¯å¦è¶…è¿‡äº†é˜ˆå€¼ï¼Œè€Œä¸å†åˆ¤æ–­å½“å‰putè¿›æ¥çš„å…ƒç´ å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ä½ç½®æ˜¯å¦æœ‰å€¼ï¼›</p>
</li>
<li>
<p>JDK7ä¸­æ˜¯å…ˆæ‰©å®¹å†æ·»åŠ æ–°å…ƒç´ ï¼ŒJDK8ä¸­æ˜¯å…ˆæ·»åŠ æ–°å…ƒç´ ç„¶åå†æ‰©å®¹ã€‚ </p>
</li>
</ol>
</blockquote>
<h3 id="2-ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«">2. ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p>
<p><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼šJDK1.7çš„ConcurrentHashMapåº•å±‚é‡‡ç”¨åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨å®ç°ï¼ŒJDK1.8é‡‡ç”¨çš„æ•°æ®ç»“æ„è·ŸHashMap1.8çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚Hashtableå’ŒJDK1.8ä¹‹å‰çš„HashMapçš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</p>
<p><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰</strong>ï¼š</p>
<p>åœ¨JDK1.7çš„æ—¶å€™ï¼ŒConcurrentHashMapå¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segmentï¼Œåˆ†æ®µé”)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚</p>
<p>åˆ°äº†JDK1.8çš„æ—¶å€™ï¼ŒConcurrentHashMapå·²ç»æ‘’å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨Nodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨synchronizedå’ŒCASæ¥æ“ä½œã€‚(JDK1.6ä»¥åsynchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–) æ•´ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¼˜åŒ–è¿‡ä¸”çº¿ç¨‹å®‰å…¨çš„HashMapï¼Œè™½ç„¶åœ¨JDK1.8ä¸­è¿˜èƒ½çœ‹åˆ°Segmentçš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å·²ç»ç®€åŒ–äº†å±æ€§ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ï¼›</p>
<p>Hashtable(åŒä¸€æŠŠé”)ï¼šä½¿ç”¨synchronizedæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨putæ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨putæ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚ </p>
</blockquote>
<h3 id="3-ConcurrentHashMap-JDK1-7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ">3. ConcurrentHashMap JDK1.7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µï¼ˆè¿™ä¸ªâ€œæ®µâ€å°±æ˜¯Segmentï¼‰çš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®æ—¶ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</p>
</li>
<li>
<p>ConcurrentHashMapæ˜¯ç”±Segmentæ•°ç»„ç»“æ„å’ŒHashEntryæ•°ç»„ç»“æ„ç»„æˆã€‚</p>
</li>
<li>
<p>Segmentç»§æ‰¿äº†ReentrantLockï¼Œæ‰€ä»¥Segmentæ˜¯ä¸€ç§å¯é‡å…¥é”ï¼Œæ‰®æ¼”é”çš„è§’è‰²ã€‚HashEntryç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚</p>
</li>
<li>
<p>ä¸€ä¸ªConcurrentHashMapé‡ŒåŒ…å«ä¸€ä¸ªSegmentæ•°ç»„ï¼ŒSegmentçš„ä¸ªæ•°ä¸€æ—¦åˆå§‹åŒ–å°±ä¸èƒ½æ”¹å˜ã€‚Segmentæ•°ç»„çš„å¤§å°é»˜è®¤æ˜¯16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤å¯ä»¥åŒæ—¶æ”¯æŒ16ä¸ªçº¿ç¨‹å¹¶å‘å†™ã€‚</p>
</li>
<li>
<p>Segmentçš„ç»“æ„å’ŒHashMapç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ªSegmentåŒ…å«ä¸€ä¸ªHashEntryæ•°ç»„ï¼Œæ¯ä¸ªHashEntryæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ªSegmentå®ˆæŠ¤ç€ä¸€ä¸ªHashEntryæ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹HashEntryæ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å¯¹åº”çš„Segmentçš„é”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹åŒä¸€Segmentçš„å¹¶å‘å†™å…¥ä¼šè¢«é˜»å¡ï¼Œä¸åŒSegmentçš„å†™å…¥æ˜¯å¯ä»¥å¹¶å‘æ‰§è¡Œçš„ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="4-ConcurrentHashMap-JDK1-8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ">4. ConcurrentHashMap JDK1.8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>JDK1.8 ConcurrentHashMapå–æ¶ˆäº†Segmentåˆ†æ®µé”ï¼Œé‡‡ç”¨Node + CAS + synchronizedæ¥ä¿è¯å¹¶å‘å®‰å…¨ã€‚æ•°æ®ç»“æ„è·ŸHashMap 1.8çš„ç»“æ„ç±»ä¼¼ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚Java 8åœ¨é“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼8ï¼ˆåŒæ—¶æ»¡è¶³å®¹é‡&gt;=64ï¼‰æ—¶å°†é“¾è¡¨ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼‰è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼ˆå¯»å€æ—¶é—´å¤æ‚åº¦ä¸ºO(log(N))ï¼‰ã€‚</p>
<p>Java 8ä¸­ï¼Œé”ç²’åº¦æ›´ç»†ï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦hashä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œå°±ä¸ä¼šå½±å“å…¶ä»–Nodeçš„è¯»å†™ï¼Œæ•ˆç‡å¤§å¹…æå‡ã€‚</p>
</blockquote>
<h3 id="5-ConcurrentHashMap-JDK1-7çš„å®ç°å’Œ1-8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«">5. ConcurrentHashMap JDK1.7çš„å®ç°å’Œ1.8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p><strong>çº¿ç¨‹å®‰å…¨å®ç°æ–¹å¼</strong>ï¼šJDK 1.7é‡‡ç”¨Segmentåˆ†æ®µé”æ¥ä¿è¯å®‰å…¨ï¼ŒSegmentæ˜¯ç»§æ‰¿è‡ªReentrantLockã€‚JDK1.8æ”¾å¼ƒäº†Segmentåˆ†æ®µé”çš„è®¾è®¡ï¼Œé‡‡ç”¨Node + CAS + synchronizedä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé”ç²’åº¦æ›´ç»†ï¼Œsynchronizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ã€‚</p>
</li>
<li>
<p><strong>Hashç¢°æ’è§£å†³æ–¹æ³•</strong>ï¼šJDK 1.7é‡‡ç”¨æ‹‰é“¾æ³•ï¼ŒJDK1.8é‡‡ç”¨æ‹‰é“¾æ³•ç»“åˆçº¢é»‘æ ‘ï¼ˆé“¾è¡¨é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¹¶å‘åº¦</strong>ï¼šJDK 1.7æœ€å¤§å¹¶å‘åº¦æ˜¯Segmentçš„ä¸ªæ•°ï¼Œé»˜è®¤æ˜¯16ã€‚JDK 1.8æœ€å¤§å¹¶å‘åº¦æ˜¯Nodeæ•°ç»„çš„å¤§å°ï¼Œå¹¶å‘åº¦æ›´å¤§ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="6-JDK1-8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨">6. JDK1.8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šé“¾è¡¨é•¿åº¦å¤§äºç­‰äº8ï¼Œä¸”æ•°ç»„é•¿åº¦å¤§äºç­‰äº64ã€‚</p>
<p>å¹¶éä¸€å¼€å§‹å°±åˆ›å»ºçº¢é»‘æ ‘ç»“æ„ï¼Œå¦‚æœå½“å‰Nodeæ•°ç»„é•¿åº¦å°äºé˜ˆå€¼MIN_TREEIFY_CAPACITYï¼Œé»˜è®¤ä¸º64ï¼Œå…ˆé€šè¿‡æ‰©å¤§æ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ä¸¤å€ä»¥ç¼“è§£å•ä¸ªé“¾è¡¨å…ƒç´ è¿‡å¤§çš„æ€§èƒ½é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="7-JDK1-8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„">7. JDK1.8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>æ•´ä½“æµç¨‹è·ŸHashMapæ¯”è¾ƒç±»ä¼¼ï¼Œå¤§è‡´æ˜¯ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ul>
<li>
<p>å¦‚æœæ¡¶æ•°ç»„æœªåˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–ï¼›</p>
</li>
<li>
<p>å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ºç©ºï¼Œåˆ™å°è¯•æŠŠæ­¤å…ƒç´ ç›´æ¥æ’å…¥åˆ°æ¡¶çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼›</p>
</li>
<li>
<p>å¦‚æœæ­£åœ¨æ‰©å®¹ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¸€èµ·åŠ å…¥åˆ°æ‰©å®¹çš„è¿‡ç¨‹ä¸­ï¼›</p>
</li>
<li>
<p>å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ä¸ºç©ºä¸”æ²¡åœ¨è¿ç§»å…ƒç´ ï¼Œåˆ™é”ä½è¿™ä¸ªæ¡¶ï¼›</p>
</li>
<li>
<p>å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥é“¾è¡¨æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p>
</li>
<li>
<p>å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥çº¢é»‘æ ‘æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨çº¢é»‘æ ‘ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p>
</li>
<li>
<p>å¦‚æœå…ƒç´ å­˜åœ¨ï¼Œåˆ™è¦†ç›–æ—§å€¼ï¼›</p>
</li>
<li>
<p>å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œæ•´ä¸ªMapçš„å…ƒç´ ä¸ªæ•°åŠ 1ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ï¼› </p>
</li>
</ul>
</blockquote>
<h3 id="8-ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ">8. ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šä¸éœ€è¦ã€‚getæ–¹æ³•ä¸æ¶‰åŠå¯¹å˜é‡çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å¹¶å‘ä¸‹å¯èƒ½å¤„é—®é¢˜çš„åŸå› å°±æ˜¯è¯»å…±äº«å˜é‡çš„å¯è§æ€§é—®é¢˜ã€‚è€ŒConcurrentHashMapä¸­ï¼Œå¯¹getæ–¹æ³•ä¸­ç”¨åˆ°çš„å…±äº«å˜é‡éƒ½ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥æ•´ä¸ªgetæ–¹æ³•ä¸åŠ é”ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="9-ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘">9. ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šåˆå§‹å®¹é‡ä¸º16</p>
</blockquote>
<h3 id="10-ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull">10. ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šä¸è¡Œã€‚å¦‚æœkeyæˆ–è€…valueä¸ºnullä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚(åŸå› æ˜¯å› ä¸ºæ²¡åŠæ³•è§£å†³getè¿”å›å€¼ä¸ºnullæ—¶çš„äºŒä¹‰æ€§é—®é¢˜ï¼Œå³æ²¡åŠæ³•ç¡®å®šæ˜¯å­˜å‚¨çš„å€¼æœ¬èº«ä¸ºnullï¼Œè¿˜æ˜¯è¯´å€¼ä¸å­˜åœ¨)ï¼›</p>
<p>æ³¨æ„ï¼šHashMapå…è®¸ä½¿ç”¨nullä½œä¸ºå€¼å’Œé”®ã€‚(å› ä¸ºHashMapåªèƒ½å•çº¿ç¨‹ä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥hashmapå¯ä»¥ç”¨containsKeyæ¥äºŒæ¬¡åˆ¤æ–­ï¼Œæ’é™¤äºŒä¹‰æ€§é—®é¢˜) </p>
</blockquote>
<h3 id="11-å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡">11.å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šå®ƒæ˜¯å®ç°Map.Entry&lt;K, V&gt;æ¥å£ã€‚é‡Œé¢å­˜æ”¾äº†hashï¼Œkeyï¼Œvalueï¼Œä»¥åŠnextèŠ‚ç‚¹ã€‚å®ƒçš„valueå’ŒnextèŠ‚ç‚¹æ˜¯ç”¨volatileè¿›è¡Œä¿®é¥°ï¼Œå¯ä»¥ä¿è¯å¤šçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ã€‚</p>
</blockquote>
<h3 id="12-ä»€ä¹ˆæ˜¯BlockingQueue">12. ä»€ä¹ˆæ˜¯BlockingQueue?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>é˜»å¡é˜Ÿåˆ—(BlockingQueue)æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚è¿™ä¸¤ä¸ªé™„åŠ çš„æ“ä½œæ”¯æŒé˜»å¡çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•ã€‚</p>
<ol>
<li>
<p>æ”¯æŒé˜»å¡çš„æ’å…¥æ–¹æ³•ï¼šæ„æ€æ˜¯å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡æ’å…¥å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸æ»¡ã€‚</p>
</li>
<li>
<p>æ”¯æŒé˜»å¡çš„ç§»é™¤æ–¹æ³•ï¼šæ„æ€æ˜¯åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚ </p>
</li>
</ol>
</blockquote>
<h3 id="13-ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—">13.ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—</h3>
<blockquote>
<ul>
<li>
<p>ArrayBlockingQueueï¼šä¸€ä¸ªç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</p>
</li>
<li>
<p>LinkedBlockingQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„é˜»å¡é˜Ÿåˆ—ã€‚æ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¯ä»¥ä¸æŒ‡å®šå®¹é‡å¤§å°ï¼Œé»˜è®¤æ˜¯Integer.MAX_VALUEï¼Œä¹Ÿå°±æ˜¯æ— ç•Œçš„ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šé˜Ÿåˆ—å¤§å°ï¼Œä»è€Œæˆä¸ºæœ‰ç•Œçš„ã€‚</p>
</li>
<li>
<p>PriorityBlockingQueueï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹å…ƒç´ é‡‡å–è‡ªç„¶é¡ºåºå‡åºæ’åˆ—ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç±»å®ç°compareTo()æ–¹æ³•æ¥æŒ‡å®šå…ƒç´ æ’åºè§„åˆ™ã€‚</p>
</li>
<li>
<p>DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä½¿ç”¨PriorityQueueæ¥å®ç°ã€‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œåœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰èƒ½ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ã€‚åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ ã€‚ï¼ˆå¸¸ç”¨åœ¨ç¼“å­˜æœ‰æ•ˆæœŸï¼Œå®šæ—¶ä»»åŠ¡è°ƒåº¦ç­‰åœºæ™¯ï¼‰</p>
</li>
<li>
<p>SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸€ä¸ªputæ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªtakeæ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚é˜Ÿåˆ—æœ¬èº«å¹¶ä¸å­˜å‚¨ä»»ä½•å…ƒç´ ï¼Œéå¸¸é€‚åˆä¼ é€’æ€§åœºæ™¯ã€‚</p>
</li>
<li>
<p>LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„å•å‘æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚å®ƒè®¾è®¡äº†ä¸€ç§ç›´æ¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ä¼ è¾“å…ƒç´ çš„æœºåˆ¶ï¼Œç§°ä¸ºâ€œtransferâ€ã€‚å½“ç”Ÿäº§è€…è°ƒç”¨transfer(e)æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé˜»å¡ç›´åˆ°æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶è¯¥å…ƒç´ ã€‚é€‚ç”¨äºéœ€è¦é«˜æ•ˆåœ°åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ç›´æ¥ä¼ è¾“æ•°æ®çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯å½“ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„é€Ÿåº¦å¤§è‡´åŒ¹é…æ—¶ã€‚</p>
</li>
<li>
<p>LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚æ‰€è°“åŒå‘é˜Ÿåˆ—æŒ‡çš„æ˜¯å¯ä»¥ä»é˜Ÿåˆ—çš„ä¸¤ç«¯æ’å…¥å’Œç§»å‡ºå…ƒç´ ã€‚ç›¸æ¯”å…¶ä»–çš„é˜»å¡é˜Ÿåˆ—ï¼ŒLinkedBlockingDequeå¤šäº†addFirstã€addLastã€offerFirstã€offerLastã€peekFirstå’ŒpeekLastç­‰æ–¹æ³•ã€‚åŒå‘é˜»å¡é˜Ÿåˆ—å¯ä»¥è¿ç”¨åœ¨â€œå·¥ä½œçªƒå–â€æ¨¡å¼ä¸­ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="14-ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«">14. ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šArrayBlockingQueueå’ŒLinkedBlockingQueueæ˜¯Javaå¹¶å‘åŒ…ä¸­å¸¸ç”¨çš„ä¸¤ç§é˜»å¡é˜Ÿåˆ—å®ç°ï¼Œå®ƒä»¬éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨ä¸‹é¢è¿™äº›åŒºåˆ«ï¼š</p>
<ul>
<li>
<p>åº•å±‚å®ç°ï¼šArrayBlockingQueueåŸºäºæ•°ç»„å®ç°ï¼Œè€ŒLinkedBlockingQueueåŸºäºé“¾è¡¨å®ç°ã€‚</p>
</li>
<li>
<p>æ˜¯å¦æœ‰ç•Œï¼šArrayBlockingQueueæ˜¯æœ‰ç•Œé˜Ÿåˆ—ï¼Œå¿…é¡»åœ¨åˆ›å»ºæ—¶æŒ‡å®šå®¹é‡å¤§å°ã€‚LinkedBlockingQueueåˆ›å»ºæ—¶å¯ä»¥ä¸æŒ‡å®šå®¹é‡å¤§å°ï¼Œé»˜è®¤æ˜¯Integer.MAX_VALUEï¼Œä¹Ÿå°±æ˜¯æ— ç•Œçš„ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šé˜Ÿåˆ—å¤§å°ï¼Œä»è€Œæˆä¸ºæœ‰ç•Œçš„ã€‚</p>
</li>
<li>
<p>é”æ˜¯å¦åˆ†ç¦»ï¼šArrayBlockingQueueä¸­çš„é”æ˜¯æ²¡æœ‰åˆ†ç¦»çš„ï¼Œå³ç”Ÿäº§å’Œæ¶ˆè´¹ç”¨çš„æ˜¯åŒä¸€ä¸ªé”ï¼›LinkedBlockingQueueä¸­çš„é”æ˜¯åˆ†ç¦»çš„ï¼Œå³ç”Ÿäº§ç”¨çš„æ˜¯putLockï¼Œæ¶ˆè´¹æ˜¯takeLockï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä¹‹é—´çš„é”äº‰å¤ºã€‚</p>
</li>
<li>
<p>å†…å­˜å ç”¨ï¼šArrayBlockingQueueéœ€è¦æå‰åˆ†é…æ•°ç»„å†…å­˜ï¼Œè€ŒLinkedBlockingQueueåˆ™æ˜¯åŠ¨æ€åˆ†é…é“¾è¡¨èŠ‚ç‚¹å†…å­˜ã€‚è¿™æ„å‘³ç€ï¼ŒArrayBlockingQueueåœ¨åˆ›å»ºæ—¶å°±ä¼šå ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œä¸”å¾€å¾€ç”³è¯·çš„å†…å­˜æ¯”å®é™…æ‰€ç”¨çš„å†…å­˜æ›´å¤§ï¼Œè€ŒLinkedBlockingQueueåˆ™æ˜¯æ ¹æ®å…ƒç´ çš„å¢åŠ è€Œé€æ¸å ç”¨å†…å­˜ç©ºé—´ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="15-å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢">15. å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<p>ç­”ï¼šä½¿ç”¨é€šçŸ¥æ¨¡å¼å®ç°ã€‚æ‰€è°“é€šçŸ¥æ¨¡å¼ï¼Œå½“æ¶ˆè´¹è€…ä»ç©ºçš„é˜Ÿåˆ—è·å–å…ƒç´ æ—¶ä¼šé˜»å¡ä½æ¶ˆè´¹è€…ï¼Œæ­¤æ—¶å¦‚æœç”Ÿäº§è€…æ”¾äº†ä¸€ä¸ªå…ƒç´ è¿›å…¥é˜Ÿåˆ—ï¼Œåˆ™éœ€è¦é€šçŸ¥é˜»å¡ä½æ¶ˆè´¹è€…å½“å‰æœ‰å…ƒç´ å¯å–ã€‚åŒç†å½“ç”Ÿäº§è€…å¾€æ»¡çš„é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ æ—¶ä¼šé˜»å¡ä½ç”Ÿäº§è€…ï¼Œå½“æ¶ˆè´¹è€…æ¶ˆè´¹äº†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„å…ƒç´ åï¼Œä¼šé€šçŸ¥ç”Ÿäº§è€…å½“å‰é˜Ÿåˆ—å¯ç”¨ã€‚é€šè¿‡æŸ¥çœ‹JDKæºç å‘ç°éƒ¨åˆ†é˜»å¡é˜Ÿåˆ—ä½¿ç”¨äº†Conditionæ¥å®ç°ã€‚ </p>
</blockquote>
<h3 id="16-CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—">16. CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—?</h3>
<blockquote>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<ul>
<li>
<p>CountDownLatchï¼šå€’è®¡æ•°å™¨ã€‚å…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œã€‚</p>
</li>
<li>
<p>CyclicBarrierçš„å­—é¢æ„æ€æ˜¯å¯å¾ªç¯ä½¿ç”¨ï¼ˆCyclicï¼‰çš„å±éšœï¼ˆBarrierï¼‰ã€‚å®ƒè¦åšçš„äº‹æƒ…æ˜¯ï¼Œè®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å«åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡ï¼Œç›´åˆ°æœ€åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­è¿è¡Œã€‚</p>
</li>
<li>
<p>Semaphoreï¼ˆä¿¡å·é‡ï¼‰ï¼šæ˜¯ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡ï¼Œå®ƒé€šè¿‡åè°ƒå„ä¸ªçº¿ç¨‹ï¼Œä»¥ä¿è¯åˆç†çš„ä½¿ç”¨å…¬å…±èµ„æºã€‚</p>
</li>
<li>
<p>Exchangerï¼ˆäº¤æ¢è€…ï¼‰ï¼šæ˜¯ä¸€ä¸ªç”¨äºçº¿ç¨‹é—´åä½œçš„å·¥å…·ç±»ã€‚Exchangerç”¨äºè¿›è¡Œçº¿ç¨‹é—´çš„æ•°æ®äº¤æ¢ã€‚å®ƒæä¾›ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œåœ¨è¿™ä¸ªåŒæ­¥ç‚¹ï¼Œä¸¤ä¸ªçº¿ç¨‹å¯ä»¥äº¤æ¢å½¼æ­¤çš„æ•°æ®ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="17-CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«">17. CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<p><strong>å‚è€ƒå›ç­”</strong>ï¼š</p>
<blockquote>
<ol>
<li>CyclicBarrieræ˜¯å¯é‡ç”¨çš„ï¼Œå…¶ä¸­çš„çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆä»»åŠ¡ã€‚å±Šæ—¶ï¼Œå±éšœå°†è¢«æ‹†é™¤ï¼Œå¹¶å¯ä»¥é€‰æ‹©æ€§åœ°åšä¸€äº›ç‰¹å®šçš„åŠ¨ä½œã€‚</li>
</ol>
<p>CountDownLatchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨åŒä¸€ä¸ªè®¡æ•°å™¨ä¸Šå·¥ä½œï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º0.</p>
<ul>
<li>CyclicBarrieré¢å‘çš„æ˜¯çº¿ç¨‹æ•°ï¼›</li>
</ul>
<p>CountDownLatché¢å‘çš„æ˜¯ä»»åŠ¡æ•°ã€‚</p>
<ul>
<li>
<p>åœ¨ä½¿ç”¨CyclicBarrieræ—¶ï¼Œä½ å¿…é¡»åœ¨æ„é€ ä¸­æŒ‡å®šå‚ä¸åä½œçš„çº¿ç¨‹æ•°ï¼Œè¿™äº›çº¿ç¨‹å¿…é¡»è°ƒç”¨await()æ–¹æ³•ï¼›ä½¿ç”¨CountDownLatchæ—¶ï¼Œåˆ™å¿…é¡»è¦æŒ‡å®šä»»åŠ¡æ•°ï¼Œè‡³äºè¿™äº›ä»»åŠ¡ç”±å“ªäº›çº¿ç¨‹å®Œæˆæ— å…³ç´§è¦ã€‚</p>
</li>
<li>
<p>CyclicBarrierå¯ä»¥åœ¨æ‰€æœ‰çš„çº¿ç¨‹é‡Šæ”¾åé‡æ–°ä½¿ç”¨ï¼›CountDownLatchåœ¨è®¡æ•°å™¨ä¸º0æ—¶ä¸èƒ½å†ä½¿ç”¨ã€‚ </p>
</li>
</ul>
</blockquote>
<h3 id="18-å¸¸è§å‡½æ•°">18.å¸¸è§å‡½æ•°</h3>
<blockquote>
<p>åœ¨ JUCï¼ˆJava.util.concurrentï¼‰ä¸­ï¼Œä¸€äº›å¸¸ç”¨çš„å‡½æ•°åŠå…¶ä½œç”¨å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><code>park()</code> å’Œ <code>unpark()</code>ï¼š</p>
<ul>
<li>
<p><code>park()</code>ï¼šç”¨äºé˜»å¡å½“å‰çº¿ç¨‹ã€‚</p>
</li>
<li>
<p><code>unpark(Thread thread)</code>ï¼šç”¨äºå”¤é†’æŒ‡å®šçš„è¢« <code>park()</code> é˜»å¡çš„çº¿ç¨‹ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>wait()</code>ã€<code>notify()</code> å’Œ <code>notifyAll()</code>ï¼š</p>
<ul>
<li>
<p><code>wait()</code>ï¼šä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ <code>notify()</code> æ–¹æ³•æˆ– <code>notifyAll()</code> æ–¹æ³•ã€‚</p>
</li>
<li>
<p><code>notify()</code>ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚</p>
</li>
<li>
<p><code>notifyAll()</code>ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>Thread.sleep(long millis)</code>ï¼šä½¿å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœæŒ‡å®šçš„æ¯«ç§’æ•°ã€‚</p>
</li>
<li>
<p><code>CountDownLatch</code>ï¼š</p>
<ul>
<li>
<p><code>countDown()</code>ï¼šä½¿è®¡æ•°å™¨å‡ 1ã€‚</p>
</li>
<li>
<p><code>await()</code>ï¼šç­‰å¾…è®¡æ•°å™¨å˜ä¸º 0ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>CyclicBarrier</code>ï¼š</p>
<ul>
<li><code>await()</code>ï¼šç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœç‚¹ã€‚</li>
</ul>
</li>
<li>
<p><code>Semaphore</code>ï¼š</p>
<ul>
<li>
<p><code>acquire()</code>ï¼šè·å–ä¸€ä¸ªè®¸å¯ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨è®¸å¯åˆ™é˜»å¡ã€‚</p>
</li>
<li>
<p><code>release()</code>ï¼šé‡Šæ”¾ä¸€ä¸ªè®¸å¯ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>Future</code> å’Œ <code>CompletableFuture</code>ï¼šç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚</p>
</li>
</ol>
<p>è¿™äº›å‡½æ•°å’Œç±»ä¸ºå¤šçº¿ç¨‹ç¼–ç¨‹æä¾›äº†ä¸°å¯Œçš„å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°ç®¡ç†çº¿ç¨‹çš„åŒæ­¥ã€åä½œå’Œå¼‚æ­¥æ“ä½œã€‚ </p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>JUCåŸºç¡€é¢è¯•é¢˜</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://outoflovenicoo.github.io/posts/2025-01-09-JUC%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98.html">https://outoflovenicoo.github.io/posts/2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>OutOfLoveğŸ¥</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2025-01-09</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2025-03-23</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JUC/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>JUC</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ä½œè€…</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/01/04/2.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/04/2.webp" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/01/04/20f8e49805975b8f8.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/04/20f8e49805975b8f8.webp" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2025-01-01-Java%E5%9F%BA%E7%A1%80.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">JavaåŸºç¡€é¢è¯•é¢˜</div></div></a></div><div class="next-post pull-right"><a href="/posts/2025331p.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">MyBatisé¢è¯•é¢˜</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Future"><span class="toc-text">1.Future</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%881%EF%BC%89Future%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">ï¼ˆ1ï¼‰Futureçš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%882%EF%BC%89CompletableFuture%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">ï¼ˆ2ï¼‰CompletableFutureçš„ç”¨æ³•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">é¢è¯•é¢˜ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E5%9F%BA%E7%A1%80"><span class="toc-text">å¹¶å‘åŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%A6%82%E4%BD%95%E6%B5%81%E8%BD%AC"><span class="toc-text">1.çº¿ç¨‹çŠ¶æ€å¦‚ä½•æµè½¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Java%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">2.Javaåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E2%AD%90%EF%B8%8F%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%E4%B8%BA%E4%BD%95%E8%B0%83%E7%94%A8start%E8%80%8C%E4%B8%8D%E6%98%AFrun%E6%96%B9%E6%B3%95"><span class="toc-text">3. â­ï¸å¯åŠ¨çº¿ç¨‹ä¸ºä½•è°ƒç”¨startè€Œä¸æ˜¯runæ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-wait-%E3%80%81notify-%E5%92%8C-notifyAll-%E3%80%81sleep-%E3%80%81yield"><span class="toc-text">4. wait()ã€notify()å’Œ notifyAll()ã€sleep()ã€yield()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Java-%E4%B8%AD-interrupted-%E5%92%8C-isInterrupted-%E6%96%B9%E6%B3%95%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">5.Java ä¸­ interrupted å’Œ isInterrupted æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95%E5%92%8C%E5%90%8C%E6%AD%A5%E5%9D%97%EF%BC%8C%E5%93%AA%E4%B8%AA%E6%98%AF%E6%9B%B4%E5%A5%BD%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text">6. åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥å—ï¼Œå“ªä¸ªæ˜¯æ›´å¥½çš„é€‰æ‹©?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E5%92%8C%E7%BA%BF%E7%A8%8B%E4%BA%92%E6%96%A5%EF%BC%8C%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%EF%BC%9F"><span class="toc-text">7.ä»€ä¹ˆæ˜¯çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹äº’æ–¥ï¼Œæœ‰å“ªå‡ ç§å®ç°æ–¹å¼ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%9C%A8%E7%9B%91%E8%A7%86%E5%99%A8-Monitor-%E5%86%85%E9%83%A8%EF%BC%8C%E6%98%AF%E5%A6%82%E4%BD%95%E5%81%9A%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E7%9A%84%EF%BC%9F%E7%A8%8B%E5%BA%8F%E5%BA%94%E8%AF%A5%E5%81%9A%E5%93%AA%E7%A7%8D%E7%BA%A7%E5%88%AB%E7%9A%84%E5%90%8C%E6%AD%A5%EF%BC%9F"><span class="toc-text">8.åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%A6%82%E6%9E%9C%E4%BD%A0%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1%E6%97%B6%EF%BC%8C%E6%A0%B8%E5%BF%83%E7%BA%BF%E7%A8%8B%E6%95%B0%E5%B7%B2%E8%BE%BE%E5%88%B0%E9%85%8D%E7%BD%AE%E7%9A%84%E6%95%B0%E9%87%8F%EF%BC%8C%E8%BF%99%E6%97%B6%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88"><span class="toc-text">9.å¦‚æœä½ æäº¤ä»»åŠ¡æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%9C%A8-Java-%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E8%BF%90%E8%A1%8C%E5%AE%89%E5%85%A8%EF%BC%9F"><span class="toc-text">10.åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%BA%BF%E7%A8%8B%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E3%80%81%E9%9D%99%E6%80%81%E5%9D%97%E6%98%AF%E8%A2%AB%E5%93%AA%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8%E7%9A%84"><span class="toc-text">11.çº¿ç¨‹ç±»çš„æ„é€ æ–¹æ³•ã€é™æ€å—æ˜¯è¢«å“ªä¸ªçº¿ç¨‹è°ƒç”¨çš„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Java%E4%B8%AD%E6%80%8E%E4%B9%88%E8%8E%B7%E5%8F%96%E4%B8%80%E4%BB%BD%E7%BA%BF%E7%A8%8Bdump%E6%96%87%E4%BB%B6%EF%BC%9F%E4%BD%A0%E5%A6%82%E4%BD%95%E5%9C%A8Java%E4%B8%AD%E8%8E%B7%E5%8F%96%E7%BA%BF%E7%A8%8B%E5%A0%86%E6%A0%88%EF%BC%9F"><span class="toc-text">12. Javaä¸­æ€ä¹ˆè·å–ä¸€ä»½çº¿ç¨‹dumpæ–‡ä»¶ï¼Ÿä½ å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹å †æ ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%8F%91%E7%94%9F%E5%BC%82%E5%B8%B8%E4%BC%9A%E6%80%8E%E6%A0%B7%EF%BC%9F"><span class="toc-text">13. ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ä¼šæ€æ ·ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">14.å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E2%9D%93%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8B-ThreadLocal"><span class="toc-text">15.â“ä»‹ç»ä¸€ä¸‹ ThreadLocal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-ThreadLocal-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E9%97%AE%E9%A2%98%E4%BA%86%E8%A7%A3%E5%90%97"><span class="toc-text">16.ThreadLocal å†…å­˜æ³„éœ²é—®é¢˜äº†è§£å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8ThreadLocal%E4%B8%8D%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F"><span class="toc-text">17.ä¸ºä»€ä¹ˆç”¨ThreadLocalä¸ç”¨çº¿ç¨‹æˆå‘˜å˜é‡?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%AD%90%EF%B8%8FJava%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%EF%BC%88Volatile-Synchronized-CAS%EF%BC%89"><span class="toc-text">â­ï¸Javaå¹¶å‘ç†è®ºï¼ˆVolatile&#x2F;Synchronized&#x2F;CASï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%A6%82%E4%BD%95%E9%80%9A%E4%BF%A1%E5%8F%8A%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%A6%82%E4%BD%95%E5%90%8C%E6%AD%A5"><span class="toc-text">1. çº¿ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡åŠçº¿ç¨‹ä¹‹é—´å¦‚ä½•åŒæ­¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%EF%BC%88JMM%EF%BC%89"><span class="toc-text">2.Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Happens-Before-%E5%8E%9F%E5%88%99"><span class="toc-text">3.Happens-Before åŸåˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Java-%E6%80%8E%E4%B9%88%E8%BF%9B%E8%A1%8C%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%EF%BC%9F"><span class="toc-text">4.Java æ€ä¹ˆè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-synchronized%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">5. synchronizedå…³é”®å­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AF%B4%E8%AF%B4%E8%87%AA%E5%B7%B1%E6%98%AF%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8synchronized%E5%85%B3%E9%94%AE%E5%AD%97%EF%BC%8C%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%94%A8%E5%88%B0%E4%BA%86%E5%90%97"><span class="toc-text">6. è¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆä½¿ç”¨synchronizedå…³é”®å­—ï¼Œåœ¨é¡¹ç›®ä¸­ç”¨åˆ°äº†å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%AF%B4%E4%B8%80%E4%B8%8Bsynchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-text">7. è¯´ä¸€ä¸‹synchronizedåº•å±‚å®ç°åŸç†?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-synchronized%E5%8F%AF%E9%87%8D%E5%85%A5%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">8. synchronizedå¯é‡å…¥çš„åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E4%BB%80%E4%B9%88%E6%98%AF%E8%87%AA%E6%97%8B"><span class="toc-text">9. ä»€ä¹ˆæ˜¯è‡ªæ—‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%ADsynchronized%E9%94%81%E5%8D%87%E7%BA%A7%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">10. å¤šçº¿ç¨‹ä¸­synchronizedé”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%BA%BF%E7%A8%8BB%E6%80%8E%E4%B9%88%E7%9F%A5%E9%81%93%E7%BA%BF%E7%A8%8BA%E4%BF%AE%E6%94%B9%E4%BA%86%E5%8F%98%E9%87%8F"><span class="toc-text">11. çº¿ç¨‹Bæ€ä¹ˆçŸ¥é“çº¿ç¨‹Aä¿®æ”¹äº†å˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%BD%93%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%BF%9B%E5%85%A5%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84synchronized%E6%96%B9%E6%B3%95A%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%85%B6%E5%AE%83%E7%BA%BF%E7%A8%8B%E6%98%AF%E5%90%A6%E5%8F%AF%E8%BF%9B%E5%85%A5%E6%AD%A4%E5%AF%B9%E8%B1%A1%E7%9A%84synchronized%E6%96%B9%E6%B3%95B"><span class="toc-text">12. å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•B?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-synchronized%E3%80%81volatile%E3%80%81CAS%E6%AF%94%E8%BE%83"><span class="toc-text">13. synchronizedã€volatileã€CASæ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-synchronized%E5%92%8CLock%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">14. synchronizedå’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-synchronized%E5%92%8CLock%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9"><span class="toc-text">15. synchronizedå’ŒLockå¦‚ä½•é€‰æ‹©?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-synchronized%E5%92%8CReentrantLock%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">16. synchronizedå’ŒReentrantLockåŒºåˆ«æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-volatile%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">17. volatileå…³é”®å­—çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-Java%E4%B8%AD%E8%83%BD%E5%88%9B%E5%BB%BAvolatile%E6%95%B0%E7%BB%84%E5%90%97"><span class="toc-text">18. Javaä¸­èƒ½åˆ›å»ºvolatileæ•°ç»„å—?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-volatile%E8%83%BD%E4%BD%BF%E5%BE%97%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E5%8F%98%E6%88%90%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E5%90%97"><span class="toc-text">19. volatileèƒ½ä½¿å¾—ä¸€ä¸ªéåŸå­æ“ä½œå˜æˆåŸå­æ“ä½œå—?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-synchronized%E5%92%8Cvolatile%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">20. synchronizedå’Œvolatileçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E8%AF%B4%E4%B8%8B%E4%BD%A0%E5%AF%B9volatile%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-text">21. è¯´ä¸‹ä½ å¯¹volatileçš„ç†è§£</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-text">çº¿ç¨‹æ± </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-text">1. ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%A0%B8%E5%BF%83%E5%8F%82%E6%95%B0%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-text">2. æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E7%A7%8D%E7%B1%BB%EF%BC%8C%E5%8C%BA%E5%88%AB%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">3. çº¿ç¨‹æ± çš„ç§ç±»ï¼ŒåŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-text">4. çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥æœ‰å“ªäº›</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%9C%A8Java%E4%B8%ADExecutor%E5%92%8CExecutors%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">5. åœ¨Javaä¸­Executorå’ŒExecutorsçš„åŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E7%8A%B6%E6%80%81"><span class="toc-text">6.çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%ADsubmit-%E5%92%8Cexecute-%E6%96%B9%E6%B3%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">7. çº¿ç¨‹æ± ä¸­submit()å’Œexecute()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%88%86%E6%9E%90%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E8%B0%83%E5%BA%A6%E8%BF%87%E7%A8%8B"><span class="toc-text">8. åˆ†æçº¿ç¨‹æ± çš„å®ç°åŸç†å’Œçº¿ç¨‹çš„è°ƒåº¦è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E6%9C%80%E5%A4%A7%E7%BA%BF%E7%A8%8B%E6%95%B0%E7%9B%AE%E6%A0%B9%E6%8D%AE%E4%BB%80%E4%B9%88%E7%A1%AE%E5%AE%9A"><span class="toc-text">9. çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ç›®æ ¹æ®ä»€ä¹ˆç¡®å®š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%A6%82%E4%BD%95%E8%B0%83%E4%BC%98"><span class="toc-text">10. çº¿ç¨‹æ± å¦‚ä½•è°ƒä¼˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9"><span class="toc-text">11. çº¿ç¨‹æ± å¦‚ä½•å®ç°åŠ¨æ€ä¿®æ”¹?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E4%BD%BF%E7%94%A8%E6%97%A0%E7%95%8C%E9%98%9F%E5%88%97%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text">12. ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%BD%93%E5%89%8D%E5%A4%84%E4%BA%8E%E7%A9%BA%E9%97%B2%E7%9A%84%E7%8A%B6%E6%80%81%EF%BC%8C%E6%A0%B8%E5%BF%83%E7%BA%BF%E7%A8%8B%E6%95%B0%E9%87%8F%E6%98%AF%E4%B8%8D%E4%BC%9A%E8%A2%AB%E9%94%80%E6%AF%81%E7%9A%84%EF%BC%8C%E9%82%A3%E8%BF%99%E5%87%A0%E4%B8%AA%E6%A0%B8%E5%BF%83%E7%BA%BF%E7%A8%8B%E5%A4%84%E4%BA%8E%E4%BB%80%E4%B9%88%E7%8A%B6%E6%80%81%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E5%A4%84%E4%BA%8E%E8%BF%99%E4%B8%AA%E7%8A%B6%E6%80%81"><span class="toc-text">13. çº¿ç¨‹æ± çš„é—®é¢˜ï¼Œå¦‚æœçº¿ç¨‹æ± å½“å‰å¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œé‚£è¿™å‡ ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Ÿä¸ºä»€ä¹ˆå¤„äºè¿™ä¸ªçŠ¶æ€?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E5%A6%82%E6%9E%9C%E4%B8%8D%E5%85%81%E8%AE%B8%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%A2%E5%BC%83%E4%BB%BB%E5%8A%A1%EF%BC%8C%E5%BA%94%E8%AF%A5%E9%80%89%E6%8B%A9%E5%93%AA%E4%B8%AA%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5%EF%BC%9F"><span class="toc-text">14. å¦‚æœä¸å…è®¸çº¿ç¨‹æ± ä¸¢å¼ƒä»»åŠ¡ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªæ‹’ç»ç­–ç•¥ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-Callable%E5%92%8CRunnable%E6%8E%A5%E5%8F%A3%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">15. Callableå’ŒRunnableæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%BA%BF%E7%A8%8B%E5%BC%82%E5%B8%B8%E5%90%8E%EF%BC%9A%E9%94%80%E6%AF%81%E8%BF%98%E6%98%AF%E5%A4%8D%E7%94%A8%EF%BC%9F"><span class="toc-text">16. çº¿ç¨‹æ± ä¸­çº¿ç¨‹å¼‚å¸¸åï¼šé”€æ¯è¿˜æ˜¯å¤ç”¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-text">17.çº¿ç¨‹æ± é˜»å¡é˜Ÿåˆ—ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E4%B8%AD%E7%9A%84%E9%94%81"><span class="toc-text">Javaä¸­çš„é”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Lock%E6%8E%A5%E5%8F%A3%E5%92%8Csynchronized%E5%AF%B9%E6%AF%94%E5%90%8C%E6%AD%A5%E5%AE%83%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E5%8A%BF"><span class="toc-text">1. Lockæ¥å£å’Œsynchronizedå¯¹æ¯”åŒæ­¥å®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81%E7%9A%84%E7%90%86%E8%A7%A3%E5%8F%8A%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-text">2. ä¹è§‚é”å’Œæ‚²è§‚é”çš„ç†è§£åŠå¦‚ä½•å®ç°ï¼Œæœ‰å“ªäº›å®ç°æ–¹å¼?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BB%80%E4%B9%88%E6%98%AFCAS"><span class="toc-text">3. ä»€ä¹ˆæ˜¯CAS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-CAS%E7%9A%84%E4%BC%9A%E4%BA%A7%E7%94%9F%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text">4. CASçš„ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8E%9F%E5%AD%90%E7%B1%BB"><span class="toc-text">5. ä»€ä¹ˆæ˜¯åŸå­ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%8E%9F%E5%AD%90%E7%B1%BB%E7%9A%84%E5%B8%B8%E7%94%A8%E7%B1%BB"><span class="toc-text">6. åŸå­ç±»çš„å¸¸ç”¨ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%AF%B4%E4%B8%80%E4%B8%8BAtomic%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">7. è¯´ä¸€ä¸‹Atomicçš„åŸç†?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%AD%BB%E9%94%81%E4%B8%8E%E6%B4%BB%E9%94%81%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%8C%E6%AD%BB%E9%94%81%E4%B8%8E%E9%A5%A5%E9%A5%BF%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">8. æ­»é”ä¸æ´»é”çš„åŒºåˆ«ï¼Œæ­»é”ä¸é¥¥é¥¿çš„åŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E6%AD%BB%E9%94%81"><span class="toc-text">9. å¦‚ä½•é¿å…æ­»é”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E4%B8%BA%E4%BB%80%E4%B9%88-wait-%E5%92%8C-notify-%E6%96%B9%E6%B3%95%E8%A6%81%E5%9C%A8%E5%90%8C%E6%AD%A5%E5%9D%97%E4%B8%AD%E8%B0%83%E7%94%A8"><span class="toc-text">10. ä¸ºä»€ä¹ˆ wait å’Œ notify æ–¹æ³•è¦åœ¨åŒæ­¥å—ä¸­è°ƒç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E8%AF%B4%E4%B8%8B%E5%AF%B9AQS%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-text">11. è¯´ä¸‹å¯¹AQSçš„ç†è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%AF%B4%E4%B8%8BCAS%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">12. è¯´ä¸‹CASçš„åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-ReentrantLock%E4%B8%AD%E7%9A%84%E5%85%AC%E5%B9%B3%E9%94%81%E5%92%8C%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0"><span class="toc-text">13. ReentrantLockä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„åº•å±‚å®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-AQS%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E5%90%8C%E6%AD%A5%E7%AE%A1%E7%90%86%E7%9A%84-%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">14. AQSæ˜¯æ€ä¹ˆå®ç°åŒæ­¥ç®¡ç†çš„? åº•å±‚æ•°æ®ç»“æ„?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%AF%E9%87%8D%E5%85%A5%EF%BC%8C%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81"><span class="toc-text">15. ä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥é”?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E5%85%AC%E5%B9%B3%E9%94%81%E5%92%8C%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">16. å…¬å¹³é”å’Œéå…¬å¹³é”æœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%E6%AF%94%E5%85%AC%E5%B9%B3%E9%94%81%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD"><span class="toc-text">17. ä¸ºä»€ä¹ˆéå…¬å¹³é”æ¯”å…¬å¹³é”æ€§èƒ½æ›´å¥½?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-ReentrantLock%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%85%AC%E5%B9%B3%E9%94%81%E7%9A%84-%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81%E7%9A%84"><span class="toc-text">18. ReentrantLockæ˜¯å¦‚ä½•å®ç°å…¬å¹³é”çš„? éå…¬å¹³é”çš„?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-ReentrantReadWriteLock%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">19. ReentrantReadWriteLockæ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-%E5%85%B1%E4%BA%AB%E9%94%81%E5%92%8C%E7%8B%AC%E5%8D%A0%E9%94%81%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">20. å…±äº«é”å’Œç‹¬å é”æœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E7%BA%BF%E7%A8%8B%E6%8C%81%E6%9C%89%E8%AF%BB%E9%94%81%E8%BF%98%E8%83%BD%E8%8E%B7%E5%8F%96%E5%86%99%E9%94%81%E5%90%97"><span class="toc-text">21. çº¿ç¨‹æŒæœ‰è¯»é”è¿˜èƒ½è·å–å†™é”å—?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E4%BB%80%E4%B9%88%E6%98%AF%E9%94%81%E7%9A%84%E5%8D%87%E9%99%8D%E7%BA%A7-RentrantReadWriteLock%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E6%94%AF%E6%8C%81%E9%94%81%E5%8D%87%E7%BA%A7"><span class="toc-text">22. ä»€ä¹ˆæ˜¯é”çš„å‡é™çº§? RentrantReadWriteLockä¸ºä»€ä¹ˆä¸æ”¯æŒé”å‡çº§?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-ReentrantReadWriteLock%E5%BA%95%E5%B1%82%E8%AF%BB%E5%86%99%E7%8A%B6%E6%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%9A%84"><span class="toc-text">23. ReentrantReadWriteLockåº•å±‚è¯»å†™çŠ¶æ€å¦‚ä½•è®¾è®¡çš„?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E5%AE%B9%E5%99%A8-%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">å¹¶å‘å®‰å…¨å®¹å™¨&#x2F;å¹¶å‘å·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-JDK7%E4%B8%8EJDK8%E4%B9%8B%E9%97%B4HashMap%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">1. JDK7ä¸JDK8ä¹‹é—´HashMapçš„åŒºåˆ«ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-ConcurrentHashMap%E5%92%8CHashtable%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">2. ConcurrentHashMapå’ŒHashtableçš„åŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ConcurrentHashMap-JDK1-7%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">3. ConcurrentHashMap JDK1.7å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-ConcurrentHashMap-JDK1-8%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">4. ConcurrentHashMap JDK1.8å®ç°çš„åŸç†æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-ConcurrentHashMap-JDK1-7%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%92%8C1-8%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">5. ConcurrentHashMap JDK1.7çš„å®ç°å’Œ1.8çš„å®ç°æœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-JDK1-8%E4%B8%AD%EF%BC%8CConCurrentHashmap%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E9%93%BE%E8%A1%A8%E6%89%8D%E4%BC%9A%E8%BD%AC%E6%8D%A2%E6%88%90%E7%BA%A2%E9%BB%91%E6%A0%91%E8%BF%9B%E8%A1%8C%E5%AD%98%E5%82%A8"><span class="toc-text">6. JDK1.8ä¸­ï¼ŒConCurrentHashmapä»€ä¹ˆæƒ…å†µä¸‹é“¾è¡¨æ‰ä¼šè½¬æ¢æˆçº¢é»‘æ ‘è¿›è¡Œå­˜å‚¨?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-JDK1-8%E4%B8%AD%EF%BC%8CConcurrentHashmap%E7%9A%84put%E8%BF%87%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84"><span class="toc-text">7. JDK1.8ä¸­ï¼ŒConcurrentHashmapçš„putè¿‡ç¨‹æ˜¯æ€æ ·çš„?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-ConcurrentHashMap%E7%9A%84get%E6%96%B9%E6%B3%95%E6%98%AF%E5%90%A6%E8%A6%81%E5%8A%A0%E9%94%81%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88"><span class="toc-text">8. ConcurrentHashMapçš„getæ–¹æ³•æ˜¯å¦è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-ConcurrentHashMap%E9%BB%98%E8%AE%A4%E5%88%9D%E5%A7%8B%E5%AE%B9%E9%87%8F%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-text">9. ConcurrentHashMapé»˜è®¤åˆå§‹å®¹é‡æ˜¯å¤šå°‘?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-ConcurrentHashMap%E7%9A%84key%EF%BC%8Cvalue%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E4%B8%BAnull"><span class="toc-text">10. ConcurrentHashMapçš„keyï¼Œvalueæ˜¯å¦å¯ä»¥ä¸ºnull?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E5%AD%98%E5%82%A8%E5%9C%A8ConcurrentHashMap%E4%B8%AD%E6%AF%8F%E4%B8%AA%E8%8A%82%E7%82%B9%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8F%98%E9%87%8F"><span class="toc-text">11.å­˜å‚¨åœ¨ConcurrentHashMapä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæœ‰å“ªäº›å˜é‡?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E4%BB%80%E4%B9%88%E6%98%AFBlockingQueue"><span class="toc-text">12. ä»€ä¹ˆæ˜¯BlockingQueue?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E4%BD%A0%E4%BA%86%E8%A7%A3%E5%93%AA%E4%BA%9B%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-text">13.ä½ äº†è§£å“ªäº›é˜»å¡é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-ArrayBlockingQueue%E5%92%8CLinkedBlockingQueue%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">14. ArrayBlockingQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E5%A6%82%E6%9E%9C%E9%98%9F%E5%88%97%E6%98%AF%E7%A9%BA%E7%9A%84%EF%BC%8C%E6%B6%88%E8%B4%B9%E8%80%85%E4%BC%9A%E4%B8%80%E7%9B%B4%E7%AD%89%E5%BE%85%EF%BC%8C%E5%BD%93%E7%94%9F%E4%BA%A7%E8%80%85%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0%E6%97%B6%EF%BC%8C%E6%B6%88%E8%B4%B9%E8%80%85%E6%98%AF%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E5%BD%93%E5%89%8D%E9%98%9F%E5%88%97%E6%9C%89%E5%85%83%E7%B4%A0%E7%9A%84%E5%91%A2"><span class="toc-text">15. å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…ä¼šä¸€ç›´ç­‰å¾…ï¼Œå½“ç”Ÿäº§è€…æ·»åŠ å…ƒç´ æ—¶ï¼Œæ¶ˆè´¹è€…æ˜¯å¦‚ä½•çŸ¥é“å½“å‰é˜Ÿåˆ—æœ‰å…ƒç´ çš„å‘¢?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-CountDownLatch%EF%BC%8CCyclicBarrier%EF%BC%8CSemaphore%EF%BC%8CExchanger%E4%BA%86%E8%A7%A3%E5%90%97"><span class="toc-text">16. CountDownLatchï¼ŒCyclicBarrierï¼ŒSemaphoreï¼ŒExchangeräº†è§£å—?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-CyclicBarrier%E5%92%8CCountDownLatch%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">17. CyclicBarrierå’ŒCountDownLatchæœ‰ä»€ä¹ˆåŒºåˆ«?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0"><span class="toc-text">18.å¸¸è§å‡½æ•°</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">é­”æ”¹æŒ‡å—</a><a href="/box/nav/">ç½‘å€å¯¼èˆª</a></li><li><a href="/social/link/">æˆ‘çš„æœ‹å‹</a><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="/personal/about/">å…³äºä½œè€…</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/Gallery/">æˆ‘çš„ç”»å»Š</a><a href="/personal/bb/">æˆ‘çš„å” å¨</a></li><li><a href="/site/time/">å»ºè®¾è¿›ç¨‹</a><a href="/site/census/">ç½‘ç«™ç»Ÿè®¡</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/" title="FomalhautğŸ¥"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/60e5d4e39da7c077.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2025</b></span><span><b>&nbsp;&nbsp;By OutOfLoveğŸ¥</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="æœ¬ç«™æ•°æ®åˆ†æå¾—ç›Šäº51laæŠ€æœ¯æ”¯æŒ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="æœ¬ç«™å·²åŠ å…¥èŒICPè±ªåå¥—é¤ï¼ŒèŒICPå¤‡20226665å·"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/èŒICPå¤‡-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="æœ¬ç½‘ç«™ç»Service Workeråˆ†æµè‡³ç¼¤çº·äº‘å¯¹è±¡å­˜å‚¨"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-ç¼¤çº·äº‘-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨ç½‘ç›¾æ˜Ÿçƒæä¾›CDNåŠ é€Ÿä¸é˜²æŠ¤"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-ç½‘ç›¾æ˜Ÿçƒ-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç½‘ç«™æºç ç”±Githubæä¾›å­˜å‚¨ä»“åº“"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>ç¾åŒ–è®¾ç½®</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://outoflovenicoo.github.io/categories/åˆ·é¢˜/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¡ MakeFanã®åˆ·é¢˜ç¬”è®° (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://outoflovenicoo.github.io/categories/é¢è¯•é¢˜/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¼ MakeFanã®é¢è¯•é¢˜æ€»ç»“ (9)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://outoflovenicoo.github.io/categories/å­¦ä¹ æ–¹æ³•ä¼˜åŒ–/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ‰ MakeFanã®å­¦ä¹ æ–¹æ³•ä¼˜åŒ–åæ€ (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://outoflovenicoo.github.io/categories/å­¦ä¹ /"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸŸ MakeFanã®å­¦ä¹ ç¬”è®° (10)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://outoflovenicoo.github.io/categories/æ¼”ç¤º/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¥ å°Fã®æ¡ˆä¾‹æ¼”ç¤ºç¬”è®° (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://outoflovenicoo.github.io/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';
    console.log('å·²æŒ‚è½½magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-03-09-MySQL å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-03-09-MySQL å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ.html&quot;);" href="javascript:void(0);" alt="">MySQL å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ</a><div class="blog-slider__text">ğŸ¥§MySQL å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-03-09-MySQL å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-03-09-è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-03-09-è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">ğŸ¥§è”åˆç´¢å¼•å­¦ä¹ </div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-03-09-è”åˆç´¢å¼•å­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-å®ä¹ ç»éªŒ.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-å®ä¹ ç»éªŒ.html&quot;);" href="javascript:void(0);" alt="">å®ä¹ ç»éªŒ</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„å®ä¹ ç»éªŒæ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-å®ä¹ ç»éªŒ.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“.html&quot;);" href="javascript:void(0);" alt="">é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“</a><div class="blog-slider__text">ğŸ¥§é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-é˜¿é‡Œå¼€å‘è§„çº¦å­¦ä¹ æ€»ç»“.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">JVMåŸºç¡€é¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§JVMåŸºç¡€é¢è¯•é¢˜æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JVMåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-Redisé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-Redisé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">Redisé¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„Redisé¢è¯•é¢˜</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-Redisé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-åœºæ™¯é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-åœºæ™¯é¢˜.html&quot;);" href="javascript:void(0);" alt="">åœºæ™¯é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„åœºæ™¯é¢˜é¢è¯•æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-åœºæ™¯é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025331n.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025331n.html&quot;);" href="javascript:void(0);" alt="">åˆ†å¸ƒå¼å­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„åˆ†å¸ƒå¼å­¦ä¹ ç¬”è®°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025331n.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">SpringåŸºç¡€é¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„SpringåŸºç¡€é¢è¯•æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-SpringåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025331m.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025331m.html&quot;);" href="javascript:void(0);" alt="">Rabbitmqé¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„Rabbitmqé¢è¯•é¢˜æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025331m.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025331p.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025331p.html&quot;);" href="javascript:void(0);" alt="">MyBatisé¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„MyBatisé¢è¯•é¢˜æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025331p.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023454z.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023454z.html&quot;);" href="javascript:void(0);" alt="">å­¦ä¹ æ–¹æ³•ä¼˜åŒ–ä¸åæ€</a><div class="blog-slider__text">ğŸ¥§å­¦ä¹ æ–¹æ³•ä¼˜åŒ–ä¸åæ€</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023454z.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">JUCåŸºç¡€é¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„JUCåŸºç¡€é¢è¯•æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-09-JUCåŸºç¡€é¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-06-09-Hot100åˆ·é¢˜ç¬”è®°.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-06-09-Hot100åˆ·é¢˜ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">Hot100åˆ·é¢˜ç¬”è®°</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„Hot100åˆ·é¢˜ç¬”è®°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-06-09-Hot100åˆ·é¢˜ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2025-01-01-JavaåŸºç¡€.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2025-01-01-JavaåŸºç¡€.html&quot;);" href="javascript:void(0);" alt="">JavaåŸºç¡€é¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„JavaåŸºç¡€é¢è¯•æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2025-01-01-JavaåŸºç¡€.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Rediså­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Rediså­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">Rediså­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„Rediså­¦ä¹ ç¬”è®°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Rediså­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024-06-09-æ’åºç®—æ³•æ€»ç»“.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-10-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024-06-09-æ’åºç®—æ³•æ€»ç»“.html&quot;);" href="javascript:void(0);" alt="">æ’åºç®—æ³•æ€»ç»“</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„æ’åºç®—æ³•æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024-06-09-æ’åºç®—æ³•æ€»ç»“.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024-08-09-å¥½çš„åšå®¢åˆ†äº«.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024-08-09-å¥½çš„åšå®¢åˆ†äº«.html&quot;);" href="javascript:void(0);" alt="">å¥½çš„åšå®¢åˆ†äº«</a><div class="blog-slider__text">ğŸ¥§å¥½çš„åšå®¢å­¦ä¹ åˆ†äº«</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024-08-09-å¥½çš„åšå®¢åˆ†äº«.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Springå­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Springå­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">Springå­¦ä¹ ç¬”è®°</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„Springå­¦ä¹ ç¬”è®°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-01-09-Springå­¦ä¹ ç¬”è®°.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MySQLé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MySQLé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">MySQLé¢è¯•é¢˜</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„MySQLé¢è¯•é¢˜æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MySQLé¢è¯•é¢˜.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MyBatis-Plus-å…¥é—¨.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MyBatis-Plus-å…¥é—¨.html&quot;);" href="javascript:void(0);" alt="">MyBatis Plus å…¥é—¨</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„MyBatisé¢è¯•é¢˜æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-01-09-MyBatis-Plus-å…¥é—¨.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2023-01-09-GitåŸºç¡€.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_15.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2023-01-09-GitåŸºç¡€.html&quot;);" href="javascript:void(0);" alt="">GitåŸºç¡€</a><div class="blog-slider__text">ğŸ¥§æœ¬äººçš„GitåŸºç¡€æ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2023-01-09-GitåŸºç¡€.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --></body></html>